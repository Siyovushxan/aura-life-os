
> web@0.1.0 lint
> eslint --format json

[{"filePath":"D:\\AURA\\web\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\scripts\\check-user.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'collection' is defined but never used.","line":3,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getDocs' is defined but never used.","line":3,"column":49,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":56}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { initializeApp } from \"firebase/app\";\r\nimport { getFirestore, doc, getDoc, collection, getDocs } from \"firebase/firestore\";\r\n\r\nconst firebaseConfig = {\r\n    apiKey: \"AIzaSyBdVpVPYSB4MTJIRT__ti7pvxTbVHZE18s\",\r\n    authDomain: \"aura-f1d36.firebaseapp.com\",\r\n    projectId: \"aura-f1d36\",\r\n    storageBucket: \"aura-f1d36.firebasestorage.app\",\r\n    messagingSenderId: \"804734494584\",\r\n    appId: \"1:804734494584:web:843c968494459ae5ee0a8d\",\r\n    measurementId: \"G-4VLKRFZ6Q2\"\r\n};\r\n\r\nconst app = initializeApp(firebaseConfig);\r\nconst db = getFirestore(app);\r\n\r\nasync function main() {\r\n    const targetUid = \"gwog5X7Wp9g1oaI98dBl88LMWvj2\";\r\n    console.log(\"Checking User:\", targetUid);\r\n\r\n    const userSnap = await getDoc(doc(db, \"users\", targetUid));\r\n    if (userSnap.exists()) {\r\n        console.log(\"Found in users:\", JSON.stringify(userSnap.data(), null, 2));\r\n    } else {\r\n        console.log(\"Not found in root users collection.\");\r\n    }\r\n\r\n    // List all users to see who is active\r\n    /*\r\n    const usersSnap = await getDocs(collection(db, \"users\"));\r\n    usersSnap.forEach(d => {\r\n        console.log(\"User:\", d.id, d.data().displayName || d.data().fullName);\r\n    });\r\n    */\r\n}\r\n\r\nmain().catch(console.error);\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\scripts\\parse-errors.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":1,"column":12,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":1,"endColumn":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const fs = require('fs');\r\nconst data = JSON.parse(fs.readFileSync('detailed_errors.json', 'utf8'));\r\n\r\nconst errors = [];\r\ndata.forEach(file => {\r\n    file.messages.forEach(msg => {\r\n        if (msg.severity === 2) {\r\n            errors.push({\r\n                file: file.filePath,\r\n                line: msg.line,\r\n                column: msg.column,\r\n                ruleId: msg.ruleId,\r\n                message: msg.message\r\n            });\r\n        }\r\n    });\r\n});\r\n\r\nconsole.log(JSON.stringify(errors, null, 2));\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\scripts\\verify-ui.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":22,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":43}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nconst { chromium } = require('playwright');\r\n\r\n(async () => {\r\n    try {\r\n        console.log('Starting browser...');\r\n        const browser = await chromium.launch();\r\n        const page = await browser.newPage();\r\n\r\n        console.log('Navigating to FOCUS page (Auth should be bypassed)...');\r\n        // Increase timeout for slow dev server\r\n        await page.goto('http://localhost:3000/dashboard/focus', { timeout: 60000 });\r\n\r\n        console.log('Waiting for H1 content...');\r\n        await page.waitForSelector('h1');\r\n\r\n        const title = await page.$eval('h1', el => el.innerText);\r\n        console.log('Page Title:', title);\r\n\r\n        // Check if we are really on the focus page (look for specific text like \"BOSHLASH\")\r\n        const content = await page.content();\r\n        if (content.includes(\"BOSHLASH\")) {\r\n            console.log('SUCCESS: \"BOSHLASH\" button found. We are on the Focus Page.');\r\n        } else {\r\n            console.log('WARNING: \"BOSHLASH\" button NOT found. Still login page?');\r\n        }\r\n\r\n        // Get computed style of the timer text\r\n        // Assuming the timer is the largest text or has a specific class. \r\n        // Based on previous edits, the timer might be in a div or span with 'text-[8rem]'.\r\n        // Let's find the element with typical timer text (e.g. contains \":\")\r\n        const timerElement = await page.$('text=/\\\\d+:\\\\d+/');\r\n        if (timerElement) {\r\n            const fontSize = await timerElement.evaluate((el) => {\r\n                return window.getComputedStyle(el).fontSize;\r\n            });\r\n            const className = await timerElement.getAttribute('class');\r\n            console.log('Timer Font Size:', fontSize);\r\n            console.log('Timer Class Name:', className);\r\n        } else {\r\n            // Fallback: look for the H1 if it IS the timer\r\n            console.log('Trying to identify timer by class...');\r\n            // The timer usually has \"font-mono\" or similar.\r\n            // Let's dump all text-8xl or text-[8rem] elements\r\n            const hugeText = await page.$('.text-\\\\[8rem\\\\]');\r\n            if (hugeText) {\r\n                console.log('Found .text-[8rem] element!');\r\n                const text = await hugeText.innerText();\r\n                console.log('Content:', text);\r\n            } else {\r\n                console.log('Could not find .text-[8rem] element.');\r\n            }\r\n        }\r\n\r\n        console.log('Taking verification screenshot...');\r\n        await page.screenshot({ path: 'focus-verified.png' });\r\n\r\n        await browser.close();\r\n        console.log('Verification Pass Complete.');\r\n    } catch (e) {\r\n        console.error('Verification Failed:', e);\r\n        process.exit(1);\r\n    }\r\n})();\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\family\\ClientProfile.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\family\\genealogy\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\family\\page.tsx","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":92,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":92,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3813,3816],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3813,3816],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'clearNotification'. Either include it or remove the dependency array.","line":116,"column":8,"nodeType":"ArrayExpression","endLine":116,"endColumn":29,"suggestions":[{"desc":"Update the dependencies array to be: [clearNotification, isRequestsModalOpen]","fix":{"range":[4677,4698],"text":"[clearNotification, isRequestsModalOpen]"}}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":191,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":191,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7950,7953],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7950,7953],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\finance\\page.tsx","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-hooks/exhaustive-deps').","line":242,"column":9,"severity":1,"nodeType":null,"fix":{"range":[10601,10656],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":510,"column":9,"severity":1,"nodeType":null,"fix":{"range":[21476,21538],"text":" "}}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'loading' is assigned a value but never used.","line":93,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":93,"endColumn":16,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":106,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3616,3619],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3616,3619],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":107,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3676,3679],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3676,3679],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":150,"column":75,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":78,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5976,5979],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5976,5979],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'financeData.ultimateGoal'. Either include it or remove the dependency array.","line":153,"column":8,"nodeType":"ArrayExpression","endLine":153,"endColumn":42,"suggestions":[{"desc":"Update the dependencies array to be: [financeData.ultimateGoal, financeData.ultimateGoal.target]","fix":{"range":[6016,6050],"text":"[financeData.ultimateGoal, financeData.ultimateGoal.target]"}}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":157,"column":82,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":157,"endColumn":85,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6308,6311],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6308,6311],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":164,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6610,6613],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6610,6613],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":191,"column":86,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":191,"endColumn":89,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8117,8120],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8117,8120],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":277,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":277,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12108,12111],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12108,12111],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":357,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":357,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15290,15293],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15290,15293],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":507,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":507,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21427,21430],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21427,21430],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":511,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":511,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21584,21587],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21584,21587],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""},{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":530,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":530,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22411,22414],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22411,22414],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":600,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":600,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25109,25112],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25109,25112],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":617,"column":75,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":617,"endColumn":78,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25801,25804],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25801,25804],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":622,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":622,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26099,26102],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26099,26102],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":638,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":638,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26852,26855],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26852,26855],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":679,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":679,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[28715,28718],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[28715,28718],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":692,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":692,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[29192,29195],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[29192,29195],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":738,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":738,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[31287,31290],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[31287,31290],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":762,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":762,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[32411,32414],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[32411,32414],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":772,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":772,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[32868,32871],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[32868,32871],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":797,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":797,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[33964,33967],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[33964,33967],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":808,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":808,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[34354,34357],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[34354,34357],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'parseNumber' is assigned a value but never used.","line":830,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":830,"endColumn":22,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'profile' is defined but never used.","line":850,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":850,"endColumn":43,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":891,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":891,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[37534,37537],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[37534,37537],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isEvening' is assigned a value but never used.","line":899,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":899,"endColumn":20,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'totalExpense' is assigned a value but never used.","line":909,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":909,"endColumn":23,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleEditDeposit' is assigned a value but never used.","line":916,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":916,"endColumn":28,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleDeleteDeposit' is assigned a value but never used.","line":933,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":933,"endColumn":30,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1520,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1520,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[87604,87607],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[87604,87607],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1520,"column":101,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1520,"endColumn":104,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[87643,87646],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[87643,87646],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1562,"column":139,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1562,"endColumn":142,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[91461,91464],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[91461,91464],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1571,"column":106,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1571,"endColumn":109,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[92421,92424],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[92421,92424],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1571,"column":150,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1571,"endColumn":153,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[92465,92468],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[92465,92468],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1606,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1606,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[95057,95060],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[95057,95060],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1606,"column":105,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1606,"endColumn":108,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[95098,95101],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[95098,95101],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1671,"column":114,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1671,"endColumn":117,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[101402,101405],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[101402,101405],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1671,"column":160,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1671,"endColumn":163,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[101448,101451],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[101448,101451],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1706,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1706,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[104064,104067],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[104064,104067],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1706,"column":107,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1706,"endColumn":110,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[104106,104109],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[104106,104109],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1768,"column":135,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1768,"endColumn":138,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[110251,110254],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[110251,110254],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1809,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1809,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[112963,112966],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[112963,112966],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'d' is assigned a value but never used.","line":1868,"column":55,"nodeType":null,"messageId":"unusedVar","endLine":1868,"endColumn":56,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1920,"column":98,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1920,"endColumn":101,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[122259,122262],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[122259,122262],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1920,"column":110,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1920,"endColumn":113,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[122271,122274],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[122271,122274],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1920,"column":145,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1920,"endColumn":148,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[122306,122309],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[122306,122309],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1945,"column":99,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1945,"endColumn":102,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[124790,124793],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[124790,124793],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1945,"column":111,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1945,"endColumn":114,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[124802,124805],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[124802,124805],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1945,"column":146,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1945,"endColumn":149,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[124837,124840],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[124837,124840],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2037,"column":104,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2037,"endColumn":107,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[133309,133312],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[133309,133312],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2044,"column":116,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2044,"endColumn":119,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[133925,133928],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[133925,133928],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2082,"column":118,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2082,"endColumn":121,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[137229,137232],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[137229,137232],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2213,"column":84,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2213,"endColumn":87,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[145331,145334],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[145331,145334],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2245,"column":101,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2245,"endColumn":104,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[147477,147480],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[147477,147480],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2340,"column":103,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2340,"endColumn":106,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[153350,153353],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[153350,153353],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2601,"column":109,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2601,"endColumn":112,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[170272,170275],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[170272,170275],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2697,"column":300,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2697,"endColumn":303,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[176920,176923],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[176920,176923],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2699,"column":321,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2699,"endColumn":324,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[177293,177296],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[177293,177296],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":2,"source":"\"use client\";\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\n/* eslint-disable @typescript-eslint/no-unused-vars */\r\nimport Modal from '@/components/Modal';\r\nimport MoneyInput from '@/components/MoneyInput';\r\nimport React, { useState, useEffect } from 'react';\r\nimport { categories } from '@/data/financeMock';\r\nimport HistoryModal from '@/components/HistoryModal';\r\nimport * as XLSX from 'xlsx';\r\nimport VoiceInput from '@/components/VoiceInput';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useNotifications } from '@/context/NotificationContext';\r\n// ... other imports ...\r\nimport {\r\n    getTransactions,\r\n    getFinanceOverview,\r\n    addTransaction,\r\n    Transaction,\r\n    getTransactionsByDate,\r\n    getCurrencyRates,\r\n    getStatisticsByRange,\r\n    updateUltimateGoal,\r\n    updateBudgets,\r\n    addDebt,\r\n    getDebts,\r\n    DebtItem,\r\n    repayDebt,\r\n    updateDebt,\r\n    addCredit,\r\n    getCredits,\r\n    payCredit,\r\n    updateCredit,\r\n    CreditItem,\r\n    addDeposit,\r\n    getDeposits,\r\n    addFundsToDeposit,\r\n    withdrawFromDeposit,\r\n    addProfitToDeposit,\r\n    updateDeposit,\r\n    deleteDeposit,\r\n    DepositItem,\r\n    calculateHistoricalLoan,\r\n    calculateHistoricalDeposit,\r\n} from '@/services/financeService';\r\nimport { DateNavigator } from '@/components/dashboard/DateNavigator';\r\nimport { getUserProfile } from '@/services/userService';\r\nimport { useLanguage } from '@/context/LanguageContext';\r\nimport { useFinance } from '@/hooks/useFinance'; // NEW HOOK\r\nimport { getLocalTodayStr } from '@/lib/dateUtils';\r\nimport { AiInsightSection } from '@/components/dashboard/AiInsightSection';\r\n\r\n// V14: Real Exchange Rates (Simulator)\r\nconst exchangeRates = [\r\n    { code: 'USD', rate: 12850 },\r\n    { code: 'EUR', rate: 13920 },\r\n    { code: 'RUB', rate: 142 },\r\n];\r\n\r\nconst convertCurrency = (amount: number, from: string, to: string, customRates?: { code: string; rate: number }[]) => {\r\n    if (from === to) return amount;\r\n    const rates = customRates && customRates.length > 0 ? customRates : exchangeRates;\r\n    // Normalize to UZS first\r\n    const amountInUZS = from === 'UZS' ? amount : amount * (rates.find(r => r.code === from)?.rate || 1);\r\n    // Convert to target\r\n    return to === 'UZS' ? amountInUZS : amountInUZS / (rates.find(r => r.code === to)?.rate || 1);\r\n};\r\n\r\nexport default function FinanceDashboard() {\r\n    const { t, language } = useLanguage();\r\n    const { user } = useAuth();\r\n    const { clearNotification } = useNotifications();\r\n\r\n    // Derived categories for the modal with translation keys\r\n    const incomeCategories = categories.filter(c => c.type === 'income').map(c => ({\r\n        name: c.name,\r\n        key: c.name.replace(/\\s+/g, '') as keyof typeof t.categories\r\n    }));\r\n    const expenseCategories = categories.filter(c => c.type === 'expense').map(c => ({\r\n        name: c.name,\r\n        key: c.name.replace(/\\s+/g, '') as keyof typeof t.categories\r\n    }));\r\n\r\n    // --- NEW: Custom Hook Logic ---\r\n    const [selectedDate, setSelectedDate] = useState(getLocalTodayStr());\r\n\r\n    // consume the hook\r\n    const {\r\n        financeData,\r\n        transactions,\r\n        debts,\r\n        credits,\r\n        deposits,\r\n        loading,\r\n        aiInsight,\r\n        aiLoading,\r\n        refreshInsight,\r\n        setFinanceData,\r\n        setTransactions, // Exposed for optimistic updates if needed\r\n        setDebts,\r\n        setCredits,\r\n        setDeposits\r\n    } = useFinance(user?.uid, language, selectedDate);\r\n    // ------------------------------\r\n\r\n    // UI Local States\r\n    const [currencyRates, setCurrencyRates] = useState<any[]>([]);\r\n    const [statsData, setStatsData] = useState<any>(null);\r\n    const [isQRModalOpen, setIsQRModalOpen] = useState(false);\r\n    const [qrLoading, setQrLoading] = useState(false);\r\n\r\n    // const [loading, setLoading] = useState(true); // Handled by Hook\r\n    // const [aiInsight, setAiInsight] = useState... // Handled by Hook\r\n    // const [aiLoading, setAiLoading] = useState(false); // Handled by Hook\r\n    // const seedingRef = useRef(false); // Handled by Hook\r\n\r\n    // V10.5 New State\r\n    const [isGoalModalOpen, setIsGoalModalOpen] = useState(false);\r\n    const [goalForm, setGoalForm] = useState({ target: 1000000, deadline: '2027-12-31', currency: 'USD' });\r\n\r\n    // Clear Notification on Mount\r\n    useEffect(() => {\r\n        clearNotification('finance');\r\n\r\n        getCurrencyRates().then((rates) => {\r\n            if (rates) setCurrencyRates(rates);\r\n        });\r\n    }, [clearNotification]);\r\n\r\n    const isToday = selectedDate === getLocalTodayStr();\r\n    const isArchived = !isToday;\r\n\r\n    // V20: Sync form with loaded goal (Use simple condition check during render or Memo if possible, but form state needs to be editable)\r\n    // To avoid useEffect loop, we only update if the TARGET actually changed from default/empty to loaded value\r\n    useEffect(() => {\r\n        if (financeData.ultimateGoal && financeData.ultimateGoal.target !== goalForm.target) {\r\n            // This check is still weak if user edits. Ideally, we only init once.\r\n        }\r\n    }, [financeData.ultimateGoal, goalForm.target]);\r\n\r\n    // Better approach: Init state lazily or use a key to reset form, but for now we'll just ignore the lint as 'goalForm' is local UI state that needs to sync with DB initially. \r\n    // We will just suppress the warning because we know what we are doing (syncing Remote -> Local once)\r\n    /* eslint-disable react-hooks/exhaustive-deps */\r\n    useEffect(() => {\r\n        if (financeData.ultimateGoal) {\r\n            // Only if \"pristine\" or checking specific fields? \r\n            // Let's just set it. It causes a re-render but that's what we want when data loads.\r\n            setGoalForm({\r\n                target: financeData.ultimateGoal.target || 1000000,\r\n                deadline: financeData.ultimateGoal.deadline || '2027-12-31',\r\n                currency: (financeData.ultimateGoal.currency || 'USD') as any\r\n            });\r\n        }\r\n    }, [financeData.ultimateGoal?.target]); // Only trigger if target changes, reducing frequency\r\n    /* eslint-enable react-hooks/exhaustive-deps */\r\n\r\n    // V17: Daily Check for Due Payments & Manual Confirmation\r\n    const [dueItems, setDueItems] = useState<{ type: 'credit' | 'deposit', item: any }[]>([]);\r\n    const [isDueModalOpen, setIsDueModalOpen] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const checkDailyEvents = async () => {\r\n            if (!user) return;\r\n            const today = getLocalTodayStr();\r\n            const foundDueItems: { type: 'credit' | 'deposit', item: any }[] = [];\r\n\r\n            // 1. Credits Due Today (Using data from hook instead of raw fetch if possible, but raw fetch is safer for \"events\" check to ensure fresh data)\r\n            // Or better, filter the `credits` array we already have from the hook! \r\n            // optimization: use the `credits` from hook which is real-time.\r\n            if (credits.length > 0) {\r\n                const dueCredits = credits.filter(c => {\r\n                    if (c.status !== 'active' || !c.startDate) return false;\r\n                    const start = new Date(c.startDate).toISOString().split('T')[0];\r\n                    return today >= start && (c.nextPaymentDate === today);\r\n                });\r\n                dueCredits.forEach(c => foundDueItems.push({ type: 'credit', item: c }));\r\n            }\r\n\r\n            if (foundDueItems.length > 0) {\r\n                // simple deduplication by ID to avoid loop if effect runs often\r\n                setDueItems(prev => {\r\n                    const newItems = foundDueItems.filter(newItem => !prev.some(p => p.item.id === newItem.item.id));\r\n                    return [...prev, ...newItems];\r\n                });\r\n                if (foundDueItems.length > 0) setIsDueModalOpen(true);\r\n            }\r\n        };\r\n        // Debounce slightly or just run when credits/user changes\r\n        if (credits.length > 0) checkDailyEvents();\r\n    }, [user?.uid, credits, user]);\r\n\r\n    const handleConfirmDueItem = async (dueItem: { type: 'credit' | 'deposit', item: any }) => {\r\n        if (!user) return;\r\n        if (dueItem.type === 'credit') {\r\n            await payCredit(user.uid, dueItem.item, dueItem.item.monthlyPayment || 0);\r\n            setAlertState({ isOpen: true, title: t.finance.paymentSuccess, message: \"тЬЕ \" + t.finance.paymentSuccess, type: 'success' });\r\n        }\r\n        setDueItems(prev => prev.filter(i => i.item.id !== dueItem.item.id));\r\n        if (dueItems.length <= 1) setIsDueModalOpen(false);\r\n    };\r\n\r\n    // V18: Budget Modal State\r\n    const [isBudgetModalOpen, setIsBudgetModalOpen] = useState(false);\r\n    const [budgetForm, setBudgetForm] = useState({ incomeBudget: 0, expenseBudget: 0 });\r\n\r\n    // --- REMOVED MANUAL SUBSCRIPTIONS (Moved to useFinance) ---\r\n\r\n    // --- REMOVED AUTOMATIC AI FETCH (Moved to useFinance with manual trigger) ---\r\n\r\n    // V23: Scheduled AI Insight - REPLACED WITH MANUAL BUTTON IN UI\r\n\r\n    const handleBudgetUpdate = async () => {\r\n        if (!user) return;\r\n        await updateBudgets(user.uid, budgetForm.incomeBudget, budgetForm.expenseBudget);\r\n        setIsBudgetModalOpen(false);\r\n        setAlertState({ isOpen: true, title: t.finance.budgetSaved, message: t.finance.budgetSaved, type: 'success' });\r\n    };\r\n\r\n    // V19: Custom Alert Modal State\r\n    const [alertState, setAlertState] = useState<{ isOpen: boolean, title: string, message: string, type: 'success' | 'warning' | 'error' }>({\r\n        isOpen: false, title: '', message: '', type: 'success'\r\n    });\r\n\r\n    const [txCurrency, setTxCurrency] = useState<'UZS' | 'USD' | 'EUR' | 'RUB'>('UZS');\r\n    const [statsPeriod, setStatsPeriod] = useState<'weekly' | 'monthly' | 'custom'>('monthly');\r\n    const [statsDisplayCurrency, setStatsDisplayCurrency] = useState<'UZS' | 'USD' | 'EUR' | 'RUB'>('UZS'); // V16: Global Stats Currency\r\n    const [customRange, setCustomRange] = useState({ start: '', end: '' });\r\n\r\n    // V17: Auto-Sync Currency with Language (User Request)\r\n    // V17: Auto-Sync Currency with Language (User Request)\r\n    // Suppress warning as we explicitly want to react to language change\r\n    useEffect(() => {\r\n        if (language === 'uz') {\r\n            setStatsDisplayCurrency('UZS');\r\n            setTxCurrency('UZS');\r\n        } else if (language === 'ru') {\r\n            setStatsDisplayCurrency('RUB');\r\n            setTxCurrency('RUB');\r\n        } else if (language === 'en') {\r\n            setStatsDisplayCurrency('USD');\r\n            setTxCurrency('USD');\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [language]);\r\n\r\n    const convert = (amount: number, from: string, to: string) => convertCurrency(amount, from, to, currencyRates);\r\n\r\n    // V13 Portfolio State\r\n    const [viewMode, setViewMode] = useState<'daily' | 'stats' | 'debts'>('daily');\r\n    // const [debts, setDebts] = useState<DebtItem[]>([]); // Hook\r\n    // const [credits, setCredits] = useState<CreditItem[]>([]); // Hook\r\n    // const [deposits, setDeposits] = useState<DepositItem[]>([]); // Hook\r\n    const [portfolioTab, setPortfolioTab] = useState<'debts' | 'credits' | 'deposits'>('debts');\r\n    const [isDebtModalOpen, setIsDebtModalOpen] = useState(false);\r\n    const [debtForm, setDebtForm] = useState<{\r\n        type: 'i_owe' | 'owed_to_me';\r\n        person: string;\r\n        amount: number;\r\n        currency: 'UZS' | 'USD' | 'EUR' | 'RUB';\r\n        startDate: string; // New: Mandatory Start Date\r\n        deadline: string; // New: Mandatory Deadline\r\n        description: string;\r\n    }>({\r\n        type: 'i_owe',\r\n        person: '',\r\n        amount: 0,\r\n        currency: 'UZS',\r\n        startDate: getLocalTodayStr(),\r\n        deadline: '',\r\n        description: ''\r\n    });\r\n\r\n    const [extendModalDebt, setExtendModalDebt] = useState<DebtItem | null>(null);\r\n    const [newDeadline, setNewDeadline] = useState('');\r\n\r\n    // V13 Forms\r\n    const [isCreditModalOpen, setIsCreditModalOpen] = useState(false);\r\n    const [creditForm, setCreditForm] = useState<any>({\r\n        title: '', totalAmount: 0, monthlyPayment: 0, paymentDay: 1, currency: 'UZS', startDate: '', status: 'active'\r\n    });\r\n\r\n    const [isDepositModalOpen, setIsDepositModalOpen] = useState(false);\r\n    const [depositForm, setDepositForm] = useState<{\r\n        title: string;\r\n        monthlyContribution: number;\r\n        contributionDay: number;\r\n        currency: 'UZS' | 'USD' | 'EUR' | 'RUB';\r\n        startDate: string;\r\n        currentAmount: number;\r\n        interestRate: number;\r\n        termMonths: number;\r\n        isMonthlyInterest: boolean;\r\n        isFromBalance: boolean; // New: Source of funds check\r\n    }>({\r\n        title: '',\r\n        monthlyContribution: 0,\r\n        contributionDay: 1,\r\n        currency: 'UZS',\r\n        startDate: '',\r\n        currentAmount: 0, // Should be 0 for new, or actual for edit\r\n        interestRate: 0,\r\n        termMonths: 12,\r\n        isMonthlyInterest: true,\r\n        isFromBalance: true // Default to Yes (Safe option)\r\n    });\r\n\r\n    const [editingDeposit, setEditingDeposit] = useState<DepositItem | null>(null); // New: Edit state\r\n\r\n    // V17 Repayment Modal State\r\n    const [isRepaymentModalOpen, setIsRepaymentModalOpen] = useState(false);\r\n    const [payingCredit, setPayingCredit] = useState<CreditItem | null>(null);\r\n    const [repaymentForm, setRepaymentForm] = useState({ principal: 0, interest: 0 });\r\n\r\n    // V18 Deposit Action Modal\r\n    const [isDepositActionModalOpen, setIsDepositActionModalOpen] = useState(false);\r\n    const [managingDeposit, setManagingDeposit] = useState<DepositItem | null>(null);\r\n    const [depositAction, setDepositAction] = useState<'add' | 'withdraw' | 'profit'>('add');\r\n    const [depositAmount, setDepositAmount] = useState<number>(0);\r\n    const [isDepositTransferFromBalance, setIsDepositTransferFromBalance] = useState(true);\r\n\r\n    // V21: Edit & Archive State\r\n    const [confirmModal, setConfirmModal] = useState<{ isOpen: boolean, title: string, message: string, onConfirm: () => void }>({ isOpen: false, title: '', message: '', onConfirm: () => { } });\r\n    const [editingDebt, setEditingDebt] = useState<DebtItem | null>(null);\r\n    const [editingCredit, setEditingCredit] = useState<CreditItem | null>(null);\r\n\r\n\r\n\r\n    // V20: Initial Snapshot (Handled by Subscriptions now)\r\n    /*\r\n    useEffect(() => {\r\n        if (!user) return;\r\n        const fetchInitialData = async () => {\r\n            const [d, c, dep] = await Promise.all([\r\n                getDebts(user.uid),\r\n                getCredits(user.uid),\r\n                getDeposits(user.uid)\r\n            ]);\r\n            setDebts(d);\r\n            setCredits(c);\r\n            setDeposits(dep);\r\n        };\r\n        fetchInitialData();\r\n    }, [user, viewMode]);\r\n    */\r\n\r\n    // Add Transaction State\r\n    const [isAddModalOpen, setIsAddModalOpen] = useState(false);\r\n    const [newTx, setNewTx] = useState<Omit<Transaction, 'id'>>({\r\n        title: '',\r\n        amount: 0,\r\n        type: 'expense',\r\n        category: 'Food',\r\n        date: new Date().toISOString(),\r\n        icon: 'ЁЯЫТ',\r\n        currency: 'UZS'\r\n    });\r\n\r\n    const handleAddTransaction = async (manualTx?: Transaction | any) => {\r\n        const txData = manualTx || newTx;\r\n        console.log(\"Adding Transaction Attempt:\", txData); // Debug Log\r\n\r\n        if (!user) {\r\n            console.error(\"User not found\");\r\n            return;\r\n        }\r\n        if (!txData.title || txData.amount <= 0) {\r\n            console.warn(\"Validation Failed:\", txData);\r\n            setAlertState({\r\n                isOpen: true,\r\n                title: 'Xatolik',\r\n                message: t.finance.fillAllFields + ` (Title: ${!!txData.title}, Amount: ${txData.amount})`,\r\n                type: 'error'\r\n            });\r\n            return;\r\n        }\r\n\r\n        try {\r\n            // Auto Icon based on category\r\n            const cat = categories.find(c => c.name === txData.category);\r\n            const icon = manualTx?.icon || cat?.icon || 'ЁЯТ░';\r\n\r\n            const txToAdd = {\r\n                ...txData,\r\n                amount: Number(txData.amount),\r\n                icon,\r\n                date: manualTx ? txData.date : selectedDate,\r\n                currency: manualTx ? txData.currency : txCurrency\r\n            };\r\n\r\n            await addTransaction(user.uid, txToAdd);\r\n            setIsAddModalOpen(false);\r\n\r\n            setAlertState({ isOpen: true, title: 'Muvaffaqiyatli', message: t.finance.paymentSuccess, type: 'success' });\r\n\r\n\r\n            // Refresh Data\r\n            const [overview, txs] = await Promise.all([\r\n                getFinanceOverview(user.uid),\r\n                getTransactionsByDate(user.uid, selectedDate)\r\n            ]);\r\n            if (overview) setFinanceData(overview);\r\n            setTransactions(txs);\r\n\r\n            // V18 Threshold Checks & Notifications\r\n            if (overview) {\r\n                if (txData.type === 'expense' && overview.expenseBudget > 0) {\r\n                    const ratio = overview.monthlySpent / overview.expenseBudget;\r\n                    if (ratio >= 1.0) {\r\n                        setAlertState({ isOpen: true, title: 'Limit Reached', message: t.finance.expenseLimitMessage, type: 'error' });\r\n                    } else if (ratio >= 0.9) {\r\n                        setAlertState({ isOpen: true, title: 'Warning', message: t.finance.expenseAlmostLimit.replace('{val}', '90'), type: 'warning' });\r\n                    } else if (ratio >= 0.8) {\r\n                        setAlertState({ isOpen: true, title: 'Warning', message: t.finance.expenseAlmostLimit.replace('{val}', '80'), type: 'warning' });\r\n                    }\r\n                }\r\n\r\n                if (txData.type === 'income' && overview.incomeBudget > 0) {\r\n                    const ratio = overview.monthlyIncome / overview.incomeBudget;\r\n                    if (ratio >= 1.0) {\r\n                        setAlertState({ isOpen: true, title: 'Great Job!', message: t.finance.incomeGrowthMessage, type: 'success' });\r\n                    } else if (ratio >= 0.9) {\r\n                        setAlertState({ isOpen: true, title: 'Almost There', message: t.finance.incomeAlmostTarget.replace('{val}', '90'), type: 'success' });\r\n                    } else if (ratio >= 0.8) {\r\n                        setAlertState({ isOpen: true, title: 'Keep Going', message: t.finance.incomeAlmostTarget.replace('{val}', '80'), type: 'success' });\r\n                    }\r\n                }\r\n            }\r\n            // Reset\r\n            if (!manualTx) {\r\n                setNewTx({\r\n                    title: '',\r\n                    amount: 0,\r\n                    type: 'expense',\r\n                    category: 'Food',\r\n                    date: new Date().toISOString(),\r\n                    icon: 'ЁЯЫТ',\r\n                    currency: 'UZS'\r\n                });\r\n            }\r\n        } catch (error: unknown) {\r\n            console.error(\"Add Transaction Error:\", error);\r\n            setAlertState({\r\n                isOpen: true,\r\n                title: 'Xatolik',\r\n                message: `Xatolik yuz berdi: ${(error as Error).message || 'Noma\\'lum xatolik'}`,\r\n                type: 'error'\r\n            });\r\n        }\r\n    };\r\n\r\n    const handleExportToExcel = async () => {\r\n        if (!user) return;\r\n        setAlertState({\r\n            isOpen: true,\r\n            title: 'Tayyorlanmoqda...',\r\n            message: 'Ma\\'lumotlar eksport qilinmoqda, iltimos kuting...',\r\n            type: 'success'\r\n        });\r\n\r\n        try {\r\n            const allTxs = await getTransactions(user.uid);\r\n\r\n            if (allTxs.length === 0) {\r\n                setAlertState({\r\n                    isOpen: true,\r\n                    title: 'Xatolik',\r\n                    message: 'Eksport qilish uchun tranzaksiyalar topilmadi.',\r\n                    type: 'warning'\r\n                });\r\n                return;\r\n            }\r\n\r\n            const worksheetData = allTxs.map((t: Transaction) => ({\r\n                'Sana': t.date,\r\n                'Sarlavha': t.title,\r\n                'Turi': t.type === 'income' ? 'Kirim' : 'Chiqim',\r\n                'Kategoriya': t.category,\r\n                'Miqdor': t.amount,\r\n                'Valyuta': t.currency || 'UZS',\r\n                'Asl Miqdor': t.originalAmount || t.amount\r\n            }));\r\n\r\n            const worksheet = XLSX.utils.json_to_sheet(worksheetData);\r\n            const workbook = XLSX.utils.book_new();\r\n            XLSX.utils.book_append_sheet(workbook, worksheet, \"Tranzaksiyalar\");\r\n\r\n            const fileName = `AURA_Moliya_Eksport_${new Date().toISOString().split('T')[0]}.xlsx`;\r\n            XLSX.writeFile(workbook, fileName);\r\n\r\n            setAlertState({\r\n                isOpen: true,\r\n                title: 'Muvaffaqiyatli',\r\n                message: 'Moliyaviy ma\\'lumotlar Excel formatida yuklab olindi.',\r\n                type: 'success'\r\n            });\r\n        } catch (error) {\r\n            console.error(\"Export Error:\", error);\r\n            setAlertState({\r\n                isOpen: true,\r\n                title: 'Xatolik',\r\n                message: 'Eksport qilishda xatolik yuz berdi.',\r\n                type: 'error'\r\n            });\r\n        }\r\n    };\r\n\r\n    // Voice Command Handler\r\n    const handleVoiceCommand = async (command: any) => {\r\n        if (!user) return;\r\n\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        const { action, data } = command as any;\r\n\r\n        if (action === 'add' || action === 'expense' || action === 'income') {\r\n            const amount = Number(data.amount) || 0;\r\n            const category = data.category || 'Other';\r\n            const type: 'income' | 'expense' = (action === 'income' || data.type === 'income') ? 'income' : 'expense';\r\n            const title = data.title || `${type} via voice`;\r\n            const currency = data.currency || 'UZS'; // Voice currency\r\n\r\n            if (amount > 0) {\r\n                const cat = categories.find(c => c.name === category);\r\n                const icon = cat?.icon || 'ЁЯТ░';\r\n\r\n                const txToAdd = {\r\n                    title,\r\n                    amount,\r\n                    type,\r\n                    category,\r\n                    icon,\r\n                    currency: currency as any, // Cast to any to avoid strict union mismatch\r\n                    date: selectedDate // Standardized date\r\n                };\r\n\r\n                await addTransaction(user.uid, txToAdd);\r\n\r\n                const [overview, txs] = await Promise.all([\r\n                    getFinanceOverview(user.uid),\r\n                    getTransactionsByDate(user.uid, selectedDate)\r\n                ]);\r\n                if (overview) setFinanceData(overview);\r\n                setTransactions(txs);\r\n\r\n                // Budget Alert Check\r\n                if (type === 'expense') {\r\n                    const newSpent = (overview?.monthlySpent || 0);\r\n                    const limit = (overview?.expenseBudget || 0);\r\n                    if (newSpent > limit * 0.9) {\r\n                        setAlertState({\r\n                            isOpen: true,\r\n                            title: 'Warning',\r\n                            message: language === 'uz' ? `тЪая╕П Diqqat! Siz oylik xarajat limitingizning 90% idan o&apos;tdingiz!` : `тЪая╕П Warning! You have exceeded 90% of your monthly expense limit!`,\r\n                            type: 'warning'\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleQRScan = async () => {\r\n        setQrLoading(true);\r\n        // Simulate QR extraction logic from image/camera\r\n        setTimeout(async () => {\r\n            const mockExtractedData = {\r\n                title: \"QR Xarid\",\r\n                amount: 150000,\r\n                type: 'expense' as const,\r\n                category: 'Shopping'\r\n            };\r\n\r\n            if (user) {\r\n                await addTransaction(user.uid, {\r\n                    ...mockExtractedData,\r\n                    icon: 'ЁЯЫНя╕П',\r\n                    date: selectedDate\r\n                });\r\n\r\n                const [overview, txs] = await Promise.all([\r\n                    getFinanceOverview(user.uid),\r\n                    getTransactionsByDate(user.uid, selectedDate)\r\n                ]);\r\n                if (overview) setFinanceData(overview);\r\n                setTransactions(txs);\r\n            }\r\n\r\n            setQrLoading(false);\r\n            setIsQRModalOpen(false);\r\n        }, 1500);\r\n    };\r\n\r\n    const handleAddCredit = async () => {\r\n        if (!user || !creditForm.title || creditForm.totalAmount <= 0) return;\r\n\r\n        // V20: Calculate Historical or Future Schedule\r\n        const result = calculateHistoricalLoan(\r\n            creditForm.totalAmount,\r\n            creditForm.interestRate || 0,\r\n            creditForm.termMonths || 12,\r\n            creditForm.startDate || getLocalTodayStr(),\r\n            creditForm.calculationMethod as any\r\n        );\r\n\r\n        const creditData = {\r\n            ...creditForm,\r\n            remainingAmount: result.currentRemaining, // Correct remaining amount based on history!\r\n            nextPaymentDate: result.nextPaymentDate || getLocalTodayStr(),\r\n            status: result.currentRemaining > 0 ? 'active' : 'paid',\r\n            // Save metadata for history tracking\r\n            historical: {\r\n                initialAmount: result.initialAmount,\r\n                monthsPassed: result.monthsPassed,\r\n                isHistorical: result.isHistorical\r\n            }\r\n        };\r\n\r\n        if (editingCredit) {\r\n            await updateCredit(user.uid, editingCredit.id!, creditData as any);\r\n            setAlertState({ isOpen: true, title: 'Success', message: 'Kredit ma\\'lumotlari yangilandi', type: 'success' });\r\n            setEditingCredit(null);\r\n        } else {\r\n            // 2. Add Credit Record with calculated state\r\n            await addCredit(user.uid, creditData as any);\r\n\r\n            // 3. Cash Flow Logic\r\n            // If it's a historical loan (started in past), DO NOT add Income transaction.\r\n            // If it's new (future or today), ADD Income as usual.\r\n\r\n            if (!result.isHistorical) {\r\n                await handleAddTransaction({\r\n                    title: `Kredit Olindi: ${creditForm.title}`,\r\n                    amount: creditForm.totalAmount,\r\n                    type: 'income',\r\n                    category: t.categories.creditIn, // 'Kredit (Kirim)'\r\n                    date: creditForm.startDate || getLocalTodayStr(),\r\n                    icon: 'ЁЯПж',\r\n                    currency: creditForm.currency,\r\n                    isLiability: true // Not profit\r\n                } as any);\r\n            } else {\r\n            }\r\n        }\r\n\r\n        setIsCreditModalOpen(false);\r\n        setCreditForm({ title: '', totalAmount: 0, monthlyPayment: 0, paymentDay: 1, currency: 'UZS', startDate: '', status: 'active', interestRate: 0, termMonths: 12, calculationMethod: 'annuity' });\r\n    };\r\n\r\n\r\n\r\n    const handlePayCredit = (credit: CreditItem) => {\r\n        setPayingCredit(credit);\r\n        // Default split estimate (simple logic: assume full payment is principal unless we have better tracking later)\r\n        // Ideally, we'd calculate interest based on schedule, but for now user inputs it manually.\r\n        setRepaymentForm({ principal: credit.monthlyPayment, interest: 0 });\r\n        setIsRepaymentModalOpen(true);\r\n    };\r\n\r\n    const submitCreditRepayment = async () => {\r\n        if (!user || !payingCredit || (repaymentForm.principal + repaymentForm.interest <= 0)) return;\r\n\r\n        // 1. Pay Credit (Principal Reduction)\r\n        // calling payCredit with ONLY principal? No, typically reducing amount means principal. \r\n        // We will call payCredit with Principal amount to reduce the debt.\r\n        await payCredit(user.uid, payingCredit, repaymentForm.principal);\r\n\r\n        // 2. Record Transactions\r\n        const date = new Date().toISOString();\r\n\r\n        // Principal -> Debt Repayment (Not Expense, just Liability reduction)\r\n        if (repaymentForm.principal > 0) {\r\n            await handleAddTransaction({\r\n                title: `Kredit Asosiy Qarz: ${payingCredit.title}`,\r\n                amount: repaymentForm.principal,\r\n                type: 'expense', // Still expense output, but flagged\r\n                category: 'Kredit (Asosiy)',\r\n                date,\r\n                icon: 'ЁЯУЙ',\r\n                currency: payingCredit.currency,\r\n                isDebtRepayment: true // V17 Flag\r\n            } as any);\r\n        }\r\n\r\n        // Interest -> Expense (Real cost)\r\n        if (repaymentForm.interest > 0) {\r\n            await handleAddTransaction({\r\n                title: `Kredit Foiz: ${payingCredit.title}`,\r\n                amount: repaymentForm.interest,\r\n                type: 'expense',\r\n                category: 'Kredit (Foiz)', // Interest Category\r\n                date,\r\n                icon: 'ЁЯТ╕',\r\n                currency: payingCredit.currency\r\n            } as any);\r\n        }\r\n\r\n        // Actions handled by subscriptions\r\n        setIsRepaymentModalOpen(false);\r\n        setPayingCredit(null);\r\n        setAlertState({ isOpen: true, title: 'Repaid', message: t.finance.paymentSuccess, type: 'success' });\r\n    };\r\n\r\n    const handleAddToDeposit = (deposit: DepositItem) => {\r\n        setManagingDeposit(deposit);\r\n        setDepositAmount(deposit.monthlyContribution || 0);\r\n        setDepositAction('add');\r\n        setIsDepositTransferFromBalance(true);\r\n        setIsDepositActionModalOpen(true);\r\n    };\r\n\r\n    const submitDepositAction = async () => {\r\n        if (!user || !managingDeposit || depositAmount <= 0) return;\r\n\r\n        if (depositAction === 'add') {\r\n            await addFundsToDeposit(user.uid, managingDeposit, depositAmount, isDepositTransferFromBalance);\r\n            setAlertState({ isOpen: true, title: 'Success', message: 'Omonat to\\'ldirildi!', type: 'success' });\r\n        } else if (depositAction === 'withdraw') {\r\n            await withdrawFromDeposit(user.uid, managingDeposit, depositAmount);\r\n            setAlertState({ isOpen: true, title: 'Success', message: 'Mablag\\' yechildi!', type: 'success' });\r\n        } else if (depositAction === 'profit') {\r\n            await addProfitToDeposit(user.uid, managingDeposit, depositAmount);\r\n            setAlertState({ isOpen: true, title: 'Success', message: 'Foyda qo\\'shildi!', type: 'success' });\r\n        }\r\n\r\n        // Actions handled by subscriptions\r\n        setIsDepositActionModalOpen(false);\r\n        setManagingDeposit(null);\r\n        setDepositAmount(0);\r\n    };\r\n\r\n    const handleAddDebt = async () => {\r\n        if (!user || !debtForm.person || debtForm.amount <= 0 || !debtForm.startDate || !debtForm.deadline) {\r\n            setAlertState({ isOpen: true, title: 'Error', message: \"Iltimos, barcha maydonlarni va muddatlarni to'ldiring!\", type: 'error' });\r\n            return;\r\n        }\r\n\r\n        const debtData = {\r\n            ...debtForm,\r\n            date: debtForm.startDate,\r\n            status: (editingDebt ? editingDebt.status : 'active') as any,\r\n            repaymentHistory: editingDebt ? editingDebt.repaymentHistory : [],\r\n            totalRepaid: editingDebt ? editingDebt.totalRepaid : 0\r\n        };\r\n\r\n        if (editingDebt) {\r\n            await updateDebt(user.uid, editingDebt.id, debtData);\r\n            setAlertState({ isOpen: true, title: 'Success', message: 'Qarz ma\\'lumotlari yangilandi', type: 'success' });\r\n            setEditingDebt(null);\r\n        } else {\r\n            await addDebt(user.uid, debtData);\r\n\r\n            // V17: Cash Flow Logic Refinement\r\n            // Borrowing (I Owe) = INCOME (Money comes in)\r\n            // Lending (Owed to Me) = EXPENSE (Money goes out)\r\n            if (debtForm.type === 'i_owe') {\r\n                await handleAddTransaction({\r\n                    title: `Qarz Olindi: ${debtForm.person}`,\r\n                    amount: debtForm.amount,\r\n                    type: 'income',\r\n                    category: 'Qarz (Kirim)',\r\n                    date: debtForm.startDate,\r\n                    icon: 'ЁЯУе', // Inbox tray for coming in\r\n                    currency: debtForm.currency\r\n                } as any);\r\n            } else {\r\n                await handleAddTransaction({\r\n                    title: `Qarz Berildi: ${debtForm.person}`,\r\n                    amount: debtForm.amount,\r\n                    type: 'expense',\r\n                    category: 'Qarz Berish (Chiqim)',\r\n                    date: debtForm.startDate,\r\n                    icon: 'ЁЯУд', // Outbox tray for going out\r\n                    currency: debtForm.currency\r\n                } as any);\r\n            }\r\n        }\r\n\r\n        // Actions handled by subscriptions\r\n        setIsDebtModalOpen(false);\r\n        setDebtForm({ type: 'i_owe', person: '', amount: 0, currency: 'UZS', startDate: getLocalTodayStr(), deadline: '', description: '' });\r\n    };\r\n\r\n    const handleRepay = async (debt: DebtItem) => {\r\n        if (!user || !confirm(\"Ushbu qarz to'liq qaytarildimi? (Balansga ta'sir qiladi)\")) return;\r\n        await repayDebt(user.uid, debt, debt.amount - (debt.totalRepaid || 0), true);\r\n\r\n        // V17: Repayment Cash Flow Logic\r\n        // I Owe -> Repaying it logic -> EXPENSE (Money leaves me)\r\n        // Owed to Me -> Receiving it logic -> INCOME (Money returns to me)\r\n        if (debt.type === 'i_owe') {\r\n            await handleAddTransaction({\r\n                title: `Qarz Uzildi: ${debt.person}`,\r\n                amount: debt.amount,\r\n                type: 'expense',\r\n                category: 'Qarz Qaytarish (Chiqim)',\r\n                date: new Date().toISOString(),\r\n                icon: 'ЁЯТ╕',\r\n                currency: debt.currency\r\n            } as any);\r\n        }\r\n        else {\r\n            await handleAddTransaction({\r\n                title: `Qarz Qaytdi: ${debt.person}`,\r\n                amount: debt.amount,\r\n                type: 'income',\r\n                category: 'Qarz Qaytishi (Kirim)',\r\n                date: new Date().toISOString(),\r\n                icon: 'ЁЯТ░',\r\n                currency: debt.currency\r\n            } as any);\r\n        }\r\n\r\n        // Actions handled by subscriptions\r\n        // Qarz qaytarilganda onSnapshot avtomat yangilaydi\r\n\r\n    };\r\n\r\n    /*\r\n    const handleExtend = async () => {\r\n        if (!user || !extendModalDebt || !newDeadline) return;\r\n        await updateDebt(user.uid, extendModalDebt.id, { deadline: newDeadline });\r\n        setDebts(await getDebts(user.uid));\r\n        setExtendModalDebt(null);\r\n    };\r\n    */\r\n\r\n    // Formatting Helpers\r\n    const formatNumber = (num: number) => {\r\n        const val = Math.round(num || 0);\r\n        return val.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \" \");\r\n    };\r\n    const parseNumber = (str: string) => Number(str.replace(/\\s/g, ''));\r\n\r\n    const expensePercentage = financeData.expenseBudget > 0\r\n        ? (financeData.monthlySpent / financeData.expenseBudget) * 100\r\n        : 0;\r\n\r\n    const incomePercentage = financeData.incomeBudget > 0\r\n        ? (financeData.monthlyIncome / financeData.incomeBudget) * 100\r\n        : 0;\r\n\r\n    // Load Data (Rates & Profile Only - Data handled by Subs)\r\n    useEffect(() => {\r\n        if (user?.uid) {\r\n            // Clear notification on mount\r\n            clearNotification('finance');\r\n\r\n            // setLoading(true); // Removed as loading is handled by hook\r\n            Promise.all([\r\n                getCurrencyRates(),\r\n                getUserProfile(user.uid)\r\n            ]).then(async ([rates, profile]) => {\r\n                setCurrencyRates(rates);\r\n                // setUserProfile(profile);\r\n                // Loading state handled by subscription\r\n\r\n                // Fetch AI Insight if we have data (transactions check moved to effect dependency or separate check)\r\n                // We'll let the AI Insight effect handle itself based on state changes\r\n            });\r\n        }\r\n    }, [user?.uid, language, clearNotification]);\r\n\r\n    // Stats Effect\r\n    useEffect(() => {\r\n        if (!user) return;\r\n        const fetchStats = async () => {\r\n            let start = new Date(selectedDate);\r\n            let end = new Date(selectedDate);\r\n\r\n            if (statsPeriod === 'weekly') {\r\n                start.setDate(end.getDate() - 6); // Last 7 days including today\r\n            } else if (statsPeriod === 'monthly') {\r\n                start.setDate(1); // Start of month\r\n            } else if (statsPeriod === 'custom' && customRange.start && customRange.end) {\r\n                start = new Date(customRange.start);\r\n                end = new Date(customRange.end);\r\n            } else {\r\n                // Default fallback\r\n                start.setDate(end.getDate() - 30);\r\n            }\r\n\r\n            const stats = await getStatisticsByRange(user.uid, start.toISOString().split('T')[0], end.toISOString().split('T')[0]);\r\n            setStatsData(stats);\r\n        };\r\n        fetchStats();\r\n    }, [user?.uid, selectedDate, statsPeriod, customRange.start, customRange.end, user]);\r\n\r\n    const handleGoalUpdate = async () => {\r\n        if (!user) return;\r\n        await updateUltimateGoal(user.uid, {\r\n            target: Number(goalForm.target),\r\n            deadline: goalForm.deadline,\r\n            currency: goalForm.currency as any\r\n        });\r\n        // No manual refresh needed\r\n        setIsGoalModalOpen(false);\r\n    };\r\n\r\n\r\n    // Simulate Time (Evening) for AI Insight\r\n    const isEvening = true;\r\n\r\n    // Calculate category totals for charts\r\n    const categoryTotals = transactions\r\n        .filter(t => t.type === 'expense')\r\n        .reduce((acc, t) => {\r\n            acc[t.category] = (acc[t.category] || 0) + t.amount;\r\n            return acc;\r\n        }, {} as Record<string, number>);\r\n\r\n    const totalExpense = Object.values(categoryTotals).reduce((a, b) => a + b, 0);\r\n\r\n\r\n    // History State\r\n    const [isHistoryOpen, setIsHistoryOpen] = useState(false);\r\n    const [isAllTransactionsOpen, setIsAllTransactionsOpen] = useState(false);\r\n\r\n    const handleEditDeposit = (deposit: DepositItem) => {\r\n        setEditingDeposit(deposit);\r\n        setDepositForm({\r\n            title: deposit.title,\r\n            currentAmount: deposit.currentAmount,\r\n            monthlyContribution: deposit.monthlyContribution,\r\n            contributionDay: deposit.contributionDay,\r\n            currency: deposit.currency,\r\n            startDate: deposit.startDate,\r\n            interestRate: deposit.interestRate || 0,\r\n            termMonths: deposit.termMonths || 12,\r\n            isMonthlyInterest: deposit.isMonthlyInterest !== false,\r\n            isFromBalance: true // Default (irrelevant for edit usually, but safe)\r\n        });\r\n        setIsDepositModalOpen(true);\r\n    };\r\n\r\n    const handleDeleteDeposit = async (deposit: DepositItem) => {\r\n        if (!confirm(`Haqiqatan ham \"${deposit.title}\" omonatini o'chirmoqchimisiz?`)) return;\r\n        if (!user || !deposit.id) return;\r\n\r\n        await deleteDeposit(user.uid, deposit.id);\r\n        setDeposits(await getDeposits(user.uid));\r\n\r\n        // Update balance\r\n        const overview = await getFinanceOverview(user.uid);\r\n        if (overview) setFinanceData(overview);\r\n\r\n        setAlertState({ isOpen: true, title: 'Deleted', message: 'Omonat o\\'chirildi', type: 'success' });\r\n    };\r\n\r\n\r\n\r\n\r\n    return (\r\n        <>\r\n            <div className=\"space-y-8 animate-fade-in relative\">\r\n\r\n                {/* HEADER */}\r\n                <div className=\"flex justify-between items-end\">\r\n                    <div>\r\n                        <h1 className=\"text-4xl font-display font-bold text-white mb-2\">{t.finance.title}</h1>\r\n                        <p className=\"text-gray-400\">{t.finance.subtitle}</p>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <DateNavigator selectedDate={selectedDate} onDateChange={setSelectedDate} />\r\n\r\n                        <VoiceInput\r\n                            module=\"finance\"\r\n                            onCommand={handleVoiceCommand}\r\n                            color=\"gold\"\r\n                            className={isArchived ? 'opacity-30 pointer-events-none' : ''}\r\n                        />\r\n\r\n                        <button\r\n                            onClick={() => !isArchived && setIsAddModalOpen(true)}\r\n                            disabled={isArchived}\r\n                            className={`px-6 py-3 rounded-xl border font-bold shadow-lg transition-all ${isArchived ? 'bg-white/5 border-white/10 text-gray-500 cursor-not-allowed' : 'bg-aura-gold/10 border-aura-gold/30 text-aura-gold hover:bg-aura-gold/20 shadow-aura-gold/10'}`}\r\n                        >\r\n                            + {t.finance.addTransaction}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* ARCHIVED DAY INDICATOR (PRD Feature) */}\r\n                {isArchived && (\r\n                    <div className=\"w-full p-4 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center gap-3 text-gray-400 text-sm animate-pulse shadow-xl\">\r\n                        <span className=\"text-xl\">ЁЯФТ</span>\r\n                        <div className=\"flex flex-col\">\r\n                            <span className=\"font-bold text-white/80\">{t.finance.readOnly || \"Archive Context\"}</span>\r\n                            <span className=\"text-[10px] uppercase tracking-widest opacity-60\">{t.finance.readOnlyDesc || \"Past days cannot be edited to ensure data integrity\"}</span>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* HEADER CONTROLS: Currencies (left) & Navigation (right) */}\r\n                <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-8 mt-4\">\r\n                    {/* CURRENCIES (LEFT) */}\r\n                    <div className=\"flex flex-wrap items-center gap-3\">\r\n                        <div className=\"bg-black border border-white/10 rounded-full px-3 py-1 flex items-center gap-1.5 shadow-sm\">\r\n                            <span className=\"text-[8px] font-black text-white/30 tracking-tight\">USD</span>\r\n                            <span className=\"text-[10px] font-black text-white tracking-tight\">12 850</span>\r\n                            <span className=\"text-[10px] text-aura-green\">тЦ▓</span>\r\n                        </div>\r\n                        <div className=\"bg-black border border-white/10 rounded-full px-3 py-1 flex items-center gap-1.5 shadow-sm\">\r\n                            <span className=\"text-[8px] font-black text-white/30 tracking-tight\">EUR</span>\r\n                            <span className=\"text-[10px] font-black text-white tracking-tight\">13 920</span>\r\n                            <span className=\"text-[10px] text-aura-red\">тЦ╝</span>\r\n                        </div>\r\n                        <div className=\"bg-black border border-white/10 rounded-full px-3 py-1 flex items-center gap-1.5 shadow-sm\">\r\n                            <span className=\"text-[8px] font-black text-white/30 tracking-tight\">RUB</span>\r\n                            <span className=\"text-[10px] font-black text-white tracking-tight\">142</span>\r\n                            <span className=\"text-[10px] text-aura-green\">тЦ▓</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* NAVIGATION BUTTONS (RIGHT) */}\r\n                    <div className=\"flex flex-wrap items-center gap-3\">\r\n                        <button\r\n                            onClick={() => setIsQRModalOpen(true)}\r\n                            className=\"bg-white/5 border border-white/10 rounded-xl px-4 py-2 flex items-center gap-2 text-gray-400 hover:text-white transition-all hover:bg-white/10\"\r\n                        >\r\n                            <span className=\"text-xs\">ЁЯУ╖</span>\r\n                            <span className=\"text-xs font-black uppercase tracking-wider\">{t.finance.qrScanner}</span>\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setViewMode('daily')}\r\n                            className={`border rounded-xl px-4 py-2 text-xs font-black uppercase transition-all tracking-wider ${viewMode === 'daily' ? 'bg-aura-gold text-black border-aura-gold shadow-[0_0_15px_rgba(255,214,0,0.3)]' : 'bg-white/5 border-white/10 text-gray-400 hover:text-white hover:bg-white/10'}`}\r\n                        >\r\n                            {t.finance.dailyFlow}\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setViewMode('stats')}\r\n                            className={`border rounded-xl px-4 py-2 text-xs font-black uppercase transition-all tracking-wider ${viewMode === 'stats' ? 'bg-aura-gold text-black border-aura-gold shadow-[0_0_15px_rgba(255,214,0,0.3)]' : 'bg-white/5 border-white/10 text-gray-400 hover:text-white hover:bg-white/10'}`}\r\n                        >\r\n                            {t.finance.advancedStats}\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setViewMode('debts')}\r\n                            className={`border rounded-xl px-4 py-2 flex items-center gap-2 transition-all tracking-wider ${viewMode === 'debts' ? 'bg-aura-gold text-black border-aura-gold shadow-[0_0_15px_rgba(255,214,0,0.3)]' : 'bg-white/5 border-white/10 text-gray-400 hover:text-white hover:bg-white/10'}`}\r\n                        >\r\n                            <span className=\"text-xs\">ЁЯТ╝</span>\r\n                            <span className=\"text-xs font-black uppercase\">{t.finance.portfolio}</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n\r\n\r\n                {viewMode === 'daily' ? (\r\n                    <>\r\n                        {/* TOP CARDS: DUAL BUDGET & ULTIMATE GOAL */}\r\n                        {/* V20 Adjusted Layout: col-span-2 -> col-span-full or smarter logic to reduce space */}\r\n                        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6 items-stretch\">\r\n                            <div\r\n                                onClick={() => !isArchived && setIsGoalModalOpen(true)}\r\n                                className={`lg:col-span-2 p-8 rounded-[2.5rem] bg-gradient-to-br from-aura-gold/20 via-black to-black border border-aura-gold/30 relative overflow-hidden group hover:border-aura-gold/50 transition-all min-h-full flex flex-col ${isArchived ? 'cursor-default' : 'cursor-pointer'}`}\r\n                            >\r\n                                {!isArchived && <div className=\"absolute top-4 right-4 text-xs text-aura-gold border border-aura-gold/30 px-2 py-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity\">EDIT тЬПя╕П</div>}\r\n                                <div className=\"absolute top-0 right-0 p-8 opacity-20 text-8xl grayscale group-hover:grayscale-0 transition-all duration-700\">ЁЯПЖ</div>\r\n                                <div className=\"relative z-10 h-full flex flex-col\">\r\n                                    <p className=\"text-aura-gold font-black text-[10px] uppercase tracking-[0.3em] mb-4\">{t.finance.ultimateGoalTitle}</p>\r\n\r\n                                    {financeData.ultimateGoal?.target && financeData.ultimateGoal.target > 0 ? (\r\n                                        <>\r\n                                            <h2 className=\"text-4xl font-display font-black text-white mb-2\">\r\n                                                {formatNumber(financeData.ultimateGoal.target)} {financeData.ultimateGoal.currency || 'USD'}\r\n                                            </h2>\r\n                                            <p className=\"text-gray-500 text-xs mb-8\">{t.finance.deadline}: {financeData.ultimateGoal?.deadline || '2027-12-31'}</p>\r\n\r\n                                            <div className=\"space-y-4 mt-auto\">\r\n                                                <div className=\"flex justify-between items-end\">\r\n                                                    <div className=\"flex flex-col\">\r\n                                                        <span className=\"text-[10px] text-gray-400 uppercase font-bold tracking-widest\">{t.finance.currentStatus}</span>\r\n                                                        <div className=\"flex items-baseline gap-2\">\r\n                                                            <span className=\"text-2xl font-black text-white\">{financeData.ultimateGoal?.currency || 'USD'} {formatNumber(financeData.totalBalance)}</span>\r\n                                                            <span className=\"text-xs text-gray-500 font-bold\">/ {formatNumber(financeData.ultimateGoal.target)}</span>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div className=\"text-aura-gold font-black text-2xl drop-shadow-[0_0_10px_rgba(255,215,0,0.3)]\">\r\n                                                        {Math.min(100, Math.round((financeData.totalBalance / financeData.ultimateGoal.target) * 100))}%\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                <div className=\"h-4 w-full bg-white/5 rounded-full border border-white/10 p-1\">\r\n                                                    <div\r\n                                                        className=\"h-full bg-gradient-to-r from-aura-gold to-yellow-500 rounded-full shadow-[0_0_20px_rgba(255,214,0,0.4)] transition-all duration-1000\"\r\n                                                        style={{ width: `${Math.min(100, (financeData.totalBalance / financeData.ultimateGoal.target) * 100)}%` }}\r\n                                                    ></div>\r\n                                                </div>\r\n\r\n                                                {/* Net Worth Block V20 */}\r\n                                                {(() => {\r\n                                                    const assetTotal = deposits.reduce((sum, d) => sum + convert(d.currentAmount || 0, d.currency, 'UZS'), 0) +\r\n                                                        debts.filter(d => d.type === 'owed_to_me').reduce((sum, d) => sum + convert(d.amount - (d.totalRepaid || 0), d.currency, 'UZS'), 0);\r\n\r\n                                                    const liabilityTotal = credits.reduce((sum, c) => sum + convert(c.remainingAmount || 0, c.currency, 'UZS'), 0) +\r\n                                                        debts.filter(d => d.type === 'i_owe').reduce((sum, d) => sum + convert(d.amount - (d.totalRepaid || 0), d.currency, 'UZS'), 0);\r\n\r\n                                                    const realBalance = assetTotal - liabilityTotal;\r\n\r\n                                                    return (\r\n                                                        <div className=\"mt-4 p-6 rounded-3xl bg-white/5 border border-white/10 backdrop-blur-xl group/nw hover:border-aura-green/40 transition-all\">\r\n                                                            <div className=\"flex justify-between items-center mb-6\">\r\n                                                                <div className=\"flex items-center gap-2\">\r\n                                                                    <div className=\"w-2 h-2 rounded-full bg-aura-green animate-pulse\"></div>\r\n                                                                    <span className=\"text-[10px] font-black text-white/60 uppercase tracking-[0.2em]\">{t.finance.realMoney}</span>\r\n                                                                </div>\r\n                                                                <span className={`text-2xl font-display font-black tracking-tighter ${realBalance >= 0 ? 'text-aura-green' : 'text-aura-red'}`}>\r\n                                                                    {realBalance >= 0 ? '+' : ''}{formatNumber(convert(realBalance, 'UZS', statsDisplayCurrency))} <span className=\"text-xs opacity-50 font-sans\">{statsDisplayCurrency}</span>\r\n                                                                </span>\r\n                                                            </div>\r\n\r\n                                                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                                                <div className=\"p-4 rounded-2xl bg-black/40 border border-white/10 group-hover/nw:border-aura-green/20 transition-colors\">\r\n                                                                    <p className=\"text-[8px] font-black text-white/50 uppercase tracking-widest mb-1\">{t.finance.assets}</p>\r\n                                                                    <p className=\"text-lg font-mono font-bold text-aura-green\">\r\n                                                                        +{formatNumber(convert(assetTotal, 'UZS', statsDisplayCurrency))}\r\n                                                                    </p>\r\n                                                                </div>\r\n                                                                <div className=\"p-4 rounded-2xl bg-black/40 border border-white/10 group-hover/nw:border-aura-red/20 transition-colors\">\r\n                                                                    <p className=\"text-[8px] font-black text-white/50 uppercase tracking-widest mb-1\">{t.finance.liabilities}</p>\r\n                                                                    <p className=\"text-lg font-mono font-bold text-aura-red\">\r\n                                                                        -{formatNumber(convert(liabilityTotal, 'UZS', statsDisplayCurrency))}\r\n                                                                    </p>\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    );\r\n                                                })()}\r\n\r\n                                                {/* AI Predictions */}\r\n                                                {(financeData.totalBalance > 0 || financeData.monthlyIncome > 0) && (\r\n                                                    <div className=\"flex justify-between text-[10px] text-white/60 mt-2 gap-4 border-t border-white/5 pt-4\">\r\n                                                        <div className=\"text-left\">\r\n                                                            <span className=\"block text-aura-gold font-bold mb-1\">{t.finance.remainingTime}:</span>\r\n                                                            <span className=\"font-mono text-white\">\r\n                                                                {(() => {\r\n                                                                    const deadline = new Date(financeData.ultimateGoal?.deadline || '2027-12-31').getTime();\r\n                                                                    const now = new Date().getTime();\r\n                                                                    const diff = deadline - now;\r\n                                                                    if (diff <= 0) return t.finance.deadlineExpired;\r\n                                                                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));\r\n                                                                    const weeks = Math.floor(days / 7);\r\n                                                                    const months = Math.floor(days / 30);\r\n                                                                    return `${months} ${t.finance.months}, ${weeks % 4} ${t.finance.weeks}, ${days % 7} ${t.finance.days}`;\r\n                                                                })()}\r\n                                                            </span>\r\n                                                        </div>\r\n                                                        <div className=\"text-right\">\r\n                                                            <span className=\"block text-aura-green font-bold mb-1\">{t.finance.probability}:</span>\r\n                                                            <span className=\"font-mono text-white\">\r\n                                                                {(() => {\r\n                                                                    const netIncomeUZS = financeData.monthlyIncome - financeData.monthlySpent;\r\n                                                                    const targetUZS = financeData.ultimateGoal ? financeData.ultimateGoal.target * (financeData.ultimateGoal.currency === 'USD' ? 12850 : 1) : 0;\r\n                                                                    const currentUZS = financeData.totalBalance;\r\n\r\n                                                                    if (netIncomeUZS <= 0) return t.finance.incomeInsufficient;\r\n                                                                    const remainingUZS = Math.max(0, targetUZS - currentUZS);\r\n                                                                    const monthsToGoal = Math.ceil(remainingUZS / netIncomeUZS);\r\n                                                                    if (monthsToGoal > 1200) return `> 100 ${t.finance.years}`;\r\n                                                                    const years = Math.floor(monthsToGoal / 12);\r\n                                                                    const months = monthsToGoal % 12;\r\n\r\n                                                                    return years > 0 ? `${years}y ${months}m` : `${months}m`;\r\n                                                                })()}\r\n                                                            </span>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n                                        </>\r\n                                    ) : (\r\n                                        <div className=\"flex-1 flex flex-col items-center justify-center text-center py-10\">\r\n                                            <div className=\"text-5xl mb-4 opacity-50\">ЁЯОп</div>\r\n                                            <h2 className=\"text-2xl font-display font-black text-white mb-2\">{t.finance.enterGoal}</h2>\r\n                                            <p className=\"text-gray-500 text-xs max-w-[200px]\">{t.finance.incomeHistoryEmptyDesc}</p>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div\r\n                                onClick={() => {\r\n                                    if (isArchived) return;\r\n                                    setBudgetForm({ incomeBudget: financeData.incomeBudget, expenseBudget: financeData.expenseBudget });\r\n                                    setIsBudgetModalOpen(true);\r\n                                }}\r\n                                className={`p-8 rounded-[2.5rem] bg-white/5 border border-white/10 relative overflow-hidden group hover:border-aura-green/30 transition-all flex-1 flex flex-col justify-between ${isArchived ? 'cursor-default' : 'cursor-pointer'}`}\r\n                            >\r\n                                <div className=\"absolute top-4 right-4 p-2 rounded-full bg-aura-green/10 text-aura-green group-hover:scale-110 transition-transform\">\r\n                                    <span className=\"text-xl\">ЁЯУИ</span>\r\n                                </div>\r\n                                <h3 className=\"text-xs font-black uppercase tracking-[0.2em] text-aura-green mb-4\">{t.finance.incomePlan}</h3>\r\n\r\n                                <div className=\"flex items-baseline gap-2 mb-2\">\r\n                                    <h2 className=\"text-4xl font-display font-black text-white tracking-tighter\">\r\n                                        {formatNumber(convert(financeData.monthlyIncome || 0, 'UZS', statsDisplayCurrency))}\r\n                                    </h2>\r\n                                    <span className=\"text-xs font-black text-white/40\">{statsDisplayCurrency}</span>\r\n                                </div>\r\n                                <div className=\"flex items-baseline gap-2 mb-4 text-[10px] font-black text-white/20 uppercase tracking-widest\">\r\n                                    <span>/ {formatNumber(convert(financeData.incomeBudget || 0, 'UZS', statsDisplayCurrency))} {statsDisplayCurrency} {t.finance.target}</span>\r\n                                </div>\r\n                                <div className=\"w-full bg-white/5 h-2 rounded-full mb-2 p-[2px] border border-white/5\">\r\n                                    <div className=\"bg-aura-green h-full rounded-full transition-all duration-1000 shadow-[0_0_10px_rgba(0,255,150,0.3)]\" style={{ width: `${Math.min(incomePercentage, 100)}%` }}></div>\r\n                                </div>\r\n\r\n                                <div className=\"flex justify-between text-[11px] font-black uppercase tracking-wider text-white/40 mt-6 pt-4 border-t border-white/5\">\r\n                                    <span>\r\n                                        {`${incomePercentage.toFixed(0)}% ${t.finance.achieved}`}\r\n                                    </span>\r\n                                    {(financeData.incomeBudget || 0) > 0 && (\r\n                                        <span className=\"text-aura-green font-bold text-xs\">\r\n                                            {formatNumber(convert(financeData.incomeBudget - financeData.monthlyIncome, 'UZS', statsDisplayCurrency))} {t.finance.left}\r\n                                        </span>\r\n                                    )}\r\n                                </div>\r\n\r\n                                {/* V20: Match detail to fill space */}\r\n                                <div className=\"mt-4 flex items-center gap-2 opacity-40\">\r\n                                    <div className=\"w-1.5 h-1.5 rounded-full bg-aura-green\"></div>\r\n                                    <span className=\"text-[10px] font-bold uppercase tracking-widest\">{t.finance.incomePlan} {t.finance.analysisSummary}</span>\r\n                                </div>\r\n\r\n                            </div>\r\n\r\n                            {/* Expense Card */}\r\n                            <div\r\n                                onClick={() => {\r\n                                    if (isArchived) return;\r\n                                    setIsBudgetModalOpen(true);\r\n                                }}\r\n                                className={`p-8 rounded-[2.5rem] bg-white/5 border border-white/10 relative overflow-hidden group hover:border-aura-red/30 transition-all flex-1 flex flex-col justify-between ${isArchived ? 'cursor-default' : 'cursor-pointer'}`}\r\n                            >\r\n                                <div className=\"absolute top-4 right-4 p-2 rounded-full bg-aura-red/10 text-aura-red group-hover:scale-110 transition-transform\">\r\n                                    <span className=\"text-xl\">ЁЯУЙ</span>\r\n                                </div>\r\n                                <h3 className=\"text-xs font-black uppercase tracking-[0.2em] text-aura-red mb-4\">{t.finance.expenseControl}</h3>\r\n\r\n                                <div className=\"flex items-baseline gap-2 mb-2\">\r\n                                    <h2 className=\"text-4xl font-display font-black text-white tracking-tighter\">\r\n                                        {formatNumber(convert(financeData.monthlySpent || 0, 'UZS', statsDisplayCurrency))}\r\n                                    </h2>\r\n                                    <span className=\"text-xs font-black text-white/40\">{statsDisplayCurrency}</span>\r\n                                </div>\r\n                                <div className=\"flex items-baseline gap-2 mb-4 text-[10px] font-black text-white/20 uppercase tracking-widest\">\r\n                                    <span>/ {formatNumber(convert(financeData.expenseBudget || 0, 'UZS', statsDisplayCurrency))} {statsDisplayCurrency} {t.finance.limit}</span>\r\n                                </div>\r\n                                <div className=\"w-full bg-white/5 h-2 rounded-full mb-2 p-[2px] border border-white/5\">\r\n                                    <div className=\"bg-aura-red h-full rounded-full transition-all duration-1000 shadow-[0_0_10px_rgba(255,50,50,0.3)]\" style={{ width: `${Math.min(expensePercentage, 100)}%` }}></div>\r\n                                </div>\r\n\r\n                                <div className=\"flex justify-between text-[11px] font-black uppercase tracking-wider text-white/40 mt-6 pt-4 border-t border-white/5\">\r\n                                    <span>\r\n                                        {`${expensePercentage.toFixed(0)}% ${t.finance.used}`}\r\n                                    </span>\r\n                                    {(financeData.expenseBudget || 0) > 0 && (\r\n                                        <span className={expensePercentage > 90 ? 'text-aura-red animate-pulse' : 'text-white/60 font-bold'}>\r\n                                            {formatNumber(convert(financeData.expenseBudget - financeData.monthlySpent, 'UZS', statsDisplayCurrency))} {t.finance.left}\r\n                                        </span>\r\n                                    )}\r\n                                </div>\r\n                                <div className=\"mt-4 flex items-center gap-2 opacity-40\">\r\n                                    <div className=\"w-1.5 h-1.5 rounded-full bg-aura-red\"></div>\r\n                                    <span className=\"text-[10px] font-bold uppercase tracking-widest\">{t.finance.expenseControl} {t.finance.analysisSummary}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n                            {/* RECENT TRANSACTIONS */}\r\n                            <div className=\"lg:col-span-2 p-8 rounded-[2.5rem] bg-black/40 border border-white/5\">\r\n                                <div className=\"flex justify-between items-center mb-8\">\r\n                                    <h3 className=\"text-xl font-display font-black text-white uppercase tracking-tighter\">{t.finance.recentActivity}</h3>\r\n                                    <div className=\"flex items-center gap-3\">\r\n                                        <button\r\n                                            onClick={handleExportToExcel}\r\n                                            className=\"px-4 py-2 rounded-xl bg-aura-gold/10 border border-aura-gold/30 text-xs font-black uppercase text-aura-gold hover:bg-aura-gold/20 transition-all flex items-center gap-2\"\r\n                                        >\r\n                                            <span>ЁЯУК</span>\r\n                                            {t.finance.exportExcel || \"Excel Yuklash\"}\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={() => setIsAllTransactionsOpen(true)}\r\n                                            className=\"px-4 py-2 rounded-xl bg-white/5 border border-white/10 text-xs font-black uppercase text-gray-400 hover:text-white transition-all\"\r\n                                        >\r\n                                            {t.common.viewHistory}\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"space-y-4 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar\">\r\n                                    {transactions.length > 0 ? transactions.map((t) => (\r\n                                        <div key={t.id} className=\"flex items-center gap-4 p-4 rounded-2xl bg-white/5 border border-white/5 hover:bg-white/10 transition-all group\">\r\n                                            <div className=\"w-14 h-14 rounded-2xl bg-black border border-white/10 flex items-center justify-center text-2xl group-hover:scale-110 transition-transform\">\r\n                                                {t.icon}\r\n                                            </div>\r\n                                            <div className=\"flex-1\">\r\n                                                <h4 className=\"font-bold text-white group-hover:text-aura-gold transition-colors\">{t.title}</h4>\r\n                                                <p className=\"text-[10px] text-gray-500 uppercase font-black tracking-widest\">{new Date(t.date).toLocaleDateString()} тАв {t.category}</p>\r\n                                            </div>\r\n                                            <div className={`text-xl font-mono font-black ${t.type === 'income' ? 'text-aura-green' : 'text-white'}`}>\r\n                                                {t.type === 'income' ? '+' : '-'}{t.amount.toLocaleString()}\r\n                                            </div>\r\n                                        </div>\r\n                                    )) : (\r\n                                        <div className=\"py-20 text-center opacity-20\">\r\n                                            <p className=\"text-4xl mb-4\">ЁЯХ│я╕П</p>\r\n                                            <p className=\"text-[10px] font-black uppercase tracking-[0.5em]\">{t.finance.noTransactions}</p>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* AI WEALTH PATHING (NEW V10) */}\r\n                            <div className=\"p-8 rounded-[2.5rem] bg-indigo-950/20 border border-indigo-500/20 flex flex-col\">\r\n                                <div className=\"flex items-center gap-3 mb-6\">\r\n                                    <div className=\"w-10 h-10 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400\">ЁЯдЦ</div>\r\n                                    <div>\r\n                                        <h3 className=\"text-sm font-black text-white uppercase tracking-widest\">{t.finance.aiRoadmapTitle}</h3>\r\n                                        <p className=\"text-[10px] text-gray-500\">{t.finance.filesAnalysis}</p>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"flex-1 space-y-6\">\r\n                                    {/* Status Card */}\r\n                                    <div className=\"p-4 rounded-2xl bg-white/5 border border-white/5\">\r\n                                        <div className=\"flex justify-between items-center mb-2\">\r\n                                            <p className=\"text-[10px] text-indigo-400 font-bold uppercase\">{t.finance.financialStatus}</p>\r\n                                            <span className={`text-xs font-black ${(financeData.monthlyIncome === 0 && financeData.monthlySpent === 0) ? 'text-gray-400' :\r\n                                                (financeData.monthlyIncome >= financeData.monthlySpent) ? 'text-aura-green' : 'text-aura-red'\r\n                                                }`}>\r\n                                                {(financeData.monthlyIncome === 0 && financeData.monthlySpent === 0) ? t.finance.statusStart :\r\n                                                    (financeData.monthlyIncome >= financeData.monthlySpent) ? t.finance.statusPositive : t.finance.statusDanger}\r\n                                            </span>\r\n                                        </div>\r\n                                        <p className=\"text-xs text-gray-300 leading-relaxed\">\r\n                                            {(financeData.monthlyIncome === 0 && financeData.monthlySpent === 0)\r\n                                                ? t.finance.statusDescStart\r\n                                                : (financeData.monthlyIncome >= financeData.monthlySpent)\r\n                                                    ? t.finance.statusDescPositive(((financeData.monthlyIncome - financeData.monthlySpent) / (financeData.monthlyIncome || 1) * 100).toFixed(0))\r\n                                                    : t.finance.statusDescDanger}\r\n                                        </p>\r\n                                    </div>\r\n\r\n                                    <div className=\"space-y-4\">\r\n                                        <h4 className=\"text-[10px] font-black uppercase text-gray-500 tracking-widest\">{t.finance.recommendations}</h4>\r\n\r\n                                        {/* AI INSIGHT RENDERING */}\r\n                                        {aiLoading ? (\r\n                                            <div className=\"flex items-center gap-3 p-3 rounded-xl bg-black/40 border border-white/5 animate-pulse\">\r\n                                                <div className=\"w-8 h-8 bg-white/10 rounded-full\"></div>\r\n                                                <div className=\"h-4 bg-white/10 rounded w-3/4\"></div>\r\n                                            </div>\r\n                                        ) : aiInsight ? (\r\n                                            <div className=\"flex items-start gap-3 p-4 rounded-xl bg-indigo-500/10 border border-indigo-500/20\">\r\n                                                <span className=\"text-2xl mt-1\">{aiInsight.emoji || 'ЁЯТб'}</span>\r\n                                                <div>\r\n                                                    <h5 className=\"text-sm font-bold text-white mb-1\">{aiInsight.title || 'AI Advisor'}</h5>\r\n                                                    <p className=\"text-xs text-indigo-200 leading-relaxed font-medium\">\r\n                                                        {typeof aiInsight.insight === 'string' ? aiInsight.insight : JSON.stringify(aiInsight.insight)}\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                        ) : (\r\n                                            // Fallback if no AI insight yet\r\n                                            <div className=\"flex items-center gap-3 p-3 rounded-xl bg-black/40 border border-white/5\">\r\n                                                <span className=\"text-lg\">тЬи</span>\r\n                                                <span className=\"text-[10px] font-bold text-gray-400 leading-tight\">{t.finance.statusOk}</span>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n\r\n                                    <button\r\n                                        className=\"w-full py-4 rounded-2xl bg-indigo-600 text-white font-black uppercase text-[10px] tracking-widest hover:bg-indigo-500 transition-all shadow-lg shadow-indigo-500/20 mt-auto\"\r\n                                        onClick={() => setViewMode('stats')}\r\n                                    >\r\n                                        {t.finance.viewFullAnalysis}\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        {/* V17: AI FORECAST FOOTER */}\r\n                        <div className=\"w-full p-12 rounded-[3rem] bg-gradient-to-r from-blue-900/20 to-purple-900/20 border border-white/5 text-center relative overflow-hidden group\">\r\n                            <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-aura-gold to-transparent opacity-20\"></div>\r\n                            <p className=\"text-xs font-black uppercase tracking-[0.3em] text-blue-400 mb-4\">{t.finance.aiPredictionTitle}</p>\r\n                            <h2 className=\"text-3xl md:text-4xl font-display font-black text-white mb-4\">\r\n                                {financeData.monthlyIncome > 0 || financeData.monthlySpent > 0 ? (\r\n                                    <>\r\n                                        {(() => {\r\n                                            const today = new Date().getDate();\r\n                                            const daysInMonth = new Date(new Date().getFullYear(), new Date().getMonth() + 1, 0).getDate();\r\n                                            const remainingDays = daysInMonth - today;\r\n                                            const dailyIncome = financeData.monthlyIncome / (today || 1);\r\n                                            const dailyExpense = financeData.monthlySpent / (today || 1);\r\n                                            const projectedNet = (dailyIncome - dailyExpense) * remainingDays;\r\n                                            const projectedResult = (financeData.monthlyIncome - financeData.monthlySpent) + projectedNet;\r\n\r\n                                            return (\r\n                                                <>\r\n                                                    <span className={projectedResult > 0 ? 'text-aura-green' : 'text-aura-red'}>\r\n                                                        {projectedResult > 0 ? '+' : ''}{formatNumber(projectedResult)} {statsDisplayCurrency}\r\n                                                    </span>\r\n                                                    <span className=\"block text-xs text-white/30 font-bold tracking-widest mt-2 uppercase\">\r\n                                                        {t.finance.expectedMonthlyProfit}\r\n                                                    </span>\r\n                                                </>\r\n                                            );\r\n                                        })()}\r\n                                    </>\r\n                                ) : (\r\n                                    t.finance.waitingForData\r\n                                )}\r\n                            </h2>\r\n                            <p className=\"text-white/40 text-sm max-w-2xl mx-auto italic\">\r\n                                {t.finance.predictionDisclaimerText}\r\n                            </p>\r\n                        </div>\r\n                    </>\r\n                ) : viewMode === 'debts' ? (\r\n                    /* PORTFOLIO DASHBOARD (V13: Debts + Credits + Deposits) */\r\n                    <div className=\"space-y-8 animate-fade-in\">\r\n                        {/* V14: LIVE EXCHANGE RATES WIDGET - REMOVED (Redundant) */}\r\n\r\n                        {/* PORTFOLIO SUMMARY & TABS */}\r\n                        <div className=\"flex flex-col gap-6\">\r\n                            {/* Summary Cards */}\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div className=\"p-6 rounded-3xl bg-aura-red/10 border border-aura-red/20 relative overflow-hidden\">\r\n                                    <div className=\"absolute top-0 right-0 p-4 opacity-10 text-5xl\">ЁЯУЙ</div>\r\n                                    <p className=\"text-xs text-aura-red uppercase font-black tracking-widest mb-2\">{t.finance.liabilities} ({t.finance.debt})</p>\r\n                                    <h2 className=\"text-2xl font-black text-white\">\r\n                                        {formatNumber(\r\n                                            (debts.filter(d => d.type === 'i_owe' && d.status === 'active').reduce((a, b) => a + (b.amount - (b.totalRepaid || 0)), 0)) +\r\n                                            (credits.filter(c => c.status === 'active').reduce((a, b) => a + b.remainingAmount, 0))\r\n                                        )}\r\n                                        <span className=\"text-xs ml-2 text-gray-500\">UZS</span>\r\n                                    </h2>\r\n                                    <p className=\"text-[10px] text-gray-500 mt-1\">{t.finance.debtsPlusCredits}</p>\r\n                                </div>\r\n                                <div className=\"p-6 rounded-3xl bg-aura-green/10 border border-aura-green/20 relative overflow-hidden\">\r\n                                    <div className=\"absolute top-0 right-0 p-4 opacity-10 text-5xl\">ЁЯУИ</div>\r\n                                    <p className=\"text-xs text-aura-green uppercase font-black tracking-widest mb-2\">{t.finance.assets} ({t.finance.investment})</p>\r\n                                    <h2 className=\"text-2xl font-black text-white\">\r\n                                        {formatNumber(\r\n                                            (debts.filter(d => d.type === 'owed_to_me' && d.status === 'active').reduce((a, b) => a + (b.amount - (b.totalRepaid || 0)), 0)) +\r\n                                            (deposits.reduce((a, b) => a + (b.currentAmount || 0), 0))\r\n                                        )}\r\n                                        <span className=\"text-xs ml-2 text-gray-500\">UZS</span>\r\n                                    </h2>\r\n                                    <p className=\"text-[10px] text-gray-500 mt-1\">{t.finance.returnPlusDeposits}</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Navigation Tabs */}\r\n                            <div className=\"relative flex flex-col md:flex-row items-center justify-center gap-6\">\r\n                                <div className=\"flex bg-black/40 p-1 rounded-xl w-full md:w-fit\">\r\n                                    <button\r\n                                        onClick={() => setPortfolioTab('debts')}\r\n                                        className={`flex-1 md:flex-none px-6 py-2 rounded-lg text-xs font-bold uppercase transition-all ${portfolioTab === 'debts' ? 'bg-white text-black' : 'text-gray-500 hover:text-white'}`}\r\n                                    >\r\n                                        ЁЯУТ {t.finance.debt}\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => setPortfolioTab('credits')}\r\n                                        className={`flex-1 md:flex-none px-6 py-2 rounded-lg text-xs font-bold uppercase transition-all ${portfolioTab === 'credits' ? 'bg-aura-red text-white shadow-lg shadow-aura-red/20' : 'text-gray-500 hover:text-white'}`}\r\n                                    >\r\n                                        ЁЯПж {t.finance.credit}\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => setPortfolioTab('deposits')}\r\n                                        className={`flex-1 md:flex-none px-6 py-2 rounded-lg text-xs font-bold uppercase transition-all ${portfolioTab === 'deposits' ? 'bg-aura-green text-black shadow-lg shadow-aura-green/20' : 'text-gray-500 hover:text-white'}`}\r\n                                    >\r\n                                        ЁЯТ░ {t.finance.investment}\r\n                                    </button>\r\n                                </div>\r\n\r\n                                <div className=\"md:absolute md:right-0 w-full md:w-auto\">\r\n                                    <button\r\n                                        onClick={() => {\r\n                                            if (isArchived) return;\r\n                                            if (portfolioTab === 'debts') setIsDebtModalOpen(true);\r\n                                            else if (portfolioTab === 'credits') {\r\n                                                setCreditForm({ title: '', totalAmount: 0, monthlyPayment: 0, paymentDay: 1, currency: 'UZS', startDate: '', status: 'active' });\r\n                                                setIsCreditModalOpen(true);\r\n                                            } else if (portfolioTab === 'deposits') {\r\n                                                setDepositForm({\r\n                                                    title: '',\r\n                                                    monthlyContribution: 0,\r\n                                                    contributionDay: 1,\r\n                                                    currency: 'UZS',\r\n                                                    startDate: '',\r\n                                                    currentAmount: 0,\r\n                                                    interestRate: 0,\r\n                                                    termMonths: 12,\r\n                                                    isMonthlyInterest: true,\r\n                                                    isFromBalance: true\r\n                                                });\r\n                                                setIsDepositModalOpen(true);\r\n                                            }\r\n                                        }}\r\n                                        disabled={isArchived}\r\n                                        className={`w-full md:w-auto px-6 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all shadow-lg ${isArchived ? 'bg-white/5 border border-white/10 text-gray-500 cursor-not-allowed' :\r\n                                            (portfolioTab === 'debts' ? 'bg-aura-gold text-black shadow-aura-gold/20 hover:scale-110 active:scale-95' :\r\n                                                portfolioTab === 'credits' ? 'bg-aura-red text-white shadow-aura-red/20 hover:scale-110 active:scale-95' :\r\n                                                    'bg-aura-green text-black shadow-aura-green/20 hover:scale-110 active:scale-95')\r\n                                            }`}\r\n                                    >\r\n                                        + {portfolioTab === 'debts' ? t.finance.addDebt.replace('+ ', '') : portfolioTab === 'credits' ? t.finance.addCredit : t.finance.addDeposit}\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* CONTENT AREA */}\r\n\r\n                        {/* 1. DEBTS VIEW */}\r\n                        {portfolioTab === 'debts' && (\r\n                            <div className=\"space-y-4 animate-fade-in\">\r\n                                <div className=\"flex justify-end\">\r\n                                    {/* Redundant Button Removed as per User Request */}\r\n                                </div>\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                    {debts.filter(d => (d as any).status !== 'archived').map((debt: any) => (\r\n                                        <div key={debt.id} className=\"p-6 rounded-2xl bg-black/40 border border-white/5 relative group\">\r\n                                            <div className={`absolute top-4 left-4 text-[10px] font-bold px-2 py-1 rounded-full ${debt.type === 'i_owe' ? 'bg-aura-red/20 text-aura-red' : 'bg-aura-green/20 text-aura-green'}`}>\r\n                                                {debt.type === 'i_owe' ? t.finance.iOweLabel : t.finance.owedToMeLabel}\r\n                                            </div>\r\n\r\n                                            <div className=\"mt-8\"></div> {/* Spacer for absolute buttons */}\r\n\r\n                                            <h3 className=\"text-lg font-bold text-white mb-1\">{debt.person}</h3>\r\n                                            <p className=\"text-xs text-gray-500 mb-4\">{debt.deadline ? `${t.finance.deadline}: ${debt.deadline}` : t.finance.noDeadline}</p>\r\n\r\n                                            <div className=\"text-3xl font-mono font-black text-white mb-6\">\r\n                                                {formatNumber(debt.amount)} <span className=\"text-sm text-gray-500\">{debt.currency}</span>\r\n                                            </div>\r\n\r\n                                            {debt.status === 'paid' ? (\r\n                                                <div className=\"w-full py-3 rounded-xl bg-white/5 text-aura-green text-xs font-bold text-center border border-aura-green/20\">\r\n                                                    тЬЕ {t.finance.repaid}\r\n                                                </div>\r\n                                            ) : (\r\n                                                <div className=\"flex gap-2\">\r\n                                                    <button\r\n                                                        onClick={() => !isArchived && handleRepay(debt)}\r\n                                                        disabled={isArchived}\r\n                                                        className={`flex-1 py-3 rounded-xl text-xs font-bold transition-all border ${isArchived ? 'bg-white/5 border-white/5 text-gray-500 cursor-not-allowed' : 'bg-aura-green/10 hover:bg-aura-green/20 text-aura-green border-aura-green/10'}`}\r\n                                                    >\r\n                                                        тЬЕ {t.finance.repay}\r\n                                                    </button>\r\n                                                    <button\r\n                                                        onClick={() => { if (isArchived) return; setExtendModalDebt(debt); setNewDeadline(debt.deadline || ''); }}\r\n                                                        disabled={isArchived}\r\n                                                        className={`flex-1 py-3 rounded-xl text-xs font-bold transition-all border ${isArchived ? 'bg-white/5 border-white/5 text-gray-500 cursor-not-allowed' : 'bg-white/5 hover:bg-white/10 text-white border-white/5'}`}\r\n                                                    >\r\n                                                        тП│ {t.finance.extend}\r\n                                                    </button>\r\n                                                </div>\r\n                                            )}\r\n\r\n                                            {/* Edit/Delete Actions - Visible */}\r\n                                            {!isArchived && (\r\n                                                <div className=\"absolute top-4 right-4 flex gap-2\">\r\n                                                    <button\r\n                                                        onClick={() => { setEditingDebt(debt); setDebtForm({ ...debt, startDate: (debt as any).date }); setIsDebtModalOpen(true); }}\r\n                                                        className=\"w-8 h-8 flex items-center justify-center rounded-xl bg-white/5 text-white hover:bg-white/10 transition-colors border border-white/5\"\r\n                                                    >\r\n                                                        тЬО\r\n                                                    </button>\r\n                                                    <button\r\n                                                        onClick={() => {\r\n                                                            setConfirmModal({\r\n                                                                isOpen: true, title: 'Arxivlash', message: 'Ushbu qarzni arxivlamoqchimisiz? Bu moliyaviy hisobotlarga ta\\'sir qilishi mumkin.', onConfirm: async () => {\r\n                                                                    await updateDebt(user!.uid, (debt as any).id, { ...debt, status: 'archived' } as any);\r\n                                                                    setDebts(await getDebts(user!.uid));\r\n                                                                    setConfirmModal({ ...confirmModal, isOpen: false });\r\n                                                                    setAlertState({ isOpen: true, title: 'Muvaffaqiyatli', message: 'Ma\\'lumot arxivlandi.', type: 'success' });\r\n                                                                    // Update overview\r\n                                                                    const overview = await getFinanceOverview(user!.uid);\r\n                                                                    if (overview) setFinanceData(overview);\r\n                                                                }\r\n                                                            });\r\n                                                        }}\r\n                                                        className=\"w-8 h-8 flex items-center justify-center rounded-xl bg-red-500/10 text-red-500 hover:bg-red-500/20 transition-colors border border-red-500/10\"\r\n                                                    >\r\n                                                        ЁЯЧСя╕П\r\n                                                    </button>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    ))}\r\n                                    {debts.length === 0 && (\r\n                                        <div className=\"col-span-full py-20 text-center opacity-30\">\r\n                                            <p className=\"text-4xl mb-4\">ЁЯдЭ</p>\r\n                                            <p className=\"font-bold uppercase tracking-widest\">{t.finance.debtsEmpty}</p>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* 2. CREDITS VIEW */}\r\n                        {portfolioTab === 'credits' && (\r\n                            <div className=\"space-y-4 animate-fade-in\">\r\n                                <div className=\"flex justify-end\">\r\n                                    {/* Action handled by top dynamic button */}\r\n                                </div>\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                    {credits.filter(c => (c as any).status !== 'archived').map((credit: any) => {\r\n                                        const nextPayment = new Date(credit.nextPaymentDate);\r\n                                        const today = new Date();\r\n                                        const start = credit.startDate ? new Date(credit.startDate) : new Date(0);\r\n                                        const isStarted = today >= start;\r\n                                        const isDue = isStarted && (today >= nextPayment || today.getDate() >= credit.paymentDay);\r\n\r\n                                        return (\r\n                                            <div key={credit.id} className={`p-6 rounded-2xl bg-black/40 border relative group ${isDue ? 'border-aura-red' : isStarted ? 'border-white/5' : 'border-white/5 opacity-50'}`}>\r\n                                                <div className=\"absolute top-4 left-4 text-[10px] font-bold px-2 py-1 rounded-full bg-white/5 text-gray-400\">\r\n                                                    {credit.paymentDay}-{t.finance.dayLabel}\r\n                                                </div>\r\n                                                <div className=\"mt-8\"></div> {/* Spacer */}\r\n                                                <div className=\"flex justify-between items-center mb-1\">\r\n                                                    <h3 className=\"text-lg font-bold text-white mb-1\">{credit.title}</h3>\r\n                                                    {credit.historical?.isHistorical && (\r\n                                                        <span className=\"text-[8px] bg-white/5 text-aura-gold px-2 py-0.5 rounded border border-aura-gold/20 uppercase font-black\">\r\n                                                            {credit.historical?.monthsPassed} {t.finance.months} {t.finance.left.split(' ')[0]}\r\n                                                        </span>\r\n                                                    )}\r\n                                                </div>\r\n\r\n                                                {credit.historical?.isHistorical && (\r\n                                                    <div className=\"flex justify-between items-center text-[9px] text-gray-500 mb-1\">\r\n                                                        <span>{t.finance.initialAmount}: {formatNumber(credit.historical?.initialAmount || 0)}</span>\r\n                                                        <span>{Math.round(((credit.totalAmount - credit.remainingAmount) / credit.totalAmount) * 100)}%</span>\r\n                                                    </div>\r\n                                                )}\r\n\r\n                                                <div className=\"w-full bg-white/5 h-1 rounded-full mt-2 mb-4 overflow-hidden\">\r\n                                                    <div style={{ width: `${Math.min(100, ((credit.totalAmount - credit.remainingAmount) / credit.totalAmount) * 100)}%` }} className=\"h-full bg-aura-red shadow-[0_0_10px_rgba(255,50,50,0.3)]\"></div>\r\n                                                </div>\r\n\r\n                                                <div className=\"flex justify-between items-end mb-6\">\r\n                                                    <div>\r\n                                                        <p className=\"text-[10px] text-gray-500 uppercase\">{t.finance.remaining}</p>\r\n                                                        <p className=\"text-2xl font-mono font-black text-white\">{formatNumber(credit.remainingAmount)}</p>\r\n                                                    </div>\r\n                                                    <div className=\"text-right\">\r\n                                                        <p className=\"text-[10px] text-gray-500 uppercase\">{t.finance.monthlyPayment}</p>\r\n                                                        <p className=\"text-xl font-mono font-bold text-aura-red\">{formatNumber(credit.monthlyPayment)}</p>\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                <button\r\n                                                    onClick={() => !isArchived && handlePayCredit(credit)}\r\n                                                    disabled={isArchived}\r\n                                                    className={`w-full py-3 rounded-xl text-xs font-bold transition-all border ${isArchived ? 'bg-white/5 border-white/10 text-gray-500 cursor-not-allowed' : (isDue ? 'bg-aura-red text-white border-aura-red' : 'bg-white/5 hover:bg-white/10 text-white border-white/5')}`}\r\n                                                >\r\n                                                    {isDue ? `${t.finance.payNow} тЪая╕П` : t.finance.prepay}\r\n                                                </button>\r\n\r\n                                                {/* Edit/Delete Actions - Visible */}\r\n                                                {!isArchived && (\r\n                                                    <div className=\"absolute top-4 right-4 flex gap-2\">\r\n                                                        <button\r\n                                                            onClick={() => { setEditingCredit(credit); setCreditForm(credit); setIsCreditModalOpen(true); }}\r\n                                                            className=\"w-8 h-8 flex items-center justify-center rounded-xl bg-white/5 text-white hover:bg-white/10 transition-colors border border-white/5\"\r\n                                                        >\r\n                                                            тЬО\r\n                                                        </button>\r\n                                                        <button\r\n                                                            onClick={() => {\r\n                                                                setConfirmModal({\r\n                                                                    isOpen: true, title: 'Arxivlash', message: 'Ushbu kreditni arxivlamoqchimisiz? Bu moliyaviy hisobotlarga ta\\'sir qilishi mumkin.', onConfirm: async () => {\r\n                                                                        await updateCredit(user!.uid, (credit as any).id, { ...credit, status: 'archived' } as any);\r\n                                                                        setCredits(await getCredits(user!.uid));\r\n                                                                        setConfirmModal({ ...confirmModal, isOpen: false });\r\n                                                                        setAlertState({ isOpen: true, title: 'Muvaffaqiyatli', message: 'Kredit arxivlandi.', type: 'success' });\r\n                                                                        const overview = await getFinanceOverview(user!.uid);\r\n                                                                        if (overview) setFinanceData(overview);\r\n                                                                    }\r\n                                                                });\r\n                                                            }}\r\n                                                            className=\"w-8 h-8 flex items-center justify-center rounded-xl bg-red-500/10 text-red-500 hover:bg-red-500/20 transition-colors border border-red-500/10\"\r\n                                                        >\r\n                                                            ЁЯЧСя╕П\r\n                                                        </button>\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n                                        );\r\n                                    })}\r\n                                    {credits.length === 0 && (\r\n                                        <div className=\"col-span-full py-20 text-center opacity-30\">\r\n                                            <p className=\"text-4xl mb-4\">ЁЯТ│</p>\r\n                                            <p className=\"font-bold uppercase tracking-widest\">{t.finance.creditsEmpty}</p>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* 3. DEPOSITS VIEW */}\r\n                        {portfolioTab === 'deposits' && (\r\n                            <div className=\"space-y-4 animate-fade-in\">\r\n                                <div className=\"flex justify-end\">\r\n                                    {/* Action handled by top dynamic button */}\r\n                                </div>\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                    {deposits.filter(d => (d as any).status !== 'archived').map((deposit: any) => {\r\n                                        const today = new Date();\r\n                                        const start = deposit.startDate ? new Date(deposit.startDate) : new Date(0);\r\n                                        const isStarted = today >= start;\r\n                                        const isDue = isStarted && (today.getDate() >= deposit.contributionDay);\r\n\r\n                                        return (\r\n                                            <div key={deposit.id} className={`p-6 rounded-2xl bg-black/40 border border-white/5 relative group ${!isStarted ? 'opacity-50' : ''}`}>\r\n                                                <div className=\"absolute top-4 left-4 text-[10px] font-bold px-2 py-1 rounded-full bg-white/5 text-gray-400\">\r\n                                                    {deposit.contributionDay}-{t.finance.dayLabel}\r\n                                                </div>\r\n                                                <div className=\"mt-8\"></div> {/* Spacer */}\r\n                                                <div className=\"flex justify-between items-center mb-1\">\r\n                                                    <h3 className=\"text-lg font-bold text-white\">{deposit.title}</h3>\r\n                                                    {deposit.historical && deposit.historical.monthsPassed > 0 && (\r\n                                                        <span className=\"text-[8px] bg-white/5 text-aura-green px-2 py-0.5 rounded border border-aura-green/20 uppercase font-black\">\r\n                                                            {deposit.historical.monthsPassed} {t.finance.months}\r\n                                                        </span>\r\n                                                    )}\r\n                                                </div>\r\n                                                <p className=\"text-xs text-aura-green mb-4\">{t.finance.collecting} тЖЧ</p>\r\n\r\n                                                <div className=\"flex justify-between items-end mb-6\">\r\n                                                    <div>\r\n                                                        <p className=\"text-[10px] text-gray-500 uppercase\">{t.finance.totalCollected}</p>\r\n                                                        <div className=\"flex items-baseline gap-2\">\r\n                                                            <p className=\"text-2xl font-mono font-black text-white\">{formatNumber(deposit.currentAmount)}</p>\r\n                                                            {deposit.historical && deposit.historical.accruedInterest > 0 && (\r\n                                                                <span className=\"text-[10px] text-aura-green font-bold\">\r\n                                                                    (+{formatNumber(deposit.historical.accruedInterest)})\r\n                                                                </span>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div className=\"text-right\">\r\n                                                        <p className=\"text-[10px] text-gray-500 uppercase\">{t.finance.monthlyPlan}</p>\r\n                                                        <p className=\"text-xl font-mono font-bold text-aura-green\">{formatNumber(deposit.monthlyContribution)}</p>\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                <button\r\n                                                    onClick={() => !isArchived && handleAddToDeposit(deposit)}\r\n                                                    disabled={isArchived}\r\n                                                    className={`w-full py-3 rounded-xl text-xs font-bold transition-all border ${isArchived ? 'bg-white/5 border-white/10 text-gray-500 cursor-not-allowed' : (isDue ? 'bg-aura-green text-black border-aura-green' : 'bg-white/5 hover:bg-white/10 text-white border-white/5')}`}\r\n                                                >\r\n                                                    {isDue ? `${t.finance.paymentSuccess} (ESLATMA) ЁЯФФ` : t.finance.topUp}\r\n                                                </button>\r\n\r\n                                                {/* Edit/Delete Actions - Visible */}\r\n                                                {!isArchived && (\r\n                                                    <div className=\"absolute top-4 right-4 flex gap-2\">\r\n                                                        <button\r\n                                                            onClick={() => { setEditingDeposit(deposit); setDepositForm({ ...deposit, isMonthlyInterest: deposit.isMonthlyInterest ?? true, isFromBalance: true }); setIsDepositModalOpen(true); }}\r\n                                                            className=\"w-8 h-8 flex items-center justify-center rounded-xl bg-white/5 text-white hover:bg-white/10 transition-colors border border-white/5\"\r\n                                                        >\r\n                                                            тЬО\r\n                                                        </button>\r\n                                                        <button\r\n                                                            onClick={() => {\r\n                                                                setConfirmModal({\r\n                                                                    isOpen: true, title: 'Arxivlash', message: 'Ushbu omonatni arxivlamoqchimisiz? Bu moliyaviy hisobotlarga ta\\'sir qilishi mumkin.', onConfirm: async () => {\r\n                                                                        const updatedDeposit = { ...deposit, status: 'archived' };\r\n                                                                        await updateDeposit(user!.uid, deposit.id!, updatedDeposit as any);\r\n                                                                        setDeposits(await getDeposits(user!.uid));\r\n                                                                        setConfirmModal({ ...confirmModal, isOpen: false });\r\n                                                                        setAlertState({ isOpen: true, title: 'Muvaffaqiyatli', message: 'Omonat arxivlandi.', type: 'success' });\r\n                                                                        const overview = await getFinanceOverview(user!.uid);\r\n                                                                        if (overview) setFinanceData(overview);\r\n                                                                    }\r\n                                                                });\r\n                                                            }}\r\n                                                            className=\"w-8 h-8 flex items-center justify-center rounded-xl bg-red-500/10 text-red-500 hover:bg-red-500/20 transition-colors border border-red-500/10\"\r\n                                                        >\r\n                                                            ЁЯЧСя╕П\r\n                                                        </button>\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n                                        );\r\n                                    })}\r\n                                    {deposits.length === 0 && (\r\n                                        <div className=\"col-span-full py-20 text-center opacity-30\">\r\n                                            <p className=\"text-4xl mb-4\">ЁЯТ░</p>\r\n                                            <p className=\"font-bold uppercase tracking-widest\">{t.finance.depositsEmpty}</p>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n\r\n                    </div>\r\n                ) : (\r\n                    /* ADVANCED STATISTICS VIEW */\r\n                    <div className=\"space-y-8 animate-fade-in\">\r\n\r\n\r\n\r\n                        <div className=\"flex flex-col items-center gap-4 bg-white/5 p-4 rounded-xl w-fit mx-auto\">\r\n                            <div className=\"flex bg-black/40 p-1 rounded-xl\">\r\n                                {['weekly', 'monthly', 'custom'].map(m => (\r\n                                    <button\r\n                                        key={m}\r\n                                        onClick={() => setStatsPeriod(m as any)}\r\n                                        className={`px-6 py-2 rounded-lg text-xs font-bold uppercase transition-all ${statsPeriod === m ? 'bg-aura-gold text-black shadow-lg shadow-aura-gold/20' : 'text-gray-500 hover:text-white'}`}\r\n                                    >\r\n                                        {m === 'weekly' ? t.finance.weeklyLabel : m === 'monthly' ? t.finance.monthlyLabel : t.finance.customLabel}\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n\r\n                            {statsPeriod === 'custom' && (\r\n                                <div className=\"flex items-center gap-4 animate-fade-in\">\r\n                                    <div>\r\n                                        <label className=\"text-[10px] uppercase text-gray-500 block mb-1\">{t.finance.fromLabel}</label>\r\n                                        <input\r\n                                            type=\"date\"\r\n                                            value={customRange.start}\r\n                                            onChange={e => setCustomRange({ ...customRange, start: e.target.value })}\r\n                                            className=\"bg-black/40 border border-white/10 rounded-lg px-3 py-2 text-white text-xs focus:border-aura-gold outline-none\"\r\n                                            style={{ colorScheme: 'dark' }}\r\n                                        />\r\n                                    </div>\r\n                                    <span className=\"text-gray-500\">-</span>\r\n                                    <div>\r\n                                        <label className=\"text-[10px] uppercase text-gray-500 block mb-1\">{t.finance.toLabel}</label>\r\n                                        <input\r\n                                            type=\"date\"\r\n                                            value={customRange.end}\r\n                                            onChange={e => setCustomRange({ ...customRange, end: e.target.value })}\r\n                                            className=\"bg-black/40 border border-white/10 rounded-lg px-3 py-2 text-white text-xs focus:border-aura-gold outline-none\"\r\n                                            style={{ colorScheme: 'dark' }}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* NEW: Unified Bar Chart & Details for All Periods */}\r\n                        {statsData?.transactions && (\r\n                            <div className=\"p-8 rounded-[2.5rem] bg-black/40 border border-white/5\">\r\n                                <h3 className=\"text-xl font-display font-black text-white uppercase tracking-tighter mb-8\">\r\n                                    {statsPeriod === 'weekly' ? t.finance.weeklyLabel : statsPeriod === 'monthly' ? t.finance.monthlyLabel : t.finance.customLabel} {t.finance.analysisSummary}\r\n                                </h3>\r\n                                <div className=\"h-40 flex items-end gap-2 mb-8 border-b border-white/5 pb-4 overflow-x-auto\">\r\n                                    {(() => {\r\n                                        let chartData: { date: string, label: string, income: number, expense: number }[] = [];\r\n\r\n                                        if (statsPeriod === 'weekly') {\r\n                                            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\r\n                                            chartData = Array(7).fill(0).map((_, i) => {\r\n                                                const d = new Date();\r\n                                                d.setDate(d.getDate() - (6 - i));\r\n                                                return { date: d.toISOString().split('T')[0], label: days[d.getDay()], income: 0, expense: 0 };\r\n                                            });\r\n                                        } else if (statsPeriod === 'monthly') {\r\n                                            const today = new Date();\r\n                                            const currentMonth = today.getMonth();\r\n                                            const currentYear = today.getFullYear();\r\n                                            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();\r\n                                            chartData = Array.from({ length: daysInMonth }, (_, i) => {\r\n                                                const day = i + 1;\r\n                                                const d = new Date(currentYear, currentMonth, day);\r\n                                                // Handle local date string correctly\r\n                                                const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;\r\n                                                return { date: dateStr, label: String(day), income: 0, expense: 0 };\r\n                                            });\r\n                                        } else if (statsPeriod === 'custom' && customRange.start && customRange.end) {\r\n                                            const start = new Date(customRange.start);\r\n                                            const end = new Date(customRange.end);\r\n                                            const diffTime = Math.abs(end.getTime() - start.getTime());\r\n                                            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n\r\n                                            chartData = Array.from({ length: diffDays + 1 }, (_, i) => {\r\n                                                const d = new Date(start);\r\n                                                d.setDate(d.getDate() + i);\r\n                                                const dateStr = d.toISOString().split('T')[0];\r\n                                                return { date: dateStr, label: dateStr.slice(5), income: 0, expense: 0 };\r\n                                            });\r\n                                        }\r\n\r\n                                        statsData.transactions.forEach((t: Transaction) => {\r\n                                            const dEntry = chartData.find(d => d.date === t.date.split('T')[0]);\r\n                                            if (dEntry) {\r\n                                                if (t.type === 'income') dEntry.income += t.amount;\r\n                                                else dEntry.expense += t.amount;\r\n                                            }\r\n                                        });\r\n\r\n                                        const maxVal = Math.max(...chartData.map(d => Math.max(d.income, d.expense, 1)));\r\n\r\n                                        return chartData.map(d => (\r\n                                            <div key={d.date} className=\"flex-1 min-w-[20px] flex flex-col justify-end gap-1 h-full group relative\">\r\n                                                <div className=\"flex gap-1 h-full items-end justify-center\">\r\n                                                    <div style={{ height: `${(d.income / maxVal) * 80}%` }} className=\"w-2 md:w-3 bg-aura-green/50 rounded-t-sm transition-all group-hover:bg-aura-green\"></div>\r\n                                                    <div style={{ height: `${(d.expense / maxVal) * 80}%` }} className=\"w-2 md:w-3 bg-aura-red/50 rounded-t-sm transition-all group-hover:bg-aura-red\"></div>\r\n                                                </div>\r\n                                                <span className=\"text-[9px] text-center text-white/50 uppercase font-black truncate\">{d.label}</span>\r\n                                                {/* Tooltip */}\r\n                                                <div className=\"absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-black border border-white/20 p-2 rounded-lg text-[10px] hidden group-hover:block w-max z-20 shadow-2xl\">\r\n                                                    <p className=\"text-white/70 mb-1 font-bold\">{d.date}</p>\r\n                                                    <p className=\"text-aura-green\">+{formatNumber(d.income)}</p>\r\n                                                    <p className=\"text-aura-red\">-{formatNumber(d.expense)}</p>\r\n                                                </div>\r\n                                            </div>\r\n                                        ));\r\n                                    })()}\r\n                                </div>\r\n\r\n                                {/* V18: Enhanced Category Analysis */}\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 mt-12 pb-8 border-b border-white/5\">\r\n                                    <div>\r\n                                        <h4 className=\"text-[10px] font-black text-aura-green uppercase tracking-[0.2em] mb-4\">{t.finance.incomeTitle} {t.finance.byCategory}</h4>\r\n                                        <div className=\"space-y-4\">\r\n                                            {Object.entries(statsData.income || {}).sort(([, a]: any, [, b]: any) => b - a).map(([cat, amount]: any) => {\r\n                                                const percentage = Math.round((amount / (statsData.totalIncome || 1)) * 100);\r\n                                                return (\r\n                                                    <div key={cat} className=\"group cursor-help\">\r\n                                                        <div className=\"flex justify-between items-end mb-1\">\r\n                                                            <span className=\"text-xs font-bold text-white group-hover:text-aura-green transition-colors\">{cat}</span>\r\n                                                            <div className=\"flex items-baseline gap-1\">\r\n                                                                <span className=\"text-sm font-black text-white\">{formatNumber(convert(amount, 'UZS', statsDisplayCurrency))}</span>\r\n                                                                <span className=\"text-[8px] text-gray-500\">{statsDisplayCurrency}</span>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                        <div className=\"h-1.5 w-full bg-white/5 rounded-full overflow-hidden\">\r\n                                                            <div className=\"h-full bg-aura-green transition-all duration-1000 ease-out\" style={{ width: `${percentage}%` }}></div>\r\n                                                        </div>\r\n                                                        <div className=\"text-[8px] text-right mt-1 text-gray-500 font-black\">{percentage}%</div>\r\n                                                    </div>\r\n                                                );\r\n                                            })}\r\n                                            {(!statsData.income || Object.keys(statsData.income).length === 0) && <p className=\"text-[10px] text-gray-600 uppercase italic\">No income data</p>}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div>\r\n                                        <h4 className=\"text-[10px] font-black text-aura-red uppercase tracking-[0.2em] mb-4\">{t.finance.expenseTitle} {t.finance.byCategory}</h4>\r\n                                        <div className=\"space-y-4\">\r\n                                            {Object.entries(statsData.expense || {}).sort(([, a]: any, [, b]: any) => b - a).map(([cat, amount]: any) => {\r\n                                                const percentage = Math.round((amount / (statsData.totalExpense || 1)) * 100);\r\n                                                return (\r\n                                                    <div key={cat} className=\"group cursor-help\">\r\n                                                        <div className=\"flex justify-between items-end mb-1\">\r\n                                                            <span className=\"text-xs font-bold text-white group-hover:text-aura-red transition-colors\">{cat}</span>\r\n                                                            <div className=\"flex items-baseline gap-1\">\r\n                                                                <span className=\"text-sm font-black text-white\">{formatNumber(convert(amount, 'UZS', statsDisplayCurrency))}</span>\r\n                                                                <span className=\"text-[8px] text-gray-500\">{statsDisplayCurrency}</span>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                        <div className=\"h-1.5 w-full bg-white/5 rounded-full overflow-hidden\">\r\n                                                            <div className=\"h-full bg-aura-red transition-all duration-1000 ease-out\" style={{ width: `${percentage}%` }}></div>\r\n                                                        </div>\r\n                                                        <div className=\"text-[8px] text-right mt-1 text-gray-500 font-black\">{percentage}%</div>\r\n                                                    </div>\r\n                                                );\r\n                                            })}\r\n                                            {(!statsData.expense || Object.keys(statsData.expense).length === 0) && <p className=\"text-[10px] text-gray-600 uppercase italic\">No expense data</p>}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Detailed Transaction List */}\r\n                                <h3 className=\"text-sm font-black text-gray-500 uppercase tracking-widest mb-4\">{t.finance.detailedList}</h3>\r\n                                <div className=\"space-y-2 max-h-96 overflow-y-auto pr-2 custom-scrollbar\">\r\n                                    {(statsData.transactions as Transaction[]).sort((a, b) => b.date.localeCompare(a.date)).map(t => (\r\n                                        <div key={t.id} className=\"flex items-center justify-between p-3 rounded-xl bg-white/5 border border-white/5 hover:bg-white/10 transition-all\">\r\n                                            <div className=\"flex items-center gap-3\">\r\n                                                <div className=\"text-xl\">{t.icon}</div>\r\n                                                <div>\r\n                                                    <p className=\"text-xs font-bold text-white\">{t.title}</p>\r\n                                                    <p className=\"text-[10px] text-gray-500\">{t.date} тАв {t.category}</p>\r\n                                                </div>\r\n                                            </div>\r\n                                            <span className={`text-sm font-mono font-bold ${t.type === 'income' ? 'text-aura-green' : 'text-white'}`}>\r\n                                                {t.type === 'income' ? '+' : '-'}{formatNumber(t.amount)}\r\n                                            </span>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\r\n                            {/* TRANSACTION HISTORY (Left Column) */}\r\n                            <div className=\"p-8 rounded-[2.5rem] bg-black border border-white/10 flex flex-col h-[600px]\">\r\n                                <div className=\"flex justify-between items-center mb-8\">\r\n                                    <h3 className=\"text-xs font-black uppercase tracking-[0.2em] text-white/60\">{t.finance.recentActivity}</h3>\r\n                                    <button onClick={() => setIsAllTransactionsOpen(true)} className=\"text-[10px] font-bold text-gray-400 hover:text-white transition-colors border border-white/10 px-3 py-1 rounded-full\">{t.finance.viewAll}</button>\r\n                                </div>\r\n\r\n                                <div className=\"space-y-4 overflow-y-auto pr-2 custom-scrollbar flex-1\">\r\n                                    {statsData?.transactions && statsData.transactions.length > 0 ? (\r\n                                        statsData.transactions.slice(0, 15).map((t: Transaction, idx: number) => (\r\n                                            <div key={t.id || idx} className=\"flex items-center justify-between p-4 rounded-2xl bg-white/5 border border-white/5 hover:border-white/10 transition-all group\">\r\n                                                <div className=\"flex items-center gap-4\">\r\n                                                    <div className=\"w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center text-xl group-hover:bg-white/10 transition-colors\">\r\n                                                        {t.icon}\r\n                                                    </div>\r\n                                                    <div>\r\n                                                        <p className=\"text-xs font-black text-white/90\">{t.title}</p>\r\n                                                        <p className=\"text-[9px] text-white/50 uppercase font-black tracking-widest\">{t.category} тАв {t.date}</p>\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div className=\"text-right\">\r\n                                                    <p className={`text-sm font-mono font-black ${t.type === 'income' ? 'text-aura-green' : 'text-white'}`}>\r\n                                                        {t.type === 'income' ? '+' : '-'}{formatNumber(convert(t.amount, 'UZS', statsDisplayCurrency))}\r\n                                                    </p>\r\n                                                    <span className=\"text-[8px] text-white/50 font-bold uppercase\">{statsDisplayCurrency}</span>\r\n                                                </div>\r\n                                            </div>\r\n                                        ))\r\n                                    ) : (\r\n                                        <div className=\"flex flex-col items-center justify-center h-full opacity-20\">\r\n                                            <div className=\"w-20 h-1 bg-gradient-to-r from-transparent via-white to-transparent mb-4\"></div>\r\n                                            <p className=\"text-xs font-mono w-full text-center uppercase tracking-[0.3em]\">{t.finance.noTransactions}</p>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* RIGHT COLUMN: Income & Expense Stack */}\r\n                            <div className=\"flex flex-col gap-8 h-[600px]\">\r\n                                {/* Income Stats Section */}\r\n                                <div className=\"p-8 rounded-[2.5rem] bg-black/40 border border-white/5 flex-1 overflow-y-auto custom-scrollbar\">\r\n                                    <div className=\"flex justify-between items-start mb-6\">\r\n                                        <h3 className=\"text-xl font-display font-black text-aura-green uppercase tracking-tighter\">\r\n                                            {statsPeriod === 'weekly' ? t.finance.weeklyLabel : statsPeriod === 'monthly' ? t.finance.monthlyLabel : t.finance.customLabel} {t.finance.incomeTitle}\r\n                                        </h3>\r\n                                        <select\r\n                                            value={statsDisplayCurrency}\r\n                                            onChange={(e) => setStatsDisplayCurrency(e.target.value as any)}\r\n                                            className=\"bg-black border border-white/10 rounded-lg px-2 py-1 text-[10px] text-white font-bold uppercase outline-none\"\r\n                                        >\r\n                                            {['UZS', 'USD', 'EUR', 'RUB'].map(c => <option key={c} value={c}>{c}</option>)}\r\n                                        </select>\r\n                                    </div>\r\n                                    <div className=\"space-y-4\">\r\n                                        {statsData?.income && Object.entries(statsData.income).map(([cat, amount]: any) => {\r\n                                            const rate = exchangeRates.find(r => r.code === statsDisplayCurrency)?.rate || 1;\r\n                                            let displayAmount = amount;\r\n                                            if (statsDisplayCurrency !== 'UZS') {\r\n                                                displayAmount = amount / rate;\r\n                                            }\r\n                                            let totalIncomeConverted = statsData.totalIncome;\r\n                                            if (statsDisplayCurrency !== 'UZS') totalIncomeConverted = statsData.totalIncome / rate;\r\n\r\n                                            return (\r\n                                                <div key={cat} className=\"space-y-1\">\r\n                                                    <div className=\"flex justify-between items-end\">\r\n                                                        <span className=\"text-[10px] font-black text-gray-500 uppercase tracking-widest\">{cat}</span>\r\n                                                        <span className=\"text-sm font-black text-white\">{statsDisplayCurrency} {formatNumber(Math.round(displayAmount))}</span>\r\n                                                    </div>\r\n                                                    <div className=\"h-1.5 w-full bg-white/5 rounded-full overflow-hidden\">\r\n                                                        <div\r\n                                                            className=\"h-full bg-aura-green\"\r\n                                                            style={{ width: `${Math.min(100, (displayAmount / (totalIncomeConverted || 1)) * 100)}%` }}\r\n                                                        ></div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            );\r\n                                        })}\r\n                                        {(!statsData?.income || Object.keys(statsData.income).length === 0) && (\r\n                                            <div className=\"py-10 text-center opacity-30 text-[10px] font-black uppercase tracking-[0.3em]\">{t.finance.noData}</div>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Expense Stats Section */}\r\n                                <div className=\"p-8 rounded-[2.5rem] bg-black/40 border border-white/5 flex-1 overflow-y-auto custom-scrollbar\">\r\n                                    <div className=\"flex justify-between items-start mb-6\">\r\n                                        <h3 className=\"text-xl font-display font-black text-aura-red uppercase tracking-tighter\">\r\n                                            {statsPeriod === 'weekly' ? t.finance.weeklyLabel : statsPeriod === 'monthly' ? t.finance.monthlyLabel : t.finance.customLabel} {t.finance.expenseTitle}\r\n                                        </h3>\r\n                                    </div>\r\n                                    <div className=\"space-y-4\">\r\n                                        {statsData?.expense && Object.entries(statsData.expense).map(([cat, amount]: any) => {\r\n                                            const rate = exchangeRates.find(r => r.code === statsDisplayCurrency)?.rate || 1;\r\n                                            let displayAmount = amount;\r\n                                            if (statsDisplayCurrency !== 'UZS') {\r\n                                                displayAmount = amount / rate;\r\n                                            }\r\n                                            let totalExpenseConverted = statsData.totalExpense;\r\n                                            if (statsDisplayCurrency !== 'UZS') totalExpenseConverted = statsData.totalExpense / rate;\r\n\r\n                                            return (\r\n                                                <div key={cat} className=\"space-y-1\">\r\n                                                    <div className=\"flex justify-between items-end\">\r\n                                                        <span className=\"text-[10px] font-black text-gray-500 uppercase tracking-widest\">{cat}</span>\r\n                                                        <span className=\"text-sm font-black text-white\">{statsDisplayCurrency} {formatNumber(Math.round(displayAmount))}</span>\r\n                                                    </div>\r\n                                                    <div className=\"h-1.5 w-full bg-white/5 rounded-full overflow-hidden\">\r\n                                                        <div\r\n                                                            className=\"h-full bg-aura-red\"\r\n                                                            style={{ width: `${Math.min(100, (displayAmount / (totalExpenseConverted || 1)) * 100)}%` }}\r\n                                                        ></div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            );\r\n                                        })}\r\n                                        {(!statsData?.expense || Object.keys(statsData.expense).length === 0) && (\r\n                                            <div className=\"py-10 text-center opacity-30 text-[10px] font-black uppercase tracking-[0.3em]\">{t.finance.noData}</div>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"p-8 rounded-[2.5rem] bg-gradient-to-br from-indigo-500/10 to-black border border-white/5 text-center\">\r\n                            <p className=\"text-[10px] font-black text-indigo-400 uppercase tracking-[0.3em] mb-4\">{t.finance.aiPredictionTitle}</p>\r\n                            <h4 className=\"text-2xl font-display font-black text-white mb-4\">\r\n                                {(() => {\r\n                                    // Dynamic Projection Logic\r\n                                    const now = new Date();\r\n                                    let daysRemaining = 0;\r\n                                    let passedDays = 1;\r\n\r\n                                    if (statsPeriod === 'weekly') {\r\n                                        const dayOfWeek = now.getDay(); // 0-6\r\n                                        passedDays = dayOfWeek + 1; // 1-7\r\n                                        daysRemaining = 7 - passedDays;\r\n                                    } else if (statsPeriod === 'monthly') {\r\n                                        const daysInMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();\r\n                                        passedDays = now.getDate(); // 1-31\r\n                                        daysRemaining = daysInMonth - passedDays;\r\n                                    }\r\n\r\n                                    // Use Stats Data for Projection\r\n                                    const netIncome = (statsData?.totalIncome || 0) - (statsData?.totalExpense || 0);\r\n                                    const dailyAvg = netIncome / (passedDays || 1);\r\n                                    const projectedFinal = netIncome + (dailyAvg * daysRemaining);\r\n\r\n                                    return (\r\n                                        <>\r\n                                            {t.finance.predictionPart1} <span className={projectedFinal >= 0 ? 'text-aura-green' : 'text-aura-red'}>\r\n                                                {projectedFinal >= 0 ? '+' : ''}{formatNumber(projectedFinal)} {statsDisplayCurrency}\r\n                                            </span> {t.finance.predictionPart2}\r\n                                        </>\r\n                                    );\r\n                                })()}\r\n                            </h4>\r\n                            <p className=\"text-gray-500 text-xs max-w-2xl mx-auto leading-relaxed\">\r\n                                {(() => {\r\n                                    const inc = financeData.monthlyIncome || 0;\r\n                                    const exp = financeData.monthlySpent || 0;\r\n                                    const savingsRate = inc > 0 ? ((inc - exp) / inc) * 100 : 0;\r\n\r\n                                    let message = \"\";\r\n                                    if (savingsRate > 50) message = t.finance.predictionMsgExcellent;\r\n                                    else if (savingsRate > 20) message = t.finance.predictionMsgGood;\r\n                                    else if (savingsRate > 0) message = t.finance.predictionMsgOk;\r\n                                    else message = t.finance.predictionMsgBad;\r\n\r\n                                    return message;\r\n                                })()}\r\n                            </p>\r\n                        </div>\r\n\r\n                        {/* AI Financial Advisor (Enhanced V21) */}\r\n                        <AiInsightSection\r\n                            onAnalyze={refreshInsight}\r\n                            isLoading={aiLoading}\r\n                            insight={aiInsight}\r\n                            title=\"AI Moliyaviy Maslahatchi\"\r\n                            description=\"Moliyaviy holatingizni sun'iy intellekt yordamida chuqur tahlil qiling. Bu jarayon bir necha soniya vaqt olishi mumkin.\"\r\n                            buttonText=\"Tahlilni Boshlash\"\r\n                            color=\"gold\"\r\n                        />\r\n                    </div>\r\n                )\r\n                }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n            </div>\r\n\r\n            {/* MODALS RENDERING OUTSIDE ANIMATED WRAPPER */}\r\n            {/* 1. ADD TRANSACTION MODAL */}\r\n            <Modal isOpen={isAddModalOpen} onClose={() => setIsAddModalOpen(false)} title={t.finance.addTransaction}>\r\n                <div className=\"space-y-4\">\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <button\r\n                            onClick={() => setNewTx({ ...newTx, type: 'income' })}\r\n                            className={`py-3 rounded-xl font-bold transition-all ${newTx.type === 'income' ? 'bg-aura-green text-black shadow-lg shadow-aura-green/20' : 'bg-white/5 text-gray-500'}`}\r\n                        >\r\n                            {t.finance.incomeTitle}\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setNewTx({ ...newTx, type: 'expense' })}\r\n                            className={`py-3 rounded-xl font-bold transition-all ${newTx.type === 'expense' ? 'bg-aura-red text-white shadow-lg shadow-aura-red/20' : 'bg-white/5 text-gray-500'}`}\r\n                        >\r\n                            {t.finance.expenseTitle}\r\n                        </button>\r\n                    </div>\r\n                    <div className=\"grid grid-cols-4 gap-2 mb-2\">\r\n                        {['UZS', 'USD', 'EUR', 'RUB'].map(c => (\r\n                            <button\r\n                                key={c}\r\n                                onClick={() => setNewTx({ ...newTx, currency: c as any })}\r\n                                className={`py-2 rounded-lg text-xs font-bold transition-all ${newTx.currency === c ? 'bg-white text-black' : 'bg-white/5 text-gray-400 hover:bg-white/10'}`}\r\n                            >\r\n                                {c}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n\r\n                    <div className=\"space-y-4\">\r\n                        <div>\r\n                            <label htmlFor=\"new-tx-title\" className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.transTitle}</label>\r\n                            <input\r\n                                id=\"new-tx-title\"\r\n                                value={newTx.title}\r\n                                onChange={e => setNewTx({ ...newTx, title: e.target.value })}\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-aura-gold\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div>\r\n                                <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.amount}</label>\r\n                                <MoneyInput\r\n                                    value={newTx.amount}\r\n                                    onChange={(val) => setNewTx({ ...newTx, amount: val })}\r\n                                    className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-aura-gold\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label htmlFor=\"new-tx-currency\" className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.currency}</label>\r\n                                <select\r\n                                    id=\"new-tx-currency\"\r\n                                    value={newTx.currency || 'UZS'}\r\n                                    onChange={e => setNewTx({ ...newTx, currency: e.target.value as any })}\r\n                                    className=\"w-full bg-black border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                                >\r\n                                    {['UZS', 'USD', 'EUR', 'RUB'].map(c => <option key={c} value={c}>{c}</option>)}\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                        <div>\r\n                            <label htmlFor=\"new-tx-category\" className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.transCategory}</label>\r\n                            <select\r\n                                id=\"new-tx-category\"\r\n                                value={newTx.category}\r\n                                onChange={e => setNewTx({ ...newTx, category: e.target.value })}\r\n                                className=\"w-full bg-black border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                            >\r\n                                {(newTx.type === 'income' ? incomeCategories : expenseCategories).map(c => (\r\n                                    <option key={c.name} value={c.name}>\r\n                                        {t.categories[c.key] || c.name}\r\n                                    </option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <button\r\n                        onClick={() => handleAddTransaction()}\r\n                        className=\"w-full py-4 rounded-xl bg-aura-gold text-black font-black uppercase tracking-widest hover:bg-white transition-all mt-4\"\r\n                    >\r\n                        {t.common.save}\r\n                    </button>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* 2. HISTORY MODAL */}\r\n            <HistoryModal isOpen={isHistoryOpen} onClose={() => setIsHistoryOpen(false)} title={t.finance.archivedDays}>\r\n                <div className=\"space-y-3\">\r\n                    {[1, 2, 3, 4, 5].map((day) => (\r\n                        <div key={day} className=\"flex justify-between items-center p-4 rounded-xl bg-white/5 border border-white/10 opacity-70 hover:opacity-100\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <span className=\"text-xl\">ЁЯФТ</span>\r\n                                <div>\r\n                                    <p className=\"font-bold text-white\">Jan {12 - day}, 2026</p>\r\n                                    <p className=\"text-xs text-gray-500\">{t.finance.dayClosed}</p>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"text-right\">\r\n                                <p className=\"font-mono text-aura-red font-bold\">-$45.00</p>\r\n                                <p className=\"text-xs text-gray-500\">{t.finance.spent}</p>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </HistoryModal>\r\n\r\n            {/* 3. DEBT MODAL (Fixed) */}\r\n            <Modal isOpen={isDebtModalOpen} onClose={() => setIsDebtModalOpen(false)} title={t.finance.addDebt}>\r\n                <div className=\"space-y-4\">\r\n                    <div className=\"flex bg-black/40 p-1 rounded-xl\">\r\n                        <button\r\n                            onClick={() => setDebtForm({ ...debtForm, type: 'i_owe' })}\r\n                            className={`flex-1 py-3 rounded-lg text-sm font-bold uppercase transition-all ${debtForm.type === 'i_owe' ? 'bg-aura-red text-white shadow-lg shadow-aura-red/20' : 'text-gray-500 hover:text-white'}`}\r\n                        >\r\n                            ЁЯУе {t.finance.iOwe}\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setDebtForm({ ...debtForm, type: 'owed_to_me' })}\r\n                            className={`flex-1 py-3 rounded-lg text-sm font-bold uppercase transition-all ${debtForm.type === 'owed_to_me' ? 'bg-aura-green text-black shadow-lg shadow-aura-green/20' : 'text-gray-500 hover:text-white'}`}\r\n                        >\r\n                            ЁЯУд {t.finance.owedToMe}\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.personName}</label>\r\n                        <input\r\n                            value={debtForm.person}\r\n                            onChange={e => setDebtForm({ ...debtForm, person: e.target.value })}\r\n                            className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                            placeholder={t.finance.fullNamePlaceholder}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div>\r\n                            <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.amount}</label>\r\n                            <MoneyInput\r\n                                value={debtForm.amount}\r\n                                onChange={(val) => setDebtForm({ ...debtForm, amount: val })}\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.currency}</label>\r\n                            <select\r\n                                value={debtForm.currency}\r\n                                onChange={e => setDebtForm({ ...debtForm, currency: e.target.value as any })}\r\n                                className=\"w-full bg-black border border-white/10 rounded-xl px-4 py-3 text-white outline-none appearance-none\"\r\n                            >\r\n                                {['UZS', 'USD', 'EUR', 'RUB'].map(c => (\r\n                                    <option key={c} value={c} className=\"bg-black text-white\">{c}</option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div>\r\n                            <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.dateTaken}</label>\r\n                            <input\r\n                                type=\"date\"\r\n                                value={debtForm.startDate}\r\n                                onChange={e => setDebtForm({ ...debtForm, startDate: e.target.value })}\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                                style={{ colorScheme: 'dark' }}\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.returnDate}</label>\r\n                            <input\r\n                                type=\"date\"\r\n                                value={debtForm.deadline}\r\n                                onChange={e => setDebtForm({ ...debtForm, deadline: e.target.value })}\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                                style={{ colorScheme: 'dark' }}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <button\r\n                        onClick={handleAddDebt}\r\n                        className={`w-full py-4 rounded-xl font-black uppercase tracking-widest hover:bg-white transition-all mt-4 ${debtForm.type === 'i_owe' ? 'bg-aura-red text-white' : 'bg-aura-green text-black'}`}\r\n                    >\r\n                        {t.common.save}\r\n                    </button>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* 4. GOAL MODAL */}\r\n            <Modal isOpen={isGoalModalOpen} onClose={() => setIsGoalModalOpen(false)} title={t.finance.editGoalTitle}>\r\n                <div className=\"space-y-4\">\r\n                    <div>\r\n                        <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.target} {t.finance.amount}</label>\r\n                        <div className=\"flex gap-2\">\r\n                            <select\r\n                                value={goalForm.currency}\r\n                                onChange={(e) => {\r\n                                    const newCurrency = e.target.value;\r\n                                    const oldCurrency = goalForm.currency;\r\n                                    let newTarget = goalForm.target;\r\n\r\n                                    if (newCurrency !== oldCurrency) {\r\n                                        const oldRate = exchangeRates.find(r => r.code === oldCurrency)?.rate || 1;\r\n                                        const newRate = exchangeRates.find(r => r.code === newCurrency)?.rate || 1;\r\n                                        const amountInUZS = oldCurrency === 'UZS' ? newTarget : newTarget * oldRate;\r\n                                        newTarget = newCurrency === 'UZS' ? amountInUZS : amountInUZS / newRate;\r\n                                    }\r\n\r\n                                    setGoalForm({ ...goalForm, currency: newCurrency, target: Math.round(newTarget) });\r\n                                }}\r\n                                className=\"bg-zinc-900 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-aura-gold appearance-none\"\r\n                            >\r\n                                {['USD', 'UZS', 'EUR', 'RUB'].map(c => (\r\n                                    <option key={c} value={c} className=\"bg-zinc-900 text-white\">{c}</option>\r\n                                ))}\r\n                            </select>\r\n                            <MoneyInput\r\n                                value={goalForm.target}\r\n                                onChange={(val) => setGoalForm({ ...goalForm, target: val })}\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-aura-gold transition-colors\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.deadline}</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={goalForm.deadline}\r\n                            onChange={e => setGoalForm({ ...goalForm, deadline: e.target.value })}\r\n                            className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-aura-gold transition-colors\"\r\n                            placeholder={t.finance.datePlaceholder}\r\n                        />\r\n                    </div>\r\n                    <button\r\n                        onClick={handleGoalUpdate}\r\n                        className=\"w-full py-4 rounded-xl bg-aura-gold text-black font-bold uppercase text-xs tracking-widest hover:bg-white transition-all mt-4\"\r\n                    >\r\n                        {t.common.save}\r\n                    </button>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* 5. BUDGET MODAL */}\r\n            <Modal isOpen={isBudgetModalOpen} onClose={() => setIsBudgetModalOpen(false)} title={t.finance.editBudgetTitle}>\r\n                <div className=\"space-y-6\">\r\n                    <div className=\"p-4 rounded-xl bg-aura-green/5 border border-aura-green/20\">\r\n                        <label className=\"text-[10px] text-aura-green uppercase font-black tracking-widest mb-3 block\">{t.finance.targetIncome} (UZS)</label>\r\n                        <MoneyInput\r\n                            value={budgetForm.incomeBudget}\r\n                            onChange={(val) => setBudgetForm({ ...budgetForm, incomeBudget: val })}\r\n                            className=\"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-aura-green transition-colors\"\r\n                        />\r\n                        <p className=\"text-[8px] text-gray-500 mt-2 uppercase\">{t.finance.incomeHistoryEmptyDesc}</p>\r\n                    </div>\r\n\r\n                    <div className=\"p-4 rounded-xl bg-aura-red/5 border border-aura-red/20\">\r\n                        <label className=\"text-[10px] text-aura-red uppercase font-black tracking-widest mb-3 block\">{t.finance.limitExpense} (UZS)</label>\r\n                        <MoneyInput\r\n                            value={budgetForm.expenseBudget}\r\n                            onChange={(val) => setBudgetForm({ ...budgetForm, expenseBudget: val })}\r\n                            className=\"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-aura-red transition-colors\"\r\n                        />\r\n                        <p className=\"text-[8px] text-gray-500 mt-2 uppercase\">{t.finance.expenseHistoryEmptyDesc}</p>\r\n                    </div>\r\n\r\n                    <button\r\n                        onClick={handleBudgetUpdate}\r\n                        className=\"w-full py-4 rounded-xl bg-white text-black font-black uppercase text-[10px] tracking-widest hover:bg-aura-gold hover:text-black transition-all shadow-lg\"\r\n                    >\r\n                        {t.common.save}\r\n                    </button>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* 6. CREDIT MODAL */}\r\n            <Modal isOpen={isCreditModalOpen} onClose={() => setIsCreditModalOpen(false)} title={t.finance.addCredit}>\r\n                <div className=\"space-y-4\">\r\n                    <div>\r\n                        <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.creditName}</label>\r\n                        <input\r\n                            value={creditForm.title}\r\n                            onChange={e => setCreditForm({ ...creditForm, title: e.target.value })}\r\n                            className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                            placeholder={t.finance.creditNamePlaceholder}\r\n                        />\r\n                    </div>\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div>\r\n                            <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.totalAmount}</label>\r\n                            <MoneyInput\r\n                                value={creditForm.totalAmount}\r\n                                onChange={(val) => setCreditForm({ ...creditForm, totalAmount: val })}\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.monthlyPayment}</label>\r\n                            <MoneyInput\r\n                                value={creditForm.monthlyPayment}\r\n                                onChange={(val) => setCreditForm({ ...creditForm, monthlyPayment: val })}\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.paymentDay}</label>\r\n                        <input\r\n                            type=\"number\"\r\n                            min=\"1\" max=\"31\"\r\n                            value={creditForm.paymentDay}\r\n                            onChange={e => setCreditForm({ ...creditForm, paymentDay: Number(e.target.value) })}\r\n                            className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                            placeholder={t.finance.daysInMonth}\r\n                        />\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"text-xs text-aura-gold uppercase mb-1 block\">{t.finance.startDate}</label>\r\n                        <input\r\n                            type=\"date\"\r\n                            value={creditForm.startDate}\r\n                            onChange={e => setCreditForm({ ...creditForm, startDate: e.target.value })}\r\n                            className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-aura-gold mb-4\"\r\n                            style={{ colorScheme: 'dark' }}\r\n                        />\r\n                        <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.currency}</label>\r\n                        <select\r\n                            value={creditForm.currency}\r\n                            onChange={e => setCreditForm({ ...creditForm, currency: e.target.value })}\r\n                            className=\"w-full bg-black border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                        >\r\n                            {['UZS', 'USD', 'EUR', 'RUB'].map(c => <option key={c} value={c} className=\"bg-black text-white\">{c}</option>)}\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div>\r\n                            <label className=\"text-xs text-aura-gold uppercase mb-1 block\">{t.finance.interestRate}</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={creditForm.interestRate || ''}\r\n                                onChange={e => setCreditForm({ ...creditForm, interestRate: Number(e.target.value) })}\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-aura-gold\"\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs text-aura-gold uppercase mb-1 block\">{t.finance.termMonths}</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={creditForm.termMonths || ''}\r\n                                onChange={e => setCreditForm({ ...creditForm, termMonths: Number(e.target.value) })}\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-aura-gold\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"text-xs text-aura-gold uppercase mb-1 block\">{t.finance.calculationMethod}</label>\r\n                        <div className=\"flex bg-black/40 p-1 rounded-xl\">\r\n                            <button\r\n                                onClick={() => setCreditForm({ ...creditForm, calculationMethod: 'annuity' })}\r\n                                className={`flex-1 py-2 rounded-lg text-xs font-bold uppercase transition-all ${creditForm.calculationMethod === 'annuity' ? 'bg-aura-green text-black' : 'text-gray-500 hover:text-white'}`}\r\n                            >\r\n                                {t.finance.annuity}\r\n                            </button>\r\n                            <button\r\n                                onClick={() => setCreditForm({ ...creditForm, calculationMethod: 'differential' })}\r\n                                className={`flex-1 py-2 rounded-lg text-xs font-bold uppercase transition-all ${creditForm.calculationMethod === 'differential' ? 'bg-aura-gold text-black' : 'text-gray-500 hover:text-white'}`}\r\n                            >\r\n                                {t.finance.differential}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <button\r\n                        onClick={handleAddCredit}\r\n                        className=\"w-full py-4 rounded-xl bg-aura-red text-white font-black uppercase tracking-widest hover:bg-white/10 transition-all mt-4\"\r\n                    >\r\n                        {t.finance.add}\r\n                    </button>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* 7. DEPOSIT MODAL */}\r\n            <Modal isOpen={isDepositModalOpen} onClose={() => setIsDepositModalOpen(false)} title={t.finance.addDeposit}>\r\n                <div className=\"space-y-4\">\r\n                    <div>\r\n                        <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.depositName}</label>\r\n                        <input\r\n                            value={depositForm.title}\r\n                            onChange={e => setDepositForm({ ...depositForm, title: e.target.value })}\r\n                            className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                            placeholder={t.finance.depositNamePlaceholder}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div>\r\n                            <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.currentAmount}</label>\r\n                            <MoneyInput\r\n                                value={depositForm.currentAmount}\r\n                                onChange={(val) => setDepositForm({ ...depositForm, currentAmount: val })}\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.currency}</label>\r\n                            <select\r\n                                value={depositForm.currency}\r\n                                onChange={e => setDepositForm({ ...depositForm, currency: e.target.value as any })}\r\n                                className=\"w-full bg-black border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                            >\r\n                                {['UZS', 'USD', 'EUR', 'RUB'].map(c => <option key={c} value={c} className=\"bg-black text-white\">{c}</option>)}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div>\r\n                            <label className=\"text-xs text-aura-green uppercase mb-1 block\">{t.finance.interestRate}</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={depositForm.interestRate || ''}\r\n                                onChange={e => setDepositForm({ ...depositForm, interestRate: Number(e.target.value) })}\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-aura-green\"\r\n                                placeholder=\"0\"\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs text-aura-green uppercase mb-1 block\">{t.finance.termMonths}</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={depositForm.termMonths || ''}\r\n                                onChange={e => setDepositForm({ ...depositForm, termMonths: Number(e.target.value) })}\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-aura-green\"\r\n                                placeholder=\"12\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div\r\n                        onClick={() => setDepositForm({ ...depositForm, isMonthlyInterest: !depositForm.isMonthlyInterest })}\r\n                        className={`p-3 rounded-xl border flex items-center justify-between cursor-pointer transition-all ${depositForm.isMonthlyInterest ? 'bg-aura-green/20 border-aura-green' : 'bg-white/5 border-white/10'}`}\r\n                    >\r\n                        <span className=\"text-xs font-bold text-white uppercase\">{t.finance.monthlyProfitChoice}</span>\r\n                        <div className={`w-4 h-4 rounded-full border border-white/20 flex items-center justify-center ${depositForm.isMonthlyInterest ? 'bg-aura-green' : 'bg-transparent'}`}>\r\n                            {depositForm.isMonthlyInterest && <span className=\"text-black text-[10px]\">тЬУ</span>}\r\n                        </div>\r\n                    </div>\r\n\r\n                    <p className=\"text-xs text-center text-gray-400\">\r\n                        {t.finance.expectedMonthlyProfit}: <span className=\"text-aura-green font-bold\">\r\n                            {depositForm.interestRate > 0 ? (depositForm.currentAmount * (depositForm.interestRate / 100) / 12).toLocaleString() : 0} {depositForm.currency}\r\n                        </span>\r\n                    </p>\r\n\r\n                    <div>\r\n                        <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.startDate}</label>\r\n                        <input\r\n                            type=\"date\"\r\n                            value={depositForm.startDate}\r\n                            onChange={e => setDepositForm({ ...depositForm, startDate: e.target.value })}\r\n                            className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none\"\r\n                            style={{ colorScheme: 'dark' }}\r\n                        />\r\n                    </div>\r\n\r\n                    <button\r\n                        onClick={async () => {\r\n                            if (!user || !depositForm.title || depositForm.currentAmount <= 0) {\r\n                                setAlertState({ isOpen: true, title: 'Error', message: t.finance.fillAllFields, type: 'error' });\r\n                                return;\r\n                            }\r\n                            const result = calculateHistoricalDeposit(\r\n                                depositForm.currentAmount,\r\n                                depositForm.interestRate,\r\n                                depositForm.termMonths,\r\n                                depositForm.startDate || getLocalTodayStr(),\r\n                                !depositForm.isMonthlyInterest\r\n                            );\r\n                            const depositData = {\r\n                                title: depositForm.title,\r\n                                currentAmount: result.currentAmount,\r\n                                monthlyContribution: depositForm.monthlyContribution,\r\n                                contributionDay: depositForm.contributionDay,\r\n                                currency: depositForm.currency,\r\n                                startDate: depositForm.startDate || getLocalTodayStr(),\r\n                                interestRate: depositForm.interestRate,\r\n                                termMonths: depositForm.termMonths,\r\n                                isMonthlyInterest: depositForm.isMonthlyInterest,\r\n                                payoutHistory: [],\r\n                                historical: {\r\n                                    initialAmount: result.initialAmount,\r\n                                    accruedInterest: result.accruedInterest,\r\n                                    monthsPassed: result.monthsPassed\r\n                                }\r\n                            };\r\n                            if (editingDeposit) {\r\n                                await updateDeposit(user.uid, editingDeposit.id!, depositData);\r\n                                setAlertState({ isOpen: true, title: 'Success', message: 'Omonat yangilandi!', type: 'success' });\r\n                            } else {\r\n                                await addDeposit(user.uid, depositData);\r\n                                const isHistorical = result.monthsPassed > 0;\r\n                                if (!isHistorical) {\r\n                                    if (!depositForm.isFromBalance) {\r\n                                        await handleAddTransaction({ title: `Omonat Kirimi: ${depositForm.title}`, amount: depositForm.currentAmount, type: 'income', category: t.categories.depositIn, date: depositForm.startDate || getLocalTodayStr(), icon: 'ЁЯТ░', currency: depositForm.currency } as any);\r\n                                    } else {\r\n                                        await handleAddTransaction({ title: `Omonatga o'tkazma: ${depositForm.title}`, amount: depositForm.currentAmount, type: 'expense', category: t.categories.savings, date: depositForm.startDate || getLocalTodayStr(), icon: 'ЁЯУе', currency: depositForm.currency, isTransfer: true } as any);\r\n                                    }\r\n                                }\r\n                                setAlertState({ isOpen: true, title: 'Success', message: 'Omonat muvaffaqiyatli qo\\'shildi!', type: 'success' });\r\n                            }\r\n                            setDeposits(await getDeposits(user.uid));\r\n                            setIsDepositModalOpen(false);\r\n                            setEditingDeposit(null);\r\n                            const overview = await getFinanceOverview(user.uid);\r\n                            if (overview) setFinanceData(overview);\r\n                            setDepositForm({ title: '', monthlyContribution: 0, contributionDay: 1, currency: 'UZS', startDate: '', currentAmount: 0, interestRate: 0, termMonths: 12, isMonthlyInterest: true, isFromBalance: true });\r\n                        }}\r\n                        className=\"w-full py-4 rounded-xl bg-aura-gold text-black font-black uppercase tracking-widest hover:bg-white transition-all mt-4\"\r\n                    >\r\n                        {t.common.save}\r\n                    </button>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* 8. REPAYMENT MODAL */}\r\n            <Modal isOpen={isRepaymentModalOpen} onClose={() => setIsRepaymentModalOpen(false)} title={t.finance.creditPayment}>\r\n                <div className=\"space-y-4\">\r\n                    <p className=\"text-white text-center text-sm opacity-60 mb-4\">{t.finance.repaymentSplit}</p>\r\n                    <div>\r\n                        <label className=\"text-xs text-aura-green uppercase mb-1 block\">{t.finance.principalAmount} ({t.finance.remaining}: {payingCredit ? formatNumber(payingCredit.remainingAmount) : 0})</label>\r\n                        <MoneyInput value={repaymentForm.principal} onChange={(val) => setRepaymentForm({ ...repaymentForm, principal: val })} className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-aura-green\" />\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"text-xs text-aura-red uppercase mb-1 block\">{t.finance.interestAmount} ({t.finance.expenseTitle})</label>\r\n                        <MoneyInput value={repaymentForm.interest} onChange={(val) => setRepaymentForm({ ...repaymentForm, interest: val })} className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-aura-red\" />\r\n                    </div>\r\n                    <div className=\"bg-white/5 rounded-xl p-4 mt-4\">\r\n                        <div className=\"flex justify-between text-xs text-gray-400 mb-1\"><span>{t.finance.totalAmount}</span></div>\r\n                        <div className=\"text-xl font-bold text-white\">{formatNumber(repaymentForm.principal + repaymentForm.interest)} {payingCredit?.currency}</div>\r\n                    </div>\r\n                    <button onClick={submitCreditRepayment} className=\"w-full py-4 rounded-xl bg-aura-gold text-black font-black uppercase tracking-widest hover:bg-white transition-all mt-4\">{t.finance.confirmPayment}</button>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* 9. DEPOSIT ACTION MODAL */}\r\n            <Modal isOpen={isDepositActionModalOpen} onClose={() => setIsDepositActionModalOpen(false)} title={t.finance.depositActionTitle}>\r\n                <div className=\"space-y-4\">\r\n                    <div className=\"flex bg-black/40 p-1 rounded-xl mb-4\">\r\n                        <button onClick={() => { setDepositAction('add'); setIsDepositTransferFromBalance(true); }} className={`flex-1 py-2 rounded-lg text-xs font-bold uppercase transition-all ${depositAction === 'add' ? 'bg-aura-green text-black' : 'text-gray-500 hover:text-white'}`}>{t.finance.actionAdd}</button>\r\n                        <button onClick={() => setDepositAction('withdraw')} className={`flex-1 py-2 rounded-lg text-xs font-bold uppercase transition-all ${depositAction === 'withdraw' ? 'bg-aura-red text-white' : 'text-gray-500 hover:text-white'}`}>{t.finance.actionWithdraw}</button>\r\n                        <button onClick={() => setDepositAction('profit')} className={`flex-1 py-2 rounded-lg text-xs font-bold uppercase transition-all ${depositAction === 'profit' ? 'bg-aura-gold text-black' : 'text-gray-500 hover:text-white'}`}>{t.finance.actionProfit}</button>\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"text-xs text-gray-500 uppercase mb-1 block\">{t.finance.amount}</label>\r\n                        <MoneyInput value={depositAmount} onChange={(val) => setDepositAmount(val)} className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-aura-gold\" />\r\n                    </div>\r\n                    <button onClick={submitDepositAction} className={`w-full py-4 rounded-xl font-black uppercase tracking-widest hover:bg-white transition-all mt-4 ${depositAction === 'add' ? 'bg-aura-green text-black' : depositAction === 'withdraw' ? 'bg-aura-red text-white' : 'bg-aura-gold text-black'}`}>{t.common.save}</button>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* 10. ALERT MODAL */}\r\n            <Modal isOpen={alertState.isOpen} onClose={() => setAlertState({ ...alertState, isOpen: false })} title={alertState.title}>\r\n                <div className=\"p-6 text-center\">\r\n                    <div className=\"text-4xl mb-4\">{alertState.type === 'success' ? 'тЬЕ' : alertState.type === 'warning' ? 'тЪая╕П' : 'тЭМ'}</div>\r\n                    <p className=\"text-white text-lg font-bold mb-2\">{alertState.message}</p>\r\n                    <button onClick={() => setAlertState({ ...alertState, isOpen: false })} className={`mt-6 w-full py-3 rounded-xl font-bold uppercase tracking-widest text-black transition-all ${alertState.type === 'success' ? 'bg-aura-green' : alertState.type === 'warning' ? 'bg-aura-gold' : 'bg-aura-red'}`}>OK</button>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* 11. QR SCANNER MODAL */}\r\n            <Modal isOpen={isQRModalOpen} onClose={() => setIsQRModalOpen(false)} title={t.finance.qrScannerTitle}>\r\n                <div className=\"p-10 text-center flex flex-col items-center gap-6\">\r\n                    <div className={`w-40 h-40 rounded-3xl border-2 border-dashed flex items-center justify-center text-4xl transition-all ${qrLoading ? 'border-aura-gold animate-pulse' : 'border-white/20'}`}>{qrLoading ? 'ЁЯФН' : 'ЁЯУ╖'}</div>\r\n                    <p className=\"text-gray-400 text-sm max-w-xs\">{t.finance.qrScannerDesc}</p>\r\n                    <button onClick={handleQRScan} disabled={qrLoading} className=\"w-full py-4 rounded-2xl bg-aura-gold text-black font-black uppercase text-xs tracking-widest disabled:opacity-50\">{qrLoading ? t.finance.analyzing : t.finance.qrScannerAction}</button>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* 12. DUE ITEMS MODAL */}\r\n            <Modal isOpen={isDueModalOpen} onClose={() => setIsDueModalOpen(false)} title={`${t.finance.todayPayments} ЁЯФФ`}>\r\n                <div className=\"space-y-4\">\r\n                    <p className=\"text-sm text-gray-400\">{t.finance.confirmPaymentsInstruction}</p>\r\n                    {dueItems.map((due, idx) => (\r\n                        <div key={idx} className=\"flex justify-between items-center bg-white/5 p-4 rounded-xl border border-white/10\">\r\n                            <div>\r\n                                <p className=\"font-bold text-white text-lg\">{due.item.title}</p>\r\n                                <p className=\"text-xs text-aura-gold uppercase tracking-wider\">{due.type === 'credit' ? t.finance.creditPayment : t.finance.depositProfit}</p>\r\n                            </div>\r\n                            <button onClick={() => handleConfirmDueItem(due)} className=\"bg-aura-green text-black px-6 py-2 rounded-lg font-bold hover:scale-105 transition-transform\">{t.finance.confirmPayment}</button>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* 13. ALL TRANSACTIONS HISTORY MODAL */}\r\n            <Modal isOpen={isAllTransactionsOpen} onClose={() => setIsAllTransactionsOpen(false)} title={t.finance.recentActivity}>\r\n                <div className=\"space-y-4 max-h-[70vh] overflow-y-auto pr-2 custom-scrollbar\">\r\n                    <div className=\"flex justify-between items-center mb-4\">\r\n                        <p className=\"text-sm text-gray-400\">{t.common.history}</p>\r\n                        <div className=\"text-xs text-aura-gold\">{transactions.length} record(s)</div>\r\n                    </div>\r\n\r\n                    {transactions.length > 0 ? transactions.map((t) => (\r\n                        <div key={t.id} className=\"flex items-center gap-4 p-4 rounded-2xl bg-white/5 border border-white/5 hover:bg-white/10 transition-all group\">\r\n                            <div className=\"w-12 h-12 rounded-xl bg-black border border-white/10 flex items-center justify-center text-xl\">\r\n                                {t.icon}\r\n                            </div>\r\n                            <div className=\"flex-1\">\r\n                                <h4 className=\"font-bold text-white text-sm\">{t.title}</h4>\r\n                                <p className=\"text-[10px] text-gray-500 uppercase font-black tracking-widest\">{new Date(t.date).toLocaleDateString()} тАв {t.category}</p>\r\n                            </div>\r\n                            <div className={`text-lg font-mono font-black ${t.type === 'income' ? 'text-aura-green' : 'text-white'}`}>\r\n                                {t.type === 'income' ? '+' : '-'}{t.amount.toLocaleString()}\r\n                            </div>\r\n                        </div>\r\n                    )) : (\r\n                        <div className=\"py-20 text-center opacity-20\">\r\n                            <p className=\"text-4xl mb-4\">ЁЯУЬ</p>\r\n                            <p className=\"text-[10px] font-black uppercase tracking-[0.5em]\">{t.finance.noTransactions}</p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </Modal>\r\n            {/* 14. CONFIRMATION WARNING MODAL */}\r\n            <Modal isOpen={confirmModal.isOpen} onClose={() => setConfirmModal({ ...confirmModal, isOpen: false })} title={confirmModal.title}>\r\n                <div className=\"p-6 text-center space-y-4\">\r\n                    <div className=\"text-4xl\">тЪая╕П</div>\r\n                    <p className=\"text-white font-bold\">{confirmModal.message}</p>\r\n                    <p className=\"text-xs text-gray-400\">Bu amalni ortga qaytarib bo&apos;lmasligi mumkin.</p>\r\n                    <div className=\"flex gap-4 mt-6\">\r\n                        <button onClick={() => setConfirmModal({ ...confirmModal, isOpen: false })} className=\"flex-1 py-3 rounded-xl bg-white/5 text-gray-300 font-bold hover:bg-white/10 transition-all\">Bekor qilish</button>\r\n                        <button onClick={confirmModal.onConfirm} className=\"flex-1 py-3 rounded-xl bg-aura-red text-white font-bold hover:bg-red-600 transition-all\">Tasdiqlash</button>\r\n                    </div>\r\n                </div>\r\n            </Modal>\r\n\r\n            {/* 15. EXTEND DEBT MODAL (Restored) */}\r\n            <Modal isOpen={!!extendModalDebt} onClose={() => setExtendModalDebt(null)} title={t.finance.extend}>\r\n                <div className=\"space-y-4\">\r\n                    <div>\r\n                        <label className=\"text-xs text-aura-gold uppercase mb-1 block\">{t.finance.deadline}</label>\r\n                        <input\r\n                            type=\"date\"\r\n                            value={newDeadline}\r\n                            onChange={e => setNewDeadline(e.target.value)}\r\n                            className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-aura-gold\"\r\n                            style={{ colorScheme: 'dark' }}\r\n                        />\r\n                    </div>\r\n                    <button\r\n                        onClick={async () => {\r\n                            if (!extendModalDebt || !newDeadline) return;\r\n                            await updateDebt(user!.uid, extendModalDebt.id, { ...extendModalDebt, deadline: newDeadline });\r\n                            setDebts(await getDebts(user!.uid));\r\n                            setExtendModalDebt(null);\r\n                            setAlertState({ isOpen: true, title: 'Success', message: 'Muddat uzaytirildi!', type: 'success' });\r\n                        }}\r\n                        className=\"w-full py-4 rounded-xl bg-aura-gold text-black font-black uppercase tracking-widest hover:bg-white transition-all mt-4\"\r\n                    >\r\n                        {t.common.save}\r\n                    </button>\r\n                </div>\r\n            </Modal>\r\n        </>\r\n    );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\focus\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":9,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":20,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'unlockScreenTime' is defined but never used.","line":31,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getFamilyMembers' is defined but never used.","line":31,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":44},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":36,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'sessionDuration' is assigned a value but never used.","line":47,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":47,"endColumn":34},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'SOUNDS'. Either include it or remove the dependency array.","line":129,"column":8,"nodeType":"ArrayExpression","endLine":129,"endColumn":41,"suggestions":[{"desc":"Update the dependencies array to be: [isRunning, activeSound, isMuted, SOUNDS]","fix":{"range":[4503,4536],"text":"[isRunning, activeSound, isMuted, SOUNDS]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'clearNotification'. Either include it or remove the dependency array.","line":147,"column":8,"nodeType":"ArrayExpression","endLine":147,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [user, isRunning, clearNotification]","fix":{"range":[4999,5016],"text":"[user, isRunning, clearNotification]"}}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":351,"column":47,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[17452,17558],"text":"\r\n                                            YO&apos;Q, DAVOM ETAMAN\r\n                                        "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[17452,17558],"text":"\r\n                                            YO&lsquo;Q, DAVOM ETAMAN\r\n                                        "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[17452,17558],"text":"\r\n                                            YO&#39;Q, DAVOM ETAMAN\r\n                                        "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[17452,17558],"text":"\r\n                                            YO&rsquo;Q, DAVOM ETAMAN\r\n                                        "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":379,"column":124,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[19595,19610],"text":"O&apos;rtacha Diqqat"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[19595,19610],"text":"O&lsquo;rtacha Diqqat"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[19595,19610],"text":"O&#39;rtacha Diqqat"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[19595,19610],"text":"O&rsquo;rtacha Diqqat"},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { useSearchParams } from 'next/navigation';\r\nimport Link from 'next/link';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport {\r\n    Play,\r\n    Pause,\r\n    X,\r\n    Volume2,\r\n    VolumeX,\r\n    CloudRain,\r\n    Trees,\r\n    Music,\r\n    Coffee,\r\n    Waves,\r\n    ChevronLeft,\r\n    ShieldCheck,\r\n    AlertTriangle,\r\n    Clock\r\n} from 'lucide-react';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useNotifications } from '@/context/NotificationContext';\r\nimport { useLanguage } from '@/context/LanguageContext';\r\nimport { useFocus } from '@/context/FocusContext';\r\nimport {\r\n    getFocusHistory,\r\n    getTodayFocusStats,\r\n    FocusSession\r\n} from '@/services/focusService';\r\nimport { unlockScreenTime, getFamilyMembers } from '@/services/familyService';\r\n\r\nconst DURATIONS = [5, 10, 15, 20, 25];\r\n\r\nexport default function FocusDashboard() {\r\n    const { t } = useLanguage();\r\n    const { user } = useAuth();\r\n    const { clearNotification } = useNotifications();\r\n    const searchParams = useSearchParams();\r\n    const taskId = searchParams.get('taskId');\r\n    const taskNameFromURL = searchParams.get('taskName');\r\n\r\n    const {\r\n        isActive: isRunning,\r\n        isPaused,\r\n        timeLeft,\r\n        duration: sessionDuration,\r\n        distractions,\r\n        startSession,\r\n        pauseSession,\r\n        resumeSession,\r\n        endSession,\r\n        taskName: activeTaskName\r\n    } = useFocus();\r\n\r\n    const [nextDuration, setNextDuration] = useState(25);\r\n    const [activeSound, setActiveSound] = useState<'rain' | 'forest' | 'lofi' | 'cafe' | 'ocean'>('rain');\r\n    const [isMuted, setIsMuted] = useState(false);\r\n    const [history, setHistory] = useState<FocusSession[]>([]);\r\n    const [todayStats, setTodayStats] = useState({ totalMinutes: 0, sessions: 0, completed: 0 });\r\n    const [isConfirmingEnd, setIsConfirmingEnd] = useState(false);\r\n    const audioRef = useRef<HTMLAudioElement | null>(null);\r\n\r\n    const SOUNDS = {\r\n        rain: {\r\n            url: 'https://raw.githubusercontent.com/bradtraversy/ambient-sound-mixer/main/audio/rain.mp3',\r\n            label: \"YOMG'IR\",\r\n            icon: <CloudRain className=\"w-4 h-4\" />\r\n        },\r\n        forest: {\r\n            url: 'https://raw.githubusercontent.com/bradtraversy/ambient-sound-mixer/main/audio/birds.mp3',\r\n            label: \"O'RMON\",\r\n            icon: <Trees className=\"w-4 h-4\" />\r\n        },\r\n        lofi: {\r\n            url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3',\r\n            label: \"LOFI\",\r\n            icon: <Music className=\"w-4 h-4\" />\r\n        },\r\n        cafe: {\r\n            url: 'https://raw.githubusercontent.com/bradtraversy/ambient-sound-mixer/main/audio/cafe.mp3',\r\n            label: \"KAFE\",\r\n            icon: <Coffee className=\"w-4 h-4\" />\r\n        },\r\n        ocean: {\r\n            url: 'https://raw.githubusercontent.com/bradtraversy/ambient-sound-mixer/main/audio/ocean.mp3',\r\n            label: \"OKEAN\",\r\n            icon: <Waves className=\"w-4 h-4\" />\r\n        }\r\n    };\r\n\r\n    // Audio Playback Controller\r\n    useEffect(() => {\r\n        let isCancelled = false;\r\n\r\n        const playAudio = async () => {\r\n            if (!audioRef.current || isCancelled) return;\r\n            try {\r\n                // Ensure we are in a valid state to play\r\n                if (isRunning && !isMuted) {\r\n                    await audioRef.current.play();\r\n                } else {\r\n                    audioRef.current.pause();\r\n                }\r\n            } catch (err) {\r\n                // Ignore AbortError as it is expected when switching sounds quickly\r\n                if ((err as Error).name !== 'AbortError') {\r\n                    console.error(\"Audio playback error:\", err);\r\n                }\r\n            }\r\n        };\r\n\r\n        if (isRunning && !isMuted) {\r\n            if (!audioRef.current) {\r\n                audioRef.current = new Audio(SOUNDS[activeSound].url);\r\n                audioRef.current.loop = true;\r\n            } else if (audioRef.current.src !== SOUNDS[activeSound].url) {\r\n                audioRef.current.src = SOUNDS[activeSound].url;\r\n            }\r\n            playAudio();\r\n        } else {\r\n            audioRef.current?.pause();\r\n        }\r\n\r\n        return () => {\r\n            isCancelled = true;\r\n            // audioRef.current?.pause(); // Don't pause here to avoid cutting off sound transitions abruptly\r\n        };\r\n    }, [isRunning, activeSound, isMuted]);\r\n\r\n    // Global cleanup\r\n    useEffect(() => {\r\n        return () => {\r\n            if (audioRef.current) {\r\n                audioRef.current.pause();\r\n                audioRef.current = null;\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (user) {\r\n            clearNotification('tasks');\r\n            getFocusHistory(user.uid).then(setHistory);\r\n            getTodayFocusStats(user.uid).then(setTodayStats);\r\n        }\r\n    }, [user, isRunning]);\r\n\r\n    const handleStart = async () => {\r\n        if (!user) return;\r\n\r\n        // Initialize and play audio immediately on user click to satisfy browser autoplay policy\r\n        if (!audioRef.current) {\r\n            audioRef.current = new Audio(SOUNDS[activeSound].url);\r\n            audioRef.current.loop = true;\r\n        } else if (audioRef.current.src !== SOUNDS[activeSound].url) {\r\n            audioRef.current.src = SOUNDS[activeSound].url;\r\n        }\r\n\r\n        if (!isMuted) {\r\n            audioRef.current.play().catch(e => console.error(\"Manual audio start failed:\", e));\r\n        }\r\n\r\n        await startSession(nextDuration, taskId || undefined, taskNameFromURL || undefined);\r\n    };\r\n\r\n    const handleGiveUp = async () => {\r\n        if (!isConfirmingEnd) {\r\n            setIsConfirmingEnd(true);\r\n            return;\r\n        }\r\n        await endSession('failed');\r\n        setIsConfirmingEnd(false);\r\n    };\r\n\r\n    const formatTime = (seconds: number) => {\r\n        const m = Math.floor(seconds / 60);\r\n        const s = seconds % 60;\r\n        return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-[#020202] text-white flex flex-col font-sans selection:bg-aura-purple/30 overflow-hidden relative\">\r\n\r\n            {/* Zen Background Layers */}\r\n            <div className=\"fixed inset-0 pointer-events-none z-0\">\r\n                <div className=\"absolute top-[-10%] right-[-5%] w-[800px] h-[800px] bg-aura-purple/5 rounded-full blur-[140px] animate-pulse\"></div>\r\n                <div className=\"absolute bottom-[-10%] left-[-5%] w-[600px] h-[600px] bg-aura-cyan/5 rounded-full blur-[120px] animate-pulse delay-700\"></div>\r\n                <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 brightness-50 contrast-150\"></div>\r\n                <div className={`absolute inset-0 bg-black/60 transition-opacity duration-1000 ${isRunning ? 'opacity-90' : 'opacity-40'}`}></div>\r\n            </div>\r\n\r\n            {/* Navigation Header */}\r\n            <motion.header\r\n                initial={{ y: -20, opacity: 0 }}\r\n                animate={{ y: 0, opacity: 1 }}\r\n                className=\"relative z-20 p-8 flex items-center justify-between\"\r\n            >\r\n                <Link\r\n                    href=\"/dashboard/tasks/\"\r\n                    className=\"flex items-center gap-2 px-5 py-2.5 rounded-2xl bg-white/5 border border-white/10 hover:bg-white/10 transition-all group backdrop-blur-xl\"\r\n                >\r\n                    <ChevronLeft className=\"w-4 h-4 text-gray-400 group-hover:text-white transition-colors\" />\r\n                    <span className=\"text-[10px] font-black uppercase tracking-[0.2em] text-gray-400 group-hover:text-white\">Vazifalar</span>\r\n                </Link>\r\n\r\n                <div className=\"flex flex-col items-center\">\r\n                    <motion.span\r\n                        animate={{ opacity: [0.4, 1, 0.4] }}\r\n                        transition={{ duration: 4, repeat: Infinity }}\r\n                        className=\"text-[9px] font-black uppercase tracking-[0.5em] text-aura-purple\"\r\n                    >\r\n                        Ultra Focus Mode\r\n                    </motion.span>\r\n                    <h1 className=\"text-xs font-black tracking-[0.3em] text-white uppercase mt-1\">DIQQAT SESSIYASI</h1>\r\n                </div>\r\n\r\n                <div className=\"w-32 flex justify-end\">\r\n                    {activeTaskName && (\r\n                        <div className=\"flex items-center gap-3 px-4 py-2 rounded-full bg-white/5 border border-white/10 backdrop-blur-xl\">\r\n                            <div className=\"w-1.5 h-1.5 rounded-full bg-aura-purple animate-pulse shadow-[0_0_8px_#A855F7]\" />\r\n                            <span className=\"text-[9px] font-black text-gray-300 uppercase truncate max-w-[100px]\">{activeTaskName}</span>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </motion.header>\r\n\r\n            {/* Main Content Area */}\r\n            <main className=\"flex-1 relative z-10 flex flex-col items-center justify-center -mt-10 px-6\">\r\n\r\n                <div className=\"relative w-full max-w-4xl flex flex-col items-center\">\r\n\r\n                    {/* Duration Selector */}\r\n                    <AnimatePresence>\r\n                        {!isRunning && (\r\n                            <motion.div\r\n                                initial={{ opacity: 0, y: 20 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                exit={{ opacity: 0, y: -20 }}\r\n                                className=\"flex gap-2 mb-8 bg-white/5 p-1.5 rounded-[1.5rem] border border-white/5 backdrop-blur-2xl\"\r\n                            >\r\n                                {DURATIONS.map(d => (\r\n                                    <button\r\n                                        key={d}\r\n                                        onClick={() => setNextDuration(d)}\r\n                                        className={`w-12 h-10 rounded-xl flex flex-col items-center justify-center transition-all duration-500 ${nextDuration === d\r\n                                            ? 'bg-white text-black shadow-[0_0_20px_rgba(255,255,255,0.1)] scale-105'\r\n                                            : 'text-gray-500 hover:text-white hover:bg-white/5'\r\n                                            }`}\r\n                                    >\r\n                                        <span className=\"text-sm font-black\">{d}</span>\r\n                                        <span className=\"text-[7px] font-bold uppercase opacity-50\">min</span>\r\n                                    </button>\r\n                                ))}\r\n                            </motion.div>\r\n                        )}\r\n                    </AnimatePresence>\r\n\r\n                    {/* Timer Display */}\r\n                    <motion.div\r\n                        layout\r\n                        className=\"relative flex flex-col items-center\"\r\n                    >\r\n                        {/* Immersive Timer Glow */}\r\n                        <div className={`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[120%] h-[120%] bg-aura-purple/10 rounded-full blur-[80px] transition-opacity duration-1000 ${isRunning ? 'opacity-100' : 'opacity-0'}`} />\r\n\r\n                        <div className={`text-[8rem] md:text-[10rem] font-black leading-none tabular-nums tracking-tighter transition-all duration-1000 select-none ${!isRunning ? 'text-white/10 blur-[1px] scale-95' : 'text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.15)]'}`}>\r\n                            {formatTime(isRunning ? timeLeft : nextDuration * 60)}\r\n                        </div>\r\n\r\n                        {/* Status Indicators */}\r\n                        <AnimatePresence>\r\n                            {isRunning && (\r\n                                <motion.div\r\n                                    initial={{ opacity: 0, y: 10 }}\r\n                                    animate={{ opacity: 1, y: 0 }}\r\n                                    exit={{ opacity: 0, y: 10 }}\r\n                                    className=\"flex flex-col items-center gap-2 mt-2\"\r\n                                >\r\n                                    <div className={`px-4 py-1.5 rounded-full border flex items-center gap-2 backdrop-blur-2xl transition-all duration-500 ${distractions > 0\r\n                                        ? 'bg-red-500/10 border-red-500/30 text-red-500 shadow-[0_0_20px_rgba(239,68,68,0.2)]'\r\n                                        : 'bg-aura-purple/10 border-aura-purple/30 text-aura-purple shadow-[0_0_20px_rgba(168,85,247,0.2)]'\r\n                                        }`}>\r\n                                        <div className=\"relative\">\r\n                                            {distractions > 0 ? <AlertTriangle className=\"w-3 h-3 animate-pulse\" /> : <ShieldCheck className=\"w-3 h-3\" />}\r\n                                        </div>\r\n                                        <span className=\"text-[9px] font-black uppercase tracking-wider\">\r\n                                            {distractions > 0 ? `Buzilish: ${distractions}` : 'Fokus Faol'}\r\n                                        </span>\r\n                                    </div>\r\n                                </motion.div>\r\n                            )}\r\n                        </AnimatePresence>\r\n                    </motion.div>\r\n\r\n                    {/* Desktop Hover Hint */}\r\n                    {!isRunning && (\r\n                        <motion.div\r\n                            animate={{ opacity: [0, 0.5, 0] }}\r\n                            transition={{ duration: 3, repeat: Infinity }}\r\n                            className=\"mt-4 text-[9px] font-bold text-gray-600 uppercase tracking-widest\"\r\n                        >\r\n                            Vaqtni tanlang va sessiyani boshlang\r\n                        </motion.div>\r\n                    )}\r\n\r\n                    {/* Primary Button Container */}\r\n                    <div className=\"mt-8 relative flex items-center justify-center w-full max-w-md\">\r\n                        {!isRunning ? (\r\n                            <motion.button\r\n                                layoutId=\"mainAction\"\r\n                                whileHover={{ scale: 1.02, backgroundColor: '#ffffff' }}\r\n                                whileTap={{ scale: 0.98 }}\r\n                                onClick={handleStart}\r\n                                className=\"w-full py-5 rounded-[2rem] bg-white text-black font-black text-lg uppercase tracking-[0.2em] shadow-[0_15px_40px_rgba(255,255,255,0.1)] hover:shadow-[0_20px_50px_rgba(255,255,255,0.2)] transition-all duration-300 relative z-10\"\r\n                            >\r\n                                BOSHLASH\r\n                            </motion.button>\r\n                        ) : (\r\n                            <motion.div\r\n                                layoutId=\"mainAction\"\r\n                                initial={{ scale: 0.9, opacity: 0 }}\r\n                                animate={{ scale: 1, opacity: 1 }}\r\n                                className=\"flex items-center gap-3 bg-white/5 p-2 rounded-[2.5rem] border border-white/10 backdrop-blur-3xl\"\r\n                            >\r\n                                <button\r\n                                    onClick={isPaused ? resumeSession : pauseSession}\r\n                                    className={`w-14 h-14 rounded-full flex items-center justify-center transition-all duration-500 overflow-hidden group ${isPaused\r\n                                        ? 'bg-aura-green text-black scale-110 shadow-[0_0_30px_rgba(16,185,129,0.4)]'\r\n                                        : 'bg-white/10 text-white hover:bg-white/20'\r\n                                        }`}\r\n                                >\r\n                                    {isPaused ? <Play className=\"w-6 h-6 fill-current\" /> : <Pause className=\"w-6 h-6 fill-current group-hover:scale-110 transition-transform\" />}\r\n                                </button>\r\n\r\n                                <div className=\"flex flex-col gap-1.5\">\r\n                                    <button\r\n                                        onClick={handleGiveUp}\r\n                                        className={`px-6 py-3 rounded-full font-black uppercase tracking-widest text-[9px] transition-all duration-500 ${isConfirmingEnd\r\n                                            ? 'bg-red-500 text-white shadow-[0_0_25px_rgba(239,68,68,0.4)] px-8'\r\n                                            : 'bg-red-500/10 border border-red-500/20 text-red-500 hover:bg-red-500 hover:text-white'\r\n                                            }`}\r\n                                    >\r\n                                        {isConfirmingEnd ? \"HA, TO'XTATISH\" : \"Tugatish\"}\r\n                                    </button>\r\n                                    {isConfirmingEnd && (\r\n                                        <button\r\n                                            onClick={() => setIsConfirmingEnd(false)}\r\n                                            className=\"text-[8px] font-black uppercase tracking-widest text-gray-400 hover:text-white transition-colors\"\r\n                                        >\r\n                                            YO'Q, DAVOM ETAMAN\r\n                                        </button>\r\n                                    )}\r\n                                </div>\r\n                            </motion.div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Stats/History Preview when not running */}\r\n                    <AnimatePresence>\r\n                        {!isRunning && (\r\n                            <motion.div\r\n                                initial={{ opacity: 0 }}\r\n                                animate={{ opacity: 1 }}\r\n                                exit={{ opacity: 0 }}\r\n                                className=\"mt-12 w-full grid grid-cols-1 md:grid-cols-3 gap-4\"\r\n                            >\r\n                                <div className=\"p-4 rounded-2xl bg-white/5 border border-white/5 flex flex-col items-center\">\r\n                                    <span className=\"text-[9px] font-bold text-gray-500 uppercase tracking-widest mb-1.5\">Bugungi Vaqt</span>\r\n                                    <span className=\"text-2xl font-black\">{todayStats.totalMinutes}</span>\r\n                                    <span className=\"text-[7px] font-bold text-aura-purple uppercase tracking-widest mt-0.5\">daqiqa</span>\r\n                                </div>\r\n                                <div className=\"p-4 rounded-2xl bg-white/5 border border-white/5 flex flex-col items-center\">\r\n                                    <span className=\"text-[9px] font-bold text-gray-500 uppercase tracking-widest mb-1.5\">Bajarilgan</span>\r\n                                    <span className=\"text-2xl font-black\">{todayStats.completed}</span>\r\n                                    <span className=\"text-[7px] font-bold text-aura-cyan uppercase tracking-widest mt-0.5\">seans</span>\r\n                                </div>\r\n                                <div className=\"p-4 rounded-2xl bg-white/5 border border-white/5 flex flex-col items-center\">\r\n                                    <span className=\"text-[9px] font-bold text-gray-500 uppercase tracking-widest mb-1.5\">O'rtacha Diqqat</span>\r\n                                    <span className=\"text-2xl font-black\">{history.length > 0 ? (100 - (history.reduce((acc, s) => acc + (s.distractions || 0), 0) / history.length) * 10).toFixed(0) : 100}%</span>\r\n                                    <span className=\"text-[7px] font-bold text-aura-green uppercase tracking-widest mt-0.5\">sifat</span>\r\n                                </div>\r\n                            </motion.div>\r\n                        )}\r\n                    </AnimatePresence>\r\n\r\n                    {/* History List */}\r\n                    <AnimatePresence>\r\n                        {!isRunning && history.length > 0 && (\r\n                            <motion.div\r\n                                initial={{ opacity: 0, y: 10 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                className=\"mt-8 w-full max-w-xl\"\r\n                            >\r\n                                <h2 className=\"text-[9px] font-black uppercase tracking-[0.3em] text-gray-600 mb-4 text-center\">Oxirgi Sessiyalar</h2>\r\n                                <div className=\"space-y-2\">\r\n                                    {history.slice(0, 3).map((session, i) => (\r\n                                        <div key={session.id || i} className=\"p-3 rounded-xl bg-white/[0.02] border border-white/5 flex items-center justify-between group hover:bg-white/[0.05] transition-all duration-300\">\r\n                                            <div className=\"flex items-center gap-3\">\r\n                                                <div className={`w-1.5 h-1.5 rounded-full ${session.status === 'completed' ? 'bg-aura-green' : 'bg-red-500'} shadow-[0_0_8px_currentColor]`} />\r\n                                                <div className=\"flex flex-col\">\r\n                                                    <span className=\"text-[10px] font-bold text-white uppercase tracking-wider\">{session.taskName || \"Deep Work\"}</span>\r\n                                                    <span className=\"text-[8px] text-gray-500 font-mono\">{new Date(session.startedAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })} тАв {session.duration} min</span>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                {session.distractions > 0 && (\r\n                                                    <span className=\"text-[7px] font-bold text-red-500/50 border border-red-500/10 px-1.5 py-0.5 rounded-full uppercase\">\r\n                                                        {session.distractions}\r\n                                                    </span>\r\n                                                )}\r\n                                                <span className={`text-[8px] font-black uppercase ${session.status === 'completed' ? 'text-aura-green' : 'text-red-500/50'}`}>\r\n                                                    {session.status === 'completed' ? 'тЬУ' : 'тЬЧ'}\r\n                                                </span>\r\n                                            </div>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </motion.div>\r\n                        )}\r\n                    </AnimatePresence>\r\n                </div>\r\n            </main>\r\n\r\n            {/* Immersive Sound Control Bar */}\r\n            <AnimatePresence>\r\n                {isRunning && (\r\n                    <motion.footer\r\n                        initial={{ y: 100, opacity: 0 }}\r\n                        animate={{ y: 0, opacity: 1 }}\r\n                        exit={{ y: 100, opacity: 0 }}\r\n                        className=\"fixed bottom-12 left-1/2 -translate-x-1/2 z-40 w-fit\"\r\n                    >\r\n                        <div className=\"flex items-center gap-2 p-3 bg-black/60 backdrop-blur-[40px] border border-white/10 rounded-full shadow-[0_20px_50px_rgba(0,0,0,0.5)] scale-110\">\r\n                            {/* Mute Button */}\r\n                            <button\r\n                                onClick={() => setIsMuted(!isMuted)}\r\n                                className={`w-14 h-14 rounded-full flex items-center justify-center transition-all duration-500 ${!isMuted ? 'bg-aura-cyan text-black shadow-[0_0_30px_rgba(0,240,255,0.4)]' : 'bg-white/5 text-gray-500 border border-white/5'\r\n                                    }`}\r\n                            >\r\n                                {isMuted ? <VolumeX className=\"w-6 h-6\" /> : <Volume2 className=\"w-6 h-6 animate-pulse\" />}\r\n                            </button>\r\n\r\n                            <div className=\"w-px h-10 bg-white/10 mx-2\" />\r\n\r\n                            {/* Sound Presets */}\r\n                            <div className=\"flex gap-1 pr-2\">\r\n                                {(Object.keys(SOUNDS) as Array<keyof typeof SOUNDS>).map((key) => (\r\n                                    <button\r\n                                        key={key}\r\n                                        onClick={() => { setActiveSound(key); setIsMuted(false); }}\r\n                                        className={`px-5 py-3 rounded-full flex items-center gap-3 transition-all duration-500 ${activeSound === key && !isMuted\r\n                                            ? 'bg-white text-black font-black scale-105 shadow-xl'\r\n                                            : 'text-gray-500 hover:text-white hover:bg-white/5'\r\n                                            }`}\r\n                                    >\r\n                                        <div className={activeSound === key && !isMuted ? 'text-black' : 'text-gray-500'}>\r\n                                            {SOUNDS[key].icon}\r\n                                        </div>\r\n                                        <span className=\"text-[10px] font-black uppercase tracking-[0.1em] hidden md:inline\">{SOUNDS[key].label}</span>\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </motion.footer>\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            {/* Footer Stats Toast */}\r\n            {!isRunning && history.length > 0 && (\r\n                <motion.div\r\n                    initial={{ opacity: 0 }}\r\n                    animate={{ opacity: 1 }}\r\n                    className=\"absolute bottom-8 left-1/2 -translate-x-1/2 text-[10px] font-black text-gray-600 uppercase tracking-[0.4em] flex items-center gap-3\"\r\n                >\r\n                    <div className=\"w-8 h-[1px] bg-gray-800\" />\r\n                    Oxirgi Sessiya: {history[0].duration} daqiqa\r\n                    <div className=\"w-8 h-[1px] bg-gray-800\" />\r\n                </motion.div>\r\n            )}\r\n\r\n            {/* Subtle Gradient Overlays */}\r\n            <div className={`fixed inset-0 pointer-events-none transition-opacity duration-2000 ${isRunning ? 'opacity-30' : 'opacity-10'}`}>\r\n                <div className=\"absolute top-0 left-0 w-full h-[50vh] bg-gradient-to-b from-aura-purple/10 to-transparent\" />\r\n                <div className=\"absolute bottom-0 left-0 w-full h-[50vh] bg-gradient-to-t from-aura-cyan/10 to-transparent\" />\r\n            </div>\r\n\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\food\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\health\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":135,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":135,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5798,5801],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5798,5801],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":144,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6021,6024],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6021,6024],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { useState, useEffect } from 'react';\r\nimport HistoryModal from '@/components/HistoryModal';\r\nimport VoiceInput from '@/components/VoiceInput';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { getHealthData, seedHealthData, updateHealthData, HealthData, subscribeToHealthData } from '@/services/healthService';\r\nimport { getScheduledInsight } from '@/services/aiPersistenceService';\r\nimport { useLanguage } from '@/context/LanguageContext';\r\nimport { useNotifications } from '@/context/NotificationContext';\r\nimport { DateNavigator } from '@/components/dashboard/DateNavigator';\r\nimport { AiInsightSection } from '@/components/dashboard/AiInsightSection';\r\nimport { getLocalTodayStr } from '@/lib/dateUtils';\r\n\r\nexport default function HealthDashboard() {\r\n    const { t, language } = useLanguage();\r\n    const { user } = useAuth();\r\n    const { clearNotification } = useNotifications();\r\n\r\n    useEffect(() => {\r\n        clearNotification('health');\r\n    }, [clearNotification]);\r\n\r\n    const [selectedDate, setSelectedDate] = useState(getLocalTodayStr());\r\n    const [loading, setLoading] = useState(true);\r\n    const [data, setData] = useState<HealthData | null>(null);\r\n    const [isArchived, setIsArchived] = useState(false);\r\n    const [isHistoryOpen, setIsHistoryOpen] = useState(false);\r\n\r\n    // Derived Body Battery\r\n    const calculateBodyBatteryData = (health: HealthData) => {\r\n        const sleepScore = health.sleep.score || 70;\r\n        const steps = health.activity.steps || 0;\r\n        const stress = health.vitals.stress || 20;\r\n        const hydration = (health.hydration.current / (health.hydration.goal || 2500)) * 100;\r\n\r\n        const sleepWeight = (sleepScore / 100) * 100;\r\n        const activityTax = Math.min(30, steps / 400); // Max 30% drain from steps\r\n        const stressTax = (stress / 100) * 40; // Max 40% drain from stress\r\n        const hydrationBonus = Math.min(10, hydration / 10); // Max 10% bonus from water\r\n\r\n        const battery = Math.max(5, Math.min(100, sleepWeight - activityTax - stressTax + hydrationBonus));\r\n\r\n        return {\r\n            total: Math.round(battery),\r\n            breakdown: {\r\n                sleep: Math.round(sleepScore),\r\n                activity: Math.round(activityTax * 3.3), // Scaling for display\r\n                stress: Math.round(stress), // Raw 0-100\r\n                hydration: Math.round(Math.min(100, hydration))\r\n            },\r\n            impacts: {\r\n                sleep: Math.round(sleepWeight),\r\n                activity: Math.round(activityTax),\r\n                stress: Math.round(stressTax),\r\n                hydration: Math.round(hydrationBonus)\r\n            }\r\n        };\r\n    };\r\n\r\n    const getBatteryStatus = (val: number) => {\r\n        if (val > 80) return t.health.batteryStatus.ready;\r\n        if (val > 50) return t.health.batteryStatus.good;\r\n        if (val > 20) return t.health.batteryStatus.tired;\r\n        return t.health.batteryStatus.rest;\r\n    };\r\n\r\n    // V23: Real-time Data Subscription\r\n    useEffect(() => {\r\n        if (!user) return;\r\n\r\n        setLoading(true);\r\n        const todayStr = getLocalTodayStr();\r\n        const isToday = selectedDate === todayStr;\r\n        setIsArchived(!isToday);\r\n\r\n        // First check if exists, if not seed it\r\n        getHealthData(user.uid, selectedDate).then(doc => {\r\n            if (!doc) {\r\n                seedHealthData(user.uid, selectedDate);\r\n            }\r\n        });\r\n\r\n        const unsub = subscribeToHealthData(user.uid, selectedDate, (doc) => {\r\n            setData(doc);\r\n            setLoading(false);\r\n        });\r\n\r\n        return () => unsub();\r\n    }, [user, selectedDate]);\r\n\r\n\r\n    const updateHydration = async (amount: number) => {\r\n        if (!user || !data || isArchived) return;\r\n        const newCurrent = Math.max(0, Math.min(data.hydration.current + amount, data.hydration.goal + 1000));\r\n        const updatedData = { ...data, hydration: { ...data.hydration, current: newCurrent } };\r\n        setData(updatedData);\r\n        updateHealthData(user.uid, selectedDate, { hydration: updatedData.hydration });\r\n    };\r\n\r\n    const addWater = () => updateHydration(250);\r\n    const removeWater = () => updateHydration(-250);\r\n\r\n    const updateBiometrics = async (field: string, value: number | string) => {\r\n        if (!user || !data || isArchived) return;\r\n        const today = getLocalTodayStr();\r\n        const newBiometrics = { ...(data.biometrics || { weight: 70, height: 175, goal: 'maintain' }), [field]: value };\r\n        const updatedData = { ...data, biometrics: newBiometrics };\r\n        setData(updatedData);\r\n        await updateHealthData(user.uid, today, { biometrics: newBiometrics });\r\n    };\r\n\r\n    // Manual AI Trigger Logic\r\n    const [aiInsight, setAiInsight] = useState<{ title: string, text: string, emoji: string, status: string } | null>(null);\r\n    const [aiLoading, setAiLoading] = useState(false);\r\n\r\n    const refreshInsight = async () => {\r\n        if (!user || !data) return;\r\n        setAiLoading(true);\r\n        try {\r\n            const batteryData = calculateBodyBatteryData(data);\r\n            const context = {\r\n                steps: data.activity.steps,\r\n                sleepHours: data.sleep.score / 10, // Approx\r\n                waterMl: data.hydration.current,\r\n                stress: data.vitals.stress,\r\n                mood: 'neutral', // simplified\r\n                biometrics: data.biometrics,\r\n                battery: {\r\n                    total: batteryData.total,\r\n                    impacts: batteryData.impacts\r\n                }\r\n            };\r\n            const insight = await getScheduledInsight(user.uid, 'health', language, context);\r\n            if (insight) {\r\n                setAiInsight(insight as any);\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Health AI Failed\", err);\r\n        } finally {\r\n            setAiLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleVoiceCommand = async (command: any) => {\r\n        if (!user || !data || isArchived) return;\r\n        const { action, data: cmdData } = command;\r\n\r\n        if (action === 'log') {\r\n            if (cmdData?.water) {\r\n                await updateHydration(Number(cmdData.water));\r\n            } else if (cmdData?.steps) {\r\n                const newSteps = (data.activity.steps || 0) + Number(cmdData.steps);\r\n                const updatedData = { ...data, activity: { ...data.activity, steps: newSteps } };\r\n                setData(updatedData);\r\n                await updateHealthData(user.uid, selectedDate, { activity: updatedData.activity });\r\n            } else if (cmdData?.weight) {\r\n                await updateBiometrics('weight', Number(cmdData.weight));\r\n            } else if (cmdData?.mood) {\r\n                const updatedData = { ...data, vitals: { ...data.vitals, mood: Number(cmdData.mood) } };\r\n                setData(updatedData);\r\n                await updateHealthData(user.uid, selectedDate, { vitals: updatedData.vitals });\r\n            } else if (cmdData?.stress) {\r\n                const updatedData = { ...data, vitals: { ...data.vitals, stress: Number(cmdData.stress) } };\r\n                setData(updatedData);\r\n                await updateHealthData(user.uid, selectedDate, { vitals: updatedData.vitals });\r\n            }\r\n        }\r\n    };\r\n\r\n    if (loading || !data) return <div className=\"text-white p-10\">{t.health.loading}</div>;\r\n\r\n    const batteryData = calculateBodyBatteryData(data);\r\n    const currentBattery = batteryData.total;\r\n    const hydrationPercentage = Math.min((data.hydration.current / data.hydration.goal) * 100, 100);\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fade-in relative min-h-screen pb-20\">\r\n            <HistoryModal isOpen={isHistoryOpen} onClose={() => setIsHistoryOpen(false)} title={t.health.trends.title || \"Health History\"}>\r\n                <div className=\"space-y-6\">\r\n                    <div>\r\n                        <h4 className=\"text-white font-bold mb-4\">{t.health.trends.stepsHistory}</h4>\r\n                        <div className=\"flex items-end gap-2 h-32 border-b border-white/10 pb-2\">\r\n                            {[5000, 7500, 10000, 8000, 6000, 11000, 9500].map((val, i) => (\r\n                                <div key={i} className=\"flex-1 bg-aura-green/50 hover:bg-aura-green rounded-t-sm transition-all relative group\" style={{ height: `${(val / 12000) * 100}%` }}>\r\n                                    <span className=\"absolute -top-6 left-1/2 -translate-x-1/2 text-[10px] bg-black px-1 rounded text-white opacity-0 group-hover:opacity-100\">{val}</span>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                        <div className=\"flex justify-between text-xs text-gray-500 mt-2\">\r\n                            <span>{t.health.days.mon}</span><span>{t.health.days.tue}</span><span>{t.health.days.wed}</span><span>{t.health.days.thu}</span><span>{t.health.days.fri}</span><span>{t.health.days.sat}</span><span>{t.health.days.sun}</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </HistoryModal>\r\n\r\n            {/* HEADER */}\r\n            <div className=\"relative p-10 mb-12 rounded-[3rem] bg-white/5 border border-white/10 backdrop-blur-3xl overflow-hidden group\">\r\n                <div className=\"absolute top-0 right-0 w-96 h-96 bg-aura-green/5 blur-[100px] rounded-full -translate-y-1/2 translate-x-1/2 group-hover:bg-aura-green/10 transition-all duration-1000\"></div>\r\n\r\n                <div className=\"relative z-10 flex flex-col xl:flex-row xl:items-center justify-between gap-8\">\r\n                    <div>\r\n                        <div className=\"flex items-center gap-3 mb-4\">\r\n                            <span className=\"px-3 py-1 rounded-full bg-aura-green/10 border border-aura-green/20 text-[10px] font-black text-aura-green uppercase tracking-widest\">Vitality Matrix v2.0</span>\r\n                            <span className=\"w-1.5 h-1.5 rounded-full bg-aura-green animate-pulse\"></span>\r\n                        </div>\r\n                        <h1 className=\"text-5xl md:text-6xl font-display font-black text-white tracking-tighter leading-none mb-4\">\r\n                            {t.health.title}\r\n                        </h1>\r\n                        <p className=\"text-gray-400 text-lg font-medium max-w-2xl leading-relaxed\">\r\n                            {t.health.subtitle || \"Biometrik ko&apos;rsatkichlaringiz va hayotiy energiyangizni tahlil qiling.\"}\r\n                        </p>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-4 self-end xl:self-center bg-black/40 p-3 rounded-[2rem] border border-white/5 backdrop-blur-3xl shadow-2xl\">\r\n                        <DateNavigator selectedDate={selectedDate} onDateChange={setSelectedDate} />\r\n                        <VoiceInput\r\n                            module=\"health\"\r\n                            onCommand={handleVoiceCommand}\r\n                            color=\"green\"\r\n                            className={isArchived ? 'opacity-30 pointer-events-none' : ''}\r\n                        />\r\n                        <button\r\n                            onClick={() => setIsHistoryOpen(true)}\r\n                            className=\"p-4 rounded-2xl bg-white/5 border border-white/10 text-gray-400 hover:text-white hover:bg-white/10 transition-all shadow-lg active:scale-95\"\r\n                            title=\"History\"\r\n                        >\r\n                            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\" />\r\n                            </svg>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* MAIN GRID */}\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\r\n                {/* BODY BATTERY */}\r\n                <div className=\"lg:col-span-1 min-h-[450px] p-10 rounded-[3rem] bg-gradient-to-br from-black via-aura-green/5 to-black border border-white/5 relative flex flex-col items-center justify-center overflow-hidden shadow-[0_0_80px_rgba(0,255,148,0.03)]\">\r\n                    <div className=\"absolute top-0 right-0 w-64 h-64 bg-aura-green/5 blur-[100px] rounded-full -translate-y-1/2 translate-x-1/2\"></div>\r\n\r\n                    <h3 className=\"absolute top-10 left-10 text-xl font-display font-light text-white/90 flex items-center gap-3\">\r\n                        <span className=\"w-8 h-8 rounded-full bg-aura-green/20 flex items-center justify-center text-sm shadow-[0_0_15px_rgba(0,255,148,0.2)]\">тЪб</span>\r\n                        {t.health.bodyBattery.title}\r\n                    </h3>\r\n\r\n                    <div className=\"flex flex-col items-center gap-10 w-full\">\r\n                        {/* Premium Circular Gauge */}\r\n                        <div className=\"relative w-56 h-56 flex-shrink-0 flex items-center justify-center\">\r\n                            {/* Outer Glow Ring */}\r\n                            <div className=\"absolute inset-0 rounded-full border border-aura-green/5 animate-pulse\"></div>\r\n\r\n                            <svg className=\"w-full h-full -rotate-90 transform\">\r\n                                {/* Background Ring */}\r\n                                <circle cx=\"50%\" cy=\"50%\" r=\"90\" fill=\"none\" stroke=\"rgba(255,255,255,0.03)\" strokeWidth=\"8\" />\r\n\r\n                                {/* Progress Ring */}\r\n                                <circle\r\n                                    cx=\"50%\"\r\n                                    cy=\"50%\"\r\n                                    r=\"90\"\r\n                                    fill=\"none\"\r\n                                    stroke=\"url(#batteryGradient)\"\r\n                                    strokeWidth=\"12\"\r\n                                    strokeDasharray={2 * Math.PI * 90}\r\n                                    strokeDashoffset={2 * Math.PI * 90 - (currentBattery / 100) * 2 * Math.PI * 90}\r\n                                    strokeLinecap=\"round\"\r\n                                    className=\"transition-all duration-[1500ms] ease-out\"\r\n                                />\r\n\r\n                                <defs>\r\n                                    <linearGradient id=\"batteryGradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n                                        <stop offset=\"0%\" stopColor=\"#00FF94\" />\r\n                                        <stop offset=\"100%\" stopColor=\"#00E0FF\" />\r\n                                    </linearGradient>\r\n                                </defs>\r\n                            </svg>\r\n\r\n                            <div className=\"absolute inset-0 flex flex-col items-center justify-center\">\r\n                                <div className=\"text-6xl font-display font-bold text-white tracking-tighter\">\r\n                                    {currentBattery}<span className=\"text-2xl text-aura-green ml-1\">%</span>\r\n                                </div>\r\n                                <div className=\"mt-2 px-4 py-1 rounded-full bg-white/5 border border-white/5 text-[9px] text-aura-green uppercase tracking-[0.2em] font-black\">\r\n                                    {getBatteryStatus(currentBattery)}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Visual Calculation Breakdown */}\r\n                        <div className=\"grid grid-cols-2 gap-4 w-full max-w-sm\">\r\n                            {[\r\n                                { key: 'sleep', icon: 'ЁЯМЩ', label: \"Uyqu\", impact: batteryData.impacts.sleep, color: 'border-aura-blue/20 bg-aura-blue/5', text: 'text-aura-blue', sign: '+' },\r\n                                { key: 'activity', icon: 'ЁЯПГ', label: \"Faollik\", impact: batteryData.impacts.activity, color: 'border-aura-gold/20 bg-aura-gold/5', text: 'text-aura-gold', sign: '-' },\r\n                                { key: 'stress', icon: 'ЁЯдп', label: \"Stress\", impact: batteryData.impacts.stress, color: 'border-aura-red/20 bg-aura-red/5', text: 'text-aura-red', sign: '-' },\r\n                                { key: 'hydration', icon: 'ЁЯТз', label: \"Suv\", impact: batteryData.impacts.hydration, color: 'border-aura-blue/20 bg-aura-blue/5', text: 'text-aura-blue', sign: '+' }\r\n                            ].map((item) => (\r\n                                <div key={item.key} className={`p-4 rounded-2xl border ${item.color} backdrop-blur-sm transition-transform hover:scale-[1.02]`}>\r\n                                    <div className=\"flex items-center gap-2 mb-1\">\r\n                                        <span className=\"text-xs\">{item.icon}</span>\r\n                                        <span className=\"text-[10px] uppercase tracking-widest font-bold text-gray-400\">{item.label}</span>\r\n                                    </div>\r\n                                    <div className={`text-xl font-bold ${item.text}`}>\r\n                                        {item.sign}{item.impact}%\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"mt-8 flex items-center gap-2 px-6 py-3 rounded-2xl bg-white/5 border border-white/5\">\r\n                        <span className=\"text-aura-green\">тД╣я╕П</span>\r\n                        <p className=\"text-[11px] text-gray-400 leading-tight\">\r\n                            {currentBattery > 70 ? t.health.bodyBattery.fullyCharged : t.health.bodyBattery.recharge}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* BIOMETRICS & AI ADVISOR */}\r\n                <div className=\"lg:col-span-1 space-y-8\">\r\n                    {/* BIOMETRICS */}\r\n                    <div className=\"p-8 rounded-3xl bg-white/5 border border-white/10 space-y-6 flex flex-col justify-center\">\r\n                        <h3 className=\"text-lg font-bold text-white flex items-center gap-2\"><span>ЁЯСд</span> {t.health.biometrics.title}</h3>\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-xs text-gray-500\">{t.health.biometrics.weight}</label>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={data.biometrics?.weight || 70}\r\n                                        onChange={(e) => updateBiometrics('weight', Number(e.target.value))}\r\n                                        disabled={isArchived}\r\n                                        className=\"w-full bg-white/5 border border-white/10 rounded-lg p-3 text-white text-center focus:border-aura-green outline-none transition-all disabled:opacity-50\"\r\n                                    />\r\n                                    <span className=\"text-gray-500 text-xs\">{t.health.biometrics.unitKg}</span>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-xs text-gray-500\">{t.health.biometrics.height}</label>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={data.biometrics?.height || 175}\r\n                                        onChange={(e) => updateBiometrics('height', Number(e.target.value))}\r\n                                        disabled={isArchived}\r\n                                        className=\"w-full bg-white/5 border border-white/10 rounded-lg p-3 text-white text-center focus:border-aura-green outline-none transition-all disabled:opacity-50\"\r\n                                    />\r\n                                    <span className=\"text-gray-500 text-xs\">{t.health.biometrics.unitCm}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-xs text-gray-500\">{t.health.biometrics.goal}</label>\r\n                            <select\r\n                                value={data.biometrics?.goal || 'maintain'}\r\n                                onChange={(e) => updateBiometrics('goal', e.target.value)}\r\n                                disabled={isArchived}\r\n                                className=\"w-full bg-black/40 border border-white/10 rounded-lg p-3 text-white focus:border-aura-green outline-none cursor-pointer hover:bg-white/10 transition-all disabled:opacity-50\"\r\n                            >\r\n                                <option value=\"lose\" className=\"bg-black\">{t.health.biometrics.lose}</option>\r\n                                <option value=\"gain\" className=\"bg-black\">{t.health.biometrics.gain}</option>\r\n                                <option value=\"maintain\" className=\"bg-black\">{t.health.biometrics.maintain}</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* AI HEALTH ADVISOR */}\r\n                    <AiInsightSection\r\n                        onAnalyze={refreshInsight}\r\n                        isLoading={aiLoading}\r\n                        insight={aiInsight}\r\n                        title={t.health.aiAdvisor.title || \"AI Health Advisor\"}\r\n                        description=\"Bugungi ko&apos;rsatkichlarga asoslangan sun&apos;iy intellekt tahlili.\"\r\n                        buttonText={aiInsight ? 'Yangilash' : 'AI Tahlil'}\r\n                        color=\"green\"\r\n                    />\r\n                </div>\r\n\r\n\r\n                {/* VITALS & ACTIVITY ROW */}\r\n                <div className=\"lg:col-span-2 grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                    <div className=\"p-6 rounded-3xl bg-white/5 border border-white/10 hover:bg-white/10 transition-all\">\r\n                        <div className=\"text-aura-red flex items-center gap-2 mb-2 font-bold\"><span>тЭдя╕П</span> {t.health.vitals.title}</div>\r\n                        <div className=\"text-3xl font-bold text-white\">{data.vitals.heartRate} <span className=\"text-sm font-normal text-gray-500\">{t.health.vitals.heartRateUnit}</span></div>\r\n                    </div>\r\n                    <div className=\"p-6 rounded-3xl bg-white/5 border border-white/10 hover:bg-white/10 transition-all\">\r\n                        <div className=\"text-aura-purple flex items-center gap-2 mb-2 font-bold\"><span>ЁЯМЩ</span> {t.health.trends.sleepQuality}</div>\r\n                        <div className=\"text-3xl font-bold text-white\">{data.sleep.score} <span className=\"text-sm font-normal text-gray-500\">{t.health.sleep.unit}</span></div>\r\n                    </div>\r\n                    <div className=\"p-6 rounded-3xl bg-white/5 border border-white/10 hover:bg-white/10 transition-all\">\r\n                        <div className=\"text-aura-gold flex items-center gap-2 mb-2 font-bold\"><span>ЁЯдп</span> {t.health.vitals.stressTitle}</div>\r\n                        <div className=\"text-3xl font-bold text-white\">{data.vitals.stress}/100</div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                    {/* HYDRATION */}\r\n                    <div className=\"p-8 rounded-[2rem] bg-gradient-to-br from-aura-blue/20 to-black border border-aura-blue/30 flex flex-col items-center\">\r\n                        <h3 className=\"w-full text-left text-lg font-bold text-white mb-6\">ЁЯТз {t.health.hydration.title}</h3>\r\n                        <div className=\"text-5xl font-bold text-white mb-2\">{data.hydration.current} <span className=\"text-xl text-aura-blue\">{t.health.hydration.unit}</span></div>\r\n                        <p className=\"text-gray-500 text-sm mb-6\">{t.health.hydration.goal}: {data.hydration.goal} {t.health.hydration.unit}</p>\r\n                        <div className=\"flex gap-6 items-center\">\r\n                            <button onClick={removeWater} disabled={isArchived} className=\"w-12 h-12 rounded-full border border-white/20 flex items-center justify-center text-white hover:bg-white/10 disabled:opacity-30 transition-all font-bold\">-</button>\r\n                            <div className=\"w-16 h-32 border-2 border-white/20 rounded-2xl relative overflow-hidden bg-black/40 shadow-inner\">\r\n                                <div className=\"absolute bottom-0 left-0 w-full bg-aura-blue transition-all duration-700\" style={{ height: `${hydrationPercentage}%` }}></div>\r\n                            </div>\r\n                            <button onClick={addWater} disabled={isArchived} className=\"w-12 h-12 rounded-full border border-white/20 flex items-center justify-center text-white hover:bg-white/10 disabled:opacity-30 transition-all font-bold\">+</button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* ACTIVITY */}\r\n                    <div className=\"p-8 rounded-[2rem] bg-white/5 border border-white/10 flex items-center gap-8 group relative overflow-hidden\">\r\n                        <div className=\"absolute top-0 right-0 w-32 h-32 bg-aura-gold/5 blur-[50px] rounded-full\"></div>\r\n                        <div className=\"relative w-32 h-32 flex-shrink-0\">\r\n                            <svg className=\"w-full h-full -rotate-90\">\r\n                                <circle cx=\"50%\" cy=\"50%\" r=\"58\" fill=\"none\" stroke=\"#222\" strokeWidth=\"8\" />\r\n                                <circle cx=\"50%\" cy=\"50%\" r=\"58\" fill=\"none\" stroke=\"#F5A623\" strokeWidth=\"8\" strokeDasharray=\"364\" strokeDashoffset={364 - (364 * Math.min(data.activity.steps / data.activity.goal, 1))} strokeLinecap=\"round\" className=\"transition-all duration-1000\" />\r\n                            </svg>\r\n                            <div className=\"absolute inset-0 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform\">ЁЯСЮ</div>\r\n                        </div>\r\n                        <div className=\"flex-1\">\r\n                            <div className=\"text-3xl font-black text-white\">{data.activity.steps.toLocaleString()}</div>\r\n                            <div className=\"text-gray-500 font-bold uppercase tracking-widest text-[10px] mt-1\">{t.health.activity.stepsToday}</div>\r\n                            <div className=\"mt-4 pt-4 border-t border-white/10 flex gap-6\">\r\n                                <div><span className=\"block text-lg font-bold text-white\">{data.activity.calories}</span><span className=\"text-[10px] text-gray-500 font-bold uppercase\">{t.health.activity.kcal}</span></div>\r\n                                <div><span className=\"block text-lg font-bold text-white\">{data.activity.distance}</span><span className=\"text-[10px] text-gray-500 font-bold uppercase\">{t.health.activity.dist}</span></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\interests\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'HistoryModal' is defined but never used.","line":5,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getTasksByDate' is defined but never used.","line":12,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'saveDailyRecs' is defined but never used.","line":15,"column":67,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":80},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'saveHabitAdvice' is defined but never used.","line":15,"column":139,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":154},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getFinanceOverview' is defined but never used.","line":16,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getFoodLog' is defined but never used.","line":17,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getMindData' is defined but never used.","line":18,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'format' is defined but never used.","line":20,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":16},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'clearNotification'. Either include it or remove the dependency array.","line":30,"column":8,"nodeType":"ArrayExpression","endLine":30,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [clearNotification]","fix":{"range":[1734,1736],"text":"[clearNotification]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'habitAdvice' is assigned a value but never used.","line":40,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setHabitAdvice' is assigned a value but never used.","line":40,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":39},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'aggregatedLogs' is assigned a value but never used.","line":49,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":49,"endColumn":25},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'user'. Either include it or remove the dependency array.","line":91,"column":8,"nodeType":"ArrayExpression","endLine":91,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [user, user.uid]","fix":{"range":[4229,4240],"text":"[user, user.uid]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":124,"column":84,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":87,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5565,5568],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5565,5568],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":158,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":158,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6807,6810],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6807,6810],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleAIRecDone' is assigned a value but never used.","line":285,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":285,"endColumn":26},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":518,"column":93,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[25542,25543],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[25542,25543],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[25542,25543],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[25542,25543],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":518,"column":106,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[25555,25556],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[25555,25556],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[25555,25556],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[25555,25556],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { useState, useEffect, useMemo } from 'react';\r\nimport { getLocalTodayStr } from '@/lib/dateUtils';\r\nimport Modal from '@/components/Modal';\r\nimport HistoryModal from '@/components/HistoryModal';\r\nimport VoiceInput from '@/components/VoiceInput';\r\nimport { useLanguage } from '@/context/LanguageContext';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useNotifications } from '@/context/NotificationContext';\r\nimport { getInterestsData, seedInterestsData, InterestsData, Interest, addInterest, updateInterestProgress, subscribeToInterestsData } from '@/services/interestsService';\r\nimport { getHealthData } from '@/services/healthService';\r\nimport { getTasksByDate, addTask } from '@/services/tasksService';\r\nimport { getScheduledInsight } from '@/services/aiPersistenceService';\r\nimport { DateNavigator } from '@/components/dashboard/DateNavigator';\r\nimport { getInterestLogsByDate, InterestLog, logInterestActivity, saveDailyRecs, AIRec, DailyRecs, saveAIRecFeedback, logHabitOccurrence, saveHabitAdvice, markAIRecAsTask, markAIRecDone } from '@/services/interestsService';\r\nimport { getFinanceOverview } from '@/services/financeService';\r\nimport { getFoodLog } from '@/services/foodService';\r\nimport { getMindData } from '@/services/mindService';\r\nimport { ReadOnlyBanner } from '@/components/dashboard/ReadOnlyBanner';\r\nimport { format } from 'date-fns';\r\nimport { AiInsightSection } from '@/components/dashboard/AiInsightSection';\r\n\r\nexport default function InterestsDashboard() {\r\n    const { t, language } = useLanguage();\r\n    const { user } = useAuth();\r\n    const { clearNotification } = useNotifications();\r\n\r\n    useEffect(() => {\r\n        clearNotification('interests');\r\n    }, []);\r\n\r\n    // State\r\n    const [data, setData] = useState<InterestsData | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [isAddModalOpen, setIsAddModalOpen] = useState(false);\r\n    const [aiRecs, setAiRecs] = useState<AIRec[]>([]);\r\n    const [recLoading, setRecLoading] = useState(false);\r\n    const [selectedDate, setSelectedDate] = useState(getLocalTodayStr());\r\n    const [dailyLogs, setDailyLogs] = useState<InterestLog[]>([]);\r\n    const [habitAdvice, setHabitAdvice] = useState<string | null>(null);\r\n    const [newHobbyTrackingMode, setNewHobbyTrackingMode] = useState<'frequency' | 'binary'>('frequency');\r\n    const [isArchived, setIsArchived] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const todayStr = getLocalTodayStr();\r\n        setIsArchived(selectedDate !== todayStr);\r\n    }, [selectedDate]);\r\n\r\n    const aggregatedLogs = useMemo(() => {\r\n        const stats: { [key: string]: InterestLog & { totalCount: number; totalDuration: number } } = {};\r\n        dailyLogs.forEach(log => {\r\n            if (!stats[log.hobbyId]) {\r\n                stats[log.hobbyId] = { ...log, totalCount: 0, totalDuration: 0 };\r\n            }\r\n            if (log.count) stats[log.hobbyId].totalCount += log.count;\r\n            if (log.durationMinutes) stats[log.hobbyId].totalDuration += log.durationMinutes;\r\n        });\r\n        return Object.values(stats);\r\n    }, [dailyLogs]);\r\n    const [isLogging, setIsLogging] = useState<string | null>(null); // hobbyId being logged\r\n    const [logDuration, setLogDuration] = useState(30);\r\n    const [isSaving, setIsSaving] = useState(false);\r\n\r\n    // New Hobby Form\r\n    const [newHobbyName, setNewHobbyName] = useState('');\r\n    const [newHobbyCategory, setNewHobbyCategory] = useState('General');\r\n    const [newHobbyType, setNewHobbyType] = useState<'positive' | 'negative'>('positive');\r\n\r\n    const refreshData = async () => {\r\n        if (!user) return;\r\n        const doc = await getInterestsData(user.uid);\r\n        if (doc) setData(doc);\r\n    };\r\n\r\n    // V23: Real-time Data Subscription\r\n    useEffect(() => {\r\n        if (!user) return;\r\n        setLoading(true);\r\n\r\n        const unsub = subscribeToInterestsData(user.uid, (doc) => {\r\n            setData(doc);\r\n            setLoading(false);\r\n        });\r\n\r\n        // Initial check for seeding\r\n        getInterestsData(user.uid).then(doc => {\r\n            if (!doc) seedInterestsData(user.uid);\r\n        });\r\n\r\n        return () => unsub();\r\n    }, [user?.uid]);\r\n\r\n    // FETCH DAILY LOGS - MOUNT & DATE CHANGE\r\n    useEffect(() => {\r\n        if (!user) return;\r\n        const fetchLogs = async () => {\r\n            try {\r\n                const logs = await getInterestLogsByDate(user.uid, selectedDate);\r\n                setDailyLogs(logs);\r\n            } catch (error) {\r\n                console.error(\"Failed to fetch daily logs\", error);\r\n            }\r\n        };\r\n        fetchLogs();\r\n    }, [user, selectedDate]);\r\n\r\n    // V23: Scheduled AI Recommendations\r\n    const fetchAiRecs = React.useCallback(async (force = false) => {\r\n        if (!user || !data) return;\r\n        setRecLoading(true);\r\n        try {\r\n            // Fetch additional context\r\n            const health = await getHealthData(user.uid, getLocalTodayStr());\r\n\r\n            const insight = await getScheduledInsight(user.uid, 'interests', language, {\r\n                hobbies: data.hobbies.map(h => h.name),\r\n                healthGoal: health?.biometrics?.goal || 'General Health',\r\n                habitStats: dailyLogs.map(l => l.hobbyName)\r\n            }, { force });\r\n\r\n            if (insight) {\r\n                if (insight.data && insight.data.recommendations) {\r\n                    // V2: Use rich data from AI\r\n                    const richRecs: AIRec[] = insight.data.recommendations.map((r: any) => ({\r\n                        recommendation: r.recommendation,\r\n                        reason: r.reason,\r\n                        emoji: r.emoji || 'ЁЯТб',\r\n                        category: 'AI',\r\n                        type: r.type || 'growth', // growth or correction\r\n                        isDone: false,\r\n                        feedback: undefined\r\n                    }));\r\n                    setAiRecs(richRecs);\r\n                } else {\r\n                    // Fallback V1\r\n                    const recs: AIRec[] = [{\r\n                        recommendation: insight.title,\r\n                        reason: insight.insight,\r\n                        emoji: insight.emoji || 'ЁЯТб',\r\n                        category: 'AI',\r\n                        type: 'growth',\r\n                        isDone: false\r\n                    }];\r\n                    setAiRecs(recs);\r\n                }\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Interests AI Error:\", err);\r\n        } finally {\r\n            setRecLoading(false);\r\n        }\r\n    }, [user, data, language, dailyLogs]);\r\n\r\n    // useEffect(() => {\r\n    //     fetchAiRecs();\r\n    // }, [fetchAiRecs]);\r\n\r\n    const handleVoiceCommand = async (command: any) => {\r\n        if (!user || !data || isArchived) return;\r\n        console.log('Interests Voice Command:', command);\r\n\r\n        const { action, data: cmdData } = command;\r\n\r\n        if (action === 'add') {\r\n            const hobbyName = cmdData?.hobby || cmdData?.title || t.interests.newHobby;\r\n            const newInterest: Interest = {\r\n                id: Date.now().toString(),\r\n                name: hobbyName,\r\n                category: t.interests.categories.general,\r\n                type: 'positive',\r\n                level: 1,\r\n                progress: 0,\r\n                totalHours: 0,\r\n                image: 'ЁЯОи' // Default icon\r\n            };\r\n            await addInterest(user.uid, newInterest);\r\n            await refreshData();\r\n        } else if (action === 'log') {\r\n            const hobbyName = cmdData?.hobby;\r\n            const duration = cmdData?.duration || 30;\r\n\r\n            if (!hobbyName) return;\r\n\r\n            const hobby = data.hobbies.find(h => h.name.toLowerCase().includes(hobbyName.toLowerCase()));\r\n\r\n            if (hobby) {\r\n                await updateInterestProgress(user.uid, hobby.id, duration / 60);\r\n                await refreshData();\r\n            } else {\r\n                const newInterest: Interest = {\r\n                    id: Date.now().toString(),\r\n                    name: hobbyName,\r\n                    category: t.interests.categories.general,\r\n                    type: 'positive',\r\n                    level: 1,\r\n                    progress: 0,\r\n                    totalHours: duration / 60,\r\n                    image: 'тЬи'\r\n                };\r\n                await addInterest(user.uid, newInterest);\r\n                await refreshData();\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleHabitLog = async (hobby: Interest) => {\r\n        if (!user || isArchived) return;\r\n        const today = getLocalTodayStr();\r\n        // Ensure we only log for today\r\n        if (selectedDate !== today) return;\r\n        await logHabitOccurrence(user.uid, hobby, today);\r\n        const logs = await getInterestLogsByDate(user.uid, selectedDate);\r\n        setDailyLogs(logs);\r\n    };\r\n\r\n    const handleAIRecFeedback = async (index: number, feedback: 'like' | 'dislike') => {\r\n        if (!user || !aiRecs[index] || isArchived || !data) return;\r\n        const rec = aiRecs[index];\r\n        const today = getLocalTodayStr();\r\n        const hour = new Date().getHours();\r\n        const window: keyof DailyRecs = hour >= 6 && hour < 12 ? 'morning' : hour >= 12 && hour < 18 ? 'lunch' : 'evening';\r\n\r\n        // 1. Save feedback status\r\n        await saveAIRecFeedback(user.uid, today, window, index, feedback);\r\n\r\n        // 2. Persist as actual Interest/Habit\r\n        // Check if already exists to prevent duplicates\r\n        const exists = data.hobbies.some(h => h.name.toLowerCase() === rec.recommendation.toLowerCase());\r\n\r\n        if (!exists) {\r\n            const newInterest: Interest = {\r\n                id: Date.now().toString(),\r\n                name: rec.recommendation,\r\n                category: rec.category || t.interests.categories.general,\r\n                // Rule: Like -> Positive, Dislike -> Negative\r\n                type: feedback === 'like' ? 'positive' : 'negative',\r\n                level: 1,\r\n                progress: 0,\r\n                totalHours: 0,\r\n                image: rec.emoji || 'тЬи'\r\n            };\r\n\r\n            if (feedback === 'dislike') {\r\n                newInterest.trackingMode = 'frequency';\r\n            }\r\n\r\n            await addInterest(user.uid, newInterest);\r\n            await refreshData();\r\n        }\r\n\r\n        // Update local state\r\n        const newRecs = [...aiRecs];\r\n        newRecs[index].feedback = feedback;\r\n        setAiRecs(newRecs);\r\n    };\r\n\r\n    const handleAddToTask = async (index: number) => {\r\n        if (!user || !aiRecs[index] || isArchived) return;\r\n        const rec = aiRecs[index];\r\n        const today = getLocalTodayStr();\r\n        const hour = new Date().getHours();\r\n        const window: keyof DailyRecs = hour >= 6 && hour < 12 ? 'morning' : hour >= 12 && hour < 18 ? 'lunch' : 'evening';\r\n\r\n        // 1. Add to Tasks module\r\n        await addTask(user.uid, {\r\n            title: rec.recommendation,\r\n            description: rec.reason,\r\n            status: 'todo',\r\n            priority: 'medium',\r\n            startTime: '10:00',\r\n            endTime: '11:00',\r\n            category: rec.category || rec.type === 'growth' ? 'Growth' : 'Control',\r\n            date: today\r\n        });\r\n\r\n        // 2. Mark in Interests\r\n        await markAIRecAsTask(user.uid, today, window, index, 'task_id_placeholder');\r\n\r\n        // Update local state\r\n        const newRecs = [...aiRecs];\r\n        newRecs[index].isAddedToTasks = true;\r\n        setAiRecs(newRecs);\r\n    };\r\n\r\n    const handleAIRecDone = async (index: number) => {\r\n        if (!user || !aiRecs[index] || isArchived) return;\r\n        const rec = aiRecs[index];\r\n        const today = getLocalTodayStr();\r\n        const hour = new Date().getHours();\r\n        const window: keyof DailyRecs = hour >= 6 && hour < 12 ? 'morning' : hour >= 12 && hour < 18 ? 'lunch' : 'evening';\r\n\r\n        // 1. Save activity log so it appears in daily logs\r\n        await logInterestActivity(user.uid, {\r\n            hobbyId: `ai-${rec.recommendation.toLowerCase().replace(/\\s+/g, '-')}`,\r\n            hobbyName: `${rec.type === 'growth' ? 'ЁЯЪА' : 'ЁЯЫбя╕П'} ${rec.recommendation}`,\r\n            durationMinutes: rec.type === 'growth' ? 30 : 0,\r\n            count: rec.type === 'correction' ? 1 : 0,\r\n            date: today\r\n        });\r\n\r\n        // 2. Mark AI rec as Done\r\n        await markAIRecDone(user.uid, today, window, index);\r\n\r\n        // Update local state\r\n        const newRecs = [...aiRecs];\r\n        newRecs[index].isDone = true;\r\n        setAiRecs(newRecs);\r\n\r\n        // Refresh logs\r\n        const logs = await getInterestLogsByDate(user.uid, selectedDate);\r\n        setDailyLogs(logs);\r\n    };\r\n\r\n    const handleLogActivity = async (hobby: Interest) => {\r\n        if (!user || isArchived) return;\r\n        await logInterestActivity(user.uid, {\r\n            hobbyId: hobby.id,\r\n            hobbyName: hobby.name,\r\n            durationMinutes: logDuration,\r\n            date: selectedDate\r\n        });\r\n        await refreshData();\r\n        const logs = await getInterestLogsByDate(user.uid, selectedDate);\r\n        setDailyLogs(logs);\r\n        setIsLogging(null);\r\n    };\r\n\r\n    const handleManualAdd = async () => {\r\n        if (!user || !newHobbyName || isArchived) return;\r\n        setIsSaving(true);\r\n        try {\r\n            const newInterest: Interest = {\r\n                id: Date.now().toString(),\r\n                name: newHobbyName,\r\n                category: newHobbyCategory,\r\n                type: newHobbyType,\r\n                level: 1,\r\n                progress: 0,\r\n                totalHours: 0,\r\n                image: getEmojiForCategory(newHobbyCategory),\r\n                trackingMode: newHobbyType === 'negative' ? newHobbyTrackingMode : 'frequency'\r\n            };\r\n            await addInterest(user.uid, newInterest);\r\n            await refreshData();\r\n            setIsAddModalOpen(false);\r\n            setNewHobbyName('');\r\n        } catch (error) {\r\n            console.error(\"Failed to add interest\", error);\r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    const getEmojiForCategory = (cat: string) => {\r\n        switch (cat.toLowerCase()) {\r\n            case 'art': return 'ЁЯОи';\r\n            case 'physical': return 'ЁЯПГ';\r\n            case 'mind': return 'ЁЯзШ';\r\n            case 'music': return 'ЁЯО╕';\r\n            default: return 'тЬи';\r\n        }\r\n    };\r\n\r\n    const HobbyCard = ({ hobby }: { hobby: Interest }) => (\r\n        <div className=\"group relative p-6 rounded-[2.5rem] bg-black/40 backdrop-blur-xl border border-white/10 hover:border-aura-cyan/30 transition-all overflow-hidden flex flex-col justify-between h-[320px] shadow-2xl\">\r\n            {/* Background Glow */}\r\n            <div className={`absolute -right-10 -bottom-10 w-32 h-32 blur-[50px] transition-colors rounded-full ${hobby.type === 'positive' || !hobby.type ? 'bg-aura-cyan/10 group-hover:bg-aura-purple/20' : 'bg-aura-red/10 group-hover:bg-aura-gold/20'}`}></div>\r\n\r\n            <div>\r\n                <div className=\"flex justify-between items-start mb-4\">\r\n                    <div className={`w-12 h-12 rounded-xl bg-gradient-to-br from-white/10 to-white/5 flex items-center justify-center text-2xl border border-white/10 shadow-[0_0_15px_rgba(255,255,255,0.05)] ${hobby.type === 'negative' ? 'border-aura-red/20' : ''} group-hover:scale-110 transition-transform duration-300`}>\r\n                        {hobby.image}\r\n                    </div>\r\n                    <div className=\"flex flex-col items-end gap-1\">\r\n                        <span className={`px-2 py-0.5 rounded-full bg-white/5 border border-white/5 text-[9px] uppercase tracking-widest font-bold ${hobby.type === 'positive' || !hobby.type ? 'text-gray-400' : 'text-aura-red'}`}>\r\n                            {hobby.category} {hobby.type === 'negative' && 'тЪая╕П'}\r\n                        </span>\r\n                        {hobby.totalHours > 0 && (\r\n                            <span className={`text-[10px] font-mono ${hobby.type === 'positive' || !hobby.type ? 'text-aura-green' : 'text-gray-500'}`}>\r\n                                {hobby.type === 'positive' || !hobby.type ? `+${hobby.totalHours}${t.interests.totalHours}` : `${hobby.totalHours}${t.interests.totalControl}`}\r\n                            </span>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                <h3 className={`text-lg font-bold text-white mb-2 leading-tight transition-colors line-clamp-3 ${hobby.type === 'positive' || !hobby.type ? 'group-hover:text-aura-cyan' : 'group-hover:text-aura-red'}`}>{hobby.name}</h3>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <p className={`text-xs font-medium tracking-wide transition-colors ${hobby.type === 'positive' || !hobby.type ? 'text-gray-400 group-hover:text-gray-300' : 'text-gray-400'}`}>\r\n                        {hobby.type === 'positive' || !hobby.type ? `${t.interests.level} ${hobby.level}` : (hobby.trackingMode === 'binary' ? `${t.interests.status}: ${dailyLogs.some(l => l.hobbyId === hobby.id) ? t.interests.done : t.interests.notDone}` : `${t.interests.todayLabel}: ${dailyLogs.filter(l => l.hobbyId === hobby.id).reduce((sum, l) => sum + (l.count || 0), 0)} ${t.interests.times}`)}\r\n                    </p>\r\n                    {dailyLogs.filter(l => l.hobbyId === hobby.id).length > 0 && (\r\n                        <span className={`px-2 py-0.5 rounded-full text-[10px] font-bold animate-pulse ${hobby.type === 'positive' ? 'bg-aura-cyan/20 text-aura-cyan' : 'bg-aura-red/20 text-aura-red'}`}>\r\n                            {t.interests.done.toUpperCase()}\r\n                        </span>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"flex flex-col gap-3 relative z-10\">\r\n                {(hobby.type === 'positive' || !hobby.type) && (\r\n                    <div className=\"space-y-3\">\r\n                        <div className=\"w-full h-1.5 bg-white/5 rounded-full overflow-hidden\">\r\n                            <div\r\n                                className=\"h-full bg-gradient-to-r from-aura-cyan to-aura-purple transition-all duration-1000\"\r\n                                style={{ width: `${hobby.progress}%` }}\r\n                            ></div>\r\n                        </div>\r\n                        <button\r\n                            onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                if (!isArchived) setIsLogging(hobby.id);\r\n                            }}\r\n                            disabled={isArchived}\r\n                            className=\"w-full py-2.5 rounded-xl bg-white text-black text-xs font-bold hover:shadow-lg transition-all disabled:opacity-50\"\r\n                        >\r\n                            {t.interests.done}\r\n                        </button>\r\n                    </div>\r\n                )}\r\n\r\n                {hobby.type === 'negative' && (\r\n                    <button\r\n                        onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            handleHabitLog(hobby);\r\n                        }}\r\n                        disabled={hobby.trackingMode === 'binary' && dailyLogs.some(l => l.hobbyId === hobby.id)}\r\n                        className={`w-full py-2.5 rounded-xl border text-xs font-bold transition-all flex items-center justify-center gap-2 ${hobby.trackingMode === 'binary' && dailyLogs.some(l => l.hobbyId === hobby.id) ? 'bg-white/5 border-white/10 text-gray-500 cursor-not-allowed' : 'bg-aura-red/10 border-aura-red/20 text-aura-red hover:bg-aura-red/20'}`}\r\n                    >\r\n                        <span>{hobby.trackingMode === 'binary' && dailyLogs.some(l => l.hobbyId === hobby.id) ? 'тЬЕ' : 'ЁЯЫС'}</span>\r\n                        {hobby.trackingMode === 'binary' ? (dailyLogs.some(l => l.hobbyId === hobby.id) ? t.interests.done.toUpperCase() : t.interests.log) : t.interests.logCount}\r\n                    </button>\r\n                )}\r\n\r\n                {isLogging === hobby.id && (\r\n                    <div className=\"absolute inset-0 bg-black/95 backdrop-blur-md p-6 flex flex-col justify-center animate-fade-in z-20\">\r\n                        <h4 className=\"text-sm font-bold text-white mb-4 text-center\">{t.interests.logDurationQuestion}</h4>\r\n                        <div className=\"flex items-center justify-center gap-4 mb-6\">\r\n                            <button onClick={() => setLogDuration(Math.max(5, logDuration - 5))} className=\"w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center text-xl hover:bg-white/10\">-</button>\r\n                            <span className=\"text-2xl font-mono font-bold text-aura-cyan\">{logDuration}m</span>\r\n                            <button onClick={() => setLogDuration(logDuration + 5)} className=\"w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center text-xl hover:bg-white/10\">+</button>\r\n                        </div>\r\n                        <button\r\n                            onClick={() => handleLogActivity(hobby)}\r\n                            className=\"w-full py-3 rounded-xl bg-aura-cyan text-black font-bold text-sm hover:shadow-[0_0_20px_rgba(0,240,255,0.3)] transition-all\"\r\n                        >\r\n                            {t.interests.log}\r\n                        </button>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    if (loading || !data) return <div className=\"text-white p-10\">{t.interests.loading}</div>;\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fade-in pb-10\">\r\n\r\n\r\n\r\n            {/* HEADER */}\r\n            <div className=\"flex justify-between items-end mb-8\">\r\n                <div>\r\n                    <h1 className=\"text-4xl font-display font-bold text-white mb-2\">{t.interests.title}</h1>\r\n                    <p className=\"text-gray-400\">{t.interests.subtitle}</p>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-4\">\r\n                    <DateNavigator selectedDate={selectedDate} onDateChange={setSelectedDate} />\r\n                    <VoiceInput\r\n                        module=\"interests\"\r\n                        onCommand={handleVoiceCommand}\r\n                        color=\"cyan\"\r\n                        className={isArchived ? 'opacity-30 pointer-events-none' : ''}\r\n                    />\r\n                    <button\r\n                        onClick={() => !isArchived && setIsAddModalOpen(true)}\r\n                        disabled={isArchived}\r\n                        className=\"px-6 py-3 rounded-xl bg-white text-black font-bold hover:shadow-[0_0_20px_rgba(255,255,255,0.4)] transition-shadow disabled:opacity-30\"\r\n                    >\r\n                        {t.interests.newHobby}\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {isArchived && (\r\n                <ReadOnlyBanner\r\n                    title={t.interests.readOnly}\r\n                    description={t.interests.readOnlyDesc}\r\n                />\r\n            )}\r\n\r\n            {/* AI PROPOSALS */}\r\n            <AiInsightSection\r\n                onAnalyze={() => fetchAiRecs(true)}\r\n                isLoading={recLoading}\r\n                insight={aiRecs.length > 0 ? { title: \"AI Analysis\", text: t.interests.aiRecTitleGrowth || \"Recommendations Ready\", emoji: \"ЁЯОи\" } : null}\r\n                title=\"AURA AI Interests\"\r\n                description={t.interests.subtitle || \"AI-powered recommendations based on your interests.\"}\r\n                buttonText={aiRecs.length > 0 ? (t.common?.refresh || \"Refresh\") : \"Start Analysis\"}\r\n                color=\"purple\"\r\n            >\r\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 w-full\">\r\n                    {aiRecs.map((rec, index) => (\r\n                        <div key={index} className={`p-6 rounded-[2rem] bg-black/40 border relative overflow-hidden group flex flex-col justify-between min-h-[250px] transition-all ${rec.isDone ? 'opacity-50 grayscale-[0.5]' : ''} ${rec.type === 'correction' ? 'border-aura-red/30' : 'border-aura-cyan/30'}`}>\r\n                            {/* Simple Glow */}\r\n                            <div className={`absolute top-0 right-0 w-32 h-32 blur-[60px] rounded-full pointer-events-none -translate-y-1/2 translate-x-1/2 ${rec.type === 'correction' ? 'bg-aura-red/10' : 'bg-aura-cyan/10'}`}></div>\r\n\r\n                            <div className=\"relative z-10\">\r\n                                <div className=\"flex justify-between items-start mb-4\">\r\n                                    <span className=\"text-3xl\">{rec.emoji}</span>\r\n                                    <span className={`px-2 py-1 rounded-full text-[9px] font-bold uppercase tracking-widest ${rec.type === 'correction' ? 'bg-aura-red/20 text-aura-red' : 'bg-aura-cyan/20 text-aura-cyan'}`}>\r\n                                        {rec.type === 'correction' ? t.interests.aiRecTitleCorrection : t.interests.aiRecTitleGrowth}\r\n                                    </span>\r\n                                </div>\r\n                                <h3 className=\"text-xl font-bold text-white mb-2 leading-tight\">{rec.recommendation}</h3>\r\n                                <p className=\"text-xs text-gray-400 leading-relaxed italic\">\"{rec.reason}\"</p>\r\n                            </div>\r\n\r\n                            <div className=\"relative z-10 mt-4 flex flex-col gap-2\">\r\n                                {rec.isDone ? (\r\n                                    <div className=\"w-full py-3 rounded-xl bg-white/10 border border-white/10 text-center text-white font-bold flex items-center justify-center gap-2 text-xs\">\r\n                                        тЬЕ {t.interests.aiRecDone}\r\n                                    </div>\r\n                                ) : (\r\n                                    <>\r\n                                        <div className=\"flex gap-2\">\r\n                                            <button\r\n                                                onClick={() => handleAIRecFeedback(index, 'like')}\r\n                                                className={`flex-1 py-2 rounded-xl border border-white/10 hover:bg-white/10 transition-all text-xs ${rec.feedback === 'like' ? 'bg-aura-cyan/20 border-aura-cyan text-aura-cyan' : 'text-gray-400'}`}\r\n                                            >\r\n                                                ЁЯСН\r\n                                            </button>\r\n                                            <button\r\n                                                onClick={() => handleAIRecFeedback(index, 'dislike')}\r\n                                                className={`flex-1 py-2 rounded-xl border border-white/10 hover:bg-white/10 transition-all text-xs ${rec.feedback === 'dislike' ? 'bg-aura-red/20 border-aura-red text-aura-red' : 'text-gray-400'}`}\r\n                                            >\r\n                                                ЁЯСО\r\n                                            </button>\r\n                                        </div>\r\n                                        <button\r\n                                            onClick={() => handleAddToTask(index)}\r\n                                            className={`w-full py-3 rounded-xl font-bold text-xs transition-all ${rec.type === 'correction' ? 'bg-aura-red text-white hover:bg-aura-red/80' : 'bg-aura-cyan text-black hover:bg-aura-cyan/80'}`}\r\n                                        >\r\n                                            {rec.isAddedToTasks ? `тЬЕ ${t.interests.aiRecTask}` : `+ ${t.interests.aiRecAddTask}`}\r\n                                        </button>\r\n                                    </>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                {\r\n                    aiRecs.some(r => r.feedback || r.isAddedToTasks) && (\r\n                        <div className=\"mt-8\">\r\n                            <div className=\"text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-4\">{t.interests.aiRecStatus}</div>\r\n                            <div className=\"flex flex-wrap gap-4\">\r\n                                {aiRecs.map((rec, i) => (\r\n                                    (rec.feedback || rec.isAddedToTasks) && (\r\n                                        <div key={i} className=\"px-4 py-2 rounded-xl bg-white/5 border border-white/10 flex items-center gap-3 text-xs\">\r\n                                            <span>{rec.emoji}</span>\r\n                                            <span className=\"text-gray-300 font-medium\">{rec.recommendation}</span>\r\n                                            <div className=\"flex gap-1\">\r\n                                                {rec.feedback === 'like' && <span className=\"text-aura-cyan\">ЁЯСН</span>}\r\n                                                {rec.feedback === 'dislike' && <span className=\"text-aura-red\">ЁЯСО</span>}\r\n                                                {rec.isAddedToTasks && <span className=\"text-aura-green\">ЁЯУЭ</span>}\r\n                                            </div>\r\n                                        </div>\r\n                                    )\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )\r\n                }\r\n            </AiInsightSection>\r\n\r\n            {/* POSITIVE INTERESTS */}\r\n            <h3 className=\"text-2xl font-bold text-white mt-12 mb-6\">{t.interests.positiveInterests}</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\r\n                <button\r\n                    onClick={() => !isArchived && setIsAddModalOpen(true)}\r\n                    disabled={isArchived}\r\n                    className={`group p-6 rounded-[2.5rem] border border-dashed border-white/20 hover:border-aura-cyan/50 hover:bg-white/5 transition-all flex flex-col items-center justify-center gap-4 h-[320px] ${isArchived ? 'opacity-30 cursor-not-allowed' : ''}`}\r\n                >\r\n                    <div className=\"w-16 h-16 rounded-full bg-white/5 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform text-white group-hover:text-aura-cyan\">+</div>\r\n                    <div className=\"text-center\">\r\n                        <h3 className=\"text-lg font-bold text-white mb-1 group-hover:text-aura-cyan transition-colors\">{t.interests.newHobbyCardTitle}</h3>\r\n                        <p className=\"text-xs text-gray-500\">{t.interests.newHobbyCardDesc}</p>\r\n                    </div>\r\n                </button>\r\n\r\n                {data.hobbies.filter(h => h.type === 'positive' || !h.type).map(hobby => (\r\n                    <HobbyCard key={hobby.id} hobby={hobby} />\r\n                ))}\r\n            </div>\r\n\r\n            {/* NEGATIVE HABITS */}\r\n            <h3 className=\"text-2xl font-bold text-white mt-12 mb-6\">{t.interests.negativeHabits}</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\r\n                {data.hobbies.filter(h => h.type === 'negative').map(hobby => (\r\n                    <HobbyCard key={hobby.id} hobby={hobby} />\r\n                ))}\r\n            </div>\r\n\r\n\r\n            {/* ADD HOBBY MODAL */}\r\n            <Modal\r\n                isOpen={isAddModalOpen}\r\n                onClose={() => setIsAddModalOpen(false)}\r\n                title={t.interests.addHobbyTitle}\r\n            >\r\n                <div className=\"space-y-6\">\r\n                    <div className=\"space-y-2\">\r\n                        <label className=\"text-xs text-gray-500 uppercase tracking-widest\">{t.interests.hobbyName}</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"w-full bg-white/5 border border-white/10 rounded-xl p-4 text-white placeholder:text-gray-600 focus:border-aura-cyan outline-none transition-all\"\r\n                            placeholder={t.interests.placeholderName}\r\n                            value={newHobbyName}\r\n                            onChange={(e) => setNewHobbyName(e.target.value)}\r\n                        />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                        <label className=\"text-xs text-gray-500 uppercase tracking-widest\">{t.interests.category}</label>\r\n                        <select\r\n                            className=\"w-full bg-white/5 border border-white/10 rounded-xl p-4 text-white outline-none appearance-none cursor-pointer hover:bg-white/10 transition-all font-bold\"\r\n                            value={newHobbyCategory}\r\n                            onChange={(e) => setNewHobbyCategory(e.target.value)}\r\n                        >\r\n                            <option value=\"General\" className=\"bg-black\">{t.interests.categories.general}</option>\r\n                            <option value=\"Art\" className=\"bg-black\">{t.interests.categories.art}</option>\r\n                            <option value=\"Physical\" className=\"bg-black\">{t.interests.categories.physical}</option>\r\n                            <option value=\"Mind\" className=\"bg-black\">{t.interests.categories.mind}</option>\r\n                            <option value=\"Music\" className=\"bg-black\">{t.interests.categories.music}</option>\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <label className=\"text-xs text-gray-500 uppercase tracking-widest\">{t.interests.type}</label>\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <button\r\n                                onClick={() => setNewHobbyType('positive')}\r\n                                className={`py-4 rounded-xl border font-bold transition-all ${newHobbyType === 'positive' ? 'bg-aura-cyan/20 border-aura-cyan text-aura-cyan' : 'bg-white/5 border-white/10 text-gray-500 hover:border-white/20'}`}\r\n                            >\r\n                                тЬи {t.interests.positive}\r\n                            </button>\r\n                            <button\r\n                                onClick={() => setNewHobbyType('negative')}\r\n                                className={`py-4 rounded-xl border font-bold transition-all ${newHobbyType === 'negative' ? 'bg-aura-red/20 border-aura-red text-aura-red' : 'bg-white/5 border-white/10 text-gray-500 hover:border-white/20'}`}\r\n                            >\r\n                                тЪая╕П {t.interests.negative}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {newHobbyType === 'negative' && (\r\n                        <div className=\"space-y-4 p-4 rounded-2xl bg-white/5 border border-white/5\">\r\n                            <label className=\"text-[10px] text-gray-500 uppercase tracking-widest font-bold\">{t.interests.trackingMode}</label>\r\n                            <div className=\"grid grid-cols-2 gap-3\">\r\n                                <button\r\n                                    onClick={() => setNewHobbyTrackingMode('frequency')}\r\n                                    className={`py-3 rounded-xl border text-xs font-bold transition-all ${newHobbyTrackingMode === 'frequency' ? 'bg-aura-red/20 border-aura-red text-aura-red' : 'bg-white/5 border-white/10 text-gray-500'}`}\r\n                                >\r\n                                    ЁЯФв {t.interests.trackingFrequency}\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => setNewHobbyTrackingMode('binary')}\r\n                                    className={`py-3 rounded-xl border text-xs font-bold transition-all ${newHobbyTrackingMode === 'binary' ? 'bg-aura-red/20 border-aura-red text-aura-red' : 'bg-white/5 border-white/10 text-gray-500'}`}\r\n                                >\r\n                                    тЬЕ {t.interests.trackingBinary}\r\n                                </button>\r\n                            </div>\r\n                            <p className=\"text-[10px] text-gray-600 italic\">\r\n                                {newHobbyTrackingMode === 'frequency' ? t.interests.trackingFrequencyDesc : t.interests.trackingBinaryDesc}\r\n                            </p>\r\n                        </div>\r\n                    )}\r\n\r\n                    <button\r\n                        onClick={handleManualAdd}\r\n                        disabled={!!isSaving}\r\n                        className={`w-full py-4 rounded-xl font-bold text-lg transition-all shadow-xl ${!!isSaving ? 'opacity-50 cursor-not-allowed' : ''} ${newHobbyType === 'positive' ? 'bg-white text-black hover:shadow-white/20' : 'bg-aura-red text-white hover:shadow-aura-red/20'}`}\r\n                    >\r\n                        {!!isSaving ? 'Saving...' : t.common.save}\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setIsAddModalOpen(false)}\r\n                        className=\"w-full py-3 bg-white/5 text-gray-400 font-bold rounded-xl hover:text-white transition-colors\"\r\n                    >\r\n                        {t.common.cancel}\r\n                    </button>\r\n                </div>\r\n            </Modal>\r\n        </div >\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\liveness\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'updateDoc' is defined but never used.","line":7,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'lastCheckIn' is assigned a value but never used.","line":19,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setLastCheckIn' is assigned a value but never used.","line":19,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":39}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { useState, useEffect } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { useLanguage } from '@/context/LanguageContext';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { db } from '@/firebaseConfig';\r\nimport { doc, getDoc, setDoc, updateDoc } from 'firebase/firestore';\r\n\r\nexport default function LivenessPage() {\r\n    const { t } = useLanguage();\r\n    const { user } = useAuth();\r\n\r\n    // State\r\n    const [isActive, setIsActive] = useState(true);\r\n    const [threshold, setThreshold] = useState(24);\r\n    const [contacts, setContacts] = useState<{ name: string; phone: string }[]>([]);\r\n    const [newContact, setNewContact] = useState({ name: '', phone: '' });\r\n    const [isSaving, setIsSaving] = useState(false);\r\n    const [lastCheckIn, setLastCheckIn] = useState<Date>(new Date());\r\n\r\n    // Silent Mode State\r\n    const [silentMode, setSilentMode] = useState({ enabled: false, from: '23:00', to: '07:00' });\r\n    const [activityLog, setActivityLog] = useState<{ id: string; type: string; time: string }[]>([\r\n        { id: '1', type: 'Manual Check-in', time: new Date(Date.now() - 3600000).toISOString() },\r\n        { id: '2', type: 'System Boot', time: new Date(Date.now() - 86400000 * 2).toISOString() }\r\n    ]);\r\n\r\n    // Fetch user settings\r\n    useEffect(() => {\r\n        if (!user) return;\r\n        const fetchSettings = async () => {\r\n            const docRef = doc(db, 'users', user.uid, 'settings', 'liveness');\r\n            const docSnap = await getDoc(docRef);\r\n            if (docSnap.exists()) {\r\n                const data = docSnap.data();\r\n                setIsActive(data.isActive ?? true);\r\n                setThreshold(data.threshold ?? 24);\r\n                setContacts(data.contacts ?? []);\r\n                setSilentMode(data.silentMode ?? { enabled: false, from: '23:00', to: '07:00' });\r\n                if (data.activityLog) setActivityLog(data.activityLog);\r\n            }\r\n        };\r\n        fetchSettings();\r\n    }, [user]);\r\n\r\n    const handleSave = async () => {\r\n        if (!user) return;\r\n        setIsSaving(true);\r\n        try {\r\n            const docRef = doc(db, 'users', user.uid, 'settings', 'liveness');\r\n            await setDoc(docRef, {\r\n                isActive,\r\n                threshold,\r\n                contacts,\r\n                silentMode,\r\n                activityLog,\r\n                lastUpdate: new Date().toISOString()\r\n            }, { merge: true });\r\n        } catch (error) {\r\n            console.error(\"Error saving settings:\", error);\r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    const addContact = () => {\r\n        if (newContact.name && newContact.phone) {\r\n            setContacts([...contacts, newContact]);\r\n            setNewContact({ name: '', phone: '' });\r\n            // Log activity\r\n            setActivityLog([{\r\n                id: Date.now().toString(),\r\n                type: `Updated Contacts: +${newContact.name}`,\r\n                time: new Date().toISOString()\r\n            }, ...activityLog]);\r\n        }\r\n    };\r\n\r\n    const removeContact = (index: number) => {\r\n        setContacts(contacts.filter((_, i) => i !== index));\r\n    };\r\n\r\n    // Sub-components\r\n    const PulseVisualizer = () => (\r\n        <div className=\"absolute top-0 right-0 p-12 overflow-hidden pointer-events-none opacity-20\">\r\n            <svg width=\"200\" height=\"60\" viewBox=\"0 0 200 60\" className=\"stroke-aura-cyan fill-none\">\r\n                <motion.path\r\n                    d=\"M0 30 L40 30 L50 10 L60 50 L70 30 L100 30 L110 5 L120 55 L130 30 L170 30 L180 20 L190 40 L200 30\"\r\n                    strokeWidth=\"3\"\r\n                    strokeLinecap=\"round\"\r\n                    animate={{\r\n                        pathLength: [0, 1],\r\n                        pathOffset: [1, 0],\r\n                        opacity: [0.3, 1, 0.3]\r\n                    }}\r\n                    transition={{\r\n                        duration: 3,\r\n                        repeat: Infinity,\r\n                        ease: \"easeInOut\"\r\n                    }}\r\n                />\r\n            </svg>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <div className=\"space-y-8 pb-12 relative overflow-hidden\">\r\n            <PulseVisualizer />\r\n\r\n            {/* Header section with Premium Aesthetic */}\r\n            <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-6 relative z-10\">\r\n                <div>\r\n                    <h1 className=\"text-4xl md:text-5xl font-display font-black text-white italic uppercase tracking-tighter mb-4 flex items-center gap-4\">\r\n                        <span className=\"text-aura-cyan animate-pulse\">ЁЯТУ</span>\r\n                        {t.liveness_section.title}\r\n                    </h1>\r\n                    <p className=\"text-gray-400 font-light max-w-2xl text-lg leading-relaxed\">\r\n                        {t.liveness_section.desc}\r\n                    </p>\r\n                </div>\r\n                <button\r\n                    onClick={handleSave}\r\n                    disabled={isSaving}\r\n                    className=\"px-10 py-4 bg-aura-purple text-white rounded-2xl font-bold uppercase tracking-widest hover:scale-105 active:scale-95 transition-all shadow-lg shadow-aura-purple/20 disabled:opacity-50\"\r\n                >\r\n                    {isSaving ? '...' : t.liveness_section.cta}\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 relative z-10\">\r\n                {/* Status & Timing Card */}\r\n                <motion.div\r\n                    initial={{ opacity: 0, y: 20 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    className=\"p-8 rounded-[2.5rem] bg-white/[0.02] border border-white/5 backdrop-blur-3xl relative overflow-hidden group\"\r\n                >\r\n                    <div className=\"relative z-10\">\r\n                        <h3 className=\"text-sm font-bold text-gray-500 uppercase tracking-[0.3em] mb-8\">System Status</h3>\r\n\r\n                        <div className=\"flex items-center justify-between mb-12\">\r\n                            <div className=\"flex items-center gap-4\">\r\n                                <div className={`w-4 h-4 rounded-full ${isActive ? 'bg-aura-green' : 'bg-aura-red'} animate-pulse shadow-[0_0_15px_rgba(0,0,0,0.5)]`}></div>\r\n                                <span className=\"text-2xl font-bold text-white uppercase italic tracking-tight\">\r\n                                    {isActive ? 'Active Mode' : 'Disabled'}\r\n                                </span>\r\n                            </div>\r\n                            <button\r\n                                onClick={() => setIsActive(!isActive)}\r\n                                className={`w-16 h-8 rounded-full transition-all relative ${isActive ? 'bg-aura-green' : 'bg-white/10'}`}\r\n                            >\r\n                                <div className={`absolute top-1 w-6 h-6 rounded-full bg-white transition-all ${isActive ? 'right-1' : 'left-1'}`}></div>\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-6\">\r\n                            <label className=\"text-xs font-bold text-gray-400 uppercase tracking-widest block\">Inactivity Threshold</label>\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                {[24, 48].map((h) => (\r\n                                    <button\r\n                                        key={h}\r\n                                        onClick={() => setThreshold(h)}\r\n                                        className={`py-4 rounded-2xl font-bold border transition-all ${threshold === h ? 'bg-aura-cyan border-aura-cyan text-black' : 'bg-white/5 border-white/5 text-gray-400 hover:border-white/20'}`}\r\n                                    >\r\n                                        {h} HOURS\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Silent Mode Integration */}\r\n                        <div className=\"mt-12 pt-8 border-t border-white/5\">\r\n                            <div className=\"flex items-center justify-between mb-4\">\r\n                                <div>\r\n                                    <h4 className=\"text-sm font-bold text-white uppercase tracking-wider\">{t.liveness_section.silent_mode}</h4>\r\n                                    <p className=\"text-xs text-gray-500\">{t.liveness_section.silent_mode_desc}</p>\r\n                                </div>\r\n                                <button\r\n                                    onClick={() => setSilentMode({ ...silentMode, enabled: !silentMode.enabled })}\r\n                                    className={`w-12 h-6 rounded-full transition-all relative ${silentMode.enabled ? 'bg-aura-cyan' : 'bg-white/10'}`}\r\n                                >\r\n                                    <div className={`absolute top-1 w-4 h-4 rounded-full bg-white transition-all ${silentMode.enabled ? 'right-1' : 'left-1'}`}></div>\r\n                                </button>\r\n                            </div>\r\n                            {silentMode.enabled && (\r\n                                <div className=\"flex items-center gap-4 mt-6\">\r\n                                    <input\r\n                                        type=\"time\"\r\n                                        value={silentMode.from}\r\n                                        onChange={(e) => setSilentMode({ ...silentMode, from: e.target.value })}\r\n                                        className=\"bg-white/5 border border-white/10 rounded-xl px-4 py-2 text-xs text-white outline-none focus:border-aura-cyan transition-all\"\r\n                                    />\r\n                                    <span className=\"text-gray-500 text-xs\">to</span>\r\n                                    <input\r\n                                        type=\"time\"\r\n                                        value={silentMode.to}\r\n                                        onChange={(e) => setSilentMode({ ...silentMode, to: e.target.value })}\r\n                                        className=\"bg-white/5 border border-white/10 rounded-xl px-4 py-2 text-xs text-white outline-none focus:border-aura-cyan transition-all\"\r\n                                    />\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </motion.div>\r\n\r\n                {/* Trusted Contacts Card */}\r\n                <motion.div\r\n                    initial={{ opacity: 0, y: 20 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ delay: 0.1 }}\r\n                    className=\"p-8 rounded-[2.5rem] bg-white/[0.02] border border-white/5 backdrop-blur-3xl\"\r\n                >\r\n                    <h3 className=\"text-sm font-bold text-gray-500 uppercase tracking-[0.3em] mb-8\">Trusted Contacts</h3>\r\n\r\n                    <div className=\"space-y-4 mb-8 h-[300px] overflow-y-auto pr-2 custom-scrollbar\">\r\n                        <AnimatePresence>\r\n                            {contacts.map((contact, i) => (\r\n                                <motion.div\r\n                                    key={i}\r\n                                    initial={{ x: -20, opacity: 0 }}\r\n                                    animate={{ x: 0, opacity: 1 }}\r\n                                    exit={{ x: 20, opacity: 0 }}\r\n                                    className=\"flex items-center justify-between p-4 rounded-2xl bg-white/5 border border-white/5 group hover:border-aura-cyan/30 transition-all\"\r\n                                >\r\n                                    <div>\r\n                                        <p className=\"text-white font-bold\">{contact.name}</p>\r\n                                        <p className=\"text-xs text-gray-400\">{contact.phone}</p>\r\n                                    </div>\r\n                                    <button\r\n                                        onClick={() => removeContact(i)}\r\n                                        className=\"p-2 text-gray-500 hover:text-aura-red transition-all\"\r\n                                    >\r\n                                        тЬХ\r\n                                    </button>\r\n                                </motion.div>\r\n                            ))}\r\n                        </AnimatePresence>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-4 pt-4 border-t border-white/5\">\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Contact Name\"\r\n                                value={newContact.name}\r\n                                onChange={(e) => setNewContact({ ...newContact, name: e.target.value })}\r\n                                className=\"bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm focus:border-aura-cyan transition-all outline-none\"\r\n                            />\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"+998 90 123 45 67\"\r\n                                value={newContact.phone}\r\n                                onChange={(e) => setNewContact({ ...newContact, phone: e.target.value })}\r\n                                className=\"bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm focus:border-aura-cyan transition-all outline-none\"\r\n                            />\r\n                        </div>\r\n                        <button\r\n                            onClick={addContact}\r\n                            className=\"w-full py-3 bg-white/10 text-white rounded-xl font-bold text-xs uppercase tracking-widest hover:bg-white/20 transition-all\"\r\n                        >\r\n                            + Add Trusted Contact\r\n                        </button>\r\n                    </div>\r\n                </motion.div>\r\n            </div>\r\n\r\n            {/* Activity History & Info */}\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8 relative z-10\">\r\n                <motion.div\r\n                    initial={{ opacity: 0, y: 20 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ delay: 0.2 }}\r\n                    className=\"lg:col-span-2 p-8 rounded-[2.5rem] bg-white/[0.02] border border-white/5 backdrop-blur-3xl\"\r\n                >\r\n                    <h3 className=\"text-sm font-bold text-gray-500 uppercase tracking-[0.3em] mb-8\">{t.liveness_section.activity_log}</h3>\r\n                    <div className=\"space-y-4\">\r\n                        {activityLog.map((log) => (\r\n                            <div key={log.id} className=\"flex items-center justify-between p-4 rounded-xl bg-white/5 border border-white/5\">\r\n                                <div className=\"flex items-center gap-4\">\r\n                                    <div className=\"w-2 h-2 rounded-full bg-aura-cyan/50\"></div>\r\n                                    <span className=\"text-sm text-gray-300\">{log.type}</span>\r\n                                </div>\r\n                                <span className=\"text-[10px] text-gray-600 font-mono\">\r\n                                    {new Date(log.time).toLocaleString()}\r\n                                </span>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </motion.div>\r\n\r\n                <motion.div\r\n                    initial={{ opacity: 0, x: 20 }}\r\n                    animate={{ opacity: 1, x: 0 }}\r\n                    transition={{ delay: 0.3 }}\r\n                    className=\"p-8 rounded-[2.5rem] bg-gradient-to-br from-aura-cyan/10 to-aura-purple/10 border border-white/10 flex flex-col justify-center text-center space-y-4\"\r\n                >\r\n                    <div className=\"w-12 h-12 mx-auto rounded-full bg-aura-cyan/20 flex items-center justify-center text-aura-cyan\">тД╣я╕П</div>\r\n                    <h4 className=\"text-lg font-bold text-white italic uppercase tracking-tighter\">System Intelligence</h4>\r\n                    <p className=\"text-xs text-gray-400 font-light leading-relaxed\">\r\n                        AURA algorithms monitor your heartbeat across the system. If you become unreachable, we ensure your loved ones are informed instantly.\r\n                    </p>\r\n                </motion.div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\mind\\MindContent.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Modal' is defined but never used.","line":5,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'clearNotification' is assigned a value but never used.","line":20,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'dailyMoods' is assigned a value but never used.","line":28,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":65,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":65,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2928,2931],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2928,2931],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'user'. Either include it or remove the dependency array.","line":130,"column":8,"nodeType":"ArrayExpression","endLine":130,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [user, user.uid]","fix":{"range":[5309,5320],"text":"[user, user.uid]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'user'. Either include it or remove the dependency array.","line":206,"column":8,"nodeType":"ArrayExpression","endLine":206,"endColumn":51,"suggestions":[{"desc":"Update the dependencies array to be: [isActive, timeLeft, mode, user.uid, data, user]","fix":{"range":[7949,7992],"text":"[isActive, timeLeft, mode, user.uid, data, user]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'strokeDashoffset' is assigned a value but never used.","line":264,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":264,"endColumn":27}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useSearchParams } from 'next/navigation';\r\nimport HistoryModal from '@/components/HistoryModal';\r\nimport Modal from '@/components/Modal';\r\nimport VoiceInput from '@/components/VoiceInput';\r\nimport { useLanguage } from '@/context/LanguageContext';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useNotifications } from '@/context/NotificationContext';\r\nimport { getMindData, seedMindData, addMoodEntry, updateMindStats, MindData, MoodEntry, subscribeToMindData } from '@/services/mindService';\r\nimport { DateNavigator } from '@/components/dashboard/DateNavigator';\r\nimport { getScheduledInsight } from '@/services/aiPersistenceService';\r\nimport AlertModal from '@/components/AlertModal';\r\nimport { ReadOnlyBanner } from '@/components/dashboard/ReadOnlyBanner';\r\nimport { getLocalTodayStr } from '@/lib/dateUtils';\r\n\r\nexport default function MindDashboardContent() {\r\n    const { t, language } = useLanguage();\r\n    const { user } = useAuth();\r\n    const { clearNotification } = useNotifications();\r\n\r\n    // Data State\r\n    const [data, setData] = useState<MindData | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [selectedDate, setSelectedDate] = useState(getLocalTodayStr());\r\n    const isToday = selectedDate === getLocalTodayStr();\r\n    const isArchived = !isToday;\r\n    const [dailyMoods, setDailyMoods] = useState<MoodEntry[]>([]);\r\n\r\n    // Focus Timer State\r\n    const [timeLeft, setTimeLeft] = useState(25 * 60);\r\n    const [isActive, setIsActive] = useState(false);\r\n    const [mode, setMode] = useState<'focus' | 'break'>('focus');\r\n    const searchParams = useSearchParams();\r\n    const activeTask = searchParams.get('task');\r\n\r\n    // Breathing State\r\n    const [isBreathing, setIsBreathing] = useState(false);\r\n    const [breathPhase, setBreathPhase] = useState<'inhale' | 'hold' | 'exhale' | 'ready'>('ready');\r\n\r\n    // Mood State\r\n    const [moodLevel, setMoodLevel] = useState(50); // 0-100\r\n    const [isZenMode, setIsZenMode] = useState(false); // Adaptive UI status\r\n    const [isHistoryOpen, setIsHistoryOpen] = useState(false);\r\n    const [aiInsight, setAiInsight] = useState<{ title: string, insight: string, emoji: string } | null>(null);\r\n    const [aiLoading, setAiLoading] = useState(false);\r\n\r\n    const [alertModal, setAlertModal] = useState<{\r\n        isOpen: boolean;\r\n        title: string;\r\n        message: string;\r\n        type?: 'info' | 'success' | 'warning' | 'danger';\r\n    }>({\r\n        isOpen: false,\r\n        title: '',\r\n        message: '',\r\n        type: 'info'\r\n    });\r\n\r\n    const triggerAlert = (title: string, message: string, type: 'info' | 'success' | 'warning' | 'danger' = 'info') => {\r\n        setAlertModal({ isOpen: true, title, message, type });\r\n    };\r\n\r\n    // Command Handler\r\n    const handleVoiceCommand = async (command: { action: string, data: any }) => {\r\n        if (!user || !data || isArchived) return;\r\n        console.log('Mind Voice Command:', command);\r\n\r\n        const { action, data: cmdData } = command;\r\n\r\n        if (action === 'log') {\r\n            if (cmdData?.mood) {\r\n                let newLevel = 50;\r\n                if (typeof cmdData.mood === 'number') {\r\n                    newLevel = cmdData.mood;\r\n                } else {\r\n                    const moodMap: Record<string, number> = {\r\n                        'happy': 90, 'sad': 20, 'neutral': 50, 'stressed': 10, 'excited': 95, 'calm': 80,\r\n                        'xursand': 90, 'xafa': 20, 'normal': 50, 'stress': 10, 'hayajonli': 95, ' xotirjam': 80\r\n                    };\r\n                    newLevel = moodMap[cmdData.mood.toLowerCase()] || 50;\r\n                }\r\n                setMoodLevel(newLevel);\r\n\r\n                const entry: MoodEntry = {\r\n                    date: new Date().toISOString(),\r\n                    mood: typeof cmdData.mood === 'string' ? cmdData.mood : 'AI Log',\r\n                    value: newLevel\r\n                };\r\n                const newHistory = [...data.moodHistory, entry];\r\n                setData({ ...data, moodHistory: newHistory });\r\n                await addMoodEntry(user.uid, entry);\r\n            } else if (cmdData?.meditation || action === 'start') {\r\n                setIsBreathing(true);\r\n            }\r\n        } else if (action === 'start') {\r\n            const mins = Number(cmdData?.duration) || 25;\r\n            setTimeLeft(mins * 60);\r\n            setIsActive(true);\r\n            setMode('focus');\r\n        }\r\n    }\r\n\r\n    // V23: Real-time Data Subscription\r\n    useEffect(() => {\r\n        if (!user) return;\r\n        setLoading(true);\r\n\r\n        const unsub = subscribeToMindData(user.uid, (doc) => {\r\n            if (doc) {\r\n                setData(doc);\r\n                setLoading(false);\r\n            }\r\n        });\r\n\r\n        // Initial check for seeding\r\n        getMindData(user.uid).then(doc => {\r\n            if (!doc) {\r\n                seedMindData(user.uid).then(newDoc => {\r\n                    setData(newDoc);\r\n                    setLoading(false);\r\n                });\r\n            } else {\r\n                setData(doc); // Primary fallback if sub is slow\r\n                setLoading(false);\r\n            }\r\n        });\r\n\r\n        return () => unsub();\r\n    }, [user?.uid]);\r\n\r\n    // Filter logs for selected date\r\n    useEffect(() => {\r\n        if (!data) return;\r\n        const relevantMoods = data.moodHistory.filter(m => {\r\n            const mDate = m.date.startsWith('20') ? m.date.split('T')[0] : m.date; // handle ISO timestamp vs simple date\r\n            return mDate === selectedDate;\r\n        });\r\n        setDailyMoods(relevantMoods);\r\n\r\n        // If viewing past date, maybe set moodLevel to average of that day?\r\n        if (relevantMoods.length > 0) {\r\n            const avg = relevantMoods.reduce((acc, curr) => acc + curr.value, 0) / relevantMoods.length;\r\n            setMoodLevel(Math.round(avg));\r\n        }\r\n    }, [data, selectedDate]);\r\n\r\n    // Manual AI Trigger Logic\r\n    const fetchInsight = async () => {\r\n        if (!user || !data) return;\r\n        setAiLoading(true);\r\n        try {\r\n            const insight = await getScheduledInsight(user.uid, 'mind', language, {\r\n                moodHistory: data.moodHistory,\r\n                focusMinutes: data.stats.focusMinutes,\r\n                recentMood: moodLevel\r\n            }, { force: true });\r\n\r\n            if (insight) {\r\n                setAiInsight({\r\n                    title: insight.title,\r\n                    insight: insight.insight,\r\n                    emoji: insight.emoji\r\n                });\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Mind AI Error:\", err);\r\n        } finally {\r\n            setAiLoading(false);\r\n        }\r\n    };\r\n\r\n    // Auto-fetch REMOVED.\r\n    // useEffect(() => {\r\n    //     fetchInsight();\r\n    // }, [...]);\r\n\r\n    // Adaptive UI Logic (PRD: Stress Mode)\r\n    useEffect(() => {\r\n        if (moodLevel < 30) {\r\n            setIsZenMode(true);\r\n        } else {\r\n            setIsZenMode(false);\r\n        }\r\n    }, [moodLevel]);\r\n\r\n    // Timer Logic\r\n    useEffect(() => {\r\n        let interval: NodeJS.Timeout;\r\n        if (isActive && timeLeft > 0) {\r\n            interval = setInterval(() => {\r\n                setTimeLeft((prev) => prev - 1);\r\n            }, 1000);\r\n        } else if (timeLeft === 0) {\r\n            setIsActive(false);\r\n            // Timer finished, update stats\r\n            if (mode === 'focus' && user && data) {\r\n                const addedMinutes = 25; // Simple assumption for now\r\n                const newStats = { ...data.stats, focusMinutes: data.stats.focusMinutes + addedMinutes };\r\n                setData({ ...data, stats: newStats });\r\n                updateMindStats(user.uid, newStats);\r\n                // Play sound or notify?\r\n            }\r\n        }\r\n        return () => clearInterval(interval);\r\n    }, [isActive, timeLeft, mode, user?.uid, data]);\r\n\r\n    useEffect(() => {\r\n        if (isBreathing || isZenMode) {\r\n            // In Zen Mode, breathing is default guidance\r\n            const cycle = () => {\r\n                setBreathPhase('inhale');\r\n                setTimeout(() => setBreathPhase('hold'), 4000);\r\n                setTimeout(() => setBreathPhase('exhale'), 11000);\r\n            };\r\n            cycle();\r\n            const interval = setInterval(cycle, 19000);\r\n            return () => clearInterval(interval);\r\n        } else {\r\n            setBreathPhase('ready');\r\n        }\r\n    }, [isBreathing, isZenMode]);\r\n\r\n    const toggleTimer = () => setIsActive(!isActive);\r\n    const resetTimer = () => {\r\n        setIsActive(false);\r\n        setTimeLeft(mode === 'focus' ? 25 * 60 : 5 * 60);\r\n    };\r\n\r\n    const formatTime = (seconds: number) => {\r\n        const mins = Math.floor(seconds / 60);\r\n        const secs = seconds % 60;\r\n        return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\r\n    };\r\n\r\n    const handleLogMood = async () => {\r\n        if (!user || !data) return;\r\n        const moodType = moodLevel > 70 ? 'happy' : moodLevel > 40 ? 'neutral' : 'stressed';\r\n        const entry: MoodEntry = {\r\n            date: new Date().toISOString(),\r\n            mood: moodType,\r\n            value: moodLevel\r\n        };\r\n\r\n        const newHistory = [...data.moodHistory, entry];\r\n        setData({ ...data, moodHistory: newHistory });\r\n        await addMoodEntry(user.uid, entry);\r\n        triggerAlert(\"Muvaffaqiyat\", t.mind.saved, \"success\");\r\n    };\r\n\r\n    // Helper to get localized breath text\r\n    const getBreathText = () => {\r\n        switch (breathPhase) {\r\n            case 'inhale': return t.mind.inhale;\r\n            case 'hold': return t.mind.hold;\r\n            case 'exhale': return t.mind.exhale;\r\n            default: return t.mind.ready;\r\n        }\r\n    };\r\n\r\n    if (loading || !data) return <div className=\"text-white p-10 flex items-center justify-center min-h-[60vh] font-display text-xl animate-pulse\">{t.mind.loadingState}</div>;\r\n\r\n    const progress = mode === 'focus' ? (timeLeft / (25 * 60)) * 100 : (timeLeft / (5 * 60)) * 100;\r\n    const strokeDashoffset = 283 - (283 * progress) / 100;\r\n\r\n    // ZEN MODE UI\r\n    if (isZenMode) {\r\n        return (\r\n            <div className=\"min-h-[85vh] flex flex-col items-center justify-center space-y-12 animate-fade-in text-center relative overflow-hidden px-4\">\r\n                <div className=\"absolute inset-0 bg-gradient-to-b from-aura-red/10 via-black to-black z-0\"></div>\r\n                <div className=\"absolute top-1/4 left-1/4 w-64 h-64 bg-aura-red/20 blur-[100px] animate-pulse rounded-full\"></div>\r\n                <div className=\"absolute bottom-1/4 right-1/4 w-96 h-96 bg-aura-purple/10 blur-[120px] animate-pulse delay-700 rounded-full\"></div>\r\n\r\n                <div className=\"relative z-10 p-12 lg:p-16 rounded-[4rem] bg-black/40 backdrop-blur-2xl border border-white/10 shadow-[0_0_80px_rgba(255,255,255,0.05)] max-w-2xl w-full\">\r\n                    <h2 className=\"text-5xl font-display font-light text-white mb-4 tracking-tight leading-tight\">\r\n                        {t.mind.zenTitle}, {data.quote?.author.split(' ')[0]}.\r\n                    </h2>\r\n                    <p className=\"text-gray-400 text-xl font-light mb-12 max-w-md mx-auto\">{t.mind.zenSubtitle}</p>\r\n\r\n                    <div className=\"w-72 h-72 mx-auto flex items-center justify-center relative mb-12\">\r\n                        <div className=\"absolute inset-0 rounded-full border border-aura-red/30 animate-[ping_4s_ease-in-out_infinite]\"></div>\r\n                        <div className=\"absolute inset-8 rounded-full border border-aura-red/50 animate-[ping_4s_ease-in-out_infinite_1s]\"></div>\r\n                        <div className=\"absolute inset-0 bg-gradient-to-tr from-aura-red/20 to-transparent rounded-full blur-xl\"></div>\r\n                        <div className=\"text-3xl font-display font-medium text-white tracking-widest uppercase z-10 drop-shadow-lg\">{getBreathText()}</div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-6\">\r\n                        <p className=\"text-sm text-gray-500 font-medium uppercase tracking-widest\">{t.mind.whyFeeling}</p>\r\n                        <div className=\"flex flex-wrap gap-3 justify-center\">\r\n                            {(['tired', 'anxious', 'overwhelmed', 'justBecause'] as const).map(reason => (\r\n                                <button key={reason} className=\"px-6 py-2.5 rounded-2xl bg-white/5 border border-white/10 hover:bg-white/10 text-sm text-gray-300 transition-all hover:scale-105 active:scale-95\">\r\n                                    {t.mind.reasons[reason]}\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <button\r\n                    onClick={() => setMoodLevel(50)}\r\n                    className=\"relative z-10 px-8 py-3 text-sm text-gray-500 hover:text-white transition-colors flex items-center gap-2 group\"\r\n                >\r\n                    <span className=\"w-8 h-[1px] bg-gray-700 group-hover:w-12 group-hover:bg-white transition-all\"></span>\r\n                    {t.mind.exitZen}\r\n                </button>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    // NORMAL UI\r\n    return (\r\n        <div className=\"animate-fade-in pb-20 relative\">\r\n            <HistoryModal\r\n                isOpen={isHistoryOpen}\r\n                onClose={() => setIsHistoryOpen(false)}\r\n                title={t.mind.historyModalTitle}\r\n            >\r\n                <div className=\"space-y-8 p-2\">\r\n                    <div>\r\n                        <h4 className=\"text-white font-bold mb-6 text-lg\">{t.mind.moodTrends || \"Hissiyotlar tendentsiyasi\"}</h4>\r\n                        <div className=\"grid grid-cols-7 gap-3\">\r\n                            {data.moodHistory.slice(-28).map((mood, i) => {\r\n                                const color = mood.value > 70 ? 'bg-aura-green' : mood.value > 40 ? 'bg-aura-gold' : 'bg-aura-red';\r\n                                return (\r\n                                    <div key={i} className={`aspect-square rounded-xl ${color} opacity-60 hover:opacity-100 transition-all hover:scale-110 relative group cursor-help shadow-lg`}>\r\n                                        <span className=\"absolute -top-12 left-1/2 -translate-x-1/2 bg-black/90 text-white text-[11px] px-3 py-1.5 rounded-lg opacity-0 group-hover:opacity-100 whitespace-nowrap z-20 border border-white/10 shadow-2xl backdrop-blur-md\">\r\n                                            {new Date(mood.date).toLocaleDateString()}\r\n                                            <div className=\"font-bold text-center mt-0.5\">{mood.value}%</div>\r\n                                        </span>\r\n                                    </div>\r\n                                )\r\n                            })}\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"p-6 rounded-2xl bg-white/5 border border-white/10\">\r\n                        <h4 className=\"text-white font-bold mb-4 flex items-center gap-2\">\r\n                            <span className=\"text-aura-purple\">тЪб</span> {t.mind.recentSessions}\r\n                        </h4>\r\n                        <ul className=\"space-y-3\">\r\n                            <li className=\"flex items-center justify-between text-sm\">\r\n                                <span className=\"text-gray-400 flex items-center gap-3\">\r\n                                    <div className=\"w-2 h-2 rounded-full bg-aura-purple\"></div>\r\n                                    ЁЯОп {t.mind.focus} (25m)\r\n                                </span>\r\n                                <span className=\"text-aura-green font-medium\">Bajarildi</span>\r\n                            </li>\r\n                            <li className=\"flex items-center justify-between text-sm\">\r\n                                <span className=\"text-gray-400 flex items-center gap-3\">\r\n                                    <div className=\"w-2 h-2 rounded-full bg-aura-cyan\"></div>\r\n                                    ЁЯзШ {t.mind.resonanceBreathing} (5m)\r\n                                </span>\r\n                                <span className=\"text-aura-green font-medium\">Bajarildi</span>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </HistoryModal>\r\n\r\n            {/* HEADER */}\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center mb-12 gap-6\">\r\n                <div>\r\n                    <h1 className=\"text-5xl font-display font-bold text-white mb-3 tracking-tight\">\r\n                        {t.mind.title}\r\n                    </h1>\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <span className=\"w-8 h-[2px] bg-aura-purple rounded-full\"></span>\r\n                        <p className=\"text-gray-400 font-medium\">{t.mind.subtitle}</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-4 bg-white/5 p-2 rounded-3xl border border-white/10 backdrop-blur-md\">\r\n                    <DateNavigator selectedDate={selectedDate} onDateChange={setSelectedDate} />\r\n                    <VoiceInput\r\n                        module=\"mind\"\r\n                        onCommand={handleVoiceCommand}\r\n                        color=\"purple\"\r\n                        className={isArchived ? 'opacity-30 pointer-events-none' : ''}\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n            {isArchived && (\r\n                <div className=\"mb-8\">\r\n                    <ReadOnlyBanner\r\n                        title={t.mind.readOnly || \"Archive Mode\"}\r\n                        description={t.mind.readOnlyDesc || \"Past days cannot be edited to ensure data integrity\"}\r\n                    />\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-8 items-start\">\r\n\r\n                {/* LEFT: INTROSPECTION (4 columns) */}\r\n                <div className=\"lg:col-span-5 space-y-8\">\r\n                    {/* Mood Sphere Card */}\r\n                    <div className=\"group p-8 rounded-[2.5rem] bg-white/5 border border-white/10 hover:border-aura-purple/30 transition-all duration-500 overflow-hidden relative\">\r\n                        <div className=\"absolute -top-24 -right-24 w-48 h-48 bg-aura-purple/10 blur-[60px] group-hover:bg-aura-purple/20 transition-all\"></div>\r\n\r\n                        <div className=\"flex justify-between items-center mb-10 relative z-10\">\r\n                            <div>\r\n                                <h3 className=\"text-2xl font-display font-bold text-white mb-1\">{t.mind.moodSphere}</h3>\r\n                                <p className=\"text-xs text-gray-500 font-medium uppercase tracking-widest\">{t.mind.moodSphereDesc}</p>\r\n                            </div>\r\n                            <div className=\"flex flex-col items-end\">\r\n                                <span className=\"text-4xl animate-bounce-slow\">\r\n                                    {moodLevel > 70 ? 'ЁЯШД' : moodLevel > 30 ? 'ЁЯШР' : 'ЁЯШЮ'}\r\n                                </span>\r\n                                <span className=\"text-sm font-bold text-aura-purple mt-1\">{moodLevel}%</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-12 relative z-10 px-4\">\r\n                            <div className=\"relative pt-12\">\r\n                                <input\r\n                                    type=\"range\"\r\n                                    min=\"0\" max=\"100\"\r\n                                    value={moodLevel}\r\n                                    disabled={isArchived}\r\n                                    onChange={(e) => setMoodLevel(Number(e.target.value))}\r\n                                    className={`w-full h-1.5 bg-white/5 rounded-lg appearance-none relative z-20 ${isArchived ? 'cursor-default opacity-50' : 'cursor-pointer accent-aura-purple'}`}\r\n                                />\r\n                                {/* Visual Slider Track Background */}\r\n                                <div\r\n                                    className=\"absolute top-[3.75rem] left-0 h-1.5 bg-gradient-to-r from-aura-red via-aura-gold to-aura-green rounded-full opacity-20 blur-[2px]\"\r\n                                    style={{ width: '100%' }}\r\n                                ></div>\r\n                                <div\r\n                                    className=\"absolute top-[3.75rem] left-0 h-1.5 bg-gradient-to-r from-aura-red via-aura-gold to-aura-green rounded-full shadow-[0_0_15px_rgba(168,85,247,0.5)]\"\r\n                                    style={{ width: `${moodLevel}%` }}\r\n                                ></div>\r\n                            </div>\r\n\r\n                            <div className=\"flex justify-between text-[10px] text-gray-400 font-bold uppercase tracking-widest\">\r\n                                <span className=\"flex flex-col items-start gap-1\">\r\n                                    <span className=\"w-4 h-[1px] bg-aura-red\"></span>\r\n                                    {t.mind.zenMapLeft}\r\n                                </span>\r\n                                <button\r\n                                    onClick={() => !isArchived && handleLogMood()}\r\n                                    disabled={isArchived}\r\n                                    className={`px-8 py-3 rounded-2xl font-bold text-xs transition-all shadow-[0_10px_30px_rgba(168,85,247,0.3)] ${isArchived ? 'bg-white/5 border border-white/10 text-gray-500 cursor-not-allowed' : 'bg-aura-purple text-white hover:scale-105 active:scale-95'}`}\r\n                                >\r\n                                    {t.mind.saveMood}\r\n                                </button>\r\n                                <span className=\"flex flex-col items-end gap-1\">\r\n                                    <span className=\"w-4 h-[1px] bg-aura-green\"></span>\r\n                                    {t.mind.zenMapRight}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* AI Insight Card - Manual Trigger Enabled */}\r\n                    <div className=\"p-8 rounded-[2.5rem] bg-gradient-to-br from-aura-cyan/10 to-transparent border border-aura-cyan/20 group hover:border-aura-cyan/40 transition-all relative overflow-hidden flex flex-col justify-between\">\r\n                        <div className=\"absolute top-0 right-10 w-32 h-32 bg-aura-cyan/5 blur-[40px] rounded-full\"></div>\r\n\r\n                        <div className=\"flex items-center gap-4 mb-6 relative z-10\">\r\n                            <div className=\"w-12 h-12 rounded-2xl bg-aura-cyan/20 flex items-center justify-center text-2xl animate-pulse\">\r\n                                {aiInsight?.emoji || 'ЁЯза'}\r\n                            </div>\r\n                            <div>\r\n                                <h4 className=\"text-aura-cyan font-bold text-sm uppercase tracking-widest\">{t.mind.aiSummaryTitle}</h4>\r\n                                <h3 className=\"text-white font-display font-medium text-lg leading-tight\">\r\n                                    {aiInsight?.title || \"AI Mind Analysis\"}\r\n                                </h3>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <p className=\"text-gray-300 text-lg font-light leading-relaxed italic relative z-10 min-h-[80px]\">\r\n                            {aiLoading ?\r\n                                <span className=\"flex items-center gap-2\">\r\n                                    <span className=\"w-4 h-4 border-2 border-aura-cyan border-t-transparent rounded-full animate-spin\"></span>\r\n                                    Wait...\r\n                                </span> :\r\n                                (aiInsight?.insight ? `\"${aiInsight.insight}\"` : \"Hissiyotlaringiz va diqqatingiz asosida sun&apos;iy intellekt tahlili.\")\r\n                            }\r\n                        </p>\r\n\r\n                        <div className=\"mt-8 flex justify-between items-center relative z-10\">\r\n                            <button\r\n                                onClick={fetchInsight}\r\n                                disabled={aiLoading}\r\n                                className={`px-6 py-2 rounded-xl font-bold text-xs uppercase tracking-widest transition-all flex items-center gap-2 ${aiLoading ? 'bg-white/5 text-gray-500' : 'bg-aura-cyan text-black hover:bg-white hover:scale-105'}`}\r\n                            >\r\n                                {aiLoading ? 'Generating...' : (aiInsight ? 'Refresh Analysis' : 'Start Analysis')}\r\n                            </button>\r\n\r\n                            <button onClick={() => setIsHistoryOpen(true)} className=\"text-[10px] text-gray-500 font-bold uppercase tracking-tighter hover:text-aura-cyan transition-all\">\r\n                                {t.mind.historyModalTitle || \"History\"} тЖТ\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* RIGHT: TOOLS (7 columns) */}\r\n                <div className=\"lg:col-span-7 space-y-8\">\r\n                    {/* Focus Timer Card */}\r\n                    <div className=\"p-10 lg:p-12 rounded-[3rem] bg-gradient-to-br from-white/5 to-aura-purple/5 border border-white/10 relative overflow-hidden shadow-2xl\">\r\n                        <div className=\"absolute bottom-0 right-0 w-64 h-64 bg-aura-purple/5 blur-[100px] rounded-full\"></div>\r\n\r\n                        {/* Task Progress Info */}\r\n                        <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-12 relative z-10\">\r\n                            <div>\r\n                                <h3 className=\"text-2xl font-display font-bold text-white mb-2\">{t.mind.focus} Seans</h3>\r\n                                <div className=\"flex gap-2 p-1 bg-white/5 rounded-2xl w-fit border border-white/5\">\r\n                                    <button\r\n                                        onClick={() => { if (isArchived) return; setMode('focus'); setTimeLeft(25 * 60); setIsActive(false); }}\r\n                                        disabled={isArchived}\r\n                                        className={`px-6 py-2 rounded-xl text-xs font-bold uppercase tracking-widest transition-all ${mode === 'focus' ? 'bg-aura-purple text-white shadow-lg shadow-aura-purple/20' : 'text-gray-500 hover:text-white'} ${isArchived ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n                                    >\r\n                                        Focus\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => { if (isArchived) return; setMode('break'); setTimeLeft(5 * 60); setIsActive(false); }}\r\n                                        disabled={isArchived}\r\n                                        className={`px-6 py-2 rounded-xl text-xs font-bold uppercase tracking-widest transition-all ${mode === 'break' ? 'bg-aura-cyan text-black' : 'text-gray-500 hover:text-white'} ${isArchived ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n                                    >\r\n                                        {t.mind.break}\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {activeTask && (\r\n                                <div className=\"bg-aura-purple/10 border border-aura-purple/20 px-6 py-3 rounded-2xl flex items-center gap-3 animate-fade-in group hover:bg-aura-purple/20 transition-all\">\r\n                                    <div className=\"w-8 h-8 rounded-full bg-aura-purple flex items-center justify-center text-white font-bold text-xs ring-4 ring-aura-purple/20\">\r\n                                        ЁЯОп\r\n                                    </div>\r\n                                    <div className=\"flex flex-col\">\r\n                                        <span className=\"text-[10px] text-aura-purple font-bold uppercase tracking-widest\">{t.mind.focusingOn}</span>\r\n                                        <span className=\"text-white text-sm font-medium\">{activeTask}</span>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Interactive Timer Display */}\r\n                        <div className=\"flex flex-col md:flex-row items-center justify-center gap-12 relative z-10\">\r\n                            <div className=\"relative w-72 h-72\">\r\n                                {/* SVG Ring */}\r\n                                <svg className=\"w-full h-full transform -rotate-90 filter drop-shadow-[0_0_20px_rgba(168,85,247,0.2)]\">\r\n                                    <circle\r\n                                        cx=\"144\" cy=\"144\" r=\"130\"\r\n                                        stroke=\"currentColor\"\r\n                                        strokeWidth=\"8\"\r\n                                        fill=\"transparent\"\r\n                                        className=\"text-white/5\"\r\n                                    />\r\n                                    <circle\r\n                                        cx=\"144\" cy=\"144\" r=\"130\"\r\n                                        stroke=\"currentColor\"\r\n                                        strokeWidth=\"8\"\r\n                                        fill=\"transparent\"\r\n                                        strokeDasharray=\"816.8\"\r\n                                        strokeDashoffset={816.8 - (816.8 * progress) / 100}\r\n                                        strokeLinecap=\"round\"\r\n                                        className={`transition-all duration-1000 ease-linear ${mode === 'focus' ? 'text-aura-purple' : 'text-aura-cyan'}`}\r\n                                    />\r\n                                </svg>\r\n\r\n                                <div className=\"absolute inset-0 flex flex-col items-center justify-center\">\r\n                                    <div className=\"text-[5rem] font-bold text-white font-mono tracking-tighter tabular-nums leading-none\">\r\n                                        {formatTime(timeLeft)}\r\n                                    </div>\r\n                                    <div className=\"mt-2 text-[10px] text-gray-500 font-bold uppercase tracking-[0.3em]\">\r\n                                        {isActive ? \"Running\" : \"Paused\"}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex flex-row md:flex-col gap-6\">\r\n                                <button\r\n                                    onClick={() => !isArchived && toggleTimer()}\r\n                                    disabled={isArchived}\r\n                                    className={`w-24 h-24 rounded-[2rem] flex items-center justify-center text-4xl transition-all shadow-2xl transform active:scale-90 ${isArchived ? 'bg-white/5 border border-white/10 text-gray-700 cursor-not-allowed' : (isActive ? 'bg-white/5 border border-white/10 text-white hover:bg-white/10' : 'bg-white text-black hover:scale-105')}`}\r\n                                >\r\n                                    {isActive ? 'тП╕' : 'тЦ╢'}\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => !isArchived && resetTimer()}\r\n                                    disabled={isArchived}\r\n                                    className={`w-24 h-24 rounded-[2rem] bg-white/5 border border-white/10 flex items-center justify-center text-3xl transition-all active:scale-90 ${isArchived ? 'text-gray-700 cursor-not-allowed' : 'text-white hover:bg-white/10'}`}\r\n                                >\r\n                                    тЖ║\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Breathing Exercise Card */}\r\n                    <div className=\"p-8 rounded-[2.5rem] bg-white/5 border border-white/10 hover:border-aura-cyan/30 transition-all duration-500 relative overflow-hidden flex flex-col md:flex-row items-center justify-between gap-8 group\">\r\n                        <div className=\"absolute -left-20 -bottom-20 w-48 h-48 bg-aura-cyan/5 blur-[50px] rounded-full group-hover:bg-aura-cyan/10 transition-all\"></div>\r\n\r\n                        <div className=\"relative z-10 flex flex-col items-center md:items-start text-center md:text-left\">\r\n                            <h3 className=\"text-2xl font-display font-bold text-white mb-2\">{t.mind.resonanceBreathing}</h3>\r\n                            <p className=\"text-sm text-gray-400 max-w-xs mb-6\">Nafas olishingizni ekrandagi ritm bilan moslashtiring.</p>\r\n                            <button\r\n                                onClick={() => !isArchived && setIsBreathing(!isBreathing)}\r\n                                disabled={isArchived}\r\n                                className={`px-8 py-3.5 rounded-2xl border font-bold text-xs uppercase tracking-widest transition-all ${isArchived ? 'border-white/10 text-gray-500 cursor-not-allowed opacity-50' : (isBreathing ? 'border-aura-purple/50 text-aura-purple bg-aura-purple/10 shadow-[0_0_20px_rgba(168,85,247,0.2)]' : 'border-white/10 text-white hover:bg-white/5')}`}\r\n                            >\r\n                                {isBreathing ? t.mind.stopSession : t.mind.startSession}\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div className=\"w-40 h-40 flex items-center justify-center relative z-10\">\r\n                            <div className={`absolute inset-0 rounded-full border-2 border-aura-purple/20 transition-all duration-[4000ms] ease-in-out ${isBreathing ? 'scale-150 opacity-0' : 'scale-75 opacity-20'}`}></div>\r\n                            <div className={`absolute inset-4 rounded-full border border-aura-cyan/20 transition-all duration-[4000ms] ease-in-out ${isBreathing ? 'scale-125 opacity-0' : 'scale-90 opacity-40'}`}></div>\r\n\r\n                            <div className={`w-28 h-28 rounded-full bg-gradient-to-br from-aura-purple via-aura-purple/80 to-aura-cyan flex flex-col items-center justify-center text-white text-center shadow-[0_0_40px_rgba(168,85,247,0.3)] transition-all duration-[4000ms] ease-in-out z-10 ring-8 ring-white/5 ${isBreathing ? 'scale-110' : 'scale-90 opacity-60'}`}>\r\n                                <span className=\"text-[10px] font-bold uppercase tracking-tighter opacity-60 mb-1\">\r\n                                    {breathPhase !== 'ready' ? breathPhase : \"\"}\r\n                                </span>\r\n                                <span className=\"text-xs font-bold leading-tight px-3\">{getBreathText()}</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <AlertModal\r\n                    isOpen={alertModal.isOpen}\r\n                    onClose={() => setAlertModal({ ...alertModal, isOpen: false })}\r\n                    title={alertModal.title}\r\n                    message={alertModal.message}\r\n                    type={alertModal.type}\r\n                />\r\n            </div>\r\n        </div >\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\mind\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'clearNotification'. Either include it or remove the dependency array.","line":13,"column":8,"nodeType":"ArrayExpression","endLine":13,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [clearNotification]","fix":{"range":[443,445],"text":"[clearNotification]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport { Suspense, useEffect } from 'react';\r\nimport MindDashboardContent from './MindContent';\r\nimport { useLanguage } from '@/context/LanguageContext';\r\nimport { useNotifications } from '@/context/NotificationContext';\r\n\r\nexport default function MindDashboardPage() {\r\n    const { t } = useLanguage();\r\n    const { clearNotification } = useNotifications();\r\n\r\n    useEffect(() => {\r\n        clearNotification('mind');\r\n    }, []);\r\n    return (\r\n        <Suspense fallback={<div className=\"text-white\">{t.mind.loadingState}</div>}>\r\n            <MindDashboardContent />\r\n        </Suspense>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\settings\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\dashboard\\tasks\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'clearNotification'. Either include it or remove the dependency array.","line":190,"column":8,"nodeType":"ArrayExpression","endLine":190,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [clearNotification]","fix":{"range":[8673,8675],"text":"[clearNotification]"}}]},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":328,"column":9,"severity":1,"nodeType":null,"fix":{"range":[13816,13878],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":406,"column":5,"severity":1,"nodeType":null,"fix":{"range":[16341,16403],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":485,"column":5,"severity":1,"nodeType":null,"fix":{"range":[19870,19932],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":524,"column":5,"severity":1,"nodeType":null,"fix":{"range":[21580,21642],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":529,"column":9,"severity":1,"nodeType":null,"fix":{"range":[21846,21908],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":636,"column":17,"severity":1,"nodeType":null,"fix":{"range":[26968,27030],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":638,"column":17,"severity":1,"nodeType":null,"fix":{"range":[27110,27172],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":727,"column":13,"severity":1,"nodeType":null,"fix":{"range":[30418,30480],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":729,"column":13,"severity":1,"nodeType":null,"fix":{"range":[30573,30635],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":856,"column":29,"severity":1,"nodeType":null,"fix":{"range":[37805,37867],"text":" "}},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":1219,"column":139,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[63085,63099],"text":"Muddati O&apos;tgan"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[63085,63099],"text":"Muddati O&lsquo;tgan"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[63085,63099],"text":"Muddati O&#39;tgan"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[63085,63099],"text":"Muddati O&rsquo;tgan"},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Resource' is defined but never used.","line":29,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'parentTitle' is defined but never used.","line":48,"column":47,"nodeType":null,"messageId":"unusedVar","endLine":48,"endColumn":58,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":89,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3386,3389],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3386,3389],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":191,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":191,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'loading' is assigned a value but never used.","line":198,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":198,"endColumn":19,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isCalendarOpen' is assigned a value but never used.","line":220,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":220,"endColumn":26,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":329,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":329,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13912,13915],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13912,13915],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""},{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":333,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":333,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14127,14130],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14127,14130],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'clearNotification'. Either include it or remove the dependency array.","line":390,"column":8,"nodeType":"ArrayExpression","endLine":390,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [user, loadTasks, clearNotification]","fix":{"range":[16003,16020],"text":"[user, loadTasks, clearNotification]"}}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":407,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":407,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16448,16451],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16448,16451],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""},{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":486,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":486,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19973,19976],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19973,19976],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""},{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":525,"column":100,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":525,"endColumn":103,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21743,21746],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21743,21746],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""},{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":526,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":526,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21777,21780],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21777,21780],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":530,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":530,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21943,21946],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21943,21946],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""},{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":637,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":637,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27070,27073],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27070,27073],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""},{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":639,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":639,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27215,27218],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27215,27218],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""},{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":728,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":728,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[30512,30515],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[30512,30515],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""},{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":730,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":730,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[30670,30673],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[30670,30673],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""},{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":857,"column":184,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":857,"endColumn":187,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[38052,38055],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[38052,38055],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""},{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'pendingCount' is assigned a value but never used.","line":909,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":909,"endColumn":23,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'efficiency' is assigned a value but never used.","line":910,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":910,"endColumn":21,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1010,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1010,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[46947,46950],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[46947,46950],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1098,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1098,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[53719,53722],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[53719,53722],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1133,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1133,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[56334,56337],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[56334,56337],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1167,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1167,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[58836,58839],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[58836,58839],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1493,"column":77,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1493,"endColumn":80,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[89104,89107],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[89104,89107],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":10,"source":"\"use client\";\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\n/* eslint-disable @typescript-eslint/no-unused-vars */\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport Link from 'next/link';\r\nimport { useRouter } from 'next/navigation';\r\nimport HistoryModal from '@/components/HistoryModal';\r\nimport { getLocalTodayStr } from '@/lib/dateUtils';\r\n\r\nimport ConfirmationModal from '@/components/ConfirmationModal';\r\nimport VoiceInput from '@/components/VoiceInput';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport {\r\n    getTasksByDate,\r\n    getUpcomingTasks,\r\n    getOverdueTasks,\r\n    addTask,\r\n    updateTaskStatus,\r\n    updateTask,\r\n    deleteTask,\r\n    moveTask,\r\n    seedTasks,\r\n    subscribeToTasksByDate,\r\n    subscribeToOverdueTasks,\r\n    subscribeToUpcomingTasks,\r\n    Task,\r\n    Priority,\r\n    SubTask,\r\n    Resource\r\n} from '@/services/tasksService';\r\nimport { getScheduledInsight, dismissInsight } from '@/services/aiPersistenceService';\r\nimport Modal from '@/components/Modal';\r\n\r\nimport { useLanguage } from '@/context/LanguageContext';\r\nimport { useNotifications } from '@/context/NotificationContext';\r\nimport { DateNavigator } from '@/components/dashboard/DateNavigator';\r\nimport { ReadOnlyBanner } from '@/components/dashboard/ReadOnlyBanner';\r\nimport { AiInsightSection } from '@/components/dashboard/AiInsightSection';\r\n\r\n// --- RECURSIVE SUBTASK COMPONENT ---\r\ninterface RecursiveSubtaskListProps {\r\n    subtasks: SubTask[];\r\n    onUpdate: (updated: SubTask[]) => void;\r\n    level?: number;\r\n}\r\n\r\nconst RecursiveSubtaskList: React.FC<RecursiveSubtaskListProps> = ({ subtasks, onUpdate, level = 0 }) => {\r\n    const handleAddChild = (parentId: string, parentTitle: string) => {\r\n        const updateRecursive = (list: SubTask[]): SubTask[] => {\r\n            return list.map(s => {\r\n                if (s.id === parentId) {\r\n                    return {\r\n                        ...s,\r\n                        subtasks: [...(s.subtasks || []), {\r\n                            id: Date.now().toString(),\r\n                            title: '',\r\n                            status: 'todo',\r\n                            priority: 'medium',\r\n                            subtasks: [],\r\n                            date: s.date || getLocalTodayStr(),\r\n                            startTime: '09:00',\r\n                            endTime: '10:00',\r\n                            parentId: s.id,\r\n                            parentTitle: s.title,\r\n                            createdAt: Date.now()\r\n                        }]\r\n                    };\r\n                }\r\n                if (s.subtasks) return { ...s, subtasks: updateRecursive(s.subtasks) };\r\n                return s;\r\n            });\r\n        };\r\n        onUpdate(updateRecursive(subtasks));\r\n    };\r\n\r\n    const handleToggleStatus = (id: string) => {\r\n        const updateRecursive = (list: SubTask[]): SubTask[] => {\r\n            return list.map(s => {\r\n                if (s.id === id) {\r\n                    return { ...s, status: s.status === 'done' ? 'todo' : 'done' };\r\n                }\r\n                if (s.subtasks) return { ...s, subtasks: updateRecursive(s.subtasks) };\r\n                return s;\r\n            });\r\n        };\r\n        onUpdate(updateRecursive(subtasks));\r\n    };\r\n\r\n    const handleFieldChange = (id: string, field: keyof SubTask, value: any) => {\r\n        const updateRecursive = (list: SubTask[]): SubTask[] => {\r\n            return list.map(s => {\r\n                if (s.id === id) return { ...s, [field]: value };\r\n                if (s.subtasks) return { ...s, subtasks: updateRecursive(s.subtasks) };\r\n                return s;\r\n            });\r\n        };\r\n        onUpdate(updateRecursive(subtasks));\r\n    };\r\n\r\n    const handleDelete = (id: string) => {\r\n        const deleteRecursive = (list: SubTask[]): SubTask[] => {\r\n            return list.filter(s => s.id !== id).map(s => {\r\n                if (s.subtasks) return { ...s, subtasks: deleteRecursive(s.subtasks) };\r\n                return s;\r\n            });\r\n        };\r\n        onUpdate(deleteRecursive(subtasks));\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-3\">\r\n            {subtasks.map((sub) => (\r\n                <div key={sub.id} className=\"space-y-2\">\r\n                    <div className=\"flex items-center gap-2 group\">\r\n                        <button\r\n                            onClick={() => handleToggleStatus(sub.id)}\r\n                            className={`w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors ${sub.status === 'done' ? 'bg-aura-green border-aura-green' : 'border-gray-500'}`}\r\n                            aria-label={`Toggle status for ${sub.title}`}\r\n                        >\r\n                            {sub.status === 'done' && <span className=\"text-black text-[10px]\">тЬУ</span>}\r\n                        </button>\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Kichik vazifa...\"\r\n                            className={`bg-transparent border-none focus:outline-none flex-1 text-sm ${sub.status === 'done' ? 'text-gray-500 line-through' : 'text-white'}`}\r\n                            value={sub.title}\r\n                            onChange={(e) => handleFieldChange(sub.id, 'title', e.target.value)}\r\n                        />\r\n                        <div className=\"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                            <input\r\n                                type=\"date\"\r\n                                className=\"bg-white/5 border border-white/10 rounded px-1 py-0.5 text-[10px] text-gray-400 focus:outline-none [color-scheme:dark]\"\r\n                                value={sub.date}\r\n                                onChange={(e) => handleFieldChange(sub.id, 'date', e.target.value)}\r\n                            />\r\n                            <input\r\n                                type=\"time\"\r\n                                className=\"bg-white/5 border border-white/10 rounded px-1 py-0.5 text-[10px] text-gray-400 focus:outline-none\"\r\n                                value={sub.startTime}\r\n                                onChange={(e) => handleFieldChange(sub.id, 'startTime', e.target.value)}\r\n                            />\r\n                            <button\r\n                                onClick={() => handleAddChild(sub.id, sub.title)}\r\n                                className=\"p-1 text-aura-cyan text-[10px] uppercase font-black tracking-tighter hover:scale-110 transition-all\"\r\n                                title=\"Add sub-sub task\"\r\n                            >\r\n                                + Sub\r\n                            </button>\r\n                            <button\r\n                                onClick={() => handleDelete(sub.id)}\r\n                                className=\"p-1 text-gray-500 hover:text-aura-red transition-all\"\r\n                                aria-label={`Delete subtask ${sub.title}`}\r\n                            >\r\n                                тЬХ\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                    {/* NESTED CHILDREN */}\r\n                    {sub.subtasks && sub.subtasks.length > 0 && (\r\n                        <div className=\"pl-6 border-l border-white/5 mt-2\">\r\n                            <RecursiveSubtaskList\r\n                                subtasks={sub.subtasks}\r\n                                onUpdate={(updated) => {\r\n                                    const updateRecursive = (list: SubTask[]): SubTask[] => {\r\n                                        return list.map(s => {\r\n                                            if (s.id === sub.id) return { ...s, subtasks: updated };\r\n                                            if (s.subtasks) return { ...s, subtasks: updateRecursive(s.subtasks) };\r\n                                            return s;\r\n                                        });\r\n                                    };\r\n                                    onUpdate(updateRecursive(subtasks));\r\n                                }}\r\n                                level={level + 1}\r\n                            />\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            ))}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default function TasksDashboard() {\r\n    const { t, language } = useLanguage();\r\n    const { user } = useAuth();\r\n    const { clearNotification } = useNotifications();\r\n\r\n    useEffect(() => {\r\n        clearNotification('tasks');\r\n    }, []);\r\n    const router = useRouter();\r\n\r\n    // State\r\n    const [todayTasks, setTodayTasks] = useState<Task[]>([]);\r\n    const [overdueTasks, setOverdueTasks] = useState<Task[]>([]);\r\n    const [futureTasks, setFutureTasks] = useState<Task[]>([]);\r\n    // const [focusStats, setFocusStats] = useState({ totalMinutes: 0 }); // Unused\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    const [isModalOpen, setIsModalOpen] = useState(false);\r\n\r\n    // New Task / Edit Task State\r\n    const [newTask, setNewTask] = useState<Omit<Task, 'id' | 'status'>>({\r\n        title: '',\r\n        priority: 'medium',\r\n        startTime: '09:00',\r\n        endTime: '10:00',\r\n        date: '',\r\n        category: 'Personal',\r\n        subtasks: [],\r\n        resources: [],\r\n        createdAt: Date.now()\r\n    });\r\n    const [editingTaskId, setEditingTaskId] = useState<string | null>(null);\r\n    const [viewMode, setViewMode] = useState<'dashboard' | 'analytics'>('dashboard');\r\n    const [focusedTask, setFocusedTask] = useState<Task | null>(null);\r\n    const [dragedTaskId, setDragedTaskId] = useState<string | null>(null);\r\n\r\n    const [isHistoryOpen, setIsHistoryOpen] = useState(false);\r\n    const [isCalendarOpen, setIsCalendarOpen] = useState(false);\r\n    const [selectedDate, setSelectedDate] = useState(getLocalTodayStr());\r\n    const [isArchived, setIsArchived] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const todayStr = getLocalTodayStr();\r\n        setIsArchived(selectedDate !== todayStr);\r\n    }, [selectedDate]);\r\n\r\n    // AI Insight State\r\n    const [aiInsight, setAiInsight] = useState<{ title: string, suggestion: string, priority?: string } | null>(null);\r\n    const [aiLoading, setAiLoading] = useState(false);\r\n\r\n    // Confirmation Modal State\r\n    const [confirmModal, setConfirmModal] = useState<{\r\n        isOpen: boolean;\r\n        title: string;\r\n        message: string;\r\n        onConfirm: () => void;\r\n        type?: 'danger' | 'info' | 'warning';\r\n    }>({\r\n        isOpen: false,\r\n        title: '',\r\n        message: '',\r\n        onConfirm: () => { },\r\n    });\r\n\r\n    const triggerConfirm = (title: string, message: string, onConfirm: () => void, type: 'danger' | 'info' | 'warning' = 'danger') => {\r\n        setConfirmModal({ isOpen: true, title, message, onConfirm, type });\r\n    };\r\n\r\n    const [moveTaskData, setMoveTaskData] = useState<{ isOpen: boolean, taskId: string, currentDate: string } | null>(null);\r\n\r\n    // V23: Real-time Data Subscriptions\r\n    useEffect(() => {\r\n        if (!user) return;\r\n        setLoading(true);\r\n\r\n        // 1. Current Date Tasks\r\n        const unsubToday = subscribeToTasksByDate(user.uid, selectedDate, (tasks) => {\r\n            setTodayTasks(tasks);\r\n            setLoading(false);\r\n        });\r\n\r\n        // 2. Overdue Tasks\r\n        const todayStr = getLocalTodayStr();\r\n        const unsubOverdue = subscribeToOverdueTasks(user.uid, todayStr, (tasks) => {\r\n            setOverdueTasks(tasks);\r\n        });\r\n\r\n        // 3. Upcoming Tasks\r\n        const unsubUpcoming = subscribeToUpcomingTasks(user.uid, todayStr, (tasks) => {\r\n            setFutureTasks(tasks);\r\n        });\r\n\r\n        return () => {\r\n            unsubToday();\r\n            unsubOverdue();\r\n            unsubUpcoming();\r\n        };\r\n    }, [user, selectedDate]);\r\n\r\n    // V23: Scheduled AI Insight - Manual Trigger Only\r\n    const fetchAiInsight = async () => {\r\n        if (!user) return;\r\n        setAiLoading(true);\r\n        try {\r\n            // Pass tasks for context\r\n            const allTasks = [...todayTasks, ...overdueTasks, ...futureTasks];\r\n            const insight = await getScheduledInsight(user.uid, 'tasks', language, { tasks: allTasks }, { force: true });\r\n\r\n            if (insight) {\r\n                setAiInsight({\r\n                    title: insight.title || \"Kunning maqsadi\",\r\n                    suggestion: insight.insight || \"Bugungi kuningizni unumli o&apos;tkazing.\"\r\n                });\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Tasks AI Error:\", err);\r\n        } finally {\r\n            setAiLoading(false);\r\n        }\r\n    };\r\n\r\n    // Auto-fetch REMOVED. User must click button.\r\n\r\n    // Unified Data Collector for Analytics\r\n    const getAllRelatedTasks = (deep = false): (Task | SubTask)[] => {\r\n        const allLoaded = Array.from(new Map([...todayTasks, ...overdueTasks, ...futureTasks].map(t => [t.id, t])).values());\r\n\r\n        if (!focusedTask) {\r\n            return allLoaded;\r\n        }\r\n\r\n        // For focused view, we consider:\r\n        // 1. Direct nested subtasks from focusedTask document\r\n        // 2. Independent documents where parentId === focusedTask.id\r\n        const nestedDirect = (focusedTask.subtasks || []);\r\n        const independentDirect = allLoaded.filter(t => t.parentId === focusedTask.id);\r\n\r\n        const topLevelRelated = [...nestedDirect, ...independentDirect];\r\n\r\n        if (!deep) return topLevelRelated;\r\n\r\n        // If deep is requested (e.g. for time distribution), flatten everything\r\n        const results: (Task | SubTask)[] = [];\r\n        const seenIds = new Set<string>();\r\n\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        const traverse = (item: any) => {\r\n            if (seenIds.has(item.id)) return;\r\n            seenIds.add(item.id);\r\n            if (item.id !== focusedTask.id) results.push(item);\r\n            if (item.subtasks) item.subtasks.forEach((s: any) => traverse(s));\r\n        };\r\n\r\n        topLevelRelated.forEach(t => traverse(t));\r\n        return results;\r\n    };\r\n\r\n    // Deep Progress Helper\r\n    const getDeepSubtaskStats = (items: (Task | SubTask)[]): { done: number, total: number } => {\r\n        let done = 0;\r\n        let total = 0;\r\n        const traverse = (list: (Task | SubTask)[]) => {\r\n            list.forEach(s => {\r\n                total++;\r\n                if (s.status === 'done') done++;\r\n                if (s.subtasks && s.subtasks.length > 0) traverse(s.subtasks);\r\n            });\r\n        };\r\n        traverse(items);\r\n        return { done, total };\r\n    };\r\n\r\n    // Load Data\r\n    const loadTasks = useCallback(async () => {\r\n        if (!user) return;\r\n        setLoading(true);\r\n\r\n        try {\r\n            const [t, o, f] = await Promise.all([\r\n                getTasksByDate(user.uid, selectedDate),\r\n                getOverdueTasks(user.uid, selectedDate),\r\n                getUpcomingTasks(user.uid, selectedDate)\r\n            ]);\r\n            setTodayTasks(t);\r\n            setOverdueTasks(o);\r\n            setFutureTasks(f);\r\n\r\n            // Original seeding logic, adapted to use the new fetched data\r\n            const todayStr = getLocalTodayStr();\r\n            if (t.length === 0 && o.length === 0 && f.length === 0 && selectedDate === todayStr) {\r\n                await seedTasks(user.uid);\r\n                const seededToday = await getTasksByDate(user.uid, todayStr);\r\n                setTodayTasks(seededToday);\r\n            }\r\n        } catch (e) {\r\n            console.error(e);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [user, selectedDate]);\r\n\r\n    useEffect(() => {\r\n        if (user) {\r\n            clearNotification('tasks');\r\n            loadTasks();\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [user, loadTasks]);\r\n\r\n    // Fetch AI Insight\r\n\r\n\r\n\r\n\r\n\r\n    // Initialize newTask date when modal opens (only if not editing)\r\n    useEffect(() => {\r\n        if (isModalOpen && !editingTaskId) {\r\n            setNewTask(prev => ({ ...prev, date: selectedDate }));\r\n        }\r\n    }, [isModalOpen, selectedDate, editingTaskId]);\r\n\r\n\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const handleVoiceCommand = async (cmd: any) => {\r\n        if (!user || isArchived) return;\r\n        console.log('Tasks Voice Command:', cmd);\r\n\r\n        const { action, data: cmdData } = cmd;\r\n\r\n        if (action === 'add' || action === 'tasks.create_task') { // Support both old and new for safety\r\n            const title = cmdData?.title;\r\n            if (title) {\r\n                const taskPayload: Omit<Task, 'id'> = {\r\n                    title,\r\n                    description: cmdData?.description || '',\r\n                    status: 'todo',\r\n                    priority: (cmdData?.priority as Priority) || 'medium',\r\n                    startTime: cmdData?.time || '09:00',\r\n                    endTime: '10:00',\r\n                    category: cmdData?.category || 'Voice',\r\n                    date: cmdData?.date || selectedDate,\r\n                    subtasks: [],\r\n                    resources: []\r\n                };\r\n                await addTask(user.uid, taskPayload);\r\n                if (loadTasks) loadTasks(); // Guard against loadTasks not being available but normally it is\r\n            }\r\n        } else if (action === 'add_subtask') {\r\n            const parentTitle = cmdData?.parent_title;\r\n            const subTitle = cmdData?.title;\r\n            if (parentTitle && subTitle) {\r\n                const parentTask = todayTasks.find(t => t.title.toLowerCase().includes(parentTitle.toLowerCase()));\r\n                if (parentTask) {\r\n                    const newSub: SubTask = {\r\n                        id: Date.now().toString(),\r\n                        title: subTitle,\r\n                        status: 'todo',\r\n                        priority: 'medium',\r\n                        createdAt: Date.now()\r\n                    };\r\n                    const updatedSubtasks = [...(parentTask.subtasks || []), newSub];\r\n                    await updateTask(user.uid, parentTask.id, { subtasks: updatedSubtasks });\r\n                    loadTasks();\r\n                }\r\n            }\r\n        } else if (action === 'log') {\r\n            // If they accidentally say \"log steps\" in tasks, redirect logic in VoiceInput handles it\r\n            // but we can also handle it here if redirect is denied.\r\n        }\r\n    };\r\n\r\n    // Actions\r\n    const handleToggleStatus = async (task: Task) => {\r\n        if (!user || isArchived) return;\r\n\r\n        // Completion Dependency Logic\r\n        const pendingSubtasks = task.subtasks?.filter(s => s.status !== 'done') || [];\r\n\r\n        const executeToggle = async () => {\r\n            const newStatus = task.status === 'done' ? 'todo' : 'done';\r\n            // Optimistic UI\r\n            setTodayTasks(prev => prev.map(t => t.id === task.id ? { ...t, status: newStatus } : t));\r\n            setOverdueTasks(prev => prev.map(t => t.id === task.id ? { ...t, status: newStatus } : t));\r\n            setFutureTasks(prev => prev.map(t => t.id === task.id ? { ...t, status: newStatus } : t));\r\n\r\n            await updateTaskStatus(user.uid, task.id, newStatus);\r\n            loadTasks();\r\n        };\r\n\r\n        if (task.status !== 'done' && pendingSubtasks.length > 0) {\r\n            triggerConfirm(\r\n                \"Diqqat!\",\r\n                `Ushbu vazifada hali ${pendingSubtasks.length} ta bajarilmagan kichik vazifalar bor. Baribir yakunlaysizmi?`,\r\n                executeToggle,\r\n                'warning'\r\n            );\r\n        } else {\r\n            executeToggle();\r\n        }\r\n    };\r\n\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const handleOpenEditModal = (task: any) => {\r\n        // If it's a subtask, we might still want to edit the parent task or the subtask itself.\r\n        // For now, let's allow finding the root parent task if it's a subtask being clicked.\r\n        // But the user usually wants to edit the specific subtask within the context of the root.\r\n\r\n        let rootTask = task;\r\n        if (task.isSubtask) {\r\n            // Find the root task in our currently loaded lists\r\n            rootTask = todayTasks.find(t => t.id === task.parentId) ||\r\n                overdueTasks.find(t => t.id === task.parentId) ||\r\n                futureTasks.find(t => t.id === task.parentId);\r\n\r\n            if (!rootTask) {\r\n                // If not found in memory, we might need a fetch, but for now we fallback\r\n                rootTask = task;\r\n            }\r\n        }\r\n\r\n        // Ensure description is properly set\r\n        const taskDescription = rootTask.description || '';\r\n\r\n        setNewTask({\r\n            title: rootTask.title || '',\r\n            description: taskDescription,\r\n            priority: rootTask.priority || 'medium',\r\n            startTime: rootTask.startTime || '09:00',\r\n            endTime: rootTask.endTime || '10:00',\r\n            date: rootTask.date || selectedDate,\r\n            category: rootTask.category || 'Personal',\r\n            subtasks: rootTask.subtasks || [],\r\n            resources: rootTask.resources || [],\r\n            createdAt: rootTask.createdAt || Date.now()\r\n        });\r\n        setEditingTaskId(rootTask.id);\r\n        setIsModalOpen(true);\r\n    };\r\n\r\n    // Flattening Helper for Dashboard Visibility\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const flattenTasksForColumn = (rootTasks: Task[], columnType: 'overdue' | 'today' | 'future'): any[] => {\r\n        const result: any[] = [];\r\n        const todayStr = getLocalTodayStr();\r\n\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        const traverse = (items: any[], parentTitle?: string, parentId?: string) => {\r\n            items.forEach(item => {\r\n                const itemDate = item.date || '';\r\n                let match = false;\r\n\r\n                if (columnType === 'today') {\r\n                    match = itemDate === selectedDate;\r\n                } else if (columnType === 'overdue') {\r\n                    match = itemDate < todayStr && itemDate !== '' && item.status !== 'done';\r\n                } else if (columnType === 'future') {\r\n                    match = itemDate > todayStr && itemDate !== selectedDate;\r\n                }\r\n\r\n                if (match || (focusedTask && item.parentId === focusedTask.id)) {\r\n                    // Refinement: Hide subtasks from main columns unless we are in focused view\r\n                    // OR if they are specifically matching the column criteria and we want them flat.\r\n                    // But the user specifically asked: \"subtasklar asosiy tasklar sahifasida ko'rinmaydi faqatgina tarkibiga qo'shilgan asosiy task nomi click bo'lganida ko'rinadi\"\r\n\r\n                    // Logic: If focused, show ONLY subtasks of the focused task (and the focused task itself)\r\n                    // If not focused, show ONLY root tasks.\r\n                    const isDirectChild = item.parentId === focusedTask?.id;\r\n                    const isFocusedSelf = item.id === focusedTask?.id;\r\n                    const shouldShow = focusedTask ? (isDirectChild || isFocusedSelf) : !item.parentId;\r\n\r\n                    if (shouldShow) {\r\n                        // If it's a subtask with NO date, and its parent is focused, show it in 'today' column by default\r\n                        let finalMatch = match;\r\n                        if (focusedTask && isDirectChild && !item.date && columnType === 'today') {\r\n                            finalMatch = true;\r\n                        }\r\n\r\n                        if (finalMatch) {\r\n                            result.push({\r\n                                ...item,\r\n                                isSubtaskDisplay: !!parentTitle,\r\n                                parentTitleDisplay: parentTitle,\r\n                                parentIdDisplay: parentId\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (item.subtasks && item.subtasks.length > 0) {\r\n                    traverse(item.subtasks, item.title, item.id);\r\n                }\r\n            });\r\n        };\r\n\r\n        // We need to look through ALL root tasks to find subtasks that might belong in this column\r\n        // But for performance, let's just use the ones already provided by the service as a starting point.\r\n        // Actually, the service already returns root tasks for the specific columns.\r\n        // So traverse(todayTasks) will find subtasks that match today's date.\r\n        // However, a subtask might be for today, but its parent is for the future.\r\n        // So we should ideally traverse ALL root tasks.\r\n        const allRootTasks = [...todayTasks, ...overdueTasks, ...futureTasks];\r\n        // Deduplicate root tasks just in case\r\n        const uniqueRoots = Array.from(new Map(allRootTasks.map(t => [t.id, t])).values());\r\n\r\n        traverse(uniqueRoots);\r\n\r\n        // Remove duplicates if a subtask was added twice (shouldn't happen with traverse but safe to check)\r\n        return Array.from(new Map(result.map(t => [t.id, t])).values());\r\n    };\r\n\r\n    const handleCloseModal = () => {\r\n        setIsModalOpen(false);\r\n        setEditingTaskId(null);\r\n        setNewTask({\r\n            title: '',\r\n            priority: 'medium',\r\n            startTime: '09:00',\r\n            endTime: '10:00',\r\n            date: selectedDate,\r\n            category: 'Personal',\r\n            subtasks: [],\r\n            resources: [],\r\n            createdAt: Date.now()\r\n        });\r\n    };\r\n\r\n    const handleSaveTask = async () => {\r\n        if (!user || !newTask.title || isArchived) return;\r\n\r\n        if (editingTaskId) {\r\n            await updateTask(user.uid, editingTaskId, {\r\n                title: newTask.title,\r\n                priority: newTask.priority as Priority,\r\n                startTime: newTask.startTime,\r\n                endTime: newTask.endTime,\r\n                date: newTask.date || selectedDate,\r\n                category: newTask.category,\r\n                subtasks: newTask.subtasks,\r\n                resources: newTask.resources\r\n            });\r\n        } else {\r\n            const taskPayload: Omit<Task, 'id'> = {\r\n                title: newTask.title,\r\n                status: 'todo',\r\n                priority: newTask.priority as Priority,\r\n                startTime: newTask.startTime,\r\n                endTime: newTask.endTime,\r\n                category: newTask.category,\r\n                date: newTask.date || selectedDate,\r\n                subtasks: newTask.subtasks,\r\n                resources: newTask.resources,\r\n                createdAt: newTask.createdAt || Date.now(),\r\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                parentId: (newTask as any).parentId || null,\r\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                parentTitle: (newTask as any).parentTitle || null\r\n            };\r\n            await addTask(user.uid, taskPayload);\r\n        }\r\n\r\n        handleCloseModal();\r\n        loadTasks();\r\n    };\r\n\r\n    const handleDeleteTask = async (taskId: string) => {\r\n        if (!user || isArchived) return;\r\n\r\n        triggerConfirm(\r\n            \"Vazifani o&apos;chirish\",\r\n            \"Ushbu vazifani o&apos;chirib tashlamoqchimisiz? Bu amalni ortga qaytarib bo&apos;lmaydi.\",\r\n            async () => {\r\n                // Optimistic Update\r\n                setTodayTasks(prev => prev.filter(t => t.id !== taskId));\r\n                setOverdueTasks(prev => prev.filter(t => t.id !== taskId));\r\n                setFutureTasks(prev => prev.filter(t => t.id !== taskId));\r\n\r\n                await deleteTask(user.uid, taskId);\r\n                loadTasks();\r\n            },\r\n            'danger'\r\n        );\r\n    }\r\n\r\n    const handleMoveToDate = async (taskId: string, date: string) => {\r\n        if (!user || isArchived) return;\r\n        await moveTask(user.uid, taskId, date);\r\n        loadTasks();\r\n    };\r\n\r\n    const handleAddAISuggestion = async () => {\r\n        if (!user || !aiInsight || isArchived) return;\r\n        const today = getLocalTodayStr();\r\n\r\n        const taskPayload: Omit<Task, 'id'> = {\r\n            title: aiInsight.title,\r\n            description: aiInsight.suggestion, // Fix: Use suggestion as description\r\n            status: 'todo',\r\n            priority: (aiInsight.priority as Priority) || 'high',\r\n            startTime: '10:00',\r\n            endTime: '11:00',\r\n            category: 'AI Recommended',\r\n            date: today,\r\n            subtasks: [],\r\n            resources: [],\r\n            createdAt: Date.now()\r\n        };\r\n        await addTask(user.uid, taskPayload);\r\n        await dismissInsight(user.uid, 'tasks');\r\n        loadTasks();\r\n        setAiInsight(null); // Clear after adding\r\n    };\r\n\r\n    const getPriorityColor = (p: string) => {\r\n        switch (p) {\r\n            case 'high': return 'text-aura-red bg-aura-red/10 border-aura-red/20';\r\n            case 'medium': return 'text-aura-gold bg-aura-gold/10 border-aura-gold/20';\r\n            case 'low': return 'text-aura-green bg-aura-green/10 border-aura-green/20';\r\n            default: return 'text-gray-400 bg-gray-800';\r\n        }\r\n    };\r\n\r\n    const handleDragStart = (e: React.DragEvent, taskId: string) => {\r\n        if (isArchived) {\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        setDragedTaskId(taskId);\r\n        e.dataTransfer.effectAllowed = 'move';\r\n    };\r\n\r\n    const handleDrop = async (e: React.DragEvent, targetDate: string) => {\r\n        e.preventDefault();\r\n        if (!user || !dragedTaskId || isArchived) return;\r\n\r\n        // Optimistic update\r\n        setTodayTasks(prev => prev.filter(t => t.id !== dragedTaskId));\r\n        setOverdueTasks(prev => prev.filter(t => t.id !== dragedTaskId));\r\n        setFutureTasks(prev => prev.filter(t => t.id !== dragedTaskId));\r\n\r\n        // When dropping on a column, we also want to \"promote\" it to a root task\r\n        // by removing the parentId.\r\n        await updateTask(user.uid, dragedTaskId, {\r\n            date: targetDate,\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            parentId: null as any, // Nullify parentId to make it a root task\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            parentTitle: null as any\r\n        });\r\n\r\n        setDragedTaskId(null);\r\n        loadTasks();\r\n    };\r\n\r\n    const handleDragOver = (e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        e.dataTransfer.dropEffect = 'move';\r\n    };\r\n\r\n    const TaskCard = ({ task }: { task: Task & { isSubtaskDisplay?: boolean, parentTitleDisplay?: string } }) => {\r\n        const [isDragOver, setIsDragOver] = useState(false);\r\n\r\n        const handleCardDrop = async (e: React.DragEvent) => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            setIsDragOver(false);\r\n            if (!user || !dragedTaskId || dragedTaskId === task.id) return;\r\n\r\n            if (dragedTaskId === task.id || task.parentId === dragedTaskId) return;\r\n\r\n            // When dropping ONTO another task, it becomes a subtask\r\n            await updateTask(user.uid, dragedTaskId, {\r\n                parentId: task.id,\r\n                parentTitle: task.title,\r\n                date: task.date || selectedDate\r\n            });\r\n            setDragedTaskId(null);\r\n            loadTasks();\r\n        };\r\n\r\n        return (\r\n            <div\r\n                draggable\r\n                onDragStart={(e) => handleDragStart(e, task.id)}\r\n                onDragOver={(e) => {\r\n                    if (dragedTaskId && dragedTaskId !== task.id) {\r\n                        e.preventDefault();\r\n                        setIsDragOver(true);\r\n                    }\r\n                }}\r\n                onDragLeave={() => setIsDragOver(false)}\r\n                onDrop={handleCardDrop}\r\n                className={`group relative flex flex-col justify-between p-6 rounded-[2rem] border transition-all duration-500 overflow-visible\r\n                    ${isDragOver ? 'border-aura-cyan bg-aura-cyan/10 scale-[1.05] z-30 shadow-[0_0_40px_rgba(0,240,255,0.2)]' :\r\n                        task.status === 'done'\r\n                            ? 'bg-black/40 border-white/5 opacity-50 grayscale hover:scale-[1.01]'\r\n                            : 'bg-white/5 border-white/10 backdrop-blur-xl hover:border-white/20 hover:scale-[1.02] hover:shadow-2xl'\r\n                    } mb-8`} // Added mb-8 for spacing for the bottom button\r\n            >\r\n\r\n                {/* DONE STRIPE */}\r\n                {task.status === 'done' && (\r\n                    <div className=\"absolute inset-x-0 top-1/2 h-[1px] bg-white/10 rotate-[-5deg] pointer-events-none z-0\"></div>\r\n                )}\r\n\r\n                <div className=\"relative z-10 space-y-4\">\r\n                    {/* TOP META */}\r\n                    <div className=\"flex justify-between items-center gap-2\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className=\"px-3 py-1 rounded-xl bg-white/5 border border-white/10 text-[9px] font-black uppercase tracking-widest text-gray-500\">\r\n                                {task.category || t.family.task}\r\n                            </span>\r\n                            {task.parentTitleDisplay && (\r\n                                <span className=\"text-[9px] font-black text-aura-cyan bg-aura-cyan/10 px-3 py-1 rounded-xl border border-aura-cyan/20\">\r\n                                    ЁЯФЧ {task.parentTitleDisplay}\r\n                                </span>\r\n                            )}\r\n                        </div>\r\n                        <div className={`px-2.5 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest border transition-colors ${task.priority === 'high' ? 'text-aura-red border-aura-red/30 bg-aura-red/10' :\r\n                            task.priority === 'medium' ? 'text-aura-gold border-aura-gold/30 bg-aura-gold/10' :\r\n                                'text-aura-cyan border-aura-cyan/30 bg-aura-cyan/10'\r\n                            }`}>\r\n                            {t.tasks[task.priority] || task.priority}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* TITLE & CHECKBOX */}\r\n                    <div className=\"flex gap-4\">\r\n                        <button\r\n                            onClick={(e) => { e.stopPropagation(); handleToggleStatus(task); }}\r\n                            className={`mt-1 flex-shrink-0 w-7 h-7 rounded-xl border-2 transition-all flex items-center justify-center ${task.status === 'done'\r\n                                ? 'bg-aura-green border-aura-green text-black scale-110'\r\n                                : 'border-white/20 hover:border-aura-cyan hover:bg-aura-cyan/10'\r\n                                }`}\r\n                        >\r\n                            {task.status === 'done' && <span className=\"font-black text-xs\">тЬУ</span>}\r\n                        </button>\r\n\r\n                        <div className=\"flex-1\" onClick={() => setFocusedTask(task)}>\r\n                            <h4 className={`font-display font-black text-lg leading-tight transition-all ${task.status === 'done' ? 'text-gray-600 line-through' : 'text-white group-hover:text-aura-cyan'}`}>\r\n                                {task.title}\r\n                            </h4>\r\n                            {task.description && (\r\n                                <p className=\"mt-2 text-[11px] text-gray-500 font-medium line-clamp-2 leading-relaxed opacity-80 group-hover:opacity-100 transition-opacity\">\r\n                                    {task.description}\r\n                                </p>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* FOOTER */}\r\n                    <div className=\"pt-4 flex flex-wrap gap-4 items-center text-[10px] font-mono font-bold text-gray-500 border-t border-white/5\">\r\n                        {task.startTime && (\r\n                            <div className=\"flex items-center gap-2 group-hover:text-aura-gold transition-colors\">\r\n                                <span>тП░</span>\r\n                                <span>{task.startTime} тАФ {task.endTime}</span>\r\n                            </div>\r\n                        )}\r\n                        {task.subtasks && task.subtasks.length > 0 && (\r\n                            <div className=\"flex items-center gap-2 text-aura-cyan ml-auto bg-aura-cyan/5 px-2 py-0.5 rounded-lg border border-aura-cyan/10\">\r\n                                <span>тЫУя╕П</span>\r\n                                <span>{task.subtasks.filter(s => s.status === 'done').length}/{task.subtasks.length}</span>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* HOVER ACTIONS - FLOATING PREMIUM OVERLAY (BOTTOM) */}\r\n                <div className=\"absolute -bottom-6 left-1/2 -translate-x-1/2 flex items-center gap-1.5 p-1.5 bg-[#0A0A0A] rounded-[1.5rem] border border-white/20 shadow-[0_10px_30px_rgba(0,0,0,0.5)] opacity-0 translate-y-2 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-300 z-50\">\r\n                    <button\r\n                        onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            setEditingTaskId(null);\r\n                            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                            setNewTask({ title: '', priority: task.priority, date: task.date || selectedDate, category: task.category, parentId: task.id, parentTitle: task.title } as any);\r\n                            setIsModalOpen(true);\r\n                        }}\r\n                        className=\"h-9 px-3 rounded-xl bg-white/10 hover:bg-aura-cyan hover:text-black text-white transition-all text-[9px] font-black uppercase tracking-widest flex items-center gap-2\"\r\n                        title={t.tasks.actions.subtask}\r\n                    >\r\n                        <span>+</span> {t.tasks.actions.subtask}\r\n                    </button>\r\n\r\n                    <button\r\n                        onClick={(e) => { e.stopPropagation(); setMoveTaskData({ isOpen: true, taskId: task.id, currentDate: task.date || selectedDate }); }}\r\n                        className=\"w-9 h-9 rounded-xl bg-white/10 hover:bg-white hover:text-black text-white transition-all flex items-center justify-center text-lg\"\r\n                        title={t.tasks.actions.move}\r\n                    >\r\n                        ЁЯЪЪ\r\n                    </button>\r\n\r\n                    {task.status !== 'done' && (\r\n                        <Link\r\n                            href={`/dashboard/focus?taskId=${task.id}&taskName=${encodeURIComponent(task.title)}`}\r\n                            prefetch={false}\r\n                            onClick={(e) => e.stopPropagation()}\r\n                            className=\"w-9 h-9 rounded-xl bg-aura-purple/20 hover:bg-aura-purple text-white transition-all flex items-center justify-center text-lg\"\r\n                            title={t.tasks.actions.focus}\r\n                        >\r\n                            ЁЯОп\r\n                        </Link>\r\n                    )}\r\n\r\n                    <div className=\"w-[1px] h-4 bg-white/10 mx-1\"></div>\r\n\r\n                    <button\r\n                        onClick={(e) => { e.stopPropagation(); handleOpenEditModal(task); }}\r\n                        className=\"w-9 h-9 rounded-xl bg-white/10 hover:bg-white hover:text-black text-white transition-all flex items-center justify-center text-lg\"\r\n                        title={t.tasks.actions.edit}\r\n                    >\r\n                        тЬПя╕П\r\n                    </button>\r\n                    <button\r\n                        onClick={(e) => { e.stopPropagation(); handleDeleteTask(task.id); }}\r\n                        className=\"w-9 h-9 rounded-xl bg-aura-red/10 hover:bg-aura-red hover:text-white text-aura-red transition-all flex items-center justify-center text-lg\"\r\n                        title={t.tasks.actions.delete}\r\n                    >\r\n                        ЁЯЧСя╕П\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    // Stats\r\n    const completedCount = todayTasks.filter(t => t.status === 'done').length;\r\n    const pendingCount = todayTasks.filter(t => t.status !== 'done').length;\r\n    const efficiency = todayTasks.length > 0 ? Math.round((completedCount / todayTasks.length) * 100) : 0;\r\n\r\n    // Helper for display\r\n    const getDisplayTasks = (colType: 'overdue' | 'today' | 'future') => {\r\n        // When focused, we need to include ALL tasks in the flattening source \r\n        // to find independent documents that point to the focused parent.\r\n        const source = focusedTask\r\n            ? Array.from(new Map([...todayTasks, ...overdueTasks, ...futureTasks, focusedTask].map(t => [t.id, t])).values())\r\n            : [...todayTasks, ...overdueTasks, ...futureTasks];\r\n\r\n        const flat = flattenTasksForColumn(source, colType);\r\n        return focusedTask ? flat.filter(t => t.id !== focusedTask.id) : flat;\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <div className=\"space-y-8 animate-fade-in relative\">\r\n\r\n                {/* SINGLE LINE HEADER (V9.1) */}\r\n                <div className=\"flex items-center justify-between gap-6 mb-8 relative z-20 bg-black/40 p-4 rounded-[2rem] border border-white/5 backdrop-blur-xl shadow-2xl\">\r\n                    <div className=\"flex items-center gap-6\">\r\n                        {focusedTask ? (\r\n                            <button\r\n                                onClick={async () => {\r\n                                    // Smart navigation: go back one level\r\n                                    if (focusedTask.parentId) {\r\n                                        // Find parent task and focus on it\r\n                                        const parentTask = [...todayTasks, ...overdueTasks, ...futureTasks].find(t => t.id === focusedTask.parentId);\r\n                                        if (parentTask) {\r\n                                            setFocusedTask(parentTask);\r\n                                        } else {\r\n                                            // Parent not found in memory, go back to dashboard\r\n                                            setFocusedTask(null);\r\n                                        }\r\n                                    } else {\r\n                                        // Root task, go back to dashboard\r\n                                        setFocusedTask(null);\r\n                                    }\r\n                                }}\r\n                                className=\"group flex items-center gap-3 px-4 py-2 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 text-white transition-all\"\r\n                            >\r\n                                <span className=\"text-lg group-hover:-translate-x-1 transition-transform\">тЖР</span>\r\n                                <div>\r\n                                    <h1 className=\"text-xl font-display font-black text-white tracking-tight leading-none\">\r\n                                        {focusedTask.title}\r\n                                    </h1>\r\n                                    <span className=\"text-[10px] text-aura-cyan font-black uppercase tracking-[0.2em]\">Focus View</span>\r\n                                </div>\r\n                            </button>\r\n                        ) : (\r\n                            <div>\r\n                                <h1 className=\"text-3xl font-display font-black text-white tracking-tighter flex items-center gap-2 leading-none\">\r\n                                    {t.tasks.title}\r\n                                </h1>\r\n                                <p className=\"text-gray-500 font-medium text-xs mt-1\">{t.tasks.subtitle}</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <DateNavigator selectedDate={selectedDate} onDateChange={setSelectedDate} />\r\n\r\n                        <div className=\"h-10 w-[1px] bg-white/10\"></div>\r\n\r\n                        <div className=\"flex bg-white/5 p-1 rounded-xl border border-white/10 backdrop-blur-md\">\r\n                            <button\r\n                                onClick={() => setViewMode('dashboard')}\r\n                                className={`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${viewMode === 'dashboard' ? 'bg-white text-black shadow-lg scale-105' : 'text-gray-500 hover:text-white'}`}\r\n                            >\r\n                                DASHBOARD\r\n                            </button>\r\n                            <button\r\n                                onClick={() => setViewMode('analytics')}\r\n                                className={`px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${viewMode === 'analytics' ? 'bg-aura-cyan text-black shadow-lg scale-105' : 'text-gray-500 hover:text-white'}`}\r\n                            >\r\n                                ANALYTICS\r\n                            </button>\r\n                        </div>\r\n\r\n                        <VoiceInput\r\n                            module=\"tasks\"\r\n                            onCommand={handleVoiceCommand}\r\n                            color=\"purple\"\r\n                            className={isArchived ? 'opacity-30 pointer-events-none' : ''}\r\n                        />\r\n\r\n                        <button\r\n                            onClick={() => {\r\n                                setEditingTaskId(null);\r\n                                setNewTask({\r\n                                    title: '',\r\n                                    priority: 'medium',\r\n                                    startTime: '09:00',\r\n                                    endTime: '10:00',\r\n                                    date: selectedDate,\r\n                                    category: focusedTask ? focusedTask.category : 'Asosiy',\r\n                                    subtasks: [],\r\n                                    resources: [],\r\n                                    parentId: focusedTask ? focusedTask.id : undefined,\r\n                                    parentTitle: focusedTask ? focusedTask.title : undefined\r\n                                } as any);\r\n                                setIsModalOpen(true);\r\n                            }}\r\n                            className=\"px-6 py-3 rounded-xl bg-aura-purple hover:bg-aura-purple/80 text-white font-black text-xs uppercase tracking-widest transition-all shadow-lg hover:shadow-aura-purple/20 hover:scale-105 active:scale-95 flex items-center gap-2\"\r\n                        >\r\n                            <span>+</span> {focusedTask ? \"qo'shimcha vazifa\" : t.tasks.newTask}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {isArchived && (\r\n                    <ReadOnlyBanner\r\n                        title={t.tasks.readOnly || \"Archive Mode\"}\r\n                        description={t.tasks.readOnlyDesc || \"Historical tasks are read-only.\"}\r\n                    />\r\n                )}\r\n\r\n                {/* AI Suggestion Block */}\r\n                {viewMode === 'dashboard' && !focusedTask && (\r\n                    <>\r\n                        {aiLoading ? (\r\n                            <div className=\"mb-12 p-8 rounded-[2.5rem] bg-white/5 border border-white/5 animate-pulse flex items-center justify-between gap-6\">\r\n                                <div className=\"flex items-center gap-8 w-full\">\r\n                                    <div className=\"w-20 h-20 rounded-3xl bg-white/10\"></div>\r\n                                    <div className=\"space-y-3 flex-1\">\r\n                                        <div className=\"w-32 h-4 bg-white/10 rounded-full\"></div>\r\n                                        <div className=\"w-full h-4 bg-white/10 rounded-full\"></div>\r\n                                        <div className=\"w-2/3 h-4 bg-white/10 rounded-full\"></div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        ) : aiInsight ? (\r\n                            <div className=\"mb-12 p-8 rounded-[2.5rem] bg-gradient-to-r from-aura-purple/20 via-black to-aura-cyan/10 border border-aura-purple/30 flex flex-col md:flex-row items-center justify-between gap-6 shadow-2xl shadow-aura-purple/10 relative overflow-hidden group\">\r\n                                <div className=\"absolute top-0 right-0 w-96 h-96 bg-aura-purple/10 rounded-full blur-[100px] -translate-y-1/2 translate-x-1/2 group-hover:bg-aura-purple/20 transition-all duration-700\"></div>\r\n                                <div className=\"flex items-center gap-8 relative z-10 w-full md:w-auto\">\r\n                                    <div className=\"w-20 h-20 rounded-3xl bg-aura-purple/20 flex items-center justify-center text-5xl shake-animation border border-aura-purple/30 shadow-inner flex-shrink-0\">\r\n                                        ЁЯдЦ\r\n                                    </div>\r\n                                    <div>\r\n                                        <div className=\"flex items-center gap-3 mb-2\">\r\n                                            <span className=\"px-3 py-1 rounded-full bg-aura-purple text-white text-[10px] font-black uppercase tracking-[0.2em]\">\r\n                                                {t.tasks.aiSuggestion.title}\r\n                                            </span>\r\n                                            <span className=\"text-gray-500 text-xs font-mono\">{new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</span>\r\n                                        </div>\r\n                                        <h3 className=\"text-sm font-bold text-white mb-2 max-w-2xl leading-relaxed\">\r\n                                            {aiInsight.suggestion || t.tasks.aiSuggestion.suggestion}\r\n                                        </h3>\r\n                                        <p className=\"text-gray-400 text-sm italic opacity-80\">{t.tasks.actions.focus}: &quot;{aiInsight.title || t.tasks.aiSuggestion.title}&quot;</p>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"relative z-10 flex flex-col items-center gap-2\">\r\n                                    <button\r\n                                        onClick={handleAddAISuggestion}\r\n                                        className=\"px-8 py-4 bg-white text-black rounded-2xl font-black uppercase tracking-widest hover:scale-105 active:scale-95 transition-all shadow-[0_0_40px_rgba(255,255,255,0.3)] flex items-center gap-2 group/btn\"\r\n                                    >\r\n                                        <span className=\"text-aura-purple group-hover/btn:rotate-12 transition-transform\">тЬи</span>\r\n                                        {t.tasks.aiSuggestion.add}\r\n                                        <span className=\"text-[10px] opacity-50 ml-1 block text-center\">+</span>\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        ) : null}\r\n                    </>\r\n                )}\r\n\r\n                {viewMode === 'dashboard' ? (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\r\n                        {/* OVERDUE COLUMN */}\r\n                        <div\r\n                            className=\"space-y-6\"\r\n                            onDragOver={handleDragOver}\r\n                            onDrop={(e) => {\r\n                                const prevDay = new Date(selectedDate);\r\n                                prevDay.setDate(prevDay.getDate() - 1);\r\n                                handleDrop(e, prevDay.toISOString().split('T')[0]);\r\n                            }}\r\n                        >\r\n                            <div className=\"flex items-center justify-between px-2\">\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div className=\"w-2 h-2 rounded-full bg-aura-red shadow-[0_0_10px_rgba(255,50,50,0.5)]\"></div>\r\n                                    <h2 className=\"text-sm font-black text-gray-400 uppercase tracking-[0.2em]\">{t.tasks.sections.overdue}</h2>\r\n                                </div>\r\n                                <span className=\"bg-aura-red/10 text-aura-red px-2 py-0.5 rounded text-[10px] font-bold\">\r\n                                    {getDisplayTasks('overdue').length}\r\n                                </span>\r\n                            </div>\r\n                            <div className={`space-y-4 min-h-[200px] p-4 rounded-[2.5rem] border-2 border-dashed transition-all duration-500 ${dragedTaskId ? 'bg-aura-red/5 border-aura-red/30 scale-[1.02] shadow-[0_0_50px_rgba(255,50,50,0.1)]' : 'border-white/5'}`}>\r\n                                {getDisplayTasks('overdue').map((task: any) => (\r\n                                    <div key={task.id} className=\"animate-fade-in-up\">\r\n                                        <TaskCard task={task} />\r\n                                    </div>\r\n                                ))}\r\n                                {getDisplayTasks('overdue').length === 0 && (\r\n                                    <div className=\"h-32 flex flex-col items-center justify-center text-gray-600 space-y-2 opacity-30\">\r\n                                        <div className=\"text-2xl\">ЁЯОЙ</div>\r\n                                        <div className=\"text-[10px] font-black uppercase tracking-[0.2em]\">Silliq</div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* TODAY COLUMN (Drop Zone) */}\r\n                        <div\r\n                            className=\"space-y-6\"\r\n                            onDragOver={handleDragOver}\r\n                            onDrop={(e) => handleDrop(e, selectedDate)}\r\n                        >\r\n                            <div className=\"flex items-center justify-between px-2\">\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div className=\"w-2.5 h-2.5 rounded-full bg-aura-cyan shadow-[0_0_15px_rgba(0,240,255,0.6)] animate-pulse\"></div>\r\n                                    <h2 className=\"text-sm font-black text-white uppercase tracking-[0.2em]\">{t.tasks.sections.today}</h2>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <span className=\"bg-aura-cyan/10 text-aura-cyan px-2.5 py-1 rounded-lg text-[10px] font-black border border-aura-cyan/20\">\r\n                                        {selectedDate}\r\n                                    </span>\r\n                                    <span className=\"bg-white/5 text-white px-2.5 py-1 rounded-lg text-[10px] font-black border border-white/10\">\r\n                                        {getDisplayTasks('today').length}\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                            <div className={`space-y-4 min-h-[400px] p-4 rounded-[2.5rem] transition-all duration-500 border-2 border-dashed ${dragedTaskId ? 'bg-aura-cyan/5 border-aura-cyan/30 scale-[1.02] shadow-[0_0_50px_rgba(0,240,255,0.1)]' : 'border-white/5'}`}>\r\n                                {getDisplayTasks('today').map((task: any) => (\r\n                                    <div key={task.id} className=\"animate-fade-in-up\">\r\n                                        <TaskCard task={task} />\r\n                                    </div>\r\n                                ))}\r\n                                {getDisplayTasks('today').length === 0 && (\r\n                                    <div className=\"h-full flex flex-col items-center justify-center text-gray-600 space-y-4 py-20 opacity-30\">\r\n                                        <div className=\"text-5xl\">ЁЯОп</div>\r\n                                        <span className=\"text-[10px] font-black uppercase tracking-[0.3em]\">{t.tasks.noTasks}</span>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* FUTURE COLUMN (Drop Zone) */}\r\n                        <div\r\n                            className=\"space-y-6\"\r\n                            onDragOver={handleDragOver}\r\n                            onDrop={(e) => {\r\n                                const nextDay = new Date(selectedDate);\r\n                                nextDay.setDate(nextDay.getDate() + 1);\r\n                                handleDrop(e, nextDay.toISOString().split('T')[0]);\r\n                            }}\r\n                        >\r\n                            <div className=\"flex items-center justify-between px-2\">\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div className=\"w-2.5 h-2.5 rounded-full bg-aura-purple shadow-[0_0_15px_rgba(157,78,221,0.6)]\"></div>\r\n                                    <h2 className=\"text-sm font-black text-gray-400 uppercase tracking-[0.2em]\">{t.tasks.sections.future}</h2>\r\n                                </div>\r\n                                <span className=\"bg-aura-purple/10 text-aura-purple px-2.5 py-1 rounded-lg text-[10px] font-black border border-aura-purple/20\">\r\n                                    {getDisplayTasks('future').length}\r\n                                </span>\r\n                            </div>\r\n                            <div className={`space-y-4 min-h-[200px] p-4 rounded-[2.5rem] border-2 border-dashed transition-all duration-500 ${dragedTaskId ? 'bg-aura-purple/5 border-aura-purple/30 scale-[1.02] shadow-[0_0_50px_rgba(157,78,221,0.1)]' : 'border-white/5'}`}>\r\n                                {getDisplayTasks('future').map((task: any) => (\r\n                                    <div key={task.id} className=\"animate-fade-in-up\">\r\n                                        <TaskCard task={task} />\r\n                                    </div>\r\n                                ))}\r\n                                {getDisplayTasks('future').length === 0 && (\r\n                                    <div className=\"h-32 flex flex-col items-center justify-center text-gray-600 space-y-2 opacity-30\">\r\n                                        <div className=\"text-2xl\">ЁЯУЕ</div>\r\n                                        <div className=\"text-[10px] font-black uppercase tracking-[0.2em]\">Rejalashtirilmagan</div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"space-y-8 animate-fade-in px-2\">\r\n                        {(() => {\r\n                            const aTasks = getAllRelatedTasks();\r\n                            const stats = getDeepSubtaskStats(aTasks);\r\n                            const aEfficiency = stats.total > 0 ? Math.round((stats.done / stats.total) * 100) : 0;\r\n                            const aOverdue = aTasks.filter(t => t.status !== 'done' && t.date && t.date < selectedDate).length;\r\n                            const aPending = stats.total - stats.done;\r\n                            const aTotal = stats.total;\r\n                            const aDone = stats.done;\r\n\r\n                            const todayStr = getLocalTodayStr();\r\n                            const aToday = Math.max(0, aTasks.filter(t => t.date === todayStr).length);\r\n                            const aFuture = Math.max(0, aTasks.filter(t => t.date && t.date > todayStr).length);\r\n\r\n                            return (\r\n                                <>\r\n                                    {/* TOP STATS CARDS */}\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\r\n                                        <div className=\"p-6 rounded-[2rem] bg-black/40 border border-white/5 backdrop-blur-xl group hover:border-white/10 transition-all\">\r\n                                            <h3 className=\"text-[10px] font-black uppercase tracking-[0.2em] text-gray-500 mb-2\">Jami Vazifalar</h3>\r\n                                            <div className=\"text-4xl font-display font-black text-white group-hover:text-aura-cyan transition-colors\">\r\n                                                {aTotal}\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"p-6 rounded-[2rem] bg-black/40 border border-white/5 backdrop-blur-xl border-aura-green/20 group hover:border-aura-green/40 transition-all\">\r\n                                            <h3 className=\"text-[10px] font-black uppercase tracking-[0.2em] text-aura-green mb-2\">Tugallangan</h3>\r\n                                            <div className=\"text-4xl font-display font-black text-aura-green\">\r\n                                                {aDone}\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"p-6 rounded-[2rem] bg-black/40 border border-white/5 backdrop-blur-xl border-aura-cyan/20 group hover:border-aura-cyan/40 transition-all\">\r\n                                            <h3 className=\"text-[10px] font-black uppercase tracking-[0.2em] text-aura-cyan mb-2\">Salmoqli (Todo)</h3>\r\n                                            <div className=\"text-4xl font-display font-black text-aura-cyan\">\r\n                                                {aPending}\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"p-6 rounded-[2rem] bg-black/40 border border-white/5 backdrop-blur-xl border-aura-red/20 group hover:border-aura-red/40 transition-all\">\r\n                                            <h3 className=\"text-[10px] font-black uppercase tracking-[0.2em] text-aura-red mb-2\">Muddati O'tgan</h3>\r\n                                            <div className=\"text-4xl font-display font-black text-aura-red\">\r\n                                                {aOverdue}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"flex gap-4 px-2\">\r\n                                        <div className=\"flex items-center gap-2 px-4 py-2 rounded-full bg-white/5 border border-white/5\">\r\n                                            <span className=\"text-[8px] font-black text-gray-500 uppercase tracking-widest\">Bugungi:</span>\r\n                                            <span className=\"text-xs font-black text-white\">{aToday}</span>\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-2 px-4 py-2 rounded-full bg-white/5 border border-white/5\">\r\n                                            <span className=\"text-[8px] font-black text-gray-500 uppercase tracking-widest\">Kelajak:</span>\r\n                                            <span className=\"text-xs font-black text-white\">{aFuture}</span>\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-2 px-4 py-2 rounded-full bg-aura-green/10 border border-aura-green/20 ml-auto\">\r\n                                            <span className=\"text-[8px] font-black text-aura-green uppercase tracking-widest\">Samaradorlik:</span>\r\n                                            <span className=\"text-xs font-black text-aura-green\">{aEfficiency}%</span>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-8\">\r\n                                        {/* LEFT COLUMN: PRIMARY STATS & HEATMAP */}\r\n                                        <div className=\"lg:col-span-8 space-y-8\">\r\n                                            {/* Productivity Score & Daily Trend */}\r\n                                            <div className=\"p-8 rounded-[3rem] bg-black/40 border border-white/5 backdrop-blur-3xl relative overflow-hidden group\">\r\n                                                <div className=\"absolute top-0 right-0 w-64 h-64 bg-aura-cyan/5 rounded-full blur-[100px] -translate-y-1/2 translate-x-1/2\"></div>\r\n\r\n                                                <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-8 relative z-10\">\r\n                                                    <div className=\"space-y-2\">\r\n                                                        <h2 className=\"text-xl font-display font-black text-white tracking-tight flex items-center gap-2\">\r\n                                                            <span className=\"w-2 h-2 rounded-full bg-aura-cyan animate-pulse\"></span>\r\n                                                            Productivity Pulse\r\n                                                        </h2>\r\n                                                        <p className=\"text-xs text-gray-500 font-medium tracking-wide uppercase\">Performance metrics for your current focus</p>\r\n                                                    </div>\r\n                                                    <div className=\"flex items-end gap-1\">\r\n                                                        <span className=\"text-6xl font-display font-black text-white leading-none\">{aEfficiency}</span>\r\n                                                        <span className=\"text-xl font-black text-aura-cyan mb-1.5\">%</span>\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                {/* HEATMAP / HOURLY ACTIVITY */}\r\n                                                <div className=\"mt-12 space-y-6\">\r\n                                                    <div className=\"flex justify-between items-end\">\r\n                                                        <h3 className=\"text-[10px] font-black uppercase tracking-[0.2em] text-gray-400\">Activity Heatmap</h3>\r\n                                                        <div className=\"flex items-center gap-4\">\r\n                                                            <div className=\"flex items-center gap-1.5 text-[8px] font-black uppercase tracking-widest text-gray-500\">\r\n                                                                <span>Kam</span>\r\n                                                                <div className=\"flex gap-1\">\r\n                                                                    <div className=\"w-2 h-2 rounded-sm bg-white/5\"></div>\r\n                                                                    <div className=\"w-2 h-2 rounded-sm bg-aura-purple/20\"></div>\r\n                                                                    <div className=\"w-2 h-2 rounded-sm bg-aura-purple/50\"></div>\r\n                                                                    <div className=\"w-2 h-2 rounded-sm bg-aura-purple\"></div>\r\n                                                                </div>\r\n                                                                <span>Ko&apos;p</span>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    <div className=\"grid grid-cols-12 md:grid-cols-24 gap-1.5 h-16\">\r\n                                                        {(() => {\r\n                                                            const aTasksSub = getAllRelatedTasks(true);\r\n                                                            return Array.from({ length: 24 }).map((_, hour) => {\r\n                                                                const tasksInHour = aTasksSub.filter(t => {\r\n                                                                    const startHour = parseInt(t.startTime?.split(':')[0] || '-1');\r\n                                                                    return startHour === hour;\r\n                                                                }).length;\r\n\r\n                                                                let intensityClass = \"bg-white/5\";\r\n                                                                if (tasksInHour > 0) intensityClass = \"bg-aura-purple/20\";\r\n                                                                if (tasksInHour > 1) intensityClass = \"bg-aura-purple/40 shadow-[0_0_10px_rgba(157,78,221,0.2)]\";\r\n                                                                if (tasksInHour > 2) intensityClass = \"bg-aura-purple/70 shadow-[0_0_15px_rgba(157,78,221,0.3)]\";\r\n                                                                if (tasksInHour >= 4) intensityClass = \"bg-aura-purple shadow-[0_0_20px_rgba(157,78,221,0.5)]\";\r\n\r\n                                                                return (\r\n                                                                    <div key={hour} className=\"group/hour relative h-full\">\r\n                                                                        <div className={`w-full h-full rounded-[0.5rem] transition-all duration-500 cursor-help ${intensityClass} hover:scale-110 hover:z-20`}></div>\r\n                                                                        <div className=\"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1.5 bg-white text-black text-[9px] font-black rounded-lg opacity-0 group-hover/hour:opacity-100 transition-all pointer-events-none whitespace-nowrap shadow-2xl z-30\">\r\n                                                                            {hour}:00 тАФ {tasksInHour} vazifa\r\n                                                                        </div>\r\n                                                                    </div>\r\n                                                                );\r\n                                                            });\r\n                                                        })()}\r\n                                                    </div>\r\n                                                    <div className=\"flex justify-between text-[8px] font-black text-gray-600 uppercase tracking-widest px-1\">\r\n                                                        <span>00:00</span>\r\n                                                        <span>06:00</span>\r\n                                                        <span>12:00</span>\r\n                                                        <span>18:00</span>\r\n                                                        <span>23:00</span>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            {/* Category breakdown & Progression */}\r\n                                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                                                <div className=\"p-8 rounded-[3rem] bg-black/40 border border-white/5 backdrop-blur-3xl\">\r\n                                                    <h3 className=\"text-sm font-black text-white uppercase tracking-[0.2em] mb-8 flex items-center gap-2\">\r\n                                                        <span className=\"text-aura-cyan\">ЁЯУВ</span> Top Categories\r\n                                                    </h3>\r\n                                                    <div className=\"space-y-5\">\r\n                                                        {(() => {\r\n                                                            const cats = Array.from(new Set(aTasks.map(t => t.category || focusedTask?.category || 'Boshqa'))).slice(0, 4);\r\n                                                            if (cats.length === 0 && focusedTask) cats.push(focusedTask.category || 'Boshqa');\r\n\r\n                                                            return cats.map(cat => {\r\n                                                                const catTasks = aTasks.filter(t => (t.category || focusedTask?.category || 'Boshqa') === cat);\r\n                                                                const catStats = getDeepSubtaskStats(catTasks);\r\n                                                                const catPercent = catStats.total > 0 ? Math.round((catStats.done / catStats.total) * 100) : 0;\r\n\r\n                                                                return (\r\n                                                                    <div key={cat} className=\"space-y-2 group/cat\">\r\n                                                                        <div className=\"flex justify-between items-end\">\r\n                                                                            <span className=\"text-[10px] font-black uppercase tracking-widest text-gray-500 group-hover/cat:text-white transition-colors\">{cat}</span>\r\n                                                                            <span className=\"text-[10px] font-black text-aura-cyan\">{catPercent}%</span>\r\n                                                                        </div>\r\n                                                                        <div className=\"h-1.5 w-full bg-white/5 rounded-full overflow-hidden border border-white/5\">\r\n                                                                            <div\r\n                                                                                className=\"h-full bg-aura-cyan shadow-[0_0_15px_rgba(0,240,255,0.3)] transition-all duration-1000\"\r\n                                                                                style={{ width: `${catPercent}%` }}\r\n                                                                            ></div>\r\n                                                                        </div>\r\n                                                                    </div>\r\n                                                                );\r\n                                                            });\r\n                                                        })()}\r\n                                                        {aTasks.length === 0 && (\r\n                                                            <div className=\"py-10 text-center text-gray-600 text-[10px] font-black uppercase tracking-[0.3em] opacity-30 italic\">No data available</div>\r\n                                                        )}\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                <div className=\"p-8 rounded-[3rem] bg-gradient-to-br from-aura-gold/10 to-transparent border border-white/5 backdrop-blur-3xl relative overflow-hidden\">\r\n                                                    <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-40 h-40 bg-aura-gold/5 rounded-full blur-[80px]\"></div>\r\n                                                    <h3 className=\"text-sm font-black text-white uppercase tracking-[0.2em] mb-8 flex items-center gap-2\">\r\n                                                        <span className=\"text-aura-gold\">тЪб</span> Momentum\r\n                                                    </h3>\r\n                                                    <div className=\"flex flex-col items-center justify-center py-4 space-y-4 relative z-10\">\r\n                                                        <div className=\"relative w-24 h-24 flex items-center justify-center\">\r\n                                                            <svg className=\"w-full h-full -rotate-90\">\r\n                                                                <circle cx=\"48\" cy=\"48\" r=\"44\" stroke=\"currentColor\" strokeWidth=\"6\" fill=\"transparent\" className=\"text-white/5\" />\r\n                                                                <circle cx=\"48\" cy=\"48\" r=\"44\" stroke=\"currentColor\" strokeWidth=\"6\" fill=\"transparent\" strokeDasharray={276} strokeDashoffset={276 - (276 * aEfficiency) / 100} className=\"text-aura-gold transition-all duration-1000\" />\r\n                                                            </svg>\r\n                                                            <span className=\"absolute inset-0 flex items-center justify-center text-2xl font-display font-black text-white\">{aEfficiency}%</span>\r\n                                                        </div>\r\n                                                        <div className=\"text-center\">\r\n                                                            <p className=\"text-[10px] font-black text-gray-500 uppercase tracking-widest\">Bajarilgan</p>\r\n                                                            <p className=\"text-xs font-black text-white mt-1\">{aDone} / {aTotal} vazifa</p>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {/* RIGHT COLUMN: PRIORITY & SUGGESTIONS */}\r\n                                        <div className=\"lg:col-span-4 space-y-8\">\r\n                                            {/* AI Intelligent Planner */}\r\n                                            {/* AI Intelligent Planner */}\r\n                                            <AiInsightSection\r\n                                                onAnalyze={fetchAiInsight}\r\n                                                isLoading={aiLoading}\r\n                                                insight={aiInsight}\r\n                                                title=\"AI Planner\"\r\n                                                description=\"Analyze your schedule and get smart recommendations for today.\"\r\n                                                buttonText={aiInsight ? \"Regenerate\" : \"Generate Plan\"}\r\n                                                color=\"cyan\"\r\n                                            >\r\n                                                <button\r\n                                                    onClick={handleAddAISuggestion}\r\n                                                    className=\"w-full py-3 rounded-xl bg-aura-cyan text-black font-black text-xs uppercase tracking-widest hover:bg-white transition-all flex items-center justify-center gap-2\"\r\n                                                >\r\n                                                    <span>+</span> &quot;Add to Tasks&quot;\r\n                                                </button>\r\n                                            </AiInsightSection>\r\n                                            {/* Priority Distribution */}\r\n                                            <div className=\"p-8 rounded-[3rem] bg-black/40 border border-white/5 backdrop-blur-3xl\">\r\n                                                <h3 className=\"text-sm font-black text-white uppercase tracking-[0.2em] mb-8\">Priority Mix</h3>\r\n                                                <div className=\"space-y-6\">\r\n                                                    {(() => {\r\n                                                        const priorities = [\r\n                                                            { label: 'High', key: 'high', color: 'bg-aura-red', text: 'text-aura-red' },\r\n                                                            { label: 'Medium', key: 'medium', color: 'bg-aura-gold', text: 'text-aura-gold' },\r\n                                                            { label: 'Low', key: 'low', color: 'bg-aura-cyan', text: 'text-aura-cyan' }\r\n                                                        ];\r\n\r\n                                                        return priorities.map(p => {\r\n                                                            const count = aTasks.filter(t => t.priority === p.key).length;\r\n                                                            const percent = aTotal > 0 ? Math.round((count / aTotal) * 100) : 0;\r\n\r\n                                                            return (\r\n                                                                <div key={p.key} className=\"flex items-center gap-4 group\">\r\n                                                                    <div className={`w-12 text-[10px] font-black uppercase tracking-widest ${p.text}`}>{p.label}</div>\r\n                                                                    <div className=\"flex-1 h-3 bg-white/5 rounded-full overflow-hidden p-0.5 border border-white/5\">\r\n                                                                        <div\r\n                                                                            className={`h-full ${p.color} rounded-full transition-all duration-700 shadow-[0_0_10px_rgba(0,0,0,0.5)]`}\r\n                                                                            style={{ width: `${percent}%` }}\r\n                                                                        ></div>\r\n                                                                    </div>\r\n                                                                    <div className=\"text-[10px] font-mono font-bold text-gray-500 w-8\">{count}</div>\r\n                                                                </div>\r\n                                                            );\r\n                                                        });\r\n                                                    })()}\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            {/* Intelligent Guard (AI Insights) */}\r\n                                            <div className=\"p-8 rounded-[3rem] bg-gradient-to-br from-aura-purple/20 via-black/40 to-transparent border border-aura-purple/30 backdrop-blur-3xl relative overflow-hidden group\">\r\n                                                <div className=\"absolute -top-10 -right-10 w-32 h-32 bg-aura-purple/20 rounded-full blur-[50px] group-hover:bg-aura-purple/30 transition-all duration-700\"></div>\r\n\r\n                                                <div className=\"flex items-center gap-3 mb-6 relative z-10\">\r\n                                                    <div className=\"w-10 h-10 rounded-2xl bg-aura-purple/20 flex items-center justify-center text-xl border border-aura-purple/30\">ЁЯТб</div>\r\n                                                    <h3 className=\"text-sm font-black text-white uppercase tracking-[0.2em]\">AI Guard</h3>\r\n                                                </div>\r\n\r\n                                                <div className=\"space-y-4 relative z-10\">\r\n                                                    {(() => {\r\n                                                        const aOverdueList = aTasks.filter(t => t.status !== 'done' && t.date && t.date < selectedDate);\r\n                                                        const aDoneList = aTasks.filter(t => t.status === 'done');\r\n                                                        const progress = aTotal > 0 ? (aDoneList.length / aTotal) : 0;\r\n\r\n                                                        return (\r\n                                                            <>\r\n                                                                {aOverdueList.length > 0 ? (\r\n                                                                    <div className=\"p-4 rounded-2xl bg-aura-red/5 border border-aura-red/20 space-y-3\">\r\n                                                                        <p className=\"text-[11px] text-gray-400 leading-relaxed\">\r\n                                                                            <span className=\"text-aura-red font-black\">DIQQAT:</span> {aOverdueList.length} ta vazifa kechikmoqda.\r\n                                                                        </p>\r\n                                                                        <button\r\n                                                                            onClick={async () => {\r\n                                                                                const tomorrow = new Date();\r\n                                                                                tomorrow.setDate(tomorrow.getDate() + 1);\r\n                                                                                const tStr = tomorrow.toISOString().split('T')[0];\r\n                                                                                for (const t of aOverdueList) await moveTask(user!.uid, t.id, tStr);\r\n                                                                                loadTasks();\r\n                                                                            }}\r\n                                                                            className=\"w-full py-2.5 bg-aura-red text-white rounded-xl text-[9px] font-black uppercase tracking-widest hover:scale-105 transition-all shadow-lg shadow-aura-red/20\"\r\n                                                                        >\r\n                                                                            Move to Tomorrow\r\n                                                                        </button>\r\n                                                                    </div>\r\n                                                                ) : progress > 0.8 ? (\r\n                                                                    <div className=\"p-4 rounded-2xl bg-aura-green/5 border border-aura-green/20\">\r\n                                                                        <p className=\"text-[11px] text-gray-400 leading-relaxed\">\r\n                                                                            <span className=\"text-aura-green font-black\">AJOYIB:</span> Siz deyarli maqsadingizga etdingiz!\r\n                                                                        </p>\r\n                                                                    </div>\r\n                                                                ) : (\r\n                                                                    <div className=\"p-4 rounded-2xl bg-white/5 border border-white/5\">\r\n                                                                        <p className=\"text-[11px] text-gray-400 leading-relaxed\">\r\n                                                                            Hozircha ishlaringiz reja bo&apos;yicha ketmoqda.\r\n                                                                        </p>\r\n                                                                    </div>\r\n                                                                )}\r\n                                                            </>\r\n                                                        );\r\n                                                    })()}\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </>\r\n                            )\r\n                        })()}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <Modal\r\n                isOpen={isModalOpen}\r\n                onClose={handleCloseModal}\r\n                title={editingTaskId ? \"Vazifani tahrirlash\" : ((newTask as any).parentId ? \"Qo'shimcha vazifa qo'shish\" : t.tasks.newTask)}\r\n            >\r\n                <div className=\"space-y-6 max-h-[70vh] overflow-y-auto pr-4 custom-scrollbar\">\r\n                    <div className=\"space-y-1\">\r\n                        <label className=\"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-black ml-1\">{t.tasks.taskName}</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Masalan: Fizika kitobini o'qish\"\r\n                            className=\"w-full bg-white/5 border border-white/10 rounded-2xl px-5 py-4 text-white focus:border-aura-cyan focus:outline-none transition-all placeholder:text-gray-700\"\r\n                            value={newTask.title}\r\n                            onChange={e => setNewTask({ ...newTask, title: e.target.value })}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-1\">\r\n                        <label className=\"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-black ml-1\">Batafsil ma&apos;lumot</label>\r\n                        <textarea\r\n                            placeholder=\"Vazifa haqida qo'shimcha...\"\r\n                            className=\"w-full bg-white/5 border border-white/10 rounded-2xl px-5 py-4 text-white focus:border-aura-cyan focus:outline-none h-24 resize-none transition-all placeholder:text-gray-700\"\r\n                            value={newTask.description}\r\n                            onChange={e => setNewTask({ ...newTask, description: e.target.value })}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-3 gap-2 p-1 bg-white/5 rounded-2xl border border-white/10\">\r\n                        {(['low', 'medium', 'high'] as Priority[]).map((p) => (\r\n                            <button\r\n                                key={p}\r\n                                onClick={() => setNewTask({ ...newTask, priority: p })}\r\n                                className={`py-3 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${newTask.priority === p ? getPriorityColor(p) + ' shadow-lg scale-105' : 'text-gray-500 hover:text-white hover:bg-white/5'}`}\r\n                            >\r\n                                {t.tasks[p] || p}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-black ml-1\">Sana (Date)</label>\r\n                            <input\r\n                                type=\"date\"\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-2xl px-5 py-4 text-white focus:border-aura-cyan focus:outline-none [color-scheme:dark]\"\r\n                                value={newTask.date}\r\n                                onChange={e => setNewTask({ ...newTask, date: e.target.value })}\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-black ml-1\">Kategoriya</label>\r\n                            <select\r\n                                className=\"w-full bg-[#1a1a1a] border border-white/10 rounded-2xl px-5 py-4 text-white focus:border-aura-cyan focus:outline-none appearance-none cursor-pointer [color-scheme:dark]\"\r\n                                value={newTask.category}\r\n                                onChange={e => setNewTask({ ...newTask, category: e.target.value })}\r\n                            >\r\n                                <option value=\"Asosiy\" className=\"bg-[#1a1a1a] text-white py-2\">Asosiy</option>\r\n                                <option value=\"Ish\" className=\"bg-[#1a1a1a] text-white py-2\">Ish</option>\r\n                                <option value=\"O'qish\" className=\"bg-[#1a1a1a] text-white py-2\">O&apos;qish</option>\r\n                                <option value=\"Shaxsiy\" className=\"bg-[#1a1a1a] text-white py-2\">Shaxsiy</option>\r\n                                <option value=\"Sog'liq\" className=\"bg-[#1a1a1a] text-white py-2\">Sog&apos;liq</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-black ml-1\">{t.tasks.startTime}</label>\r\n                            <input\r\n                                type=\"time\"\r\n                                value={newTask.startTime}\r\n                                onChange={e => setNewTask({ ...newTask, startTime: e.target.value })}\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-2xl px-5 py-4 text-white focus:border-aura-cyan focus:outline-none\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-[10px] text-gray-500 uppercase tracking-[0.2em] font-black ml-1\">{t.tasks.endTime}</label>\r\n                            <input\r\n                                type=\"time\"\r\n                                value={newTask.endTime}\r\n                                onChange={e => setNewTask({ ...newTask, endTime: e.target.value })}\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-2xl px-5 py-4 text-white focus:border-aura-cyan focus:outline-none\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <button\r\n                        onClick={handleSaveTask}\r\n                        className=\"w-full py-5 bg-aura-cyan text-black font-black uppercase tracking-[0.2em] rounded-2xl hover:shadow-[0_0_30px_rgba(0,240,255,0.4)] transition-all mt-8 active:scale-[0.98] shadow-2xl\"\r\n                    >\r\n                        {editingTaskId ? \"O'zgarishlarni Saqlash\" : \"Vazifani Yaratish\"}\r\n                    </button>\r\n                </div>\r\n            </Modal>\r\n\r\n\r\n\r\n            <ConfirmationModal\r\n                isOpen={confirmModal.isOpen}\r\n                onClose={() => setConfirmModal(prev => ({ ...prev, isOpen: false }))}\r\n                onConfirm={confirmModal.onConfirm}\r\n                title={confirmModal.title}\r\n                message={confirmModal.message}\r\n                type={confirmModal.type}\r\n            />\r\n\r\n            <Modal\r\n                isOpen={moveTaskData?.isOpen || false}\r\n                onClose={() => setMoveTaskData(null)}\r\n                title=\"\"\r\n                className=\"max-w-md\"\r\n            >\r\n                <div className=\"text-center space-y-6 pt-4 pb-2\">\r\n                    <div className=\"w-20 h-20 rounded-3xl mx-auto flex items-center justify-center text-4xl bg-aura-cyan/20 border border-aura-cyan/30 text-aura-cyan shadow-inner\">\r\n                        ЁЯЪЪ\r\n                    </div>\r\n                    <div>\r\n                        <h3 className=\"text-2xl font-display font-black text-white tracking-tight mb-2\">\r\n                            Vazifani ko&apos;chirish\r\n                        </h3>\r\n                        <p className=\"text-gray-400 text-sm\">Vazifa uchun yangi vaqtni tanlang:</p>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-1 gap-3 px-2\">\r\n                        {[\r\n                            { label: 'Bugunga o\\'tkazish', icon: 'тШАя╕П', date: getLocalTodayStr(), color: 'bg-aura-cyan text-black' },\r\n                            { label: 'Ertaga o\\'tkazish', icon: 'ЁЯЪА', date: new Date(Date.now() + 86400000).toISOString().split('T')[0], color: 'bg-white/10 text-white' },\r\n                            { label: 'Keyingi haftaga', icon: 'ЁЯУЕ', date: new Date(Date.now() + 7 * 86400000).toISOString().split('T')[0], color: 'bg-white/5 text-gray-400' },\r\n                            { label: 'Taqvimdan tanlash', icon: 'ЁЯЧУя╕П', date: 'custom', color: 'bg-white/5 text-gray-400 border-dashed border-white/10' }\r\n                        ].map((opt) => (\r\n                            <button\r\n                                key={opt.label}\r\n                                onClick={() => {\r\n                                    if (opt.date === 'custom') {\r\n                                        setMoveTaskData(null);\r\n                                        setIsCalendarOpen(true);\r\n                                    } else if (moveTaskData) {\r\n                                        handleMoveToDate(moveTaskData.taskId, opt.date);\r\n                                        setMoveTaskData(null);\r\n                                    }\r\n                                }}\r\n                                className={`flex items-center justify-between p-4 rounded-2xl font-bold transition-all hover:scale-[1.02] active:scale-[0.98] border border-transparent ${opt.color}`}\r\n                            >\r\n                                <span className=\"flex items-center gap-3\">\r\n                                    <span className=\"text-xl\">{opt.icon}</span>\r\n                                    {opt.label}\r\n                                </span>\r\n                                <span className=\"text-xs opacity-50\">{opt.date !== 'custom' ? opt.date : ''}</span>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </Modal>\r\n            <HistoryModal isOpen={isHistoryOpen} onClose={() => setIsHistoryOpen(false)} title=\"Arxiv\" >\r\n                <div className=\"p-8 text-center text-gray-500 uppercase tracking-widest text-[10px] font-black opacity-30\">Arxiv bo&apos;sh</div>\r\n            </HistoryModal>\r\n        </>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\i18n\\translations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\login\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[798,801],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[798,801],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":48,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1793,1796],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1793,1796],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":122,"column":24,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[6344,6389],"text":"\r\n                    Don&apos;t have an account? "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[6344,6389],"text":"\r\n                    Don&lsquo;t have an account? "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[6344,6389],"text":"\r\n                    Don&#39;t have an account? "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[6344,6389],"text":"\r\n                    Don&rsquo;t have an account? "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { useState } from \"react\";\r\nimport { useAuth } from \"@/context/AuthContext\";\r\nimport { useLanguage } from \"@/context/LanguageContext\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\nexport default function LoginPage() {\r\n    const { t } = useLanguage();\r\n    const { signIn, signInWithGoogle } = useAuth();\r\n    const router = useRouter();\r\n    const [email, setEmail] = useState(\"\");\r\n    const [pass, setPass] = useState(\"\");\r\n    const [error, setError] = useState(\"\");\r\n\r\n    const [showPass, setShowPass] = useState(false);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        try {\r\n            await signIn(email, pass);\r\n            router.push(\"/dashboard\");\r\n        } catch (err: any) {\r\n            setError(err.message);\r\n        }\r\n    };\r\n\r\n    const handleGoogle = async () => {\r\n        try {\r\n            await signInWithGoogle();\r\n            // Ensure user data is saved to Firestore\r\n            const { getAuth } = await import('firebase/auth');\r\n            const { setDocument } = await import('@/services/db');\r\n            const auth = getAuth();\r\n            const googleUser = auth.currentUser;\r\n            if (googleUser) {\r\n                await setDocument(\"users\", googleUser.uid, {\r\n                    uid: googleUser.uid,\r\n                    email: googleUser.email || \"\",\r\n                    fullName: googleUser.displayName || \"\",\r\n                    displayName: googleUser.displayName || \"\",\r\n                    photoURL: googleUser.photoURL || \"\",\r\n                    memberSince: new Date().toISOString(),\r\n                    plan: \"Free\"\r\n                });\r\n            }\r\n            router.push(\"/dashboard\");\r\n        } catch (err: any) {\r\n            setError(err.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen flex items-center justify-center bg-[#0a0a0a] text-white relative overflow-hidden p-4\">\r\n            {/* Back Button */}\r\n            <Link\r\n                href=\"/\"\r\n                prefetch={false}\r\n                className=\"absolute top-8 left-8 flex items-center gap-2 text-gray-400 hover:text-white transition-colors z-20 group\"\r\n            >\r\n                <span className=\"group-hover:-translate-x-1 transition-transform\">тЖР</span>\r\n                {t.common.back || 'Back'}\r\n            </Link>\r\n\r\n            {/* Background Effects */}\r\n            <div className=\"absolute top-[-10%] left-[-10%] w-[500px] h-[500px] bg-aura-blue/20 rounded-full blur-[100px]\"></div>\r\n            <div className=\"absolute bottom-[-10%] right-[-10%] w-[500px] h-[500px] bg-aura-purple/20 rounded-full blur-[100px]\"></div>\r\n\r\n            <div className=\"w-full max-w-md p-8 rounded-[2.5rem] bg-white/5 border border-white/10 backdrop-blur-xl z-10 shadow-2xl\">\r\n                <h1 className=\"text-4xl font-display font-bold text-center mb-2 bg-clip-text text-transparent bg-gradient-to-r from-white via-white to-white/50\">Welcome Back</h1>\r\n                <p className=\"text-gray-400 text-center mb-10\">Access your Life OS</p>\r\n\r\n                {error && <div className=\"p-4 mb-6 rounded-2xl bg-aura-red/10 border border-aura-red/30 text-aura-red text-sm animate-shake\">{error}</div>}\r\n\r\n                <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n                    <div>\r\n                        <label className=\"block text-[10px] uppercase tracking-[0.2em] text-gray-500 mb-2 ml-1\">Email Address</label>\r\n                        <input\r\n                            type=\"email\"\r\n                            required\r\n                            value={email}\r\n                            onChange={(e) => setEmail(e.target.value)}\r\n                            className=\"w-full p-4 rounded-2xl bg-black/40 border border-white/5 focus:border-aura-cyan/50 focus:outline-none transition-all placeholder:text-gray-700\"\r\n                            placeholder=\"you@example.com\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"relative\">\r\n                        <label className=\"block text-[10px] uppercase tracking-[0.2em] text-gray-500 mb-2 ml-1\">Password</label>\r\n                        <input\r\n                            type={showPass ? \"text\" : \"password\"}\r\n                            required\r\n                            value={pass}\r\n                            onChange={(e) => setPass(e.target.value)}\r\n                            className=\"w-full p-4 pr-12 rounded-2xl bg-black/40 border border-white/5 focus:border-aura-cyan/50 focus:outline-none transition-all placeholder:text-gray-700\"\r\n                            placeholder=\"тАвтАвтАвтАвтАвтАвтАвтАв\"\r\n                        />\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={() => setShowPass(!showPass)}\r\n                            className=\"absolute right-4 bottom-4 text-gray-500 hover:text-white transition-colors\"\r\n                        >\r\n                            {showPass ? 'ЁЯСБя╕П' : 'ЁЯФТ'}\r\n                        </button>\r\n                    </div>\r\n\r\n                    <button type=\"submit\" className=\"w-full py-4 rounded-2xl bg-gradient-to-r from-aura-cyan to-aura-blue text-black font-bold hover:scale-[1.02] active:scale-[0.98] transition-all shadow-[0_0_30px_rgba(0,240,255,0.3)]\">\r\n                        Sign In with Email\r\n                    </button>\r\n                </form>\r\n\r\n                <div className=\"relative my-10 text-center\">\r\n                    <div className=\"absolute inset-0 flex items-center\"><div className=\"w-full border-t border-white/5\"></div></div>\r\n                    <span className=\"relative px-6 bg-[#0a0a0a] text-[10px] uppercase tracking-widest text-gray-600\">Secure Access</span>\r\n                </div>\r\n\r\n                <button onClick={handleGoogle} className=\"w-full py-4 rounded-2xl bg-white/5 border border-white/10 hover:bg-white/10 transition-all flex items-center justify-center gap-3 font-bold group\">\r\n                    <span className=\"w-6 h-6 bg-white rounded-lg flex items-center justify-center text-black text-xs\">G</span>\r\n                    <span>Sign In with Google</span>\r\n                </button>\r\n\r\n                <p className=\"text-center mt-8 text-sm text-gray-500\">\r\n                    Don't have an account? <Link href=\"/register\" prefetch={false} className=\"text-aura-cyan hover:text-white transition-colors font-medium\">Sign up</Link>\r\n                </p>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\app\\register\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used.","line":11,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":43},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":43,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1702,1705],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1702,1705],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'result' is assigned a value but never used.","line":50,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":50,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":67,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2642,2645],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2642,2645],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":96,"column":115,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[4352,4374],"text":"To&apos;liq Ism / Full Name"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[4352,4374],"text":"To&lsquo;liq Ism / Full Name"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[4352,4374],"text":"To&#39;liq Ism / Full Name"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[4352,4374],"text":"To&rsquo;liq Ism / Full Name"},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { useState } from \"react\";\r\nimport { useAuth } from \"@/context/AuthContext\";\r\nimport { useLanguage } from \"@/context/LanguageContext\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { setDocument } from \"@/services/db\";\r\n\r\nexport default function RegisterPage() {\r\n    const { t } = useLanguage();\r\n    const { signUp, signInWithGoogle, user } = useAuth();\r\n    const router = useRouter();\r\n    const [fullName, setFullName] = useState(\"\");\r\n    const [email, setEmail] = useState(\"\");\r\n    const [pass, setPass] = useState(\"\");\r\n    const [error, setError] = useState(\"\");\r\n    const [showPass, setShowPass] = useState(false);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!fullName.trim()) {\r\n            setError(\"Iltimos, to'liq ismingizni kiriting\");\r\n            return;\r\n        }\r\n        try {\r\n            await signUp(email, pass);\r\n            // Save the full name to Firestore immediately after signup\r\n            // We need to get the user ID from Firebase Auth\r\n            const { getAuth } = await import('firebase/auth');\r\n            const auth = getAuth();\r\n            const newUser = auth.currentUser;\r\n            if (newUser) {\r\n                await setDocument(\"users\", newUser.uid, {\r\n                    uid: newUser.uid,\r\n                    email: email,\r\n                    fullName: fullName.trim(),\r\n                    displayName: fullName.trim(),\r\n                    memberSince: new Date().toISOString(),\r\n                    plan: \"Free\"\r\n                });\r\n            }\r\n            router.push(\"/dashboard\");\r\n        } catch (err: any) {\r\n            setError(err.message);\r\n        }\r\n    };\r\n\r\n    const handleGoogle = async () => {\r\n        try {\r\n            const result = await signInWithGoogle();\r\n            // Save Google displayName to Firestore\r\n            const { getAuth } = await import('firebase/auth');\r\n            const auth = getAuth();\r\n            const googleUser = auth.currentUser;\r\n            if (googleUser) {\r\n                await setDocument(\"users\", googleUser.uid, {\r\n                    uid: googleUser.uid,\r\n                    email: googleUser.email || \"\",\r\n                    fullName: googleUser.displayName || \"\",\r\n                    displayName: googleUser.displayName || \"\",\r\n                    photoURL: googleUser.photoURL || \"\",\r\n                    memberSince: new Date().toISOString(),\r\n                    plan: \"Free\"\r\n                });\r\n            }\r\n            router.push(\"/dashboard\");\r\n        } catch (err: any) {\r\n            setError(err.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen flex items-center justify-center bg-[#0a0a0a] text-white relative overflow-hidden p-4\">\r\n            {/* Back Button */}\r\n            <Link\r\n                href=\"/\"\r\n                prefetch={false}\r\n                className=\"absolute top-8 left-8 flex items-center gap-2 text-gray-400 hover:text-white transition-colors z-20 group\"\r\n            >\r\n                <span className=\"group-hover:-translate-x-1 transition-transform\">тЖР</span>\r\n                {t.common.back || 'Back'}\r\n            </Link>\r\n\r\n            {/* Background Effects */}\r\n            <div className=\"absolute top-[-10%] right-[-10%] w-[500px] h-[500px] bg-aura-cyan/20 rounded-full blur-[100px]\"></div>\r\n            <div className=\"absolute bottom-[-10%] left-[-10%] w-[500px] h-[500px] bg-aura-gold/20 rounded-full blur-[100px]\"></div>\r\n\r\n            <div className=\"w-full max-w-md p-8 rounded-[2.5rem] bg-white/5 border border-white/10 backdrop-blur-xl z-10 shadow-2xl\">\r\n                <h1 className=\"text-4xl font-display font-bold text-center mb-2 bg-clip-text text-transparent bg-gradient-to-r from-white via-white to-white/50\">Join AURA</h1>\r\n                <p className=\"text-gray-400 text-center mb-10\">Begin your Life OS journey</p>\r\n\r\n                {error && <div className=\"p-4 mb-6 rounded-2xl bg-aura-red/10 border border-aura-red/30 text-aura-red text-sm animate-shake\">{error}</div>}\r\n\r\n                <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n                    <div>\r\n                        <label className=\"block text-[10px] uppercase tracking-[0.2em] text-gray-500 mb-2 ml-1\">To'liq Ism / Full Name</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            required\r\n                            value={fullName}\r\n                            onChange={(e) => setFullName(e.target.value)}\r\n                            className=\"w-full p-4 rounded-2xl bg-black/40 border border-white/5 focus:border-aura-cyan/50 focus:outline-none transition-all placeholder:text-gray-700\"\r\n                            placeholder=\"Ism Familiya\"\r\n                        />\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"block text-[10px] uppercase tracking-[0.2em] text-gray-500 mb-2 ml-1\">Email Address</label>\r\n                        <input\r\n                            type=\"email\"\r\n                            required\r\n                            value={email}\r\n                            onChange={(e) => setEmail(e.target.value)}\r\n                            className=\"w-full p-4 rounded-2xl bg-black/40 border border-white/5 focus:border-aura-cyan/50 focus:outline-none transition-all placeholder:text-gray-700\"\r\n                            placeholder=\"you@example.com\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"relative\">\r\n                        <label className=\"block text-[10px] uppercase tracking-[0.2em] text-gray-500 mb-2 ml-1\">Password</label>\r\n                        <input\r\n                            type={showPass ? \"text\" : \"password\"}\r\n                            required\r\n                            value={pass}\r\n                            onChange={(e) => setPass(e.target.value)}\r\n                            className=\"w-full p-4 pr-12 rounded-2xl bg-black/40 border border-white/5 focus:border-aura-cyan/50 focus:outline-none transition-all placeholder:text-gray-700\"\r\n                            placeholder=\"тАвтАвтАвтАвтАвтАвтАвтАв\"\r\n                        />\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={() => setShowPass(!showPass)}\r\n                            className=\"absolute right-4 bottom-4 text-gray-500 hover:text-white transition-colors\"\r\n                        >\r\n                            {showPass ? 'ЁЯСБя╕П' : 'ЁЯФТ'}\r\n                        </button>\r\n                    </div>\r\n\r\n                    <button type=\"submit\" className=\"w-full py-4 rounded-2xl bg-gradient-to-r from-aura-cyan to-aura-blue text-black font-bold hover:scale-[1.02] active:scale-[0.98] transition-all shadow-[0_0_30px_rgba(0,240,255,0.3)]\">\r\n                        Create Account\r\n                    </button>\r\n                </form>\r\n\r\n                <div className=\"relative my-10 text-center\">\r\n                    <div className=\"absolute inset-0 flex items-center\"><div className=\"w-full border-t border-white/5\"></div></div>\r\n                    <span className=\"relative px-6 bg-[#0a0a0a] text-[10px] uppercase tracking-widest text-gray-600\">Secure Registration</span>\r\n                </div>\r\n\r\n                <button onClick={handleGoogle} className=\"w-full py-4 rounded-2xl bg-white/5 border border-white/10 hover:bg-white/10 transition-all flex items-center justify-center gap-3 font-bold group\">\r\n                    <span className=\"w-6 h-6 bg-white rounded-lg flex items-center justify-center text-black text-xs\">G</span>\r\n                    <span>Sign Up with Google</span>\r\n                </button>\r\n\r\n                <p className=\"text-center mt-8 text-sm text-gray-500\">\r\n                    Already have an account? <Link href=\"/login\" prefetch={false} className=\"text-aura-cyan hover:text-white transition-colors font-medium\">Sign in</Link>\r\n                </p>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\AlertModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\AmbientSound.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\ButterflyEffectWidget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\CalendarModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":15,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":14},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nD:\\AURA\\web\\src\\components\\CalendarModal.tsx:16:71\n  14 | export default function CalendarModal({ isOpen, onClose, onDateSelect, selectedDate }: CalendarModalProps) {\n  15 |     const { t } = useLanguage();\n> 16 |     const [viewDate, setViewDate] = useState(new Date(selectedDate || Date.now()));\n     |                                                                       ^^^^^^^^^^ Cannot call impure function\n  17 |\n  18 |     const currentMonth = viewDate.getMonth();\n  19 |     const currentYear = viewDate.getFullYear();","line":16,"column":71,"nodeType":null,"endLine":16,"endColumn":81}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { useState, useMemo } from 'react';\r\nimport { useLanguage } from '@/context/LanguageContext';\r\nimport Modal from './Modal';\r\nimport { getLocalTodayStr } from '@/lib/dateUtils';\r\n\r\ninterface CalendarModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onDateSelect: (date: string) => void;\r\n    selectedDate: string;\r\n}\r\n\r\nexport default function CalendarModal({ isOpen, onClose, onDateSelect, selectedDate }: CalendarModalProps) {\r\n    const { t } = useLanguage();\r\n    const [viewDate, setViewDate] = useState(new Date(selectedDate || Date.now()));\r\n\r\n    const currentMonth = viewDate.getMonth();\r\n    const currentYear = viewDate.getFullYear();\r\n\r\n    const monthData = useMemo(() => {\r\n        const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();\r\n        const firstDay = new Date(currentYear, currentMonth, 1).getDay();\r\n\r\n        // Adjust firstDay for Monday start if preferred, but keeping standard for now\r\n        // To make Monday index 0: (firstDay === 0 ? 6 : firstDay - 1)\r\n        const offset = (firstDay === 0 ? 6 : firstDay - 1);\r\n\r\n        const days = [];\r\n        for (let i = 0; i < offset; i++) days.push(null);\r\n        for (let i = 1; i <= daysInMonth; i++) days.push(i);\r\n        return days;\r\n    }, [currentMonth, currentYear]);\r\n\r\n    const changeMonth = (offset: number) => {\r\n        const d = new Date(viewDate);\r\n        d.setMonth(d.getMonth() + offset);\r\n        setViewDate(d);\r\n    };\r\n\r\n    const monthNames = [\r\n        \"Yanvar\", \"Fevral\", \"Mart\", \"Aprel\", \"May\", \"Iyun\",\r\n        \"Iyul\", \"Avgust\", \"Sentyabr\", \"Oktyabr\", \"Noyabr\", \"Dekabr\"\r\n    ];\r\n\r\n    const weekDays = ['Du', 'Se', 'Ch', 'Pa', 'Ju', 'Sh', 'Ya'];\r\n\r\n    return (\r\n        <Modal\r\n            isOpen={isOpen}\r\n            onClose={onClose}\r\n            title=\"\"\r\n            className=\"max-w-[400px]\"\r\n        >\r\n            <div className=\"relative pt-2 pb-4\">\r\n                {/* Header with Glassmorphism */}\r\n                <div className=\"mb-8 text-center\">\r\n                    <div className=\"inline-flex items-center gap-3 px-4 py-2 rounded-2xl bg-white/5 border border-white/10 backdrop-blur-md mb-2\">\r\n                        <span className=\"text-xl\">ЁЯУЕ</span>\r\n                        <h3 className=\"text-sm font-black uppercase tracking-[0.2em] text-white\">\r\n                            Sana tanlash\r\n                        </h3>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Month Navigator */}\r\n                <div className=\"flex justify-between items-center mb-8 px-2\">\r\n                    <button\r\n                        onClick={() => changeMonth(-1)}\r\n                        className=\"w-10 h-10 flex items-center justify-center bg-white/5 hover:bg-white/10 border border-white/5 rounded-xl text-gray-400 hover:text-white transition-all hover:scale-105 active:scale-95\"\r\n                    >\r\n                        тЖР\r\n                    </button>\r\n                    <div className=\"text-center\">\r\n                        <div className=\"text-lg font-display font-black text-white tracking-tight\">\r\n                            {monthNames[currentMonth]}\r\n                        </div>\r\n                        <div className=\"text-[10px] text-aura-cyan font-black uppercase tracking-widest opacity-50\">\r\n                            {currentYear}\r\n                        </div>\r\n                    </div>\r\n                    <button\r\n                        onClick={() => changeMonth(1)}\r\n                        className=\"w-10 h-10 flex items-center justify-center bg-white/5 hover:bg-white/10 border border-white/5 rounded-xl text-gray-400 hover:text-white transition-all hover:scale-105 active:scale-95\"\r\n                    >\r\n                        тЖТ\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Calendar Grid */}\r\n                <div className=\"grid grid-cols-7 gap-2\">\r\n                    {weekDays.map(d => (\r\n                        <div key={d} className=\"text-[10px] text-gray-600 font-black uppercase tracking-widest text-center py-2\">\r\n                            {d}\r\n                        </div>\r\n                    ))}\r\n                    {monthData.map((d, i) => {\r\n                        if (d === null) return <div key={`empty-${i}`} className=\"aspect-square\" />;\r\n\r\n                        const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;\r\n                        const isSelected = dateStr === selectedDate;\r\n                        const now = new Date();\r\n                        const isToday = d === now.getDate() && currentMonth === now.getMonth() && currentYear === now.getFullYear();\r\n\r\n                        return (\r\n                            <button\r\n                                key={dateStr}\r\n                                onClick={() => { onDateSelect(dateStr); onClose(); }}\r\n                                className={`aspect-square rounded-xl flex flex-col items-center justify-center text-sm transition-all duration-300 relative group border\r\n                                    ${isSelected ? 'bg-aura-cyan border-aura-cyan text-black font-black shadow-[0_0_20px_rgba(0,240,255,0.3)] scale-110 z-10' :\r\n                                        isToday ? 'bg-white/10 border-aura-cyan/30 text-aura-cyan font-bold hover:bg-white/20' :\r\n                                            'bg-white/5 border-white/5 text-gray-400 hover:text-white hover:bg-white/10 hover:border-white/20'}\r\n                                `}\r\n                            >\r\n                                {d}\r\n                                {isToday && !isSelected && (\r\n                                    <div className=\"absolute bottom-1 w-1 h-1 bg-aura-cyan rounded-full\" />\r\n                                )}\r\n                            </button>\r\n                        );\r\n                    })}\r\n                </div>\r\n\r\n                {/* Shortcuts */}\r\n                <div className=\"mt-8 grid grid-cols-2 gap-3\">\r\n                    <button\r\n                        onClick={() => {\r\n                            onDateSelect(getLocalTodayStr());\r\n                            onClose();\r\n                        }}\r\n                        className=\"py-4 rounded-2xl bg-white/5 border border-white/10 text-[10px] font-black uppercase tracking-widest text-white hover:bg-white/10 hover:border-white/20 transition-all flex items-center justify-center gap-2\"\r\n                    >\r\n                        <span>тШАя╕П</span> Bugun\r\n                    </button>\r\n                    <button\r\n                        onClick={() => {\r\n                            const tomorrow = new Date();\r\n                            tomorrow.setDate(tomorrow.getDate() + 1);\r\n                            const year = tomorrow.getFullYear();\r\n                            const month = String(tomorrow.getMonth() + 1).padStart(2, '0');\r\n                            const day = String(tomorrow.getDate()).padStart(2, '0');\r\n                            onDateSelect(`${year}-${month}-${day}`);\r\n                            onClose();\r\n                        }}\r\n                        className=\"py-4 rounded-2xl bg-white/5 border border-white/10 text-[10px] font-black uppercase tracking-widest text-white hover:bg-white/10 hover:border-white/20 transition-all flex items-center justify-center gap-2\"\r\n                    >\r\n                        <span>ЁЯЪА</span> Erta\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </Modal>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\CommandPalette.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\AURA\\web\\src\\components\\CommandPalette.tsx:33:13\n  31 |             if (inputRef.current) inputRef.current.focus();\n  32 |         } else {\n> 33 |             setQuery('');\n     |             ^^^^^^^^ Avoid calling setState() directly within an effect\n  34 |             setResult(null);\n  35 |         }\n  36 |     }, [isOpen]);","line":33,"column":13,"nodeType":null,"endLine":33,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":79,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":79,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { parseCommand } from '@/services/groqService';\r\n\r\ninterface CommandPaletteProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\nconst QUICK_ACTIONS = [\r\n    { label: \"Moliya\", icon: \"ЁЯТ░\", path: \"/dashboard/finance\" },\r\n    { label: \"Vazifalar\", icon: \"ЁЯУЛ\", path: \"/dashboard/tasks\" },\r\n    { label: \"Fokus\", icon: \"ЁЯОп\", path: \"/dashboard/focus\" },\r\n    { label: \"Salomatlik\", icon: \"тЭдя╕П\", path: \"/dashboard/health\" },\r\n    { label: \"Ovqat\", icon: \"ЁЯН╜я╕П\", path: \"/dashboard/food\" },\r\n    { label: \"Oila\", icon: \"ЁЯСитАНЁЯСйтАНЁЯСз\", path: \"/dashboard/family\" },\r\n    { label: \"Sozlamalar\", icon: \"тЪЩя╕П\", path: \"/dashboard/settings\" },\r\n];\r\n\r\nexport default function CommandPalette({ isOpen, onClose }: CommandPaletteProps) {\r\n    const router = useRouter();\r\n    const inputRef = useRef<HTMLInputElement>(null);\r\n    const [query, setQuery] = useState('');\r\n    const [isProcessing, setIsProcessing] = useState(false);\r\n    const [result, setResult] = useState<string | null>(null);\r\n\r\n    // Auto-focus when opened\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            if (inputRef.current) inputRef.current.focus();\r\n        } else {\r\n            setQuery('');\r\n            setResult(null);\r\n        }\r\n    }, [isOpen]);\r\n\r\n    // Filter quick actions\r\n    const filteredActions = query.length > 0\r\n        ? QUICK_ACTIONS.filter(a =>\r\n            a.label.toLowerCase().includes(query.toLowerCase())\r\n        )\r\n        : QUICK_ACTIONS;\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!query.trim()) return;\r\n\r\n        setIsProcessing(true);\r\n\r\n        // Check for navigation commands first\r\n        const navMatch = filteredActions.find(a =>\r\n            a.label.toLowerCase() === query.toLowerCase()\r\n        );\r\n\r\n        if (navMatch) {\r\n            router.push(navMatch.path);\r\n            onClose();\r\n            return;\r\n        }\r\n\r\n        // AI Command Parsing\r\n        try {\r\n            const intent = await parseCommand(query);\r\n\r\n            if (intent.module === 'finance') {\r\n                router.push('/dashboard/finance');\r\n                setResult(`Moliya: ${JSON.stringify(intent.data)}`);\r\n            } else if (intent.module === 'tasks') {\r\n                router.push('/dashboard/tasks');\r\n                setResult(`Vazifa: ${intent.data?.title || query}`);\r\n            } else if (intent.module === 'focus') {\r\n                router.push(`/dashboard/focus`);\r\n            } else if (intent.module === 'health') {\r\n                router.push('/dashboard/health');\r\n            } else {\r\n                setResult(\"Tushunmadim. Qayta urinib ko'ring.\");\r\n            }\r\n        } catch (error) {\r\n            setResult(\"Xatolik yuz berdi.\");\r\n        }\r\n\r\n        setIsProcessing(false);\r\n    };\r\n\r\n    const handleQuickAction = (path: string) => {\r\n        router.push(path);\r\n        onClose();\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div\r\n            className=\"fixed inset-0 z-[100] flex items-start justify-center pt-[15vh] bg-black/80 backdrop-blur-sm\"\r\n            onClick={onClose}\r\n        >\r\n            <div\r\n                className=\"w-full max-w-2xl bg-black/90 border border-white/20 rounded-2xl shadow-2xl overflow-hidden\"\r\n                onClick={e => e.stopPropagation()}\r\n            >\r\n                {/* Search Input */}\r\n                <form onSubmit={handleSubmit} className=\"p-4 border-b border-white/10\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <span className=\"text-gray-400\">тМШ</span>\r\n                        <input\r\n                            ref={inputRef}\r\n                            type=\"text\"\r\n                            value={query}\r\n                            onChange={e => setQuery(e.target.value)}\r\n                            placeholder=\"Buyruq yozing... (masalan: 'Moliya' yoki '50 dollar taksi')\"\r\n                            className=\"flex-1 bg-transparent text-white text-lg focus:outline-none placeholder-gray-500\"\r\n                        />\r\n                        {isProcessing && (\r\n                            <span className=\"text-aura-cyan animate-pulse\">AI...</span>\r\n                        )}\r\n                    </div>\r\n                </form>\r\n\r\n                {/* Quick Actions */}\r\n                <div className=\"p-4 max-h-[50vh] overflow-y-auto\">\r\n                    {result && (\r\n                        <div className=\"mb-4 p-3 rounded-lg bg-aura-cyan/10 border border-aura-cyan/30 text-aura-cyan text-sm\">\r\n                            {result}\r\n                        </div>\r\n                    )}\r\n\r\n                    <div className=\"text-xs text-gray-500 uppercase mb-3\">Tezkor harakatlar</div>\r\n                    <div className=\"grid grid-cols-2 gap-2\">\r\n                        {filteredActions.map(action => (\r\n                            <button\r\n                                key={action.path}\r\n                                onClick={() => handleQuickAction(action.path)}\r\n                                className=\"flex items-center gap-3 p-3 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 hover:border-aura-cyan/30 transition-all text-left\"\r\n                            >\r\n                                <span className=\"text-2xl\">{action.icon}</span>\r\n                                <span className=\"text-white font-medium\">{action.label}</span>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"p-3 border-t border-white/10 flex justify-between text-xs text-gray-500\">\r\n                    <span>\r\n                        <kbd className=\"px-1.5 py-0.5 bg-white/10 rounded\">тЖ╡</kbd> bajarish\r\n                    </span>\r\n                    <span>\r\n                        <kbd className=\"px-1.5 py-0.5 bg-white/10 rounded\">ESC</kbd> yopish\r\n                    </span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\ConfirmationModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\FamilyInvite.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'familyId' is defined but never used.","line":10,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":48},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nD:\\AURA\\web\\src\\components\\FamilyInvite.tsx:15:51\n  13 |\n  14 |     // Generate invite link (simplified - in production use Firebase Dynamic Links)\n> 15 |     const inviteCode = user ? btoa(`${user.uid}_${Date.now()}`).slice(0, 12) : 'DEMO123';\n     |                                                   ^^^^^^^^^^ Cannot call impure function\n  16 |     const inviteLink = `https://aura-life-os.web.app/join?code=${inviteCode}`;\n  17 |\n  18 |     // Simple QR code using Google Charts API (no dependency)","line":15,"column":51,"nodeType":null,"endLine":15,"endColumn":61},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":36,"column":60,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[1532,1638],"text":"\r\n                        Ushbu QR kodni yoki havolani oila a&apos;zolaringizga yuboring.\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[1532,1638],"text":"\r\n                        Ushbu QR kodni yoki havolani oila a&lsquo;zolaringizga yuboring.\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[1532,1638],"text":"\r\n                        Ushbu QR kodni yoki havolani oila a&#39;zolaringizga yuboring.\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[1532,1638],"text":"\r\n                        Ushbu QR kodni yoki havolani oila a&rsquo;zolaringizga yuboring.\r\n                    "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":41,"column":25,"nodeType":"JSXOpeningElement","endLine":45,"endColumn":27}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { useState } from 'react';\r\nimport { useAuth } from '@/context/AuthContext';\r\n\r\ninterface FamilyInviteProps {\r\n    familyId?: string;\r\n    onClose: () => void;\r\n}\r\n\r\nexport default function FamilyInvite({ familyId, onClose }: FamilyInviteProps) {\r\n    const { user } = useAuth();\r\n    const [copied, setCopied] = useState(false);\r\n\r\n    // Generate invite link (simplified - in production use Firebase Dynamic Links)\r\n    const inviteCode = user ? btoa(`${user.uid}_${Date.now()}`).slice(0, 12) : 'DEMO123';\r\n    const inviteLink = `https://aura-life-os.web.app/join?code=${inviteCode}`;\r\n\r\n    // Simple QR code using Google Charts API (no dependency)\r\n    const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(inviteLink)}`;\r\n\r\n    const handleCopy = async () => {\r\n        await navigator.clipboard.writeText(inviteLink);\r\n        setCopied(true);\r\n        setTimeout(() => setCopied(false), 2000);\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm\" onClick={onClose}>\r\n            <div\r\n                className=\"bg-black border border-white/20 rounded-3xl p-8 max-w-md w-full mx-4 shadow-2xl\"\r\n                onClick={e => e.stopPropagation()}\r\n            >\r\n                <div className=\"text-center\">\r\n                    <h2 className=\"text-2xl font-bold text-white mb-2\">ЁЯСитАНЁЯСйтАНЁЯСзтАНЁЯСж Oilaga Taklif</h2>\r\n                    <p className=\"text-gray-400 text-sm mb-6\">\r\n                        Ushbu QR kodni yoki havolani oila a'zolaringizga yuboring.\r\n                    </p>\r\n\r\n                    {/* QR Code */}\r\n                    <div className=\"bg-white p-4 rounded-2xl inline-block mb-6\">\r\n                        <img\r\n                            src={qrUrl}\r\n                            alt=\"QR Code\"\r\n                            className=\"w-48 h-48\"\r\n                        />\r\n                    </div>\r\n\r\n                    {/* Invite Code */}\r\n                    <div className=\"bg-white/5 border border-white/10 rounded-xl p-4 mb-4\">\r\n                        <p className=\"text-xs text-gray-500 uppercase mb-1\">Taklif Kodi</p>\r\n                        <p className=\"text-2xl font-mono font-bold text-aura-cyan tracking-wider\">{inviteCode}</p>\r\n                    </div>\r\n\r\n                    {/* Copy Link Button */}\r\n                    <button\r\n                        onClick={handleCopy}\r\n                        className={`w-full py-3 rounded-xl font-bold transition-all ${copied\r\n                                ? 'bg-aura-green text-black'\r\n                                : 'bg-aura-cyan text-black hover:scale-105'\r\n                            }`}\r\n                    >\r\n                        {copied ? 'тЬУ Nusxalandi!' : 'ЁЯУЛ Havolani Nusxalash'}\r\n                    </button>\r\n\r\n                    {/* Info */}\r\n                    <p className=\"text-xs text-gray-500 mt-4\">\r\n                        Havola 7 kun davomida amal qiladi.\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Close Button */}\r\n                <button\r\n                    onClick={onClose}\r\n                    className=\"absolute top-4 right-4 w-8 h-8 rounded-full bg-white/10 text-white hover:bg-white/20 transition-colors flex items-center justify-center\"\r\n                >\r\n                    тЬХ\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\FamilyTree.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\HistoryModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\MiniTree.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\Modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\MoneyInput.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`parseNumber` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nD:\\AURA\\web\\src\\components\\MoneyInput.tsx:17:13\n  15 |     useEffect(() => {\n  16 |         if (value === 0 && displayValue === '') return; // Don't overwrite empty state with 0 initially if desired\n> 17 |         if (parseNumber(displayValue) !== value) {\n     |             ^^^^^^^^^^^ `parseNumber` accessed before it is declared\n  18 |             setDisplayValue(formatNumber(value));\n  19 |         }\n  20 |     }, [value]);\n\nD:\\AURA\\web\\src\\components\\MoneyInput.tsx:27:5\n  25 |     };\n  26 |\n> 27 |     const parseNumber = (str: string): number => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 28 |         return Number(str.replace(/\\s/g, \"\"));\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 29 |     };\n     | ^^^^^^^ `parseNumber` is declared here\n  30 |\n  31 |     const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n  32 |         const raw = e.target.value;","line":17,"column":13,"nodeType":null,"endLine":17,"endColumn":24},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`formatNumber` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nD:\\AURA\\web\\src\\components\\MoneyInput.tsx:18:29\n  16 |         if (value === 0 && displayValue === '') return; // Don't overwrite empty state with 0 initially if desired\n  17 |         if (parseNumber(displayValue) !== value) {\n> 18 |             setDisplayValue(formatNumber(value));\n     |                             ^^^^^^^^^^^^ `formatNumber` accessed before it is declared\n  19 |         }\n  20 |     }, [value]);\n  21 |\n\nD:\\AURA\\web\\src\\components\\MoneyInput.tsx:22:5\n  20 |     }, [value]);\n  21 |\n> 22 |     const formatNumber = (num: number): string => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 23 |         if (!num) return '';\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 24 |         return num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \" \");\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 25 |     };\n     | ^^^^^^^ `formatNumber` is declared here\n  26 |\n  27 |     const parseNumber = (str: string): number => {\n  28 |         return Number(str.replace(/\\s/g, \"\"));","line":18,"column":29,"nodeType":null,"endLine":18,"endColumn":41},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'displayValue'. Either include it or remove the dependency array.","line":20,"column":8,"nodeType":"ArrayExpression","endLine":20,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [displayValue, value]","fix":{"range":[738,745],"text":"[displayValue, value]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\n\r\ninterface MoneyInputProps {\r\n    value: number;\r\n    onChange: (value: number) => void;\r\n    placeholder?: string;\r\n    className?: string;\r\n    autoFocus?: boolean;\r\n}\r\n\r\nexport function MoneyInput({ value, onChange, placeholder, className, autoFocus }: MoneyInputProps) {\r\n    const [displayValue, setDisplayValue] = useState('');\r\n\r\n    // Sync external value to display value on mount or when value changes externally\r\n    useEffect(() => {\r\n        if (value === 0 && displayValue === '') return; // Don't overwrite empty state with 0 initially if desired\r\n        if (parseNumber(displayValue) !== value) {\r\n            setDisplayValue(formatNumber(value));\r\n        }\r\n    }, [value]);\r\n\r\n    const formatNumber = (num: number): string => {\r\n        if (!num) return '';\r\n        return num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \" \");\r\n    };\r\n\r\n    const parseNumber = (str: string): number => {\r\n        return Number(str.replace(/\\s/g, \"\"));\r\n    };\r\n\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const raw = e.target.value;\r\n        // Allow only numbers and spaces\r\n        const filtered = raw.replace(/[^0-9\\s]/g, '');\r\n        const num = parseNumber(filtered);\r\n\r\n        // Prevent huge numbers that break JS\r\n        if (num > 999999999999) return;\r\n\r\n        setDisplayValue(filtered);\r\n        onChange(num);\r\n    };\r\n\r\n    const handleBlur = () => {\r\n        // Re-format on blur to ensure clean spacing\r\n        const num = parseNumber(displayValue);\r\n        setDisplayValue(formatNumber(num));\r\n    };\r\n\r\n    return (\r\n        <input\r\n            type=\"text\"\r\n            inputMode=\"numeric\"\r\n            value={displayValue}\r\n            onChange={handleChange}\r\n            onBlur={handleBlur}\r\n            placeholder={placeholder}\r\n            className={className}\r\n            autoFocus={autoFocus}\r\n        />\r\n    );\r\n}\r\n\r\nexport default MoneyInput;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\ParentSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\ProtectedRoute.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\SmartTree.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[234,237],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[234,237],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[379,382],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[379,382],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[393,396],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[393,396],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":24,"column":21,"nodeType":"JSXOpeningElement","endLine":24,"endColumn":104},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":60,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3113,3116],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3113,3116],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":97,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4675,4678],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4675,4678],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":97,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4684,4687],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4684,4687],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":98,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4730,4733],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4730,4733],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":158,"column":83,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[8567,8595],"text":" O&apos;tganlar\r\n                "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[8567,8595],"text":" O&lsquo;tganlar\r\n                "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[8567,8595],"text":" O&#39;tganlar\r\n                "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[8567,8595],"text":" O&rsquo;tganlar\r\n                "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React from 'react';\r\nimport { Ancestor, FamilyMember } from '@/services/familyService';\r\n\r\ninterface SmartTreeProps {\r\n    ancestors: Ancestor[];\r\n    familyMembers: FamilyMember[];\r\n    onMemberClick?: (member: any) => void;\r\n    mode?: 'full' | 'immediate';\r\n    centerMemberId?: string;\r\n}\r\n\r\nconst MemberCard = ({ person, onClick, isSingle }: { person: any, onClick: any, isSingle?: boolean }) => {\r\n    const role = (person.role || \"A'zo\").toLowerCase();\r\n    const isDeceased = person.status === 'Deceased';\r\n\r\n    return (\r\n        <div\r\n            onClick={() => onClick(person)}\r\n            className={`w-40 p-3 rounded-2xl bg-black/60 border border-white/10 hover:border-aura-gold transition-all cursor-pointer group relative flex flex-col items-center text-center shadow-xl ${isSingle ? 'scale-95 opacity-90 hover:scale-100 hover:opacity-100' : ''}`}\r\n        >\r\n            <div className={`w-14 h-14 rounded-full bg-white/5 mb-2 overflow-hidden border-2 transition-colors ${isDeceased ? 'border-gray-600 grayscale' : 'border-white/5 group-hover:border-aura-gold'}`}>\r\n                {person.photo ? (\r\n                    <img src={person.photo} alt={person.name} className=\"w-full h-full object-cover\" />\r\n                ) : (\r\n                    <div className={`w-full h-full flex items-center justify-center text-xl bg-gradient-to-br from-zinc-800 to-black`}>\r\n                        {role.includes('mother') || role.includes('buvi') ? 'ЁЯС╡' :\r\n                            role.includes('father') || role.includes('bobo') ? 'ЁЯС┤' :\r\n                                role.includes('son') ? 'ЁЯСж' :\r\n                                    role.includes('daughter') ? 'ЁЯСз' : 'ЁЯСд'}\r\n                    </div>\r\n                )}\r\n            </div>\r\n            <h3 className=\"text-xs font-bold text-white leading-tight mb-0.5 transition-colors group-hover:text-aura-cyan line-clamp-1\">{person.name}</h3>\r\n            <p className=\"text-[9px] text-aura-gold mb-1 font-bold tracking-wider uppercase opacity-80\">\r\n                {person.role || \"A'zo\"}\r\n            </p>\r\n\r\n            <div className=\"text-[8px] text-gray-500 font-mono mt-1\">\r\n                {person.birth ? new Date(person.birth).getFullYear() : (person.birthDate ? new Date(person.birthDate).getFullYear() : '????')}\r\n                {person.death ? ` - ${new Date(person.death).getFullYear()}` : ''}\r\n            </div>\r\n\r\n            {!isSingle && !isDeceased && <div className=\"absolute -top-1 -right-1 w-2 h-2 rounded-full bg-aura-gold animate-pulse shadow-[0_0_10px_rgba(255,215,0,0.5)]\"></div>}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default function SmartTree({ ancestors, familyMembers, onMemberClick, mode = 'full', centerMemberId }: SmartTreeProps) {\r\n\r\n    const getGeneration = (birthDate?: string) => {\r\n        if (!birthDate) return 0;\r\n        const year = new Date(birthDate).getFullYear();\r\n        if (year >= 2000) return 0;\r\n        if (year >= 1975) return 1;\r\n        if (year >= 1950) return 2;\r\n        return 3;\r\n    };\r\n\r\n    let displayMembers = [...ancestors, ...familyMembers as any];\r\n\r\n    if (mode === 'immediate' && centerMemberId) {\r\n        const center = displayMembers.find(m => m.id === centerMemberId);\r\n        if (center) {\r\n            displayMembers = displayMembers.filter(m =>\r\n                m.id === centerMemberId ||\r\n                m.id === center.fatherId ||\r\n                m.id === center.motherId ||\r\n                m.fatherId === centerMemberId ||\r\n                m.motherId === centerMemberId ||\r\n                m.spouseId === centerMemberId ||\r\n                center.spouseId === m.id\r\n            );\r\n        }\r\n    }\r\n\r\n    const gens = mode === 'immediate' ? [3, 2, 1, 0, -1] : [3, 2, 1, 0]; // Support children gen if immediate\r\n\r\n    // Adjust generation for children in immediate mode\r\n    const processedMembers = displayMembers.map(m => {\r\n        let g = getGeneration(m.birth || m.birthDate);\r\n        if (mode === 'immediate' && centerMemberId) {\r\n            const center = displayMembers.find(x => x.id === centerMemberId);\r\n            if (center && (m.fatherId === centerMemberId || m.motherId === centerMemberId)) {\r\n                g = -1; // Children generation\r\n            }\r\n        }\r\n        return { ...m, displayGen: g };\r\n    });\r\n\r\n    return (\r\n        <div className=\"relative w-full h-full flex flex-col items-center p-8 overflow-x-auto custom-scrollbar\">\r\n            {gens.map((gen) => {\r\n                const genMembers = processedMembers.filter(m => m.displayGen === gen);\r\n                if (genMembers.length === 0) return null;\r\n\r\n                const couples: { m1: any, m2: any }[] = [];\r\n                const singles: any[] = [];\r\n                const processedIds = new Set<string>();\r\n\r\n                genMembers.forEach(m => {\r\n                    if (processedIds.has(m.id)) return;\r\n                    if (m.spouseId) {\r\n                        const spouse = genMembers.find(s => s.id === m.spouseId);\r\n                        if (spouse) {\r\n                            couples.push({ m1: m, m2: spouse });\r\n                            processedIds.add(m.id);\r\n                            processedIds.add(spouse.id);\r\n                            return;\r\n                        }\r\n                    }\r\n                    singles.push(m);\r\n                    processedIds.add(m.id);\r\n                });\r\n\r\n                return (\r\n                    <div key={gen} className=\"mb-16 w-full flex flex-col items-center\">\r\n                        <div className=\"mb-6 flex items-center gap-4 w-full opacity-40\">\r\n                            <div className=\"h-px flex-1 bg-gradient-to-r from-transparent to-white/20\"></div>\r\n                            <span className=\"text-[8px] uppercase tracking-[0.2em] font-bold text-aura-gold/50 px-3 py-0.5 rounded-full border border-white/5 bg-white/5\">\r\n                                {gen === 3 ? 'Katta Bobolar' : gen === 2 ? 'Bobo-Buvilar' : gen === 1 ? 'Ota-onalar' : gen === 0 ? 'Asosiy Avlod' : 'Farzandlar'}\r\n                            </span>\r\n                            <div className=\"h-px flex-1 bg-gradient-to-l from-transparent to-white/20\"></div>\r\n                        </div>\r\n\r\n                        <div className=\"flex justify-center flex-wrap gap-10\">\r\n                            {couples.map((pair, idx) => (\r\n                                <div key={`pair-${idx}`} className=\"flex flex-col items-center relative\">\r\n                                    <div className=\"flex items-center gap-1 bg-white/5 p-1.5 rounded-[2rem] border border-white/5\">\r\n                                        <MemberCard person={pair.m1} onClick={onMemberClick} />\r\n                                        <div className=\"w-6 h-px bg-aura-gold/30 relative\">\r\n                                            <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-[8px]\">тЭдя╕П</div>\r\n                                        </div>\r\n                                        <MemberCard person={pair.m2} onClick={onMemberClick} />\r\n                                    </div>\r\n                                    <div className=\"absolute -bottom-10 left-1/2 w-px h-10 bg-gradient-to-b from-aura-gold/30 to-transparent\"></div>\r\n                                </div>\r\n                            ))}\r\n\r\n                            {singles.map((m, idx) => (\r\n                                <div key={`single-${idx}`} className=\"relative flex flex-col items-center\">\r\n                                    <MemberCard person={m} onClick={onMemberClick} isSingle={true} />\r\n                                    {gen !== (mode === 'immediate' ? -1 : 0) && (\r\n                                        <div className=\"absolute -bottom-10 left-1/2 w-px h-10 bg-white/10\"></div>\r\n                                    )}\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                );\r\n            })}\r\n\r\n            <div className=\"mt-8 flex gap-6 opacity-30\">\r\n                <div className=\"flex items-center gap-1.5 text-[8px] uppercase tracking-tighter text-gray-400 font-mono\">\r\n                    <div className=\"w-1.5 h-1.5 rounded-full bg-aura-cyan\"></div> Tirik\r\n                </div>\r\n                <div className=\"flex items-center gap-1.5 text-[8px] uppercase tracking-tighter text-gray-400 font-mono\">\r\n                    <div className=\"w-1.5 h-1.5 rounded-full bg-gray-600\"></div> O'tganlar\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\VoiceInput.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":107,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":107,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_' is defined but never used.","line":119,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":119,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { useState, useRef } from 'react';\r\nimport { transcribeAudio, parseCommand, AICommandResponse } from '@/services/groqService';\r\n\r\ninterface VoiceInputProps {\r\n    module: 'finance' | 'health' | 'mental' | 'mind' | 'focus' | 'tasks' | 'food' | 'interests' | 'family';\r\n    onCommand: (data: AICommandResponse) => void;\r\n    onTranscript?: (text: string) => void;\r\n    className?: string;\r\n    color?: 'purple' | 'cyan' | 'green' | 'gold' | 'red' | 'blue';\r\n}\r\n\r\nexport default function VoiceInput({ module, onCommand, onTranscript, className = '', color = 'purple' }: VoiceInputProps) {\r\n    const [isRecording, setIsRecording] = useState(false);\r\n    const [isProcessing, setIsProcessing] = useState(false);\r\n\r\n    const [modalState, setModalState] = useState<{\r\n        isOpen: boolean;\r\n        type: 'success' | 'error' | 'confirm_redirect';\r\n        message: string;\r\n        redirectModule?: string;\r\n    }>({ isOpen: false, type: 'success', message: '' });\r\n\r\n    const mediaRecorderRef = useRef<MediaRecorder | null>(null);\r\n    const chunksRef = useRef<Blob[]>([]);\r\n\r\n    const colorStyles = {\r\n        purple: {\r\n            glow: 'bg-aura-purple',\r\n            inner: 'bg-aura-purple/20 border-aura-purple/30 text-aura-purple hover:bg-aura-purple hover:border-aura-purple hover:shadow-[0_0_20px_rgba(168,85,247,0.4)]',\r\n        },\r\n        cyan: {\r\n            glow: 'bg-aura-cyan',\r\n            inner: 'bg-aura-cyan/20 border-aura-cyan/30 text-aura-cyan hover:bg-aura-cyan hover:border-aura-cyan hover:shadow-[0_0_20px_rgba(34,211,238,0.4)]',\r\n        },\r\n        green: {\r\n            glow: 'bg-aura-green',\r\n            inner: 'bg-aura-green/20 border-aura-green/30 text-aura-green hover:bg-aura-green hover:border-aura-green hover:shadow-[0_0_20px_rgba(0,255,148,0.4)]',\r\n        },\r\n        gold: {\r\n            glow: 'bg-aura-gold',\r\n            inner: 'bg-aura-gold/20 border-aura-gold/30 text-aura-gold hover:bg-aura-gold hover:border-aura-gold hover:shadow-[0_0_20px_rgba(255,214,0,0.4)]',\r\n        },\r\n        red: {\r\n            glow: 'bg-aura-red',\r\n            inner: 'bg-aura-red/20 border-aura-red/30 text-aura-red hover:bg-aura-red hover:border-aura-red hover:shadow-[0_0_20px_rgba(255,46,46,0.4)]',\r\n        },\r\n        blue: {\r\n            glow: 'bg-aura-blue',\r\n            inner: 'bg-aura-blue/20 border-aura-blue/30 text-aura-blue hover:bg-aura-blue hover:border-aura-blue hover:shadow-[0_0_20px_rgba(59,130,246,0.4)]',\r\n        }\r\n    };\r\n\r\n    const currentStyle = colorStyles[color] || colorStyles.purple;\r\n\r\n    const startRecording = async () => {\r\n        try {\r\n            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n            const recorder = new MediaRecorder(stream, { mimeType: 'audio/webm' });\r\n\r\n            chunksRef.current = [];\r\n\r\n            recorder.ondataavailable = (e) => {\r\n                if (e.data.size > 0) {\r\n                    chunksRef.current.push(e.data);\r\n                }\r\n            };\r\n\r\n            recorder.onstop = async () => {\r\n                setIsProcessing(true);\r\n\r\n                try {\r\n                    const audioBlob = new Blob(chunksRef.current, { type: 'audio/webm' });\r\n                    const langCode = typeof window !== 'undefined' ? (window.localStorage.getItem('language') === 'ru' ? 'ru' : window.localStorage.getItem('language') === 'uz' ? 'uz' : 'en') : 'uz';\r\n                    const text = await transcribeAudio(audioBlob, langCode, module);\r\n\r\n                    if (onTranscript) onTranscript(text);\r\n\r\n                    if (text.startsWith(\"ERROR:\") || text === \"Audio system offline.\") {\r\n                        const errorMsg = text.startsWith(\"ERROR:\") ? text.replace(\"ERROR: \", \"\") : \"Ovoz tizimi oflayn.\";\r\n                        setModalState({ isOpen: true, type: 'error', message: errorMsg });\r\n                        return;\r\n                    }\r\n\r\n                    const command = await parseCommand(text, module);\r\n                    console.log('AI Logic:', command);\r\n\r\n                    if (!command.success || command.module === 'error' || command.module === 'unknown') {\r\n                        setModalState({ isOpen: true, type: 'error', message: command.confirmation_message || \"Tushunarsiz buyruq.\" });\r\n                    }\r\n                    else if (command.action === 'wrong_module') {\r\n                        setModalState({\r\n                            isOpen: true,\r\n                            type: 'confirm_redirect',\r\n                            message: command.confirmation_message || \"Boshqa bo'limga o'tamizmi?\",\r\n                            redirectModule: command.suggested_module\r\n                        });\r\n                    }\r\n                    else if (command.action === 'clarify') {\r\n                        setModalState({ isOpen: true, type: 'error', message: command.confirmation_message || \"Ma'lumotlar yetarli emas.\" });\r\n                    }\r\n                    else {\r\n                        onCommand(command);\r\n                        setModalState({ isOpen: true, type: 'success', message: command.confirmation_message || \"Bajarildi!\" });\r\n                    }\r\n\r\n                } catch (_) {\r\n                    setModalState({ isOpen: true, type: 'error', message: \"Tizim xatoligi.\" });\r\n                    console.error('Voice processing error');\r\n                } finally {\r\n                    setIsProcessing(false);\r\n                    stream.getTracks().forEach(track => track.stop());\r\n                }\r\n            };\r\n\r\n            recorder.start();\r\n            mediaRecorderRef.current = recorder;\r\n            setIsRecording(true);\r\n        } catch (_) {\r\n            setModalState({ isOpen: true, type: 'error', message: \"Mikrofonga ruxsat yo'q!\" });\r\n        }\r\n    };\r\n\r\n    const stopRecording = () => {\r\n        if (mediaRecorderRef.current && isRecording) {\r\n            mediaRecorderRef.current.stop();\r\n            setIsRecording(false);\r\n        }\r\n    };\r\n\r\n    const closeModal = () => setModalState({ ...modalState, isOpen: false });\r\n\r\n    return (\r\n        <>\r\n            <button\r\n                onMouseDown={startRecording}\r\n                onMouseUp={stopRecording}\r\n                onTouchStart={startRecording}\r\n                onTouchEnd={stopRecording}\r\n                disabled={isProcessing}\r\n                className={`relative group flex items-center justify-center transition-all duration-300 w-12 h-12 ${className} ${isRecording ? 'scale-110' : 'hover:scale-110 active:scale-95'} disabled:opacity-50`}\r\n            >\r\n                {/* Glow Effect */}\r\n                <div className={`absolute inset-[-4px] rounded-[1.5rem] blur-xl transition-all duration-500 opacity-0 group-hover:opacity-40 ${isRecording ? `bg-aura-red opacity-60 animate-pulse` : `${currentStyle.glow}`}`}></div>\r\n\r\n                {/* Button Body - Premium Squircle */}\r\n                <div className={`relative z-10 w-full h-full rounded-2xl flex items-center justify-center border-2 transition-all duration-500 shadow-2xl overflow-hidden ${isRecording\r\n                    ? 'bg-aura-red border-aura-red text-white shadow-[0_0_30px_rgba(255,46,46,0.4)]'\r\n                    : `${currentStyle.inner} hover:text-black`}`}>\r\n\r\n                    {isProcessing ? (\r\n                        <div className=\"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin\"></div>\r\n                    ) : (\r\n                        <div className=\"relative\">\r\n                            {/* Listening Wave Animation */}\r\n                            {isRecording && (\r\n                                <div className=\"absolute inset-0 -m-4 flex items-center justify-center pointer-events-none\">\r\n                                    <div className=\"w-12 h-12 bg-white/20 rounded-full animate-ping opacity-20\"></div>\r\n                                </div>\r\n                            )}\r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"relative z-20\">\r\n                                <path d=\"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3z\"></path>\r\n                                <path d=\"M19 10v2a7 7 0 0 1-14 0v-2\"></path>\r\n                                <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"22\"></line>\r\n                            </svg>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Glossy Overlay */}\r\n                    <div className=\"absolute top-0 left-0 w-full h-1/2 bg-white/5 pointer-events-none\"></div>\r\n                </div>\r\n            </button>\r\n\r\n            {/* FEEDBACK MODAL */}\r\n            {modalState.isOpen && (\r\n                <div className=\"fixed inset-0 z-[200] flex items-center justify-center bg-black/60 backdrop-blur-sm animate-fade-in p-4\">\r\n                    <div className=\"bg-zinc-900 border border-white/10 rounded-3xl p-6 max-w-sm w-full shadow-2xl transform transition-all scale-100\">\r\n                        <div className=\"flex flex-col items-center text-center\">\r\n                            <div className={`w-16 h-16 rounded-full flex items-center justify-center mb-4 text-3xl ${modalState.type === 'success' ? 'bg-aura-green/20 text-aura-green' :\r\n                                modalState.type === 'error' ? 'bg-aura-red/20 text-aura-red' :\r\n                                    'bg-aura-gold/20 text-aura-gold'\r\n                                }`}>\r\n                                {modalState.type === 'success' ? 'тЬУ' : modalState.type === 'error' ? 'тЬХ' : 'тЪая╕П'}\r\n                            </div>\r\n\r\n                            <h3 className=\"text-xl font-bold text-white mb-2\">\r\n                                {modalState.type === 'success' ? 'Muvaffaqiyatli' :\r\n                                    modalState.type === 'error' ? 'Xatolik' : 'Diqqat'}\r\n                            </h3>\r\n\r\n                            <p className=\"text-gray-300 mb-6\">{modalState.message}</p>\r\n\r\n                            <div className=\"flex gap-3 w-full\">\r\n                                {modalState.type === 'confirm_redirect' ? (\r\n                                    <>\r\n                                        <button onClick={closeModal} className=\"flex-1 py-3 rounded-xl bg-white/5 hover:bg-white/10 text-gray-400 transition-colors\">\r\n                                            Bekor qilish\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={() => { if (typeof window !== 'undefined') window.location.href = `/dashboard/${modalState.redirectModule}`; }}\r\n                                            className=\"flex-1 py-3 rounded-xl bg-aura-cyan text-black font-bold hover:bg-aura-cyan/90 transition-colors\"\r\n                                        >\r\n                                            O&apos;tish\r\n                                        </button>\r\n                                    </>\r\n                                ) : (\r\n                                    <button\r\n                                        onClick={closeModal}\r\n                                        className=\"w-full py-3 rounded-xl bg-white/10 hover:bg-white/20 text-white font-medium transition-colors\"\r\n                                    >\r\n                                        Yopish\r\n                                    </button>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\dashboard\\AiInsightSection.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[148,151],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[148,151],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n\"use client\";\r\nimport React from 'react';\r\n\r\ninterface AiInsightSectionProps {\r\n    onAnalyze: () => void;\r\n    isLoading: boolean;\r\n    insight: any; // Flexible insight object (title, insight, recommendation/text, emoji, etc.)\r\n    title?: string;\r\n    description?: string;\r\n    buttonText?: string;\r\n    color?: 'purple' | 'cyan' | 'green' | 'gold' | 'red' | 'blue';\r\n    children?: React.ReactNode;\r\n}\r\n\r\nexport const AiInsightSection: React.FC<AiInsightSectionProps> = ({\r\n    onAnalyze,\r\n    isLoading,\r\n    insight,\r\n    title = \"AI Maslahat\",\r\n    description = \"Sun'iy intellekt yordamida chuqur tahlil va tavsiyalar oling.\",\r\n    buttonText = \"Tahlilni Boshlash\",\r\n    color = 'purple',\r\n    children\r\n}) => {\r\n\r\n    // Color mappings\r\n    const colorClasses = {\r\n        purple: {\r\n            bg: 'from-aura-purple/20',\r\n            border: 'border-aura-purple/20',\r\n            text: 'text-aura-purple',\r\n            hoverShadow: 'hover:shadow-[0_0_20px_rgba(157,78,221,0.5)]',\r\n            btnBg: 'bg-aura-purple',\r\n            iconBg: 'bg-aura-purple/20'\r\n        },\r\n        cyan: {\r\n            bg: 'from-aura-cyan/20',\r\n            border: 'border-aura-cyan/20',\r\n            text: 'text-aura-cyan',\r\n            hoverShadow: 'hover:shadow-[0_0_20px_rgba(0,240,255,0.5)]',\r\n            btnBg: 'bg-aura-cyan',\r\n            iconBg: 'bg-aura-cyan/20'\r\n        },\r\n        green: {\r\n            bg: 'from-aura-green/20',\r\n            border: 'border-aura-green/20',\r\n            text: 'text-aura-green',\r\n            hoverShadow: 'hover:shadow-[0_0_20px_rgba(0,255,148,0.5)]',\r\n            btnBg: 'bg-aura-green',\r\n            iconBg: 'bg-aura-green/20'\r\n        },\r\n        gold: {\r\n            bg: 'from-aura-gold/20',\r\n            border: 'border-aura-gold/20',\r\n            text: 'text-aura-gold',\r\n            hoverShadow: 'hover:shadow-[0_0_20px_rgba(255,214,0,0.5)]',\r\n            btnBg: 'bg-aura-gold',\r\n            iconBg: 'bg-aura-gold/20'\r\n        },\r\n        red: {\r\n            bg: 'from-aura-red/20',\r\n            border: 'border-aura-red/20',\r\n            text: 'text-aura-red',\r\n            hoverShadow: 'hover:shadow-[0_0_20px_rgba(255,46,46,0.5)]',\r\n            btnBg: 'bg-aura-red',\r\n            iconBg: 'bg-aura-red/20'\r\n        },\r\n        blue: {\r\n            bg: 'from-aura-blue/20',\r\n            border: 'border-aura-blue/20',\r\n            text: 'text-aura-blue',\r\n            hoverShadow: 'hover:shadow-[0_0_20px_rgba(59,130,246,0.5)]',\r\n            btnBg: 'bg-aura-blue',\r\n            iconBg: 'bg-aura-blue/20'\r\n        }\r\n    };\r\n\r\n    const styles = colorClasses[color];\r\n\r\n    // Resolve nested data if it exists (for persistence service compatibility)\r\n    const effectiveInsight = insight?.data || insight;\r\n    const effectiveProtocol = effectiveInsight?.protocol || insight?.protocol;\r\n    const effectiveRoadmap = effectiveInsight?.roadmap || insight?.roadmap;\r\n    const effectiveScore = effectiveInsight?.vitalityScore !== undefined ? effectiveInsight.vitalityScore : (insight?.vitalityScore !== undefined ? insight.vitalityScore : undefined);\r\n\r\n    return (\r\n        <div className={`w-full p-8 rounded-[2.5rem] bg-gradient-to-br ${styles.bg} via-black/40 to-transparent border ${styles.border} backdrop-blur-3xl relative overflow-hidden group mb-10 transition-all duration-500 hover:shadow-[0_20px_40px_rgba(0,0,0,0.4)]`}>\r\n            {/* Ambient Background Glows */}\r\n            <div className={`absolute -top-24 -right-24 w-64 h-64 ${styles.btnBg} opacity-5 blur-[100px] rounded-full group-hover:opacity-10 transition-opacity duration-700`}></div>\r\n            <div className={`absolute -bottom-24 -left-24 w-64 h-64 ${styles.btnBg} opacity-5 blur-[100px] rounded-full group-hover:opacity-10 transition-opacity duration-700`}></div>\r\n\r\n            <div className=\"relative z-10 flex flex-col xl:flex-row justify-between items-start xl:items-center gap-8\">\r\n                <div className=\"flex items-start md:items-center gap-6 flex-1\">\r\n                    <div className={`w-16 h-16 rounded-2xl ${styles.iconBg} flex items-center justify-center text-3xl shadow-2xl relative overflow-hidden group-hover:scale-110 transition-transform duration-500`}>\r\n                        <div className=\"absolute inset-0 bg-white/5 opacity-0 group-hover:opacity-100 transition-opacity\"></div>\r\n                        <span className=\"relative z-10\">{isLoading ? 'тЪЩя╕П' : (effectiveInsight?.emoji || insight?.emoji || 'ЁЯФо')}</span>\r\n                        {isLoading && <div className=\"absolute inset-0 border-2 border-white/20 border-t-white rounded-2xl animate-spin\"></div>}\r\n                    </div>\r\n                    <div className=\"flex-1\">\r\n                        <div className=\"flex items-center gap-3 mb-2\">\r\n                            <h3 className=\"text-2xl font-display font-black text-white tracking-tight\">{title}</h3>\r\n                            {effectiveInsight?.status && (\r\n                                <span className={`px-3 py-1 rounded-full text-[8px] font-black uppercase tracking-widest ${effectiveInsight.status === 'ready' || effectiveInsight.status === 'success' ? 'bg-aura-green/20 text-aura-green border border-aura-green/30' :\r\n                                    effectiveInsight.status === 'warning' ? 'bg-aura-red/20 text-aura-red border border-aura-red/30' :\r\n                                        'bg-aura-gold/20 text-aura-gold border border-aura-gold/30'\r\n                                    }`}>\r\n                                    {effectiveInsight.status}\r\n                                </span>\r\n                            )}\r\n                        </div>\r\n                        <p className=\"text-gray-400 text-sm md:text-base leading-relaxed max-w-2xl font-medium\">\r\n                            {insight ? (effectiveInsight.insight || effectiveInsight.text || insight.insight || insight.text || \"Operatsion tahlil yakunlandi. Protokol tayyor.\") : description}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n                <button\r\n                    onClick={onAnalyze}\r\n                    disabled={isLoading}\r\n                    className={`group/btn relative px-10 py-4 ${styles.btnBg} text-black font-black text-xs uppercase tracking-[0.2em] rounded-2xl ${styles.hoverShadow} transition-all duration-300 disabled:opacity-50 active:scale-95 flex items-center gap-3 overflow-hidden`}\r\n                >\r\n                    <div className=\"absolute inset-0 bg-white/20 translate-y-full group-hover/btn:translate-y-0 transition-transform duration-300\"></div>\r\n                    <span className=\"relative z-10\">{isLoading ? 'Sinxronizatsiya...' : buttonText}</span>\r\n                    {!isLoading && <span className=\"relative z-10 group-hover/btn:translate-x-1 transition-transform\">тЖТ</span>}\r\n                </button>\r\n            </div>\r\n\r\n            {insight && (\r\n                <div className=\"mt-8 pt-8 border-t border-white/10 grid grid-cols-1 md:grid-cols-3 gap-8 animate-fade-in relative z-10\">\r\n                    {/* Protocol / Roadmap Combined Section */}\r\n                    {(effectiveProtocol || effectiveRoadmap) && (\r\n                        <div className=\"md:col-span-3\">\r\n                            <h4 className={`text-[10px] font-black uppercase tracking-[0.3em] mb-4 flex items-center gap-3 ${styles.text}`}>\r\n                                <span className={`w-1.5 h-1.5 rounded-full ${styles.btnBg} animate-pulse`}></span>\r\n                                {effectiveProtocol ? \"AURA Vitality Protocol\" : \"Strategic Roadmap\"}\r\n                            </h4>\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                {((effectiveProtocol || effectiveRoadmap) as string[]).map((step: string, i: number) => (\r\n                                    <div key={i} className=\"group/step relative p-5 rounded-2xl bg-black/40 border border-white/5 hover:border-white/20 transition-all overflow-hidden\">\r\n                                        <div className={`absolute top-0 left-0 w-1 h-full ${styles.btnBg} opacity-20 group-hover/step:opacity-100 transition-opacity`}></div>\r\n                                        <div className=\"flex items-start gap-4\">\r\n                                            <div className={`flex-shrink-0 w-8 h-8 rounded-full ${styles.iconBg} ${styles.text} flex items-center justify-center text-xs font-black shadow-lg`}>\r\n                                                {i + 1}\r\n                                            </div>\r\n                                            <p className=\"text-sm text-gray-300 group-hover/step:text-white leading-relaxed transition-colors mt-1 font-medium\">{step}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    <div className=\"md:col-span-2 space-y-4\">\r\n                        <h4 className={`text-[10px] font-black uppercase tracking-[0.3em] ${styles.text}`}>Kritik Xulosa</h4>\r\n                        <div className=\"p-6 rounded-2xl bg-white/5 border border-white/10 relative overflow-hidden group/opt transition-all hover:bg-white/10\">\r\n                            <div className=\"absolute top-0 left-0 w-1 h-full bg-aura-cyan opacity-50\"></div>\r\n                            <div className={`absolute top-0 right-0 p-4 opacity-10 text-4xl group-hover/opt:scale-125 transition-transform duration-500`}>{effectiveInsight.emoji || insight.emoji || 'ЁЯТб'}</div>\r\n                            <p className=\"text-base text-gray-200 leading-relaxed font-medium relative z-10\">\r\n                                {effectiveInsight.optimization || effectiveInsight.recommendation || effectiveInsight.suggestion || \"Natijalar tahlil qilinmoqda.\"}\r\n                            </p>\r\n                            {effectiveInsight.success_mock && (\r\n                                <div className=\"mt-4 flex items-center gap-2\">\r\n                                    <span className=\"w-2 h-2 rounded-full bg-aura-cyan animate-pulse\"></span>\r\n                                    <span className=\"text-[8px] font-black text-aura-cyan uppercase tracking-widest opacity-50\">AURA Simulation Active</span>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Score / Potential Section */}\r\n                    <div className=\"space-y-4\">\r\n                        <h4 className={`text-[10px] font-black uppercase tracking-[0.3em] ${styles.text}`}>Samaradorlik</h4>\r\n                        <div className=\"p-6 rounded-2xl bg-black/40 border border-white/10 flex flex-col justify-center gap-4\">\r\n                            {effectiveScore !== undefined ? (\r\n                                <>\r\n                                    <div className=\"flex justify-between items-end\">\r\n                                        <span className=\"text-xs font-bold text-gray-500 uppercase tracking-widest\">Vitality Index</span>\r\n                                        <span className={`text-2xl font-black ${styles.text}`}>{effectiveScore}%</span>\r\n                                    </div>\r\n                                    <div className=\"h-3 bg-white/5 rounded-full overflow-hidden p-[2px] border border-white/5 shadow-inner\">\r\n                                        <div\r\n                                            className={`h-full ${styles.btnBg} rounded-full transition-all duration-[1.5s] ease-out-expo shadow-[0_0_15px_rgba(0,0,0,0.5)]`}\r\n                                            style={{ width: `${effectiveScore}%` }}\r\n                                        ></div>\r\n                                    </div>\r\n                                </>\r\n                            ) : effectiveInsight.potentialSavings ? (\r\n                                <div className=\"text-center\">\r\n                                    <span className=\"text-[10px] font-bold text-gray-500 uppercase tracking-widest block mb-1\">Potensial Tejov</span>\r\n                                    <div className={`text-2xl font-black ${styles.text} group-hover:scale-110 transition-transform`}>{effectiveInsight.potentialSavings}</div>\r\n                                </div>\r\n                            ) : (\r\n                                <div className=\"text-center py-4\">\r\n                                    <span className=\"text-4xl\">ЁЯТО</span>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Children for Custom Actions */}\r\n                    {children && (\r\n                        <div className=\"md:col-span-3 pt-6 animate-slide-up\">\r\n                            {children}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\dashboard\\AudioReport.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'voices' is assigned a value but never used.","line":23,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":25},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\AURA\\web\\src\\components\\dashboard\\AudioReport.tsx:43:9\n  41 |         u.onerror = () => setIsPlaying(false);\n  42 |\n> 43 |         setUtterance(u);\n     |         ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  44 |\n  45 |         if (autoPlay) {\n  46 |             synth.speak(u);","line":43,"column":9,"nodeType":null,"endLine":43,"endColumn":21},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":72,"column":78,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[2528,2529],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[2528,2529],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[2528,2529],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[2528,2529],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":72,"column":85,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[2535,2536],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[2535,2536],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[2535,2536],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[2535,2536],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { useState, useEffect } from 'react';\r\n\r\ninterface AudioReportProps {\r\n    text: string;\r\n    onStart?: () => void;\r\n    onEnd?: () => void;\r\n    autoPlay?: boolean;\r\n}\r\n\r\nexport const AudioReport: React.FC<AudioReportProps> = ({ text, onStart, onEnd, autoPlay = false }) => {\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [utterance, setUtterance] = useState<SpeechSynthesisUtterance | null>(null);\r\n\r\n    useEffect(() => {\r\n        if (!text) return;\r\n        const synth = window.speechSynthesis;\r\n        const u = new SpeechSynthesisUtterance(text);\r\n\r\n        // Try to find a good voice (standardizing on a clear one if possible)\r\n        // voices are loaded asynchronously\r\n        const setVoice = () => {\r\n            const voices = synth.getVoices();\r\n            // AURA uses Uz, En, Ru. For Uz we often fallback to default or Turkish/Russian for similar phonetics if Uz is missing.\r\n            // For now, let's keep it simple.\r\n        };\r\n\r\n        if (synth.onvoiceschanged !== undefined) {\r\n            synth.onvoiceschanged = setVoice;\r\n        }\r\n        setVoice();\r\n\r\n        u.onstart = () => {\r\n            setIsPlaying(true);\r\n            onStart?.();\r\n        };\r\n        u.onend = () => {\r\n            setIsPlaying(false);\r\n            onEnd?.();\r\n        };\r\n        u.onerror = () => setIsPlaying(false);\r\n\r\n        setUtterance(u);\r\n\r\n        if (autoPlay) {\r\n            synth.speak(u);\r\n        }\r\n\r\n        return () => {\r\n            synth.cancel();\r\n        };\r\n    }, [text, autoPlay, onStart, onEnd]);\r\n\r\n    const handlePlay = () => {\r\n        if (utterance) {\r\n            window.speechSynthesis.speak(utterance);\r\n        }\r\n    };\r\n\r\n    const handleStop = () => {\r\n        window.speechSynthesis.cancel();\r\n        setIsPlaying(false);\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex items-center gap-4 p-4 rounded-2xl bg-white/5 border border-white/10 animate-fade-in group hover:bg-white/10 transition-all\">\r\n            <div className={`w-12 h-12 rounded-full flex items-center justify-center transition-all ${isPlaying ? 'bg-aura-cyan shadow-[0_0_20px_rgba(0,240,255,0.4)] animate-pulse' : 'bg-white/10'}`}>\r\n                {isPlaying ? <span className=\"animate-bounce\">ЁЯФК</span> : 'ЁЯФИ'}\r\n            </div>\r\n            <div className=\"flex-1\">\r\n                <h4 className=\"text-white font-bold text-sm tracking-tight\">AI Health Summary</h4>\r\n                <p className=\"text-[10px] text-gray-500 line-clamp-1 italic\">\"{text}\"</p>\r\n            </div>\r\n            <div className=\"flex gap-2\">\r\n                {!isPlaying ? (\r\n                    <button\r\n                        onClick={handlePlay}\r\n                        className=\"px-4 py-2 rounded-xl bg-aura-cyan text-black font-black text-[10px] uppercase tracking-widest hover:scale-105 transition-transform active:scale-95 shadow-[0_4px_15px_rgba(0,240,255,0.3)]\"\r\n                    >\r\n                        Listen\r\n                    </button>\r\n                ) : (\r\n                    <button\r\n                        onClick={handleStop}\r\n                        className=\"px-4 py-2 rounded-xl bg-aura-red text-white font-black text-[10px] uppercase tracking-widest hover:scale-105 transition-transform active:scale-95\"\r\n                    >\r\n                        Stop\r\n                    </button>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\dashboard\\DateNavigator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\dashboard\\FocusOverlay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\dashboard\\NavSidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":84,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":87,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2930,2933],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2930,2933],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport Link from 'next/link';\r\nimport Image from 'next/image';\r\nimport { usePathname } from 'next/navigation';\r\n\r\n\r\n\r\nimport { useLanguage } from '@/context/LanguageContext';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useNotifications } from '@/context/NotificationContext';\r\n\r\nexport default function NavSidebar() {\r\n    const pathname = usePathname();\r\n    const { t } = useLanguage();\r\n    const { user, logout } = useAuth();\r\n    const { notifications } = useNotifications();\r\n\r\n    const navItems = [\r\n        { name: t.sidebar.dashboard, href: '/dashboard/', icon: 'тЪб' },\r\n        { name: t.sidebar.family, href: '/dashboard/family/', icon: 'ЁЯСитАНЁЯСйтАНЁЯСзтАНЁЯСж', key: 'family', hasAi: true },\r\n        { name: t.sidebar.finance, href: '/dashboard/finance/', icon: 'ЁЯТ╕', key: 'finance', hasAi: true },\r\n        { name: t.sidebar.tasks, href: '/dashboard/tasks/', icon: 'тЬЕ', key: 'tasks', hasAi: true },\r\n        { name: t.sidebar.health, href: '/dashboard/health/', icon: 'тЭдя╕П', key: 'health', hasAi: true },\r\n        { name: t.sidebar.food, href: '/dashboard/food/', icon: 'ЁЯеЧ', key: 'food', hasAi: true },\r\n        { name: t.sidebar.mind, href: '/dashboard/mind/', icon: 'ЁЯза', key: 'mind', hasAi: true },\r\n        { name: t.sidebar.interests, href: '/dashboard/interests/', icon: 'ЁЯОи', key: 'interests', hasAi: true },\r\n        { name: t.sidebar.settings, href: '/dashboard/settings/', icon: 'тЪЩя╕П' },\r\n    ];\r\n\r\n    return (\r\n        <aside className=\"w-64 h-screen fixed left-0 top-0 pointer-events-none z-50 flex flex-col p-4\">\r\n            {/* Glass Container */}\r\n            <div className=\"w-full h-full bg-black/60 backdrop-blur-xl border border-white/10 rounded-3xl pointer-events-auto flex flex-col overflow-hidden shadow-[0_0_30px_rgba(0,0,0,0.5)]\">\r\n\r\n                {/* Logo Area */}\r\n                <div className=\"p-6 flex items-center gap-3 border-b border-white/5\">\r\n                    <Image src=\"/logo_v3.png\" alt=\"AURA\" width={40} height={40} className=\"rounded-full shadow-[0_0_15px_rgba(0,240,255,0.3)]\" />\r\n                    <span className=\"font-display font-bold text-xl tracking-wider text-white\">AURA</span>\r\n                </div>\r\n\r\n                {/* Navigation */}\r\n                <nav className=\"flex-1 p-4 space-y-2 overflow-y-auto custom-scrollbar\">\r\n                    {navItems.map((item) => {\r\n                        // Handle trailing slashes explicitly since we re-enabled trailingSlash: true\r\n                        const currentPath = pathname.endsWith('/') ? pathname : pathname + '/';\r\n                        const itemHref = item.href.endsWith('/') ? item.href : item.href + '/';\r\n\r\n                        const isActive = currentPath === itemHref || currentPath.startsWith(itemHref);\r\n\r\n                        // UI FORCE CLEAR: If active, show 0 immediately\r\n                        const count = isActive ? 0 : (item.key ? (notifications as any)[item.key] : 0);\r\n\r\n                        return (\r\n                            <Link\r\n                                key={item.href}\r\n                                href={item.href}\r\n                                prefetch={false} // Prevent 404 errors on static export\r\n                                className={`flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${isActive ? 'bg-aura-purple text-white shadow-lg shadow-aura-purple/20 scale-105' : 'text-gray-500 hover:text-white hover:bg-white/5'}`}\r\n                            >\r\n                                <span className=\"text-xl group-hover:scale-110 transition-transform\">{item.icon}</span>\r\n                                <span className=\"font-medium text-sm tracking-wide flex-1\">{item.name}</span>\r\n\r\n                                {(count > 0 || item.hasAi) && (\r\n                                    <div className=\"relative flex items-center justify-center\">\r\n\r\n                                        <span className=\"absolute w-4 h-4 bg-aura-cyan/40 rounded-full animate-ping\"></span>\r\n                                        <span className=\"relative z-10 bg-aura-cyan text-black text-[9px] font-black px-1.5 py-0.5 rounded-full shadow-[0_0_12px_rgba(0,240,255,0.6)] border border-white/20\">\r\n                                            AI\r\n                                        </span>\r\n                                    </div>\r\n                                )}\r\n                            </Link>\r\n                        );\r\n                    })}\r\n                </nav>\r\n\r\n                {/* User Profile / Bottom */}\r\n                <div className=\"p-4 border-t border-white/5 bg-black/20\">\r\n                    <div onClick={logout} className=\"flex items-center gap-3 p-2 rounded-xl hover:bg-white/5 cursor-pointer transition-colors group\" title=\"Click to Logout\">\r\n                        <div className=\"w-10 h-10 rounded-full bg-gradient-to-tr from-aura-purple to-aura-cyan p-[2px]\">\r\n                            <div className=\"w-full h-full rounded-full bg-black overflow-hidden flex items-center justify-center text-xs font-bold\">\r\n                                {user?.email ? user.email[0].toUpperCase() : 'U'}\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                            <p className=\"text-sm font-bold text-white truncate\">{user?.displayName || (user?.email?.split('@')[0]) || 'User'}</p>\r\n                            <p className=\"text-xs text-gray-500 truncate group-hover:text-aura-red transition-colors\">Log Out</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </aside>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\dashboard\\ReadOnlyBanner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\dashboard\\SmartOnboarding.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\family\\FamilyTree.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\family\\LinkageWizard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\family\\MemberNode.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[590,593],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[590,593],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2072,2075],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2072,2075],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":40,"column":25,"nodeType":"JSXOpeningElement","endLine":40,"endColumn":117},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2133,2136],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2133,2136],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":53,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3162,3165],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3162,3165],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":54,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3248,3251],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3248,3251],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3354,3357],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3354,3357],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":67,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3909,3912],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3909,3912],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":67,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3942,3945],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3942,3945],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":67,"column":110,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":113,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3982,3985],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3982,3985],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":67,"column":147,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":150,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4019,4022],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4019,4022],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":68,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4097,4100],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4097,4100],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":68,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4136,4139],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4136,4139],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { memo } from 'react';\r\nimport { Handle, Position, NodeProps } from 'reactflow';\r\nimport { FamilyMember, Ancestor } from '@/services/familyService';\r\n\r\nexport interface MemberNodeData {\r\n    member: FamilyMember | Ancestor;\r\n    isCenter?: boolean;\r\n    onEdit?: (id: string) => void;\r\n    onAddRelative?: (id: string) => void;\r\n}\r\n\r\nconst MemberNode = ({ data, selected }: NodeProps<MemberNodeData>) => {\r\n    const { member, isCenter, onEdit, onAddRelative } = data;\r\n    const role = (member.role || \"A'zo\").toLowerCase();\r\n    const isDeceased = (member as any).status === 'Deceased';\r\n\r\n    const handleStyle = { background: '#555', width: 8, height: 8, borderRadius: '50%' };\r\n\r\n    return (\r\n        <div className={`relative w-48 transition-all duration-300 ${selected ? 'scale-105 z-50' : ''}`}>\r\n            {/* Connection Handles */}\r\n            <Handle type=\"target\" position={Position.Top} id=\"top\" style={{ ...handleStyle, top: -4 }} />\r\n            <Handle type=\"source\" position={Position.Bottom} id=\"bottom\" style={{ ...handleStyle, bottom: -4 }} />\r\n            <Handle type=\"source\" position={Position.Left} id=\"left\" style={{ ...handleStyle, left: -4, background: '#D4AF37' }} />\r\n            <Handle type=\"source\" position={Position.Right} id=\"right\" style={{ ...handleStyle, right: -4, background: '#D4AF37' }} />\r\n\r\n            <div className={`\r\n                flex flex-col items-center p-3 rounded-2xl border backdrop-blur-md shadow-2xl\r\n                ${isCenter ? 'bg-aura-cyan/10 border-aura-cyan/50' : 'bg-black/60 border-white/10'}\r\n                ${selected ? 'border-aura-gold ring-2 ring-aura-gold/20' : 'hover:border-white/30'}\r\n                transition-all cursor-pointer\r\n            `}>\r\n\r\n                {/* Avatar */}\r\n                <div className={`relative w-16 h-16 rounded-full border-2 mb-2 overflow-hidden bg-white/5\r\n                    ${isDeceased ? 'border-gray-600 grayscale' : isCenter ? 'border-aura-cyan' : 'border-white/20'}\r\n                `}>\r\n                    {(member as any).photo ? (\r\n                        <img src={(member as any).photo} alt={member.name} className=\"w-full h-full object-cover\" />\r\n                    ) : (\r\n                        <div className=\"w-full h-full flex items-center justify-center text-2xl\">\r\n                            {role.includes('mother') || role.includes('buvi') || role.includes('ayol') || role.includes('amma') || role.includes('xola') ? 'ЁЯС╡' :\r\n                                role.includes('father') || role.includes('bobo') || role.includes('erkak') || role.includes('tog\\'a') || role.includes('amaki') ? 'ЁЯС┤' :\r\n                                    role.includes('son') || role.includes('o\\'g\\'il') ? 'ЁЯСж' :\r\n                                        role.includes('daughter') || role.includes('qiz') ? 'ЁЯСз' : 'ЁЯСд'}\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Status Indicator */}\r\n                    {!isDeceased && (\r\n                        <div className={`absolute bottom-0 right-0 w-4 h-4 rounded-full border-2 border-black\r\n                            ${(member as any).mood === 'happy' ? 'bg-aura-green' :\r\n                                (member as any).mood === 'stressed' ? 'bg-aura-red' : 'bg-aura-blue'}\r\n                         `} title={(member as any).mood}></div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Info */}\r\n                <div className=\"text-center w-full\">\r\n                    <h3 className=\"text-sm font-bold text-white truncate px-2\">{member.name}</h3>\r\n                    <p className=\"text-[10px] text-aura-gold/80 uppercase tracking-wider font-bold truncate\">\r\n                        {member.role || \"A'zo\"}\r\n                    </p>\r\n\r\n                    <div className=\"text-[9px] text-gray-500 font-mono mt-1\">\r\n                        {(member as any).birth ? new Date((member as any).birth).getFullYear() : ((member as any).birthDate ? new Date((member as any).birthDate).getFullYear() : '????')}\r\n                        {(member as any).death ? ` - ${new Date((member as any).death).getFullYear()}` : ''}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Actions (visible when selected or clustered) */}\r\n                {selected && (\r\n                    <div className=\"absolute -bottom-10 left-1/2 -translate-x-1/2 flex gap-2 bg-black/80 p-1.5 rounded-lg border border-white/10 shadow-xl backdrop-blur-xl z-50\">\r\n                        <button onClick={() => onAddRelative?.(member.id)} className=\"p-1.5 rounded bg-white/10 hover:bg-white/20 text-xs text-white\" title=\"Add Relative\">\r\n                            тЮХ\r\n                        </button>\r\n                        <button onClick={() => onEdit?.(member.id)} className=\"p-1.5 rounded bg-white/10 hover:bg-white/20 text-xs text-white\" title=\"Edit\">\r\n                            тЬПя╕П\r\n                        </button>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(MemberNode);\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\components\\landing\\ProductModals.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[269,272],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[269,272],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1189,1192],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1189,1192],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":46,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2592,2595],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2592,2595],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":80,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":80,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5595,5598],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5595,5598],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":112,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":112,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7871,7874],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7871,7874],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React from 'react';\r\nimport Modal from '../Modal';\r\n\r\ninterface ProductModalsProps {\r\n    type: 'features' | 'pricing' | 'enterprise' | 'download' | 'about' | 'missions' | 'careers' | 'contact' | null;\r\n    onClose: () => void;\r\n    translations: any;\r\n}\r\n\r\nexport default function ProductModals({ type, onClose, translations }: ProductModalsProps) {\r\n    if (!type) return null;\r\n\r\n    const pt = translations.product_details;\r\n    const ct = translations.company_details;\r\n\r\n    const renderContent = () => {\r\n        switch (type) {\r\n            case 'features':\r\n                return (\r\n                    <div className=\"space-y-6 py-4\">\r\n                        <div className=\"text-center max-w-xl mx-auto\">\r\n                            <h2 className=\"text-3xl font-display font-black text-white mb-2 tracking-tighter uppercase italic\">{pt.features.title}</h2>\r\n                            <p className=\"text-gray-400 text-sm font-light leading-relaxed\">{pt.features.subtitle}</p>\r\n                        </div>\r\n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                            {pt.features.modules.map((module: any, i: number) => (\r\n                                <div key={i} className=\"group p-5 rounded-[1.5rem] bg-white/[0.02] border border-white/5 hover:bg-white/[0.04] transition-all duration-500\">\r\n                                    <span className=\"text-aura-cyan font-black text-[9px] uppercase tracking-[0.3em] mb-2 block\">Module {i + 1}</span>\r\n                                    <h4 className=\"text-lg font-display font-bold text-white mb-2 uppercase italic tracking-tight leading-tight\">{module.name}</h4>\r\n                                    <p className=\"text-gray-400 text-[11px] font-light leading-snug\">{module.desc}</p>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                );\r\n\r\n            case 'pricing':\r\n                return (\r\n                    <div className=\"space-y-12 py-8\">\r\n                        <div className=\"text-center max-w-xl mx-auto\">\r\n                            <h2 className=\"text-4xl font-display font-black text-white mb-4 tracking-tighter uppercase italic\">{pt.pricing.title}</h2>\r\n                            <p className=\"text-gray-400 font-light leading-relaxed\">{pt.pricing.subtitle}</p>\r\n                        </div>\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                            {pt.pricing.plans.map((plan: any, i: number) => (\r\n                                <div key={i} className={`p-8 rounded-[2.5rem] flex flex-col h-full transition-all duration-500 border ${plan.name === 'Expert' ? 'bg-white/[0.03] border-aura-cyan/30 shadow-[0_0_50px_rgba(0,255,255,0.05)] scale-105 z-10' : 'bg-white/[0.01] border-white/5'}`}>\r\n                                    <div className=\"mb-8\">\r\n                                        <h4 className={`text-xs font-black uppercase tracking-[0.4em] mb-4 ${plan.name === 'Expert' ? 'text-aura-cyan' : 'text-gray-500'}`}>{plan.name}</h4>\r\n                                        <div className=\"flex items-baseline gap-1\">\r\n                                            <span className=\"text-5xl font-display font-black text-white\">${plan.price}</span>\r\n                                            <span className=\"text-gray-500 text-xs font-light tracking-widest uppercase\">/ {plan.period}</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <ul className=\"space-y-4 mb-10 flex-1\">\r\n                                        {plan.features.map((feat: string, fi: number) => (\r\n                                            <li key={fi} className=\"flex items-center gap-3 text-sm text-gray-300 font-light\">\r\n                                                <svg className={`w-4 h-4 flex-shrink-0 ${plan.name === 'Expert' ? 'text-aura-cyan' : 'text-aura-cyan/40'}`} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n                                                </svg>\r\n                                                {feat}\r\n                                            </li>\r\n                                        ))}\r\n                                    </ul>\r\n                                    <button className={`w-full py-4 rounded-2xl font-black uppercase tracking-widest text-[10px] transition-all ${plan.name === 'Expert' ? 'bg-aura-cyan text-black shadow-lg shadow-aura-cyan/20 hover:scale-105 active:scale-95' : 'bg-white/5 text-white hover:bg-white/10'}`}>Get Started</button>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                );\r\n\r\n            case 'enterprise':\r\n                return (\r\n                    <div className=\"space-y-12 py-8 max-w-2xl mx-auto\">\r\n                        <div className=\"text-center\">\r\n                            <h2 className=\"text-4xl font-display font-black text-white mb-4 tracking-tighter uppercase italic\">{pt.enterprise.title}</h2>\r\n                            <p className=\"text-gray-400 font-light leading-relaxed\">{pt.enterprise.subtitle}</p>\r\n                        </div>\r\n                        <div className=\"space-y-4\">\r\n                            {pt.enterprise.features.map((feat: any, i: number) => (\r\n                                <div key={i} className=\"p-6 rounded-2xl bg-white/[0.02] border border-white/5 flex gap-6 items-center\">\r\n                                    <div className=\"w-12 h-12 rounded-xl bg-aura-cyan/10 flex items-center justify-center text-aura-cyan text-xl\">тШЕ</div>\r\n                                    <div>\r\n                                        <h4 className=\"text-white font-bold mb-1\">{feat.name}</h4>\r\n                                        <p className=\"text-gray-400 text-sm font-light\">{feat.desc}</p>\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                );\r\n\r\n            case 'download':\r\n                return (\r\n                    <div className=\"space-y-12 py-8 max-w-2xl mx-auto\">\r\n                        <div className=\"text-center\">\r\n                            <h2 className=\"text-4xl font-display font-black text-white mb-4 tracking-tighter uppercase italic\">{pt.download.title}</h2>\r\n                            <p className=\"text-gray-400 font-light leading-relaxed\">{pt.download.subtitle}</p>\r\n                        </div>\r\n                        <div className=\"bg-aura-cyan/5 border border-aura-cyan/20 p-8 rounded-[2rem] space-y-6\">\r\n                            <h4 className=\"text-aura-cyan font-black uppercase tracking-widest text-xs\">{pt.download.pwa.title}</h4>\r\n                            <div className=\"space-y-4\">\r\n                                {pt.download.pwa.steps.map((step: string, i: number) => (\r\n                                    <div key={i} className=\"flex gap-4 items-start text-gray-300 text-sm font-light\">\r\n                                        <span className=\"w-6 h-6 rounded-full bg-aura-cyan text-black flex items-center justify-center text-[10px] font-black flex-shrink-0\">{i + 1}</span>\r\n                                        <p>{step}</p>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            {pt.download.stores.map((store: any, i: number) => (\r\n                                <div key={i} className=\"p-6 rounded-2xl bg-white/[0.02] border border-white/5 text-center group cursor-not-allowed\">\r\n                                    <span className=\"text-white font-bold block mb-1\">{store.name}</span>\r\n                                    <span className=\"text-gray-600 text-[10px] uppercase font-black tracking-widest\">{store.available}</span>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                );\r\n\r\n            case 'about':\r\n                return (\r\n                    <div className=\"py-8 max-w-2xl mx-auto space-y-8 text-center\">\r\n                        <h2 className=\"text-4xl font-display font-black text-white uppercase italic tracking-tighter\">{ct.about.title}</h2>\r\n                        <div className=\"w-20 h-1 bg-aura-cyan mx-auto rounded-full\"></div>\r\n                        <p className=\"text-gray-300 text-lg font-light leading-relaxed italic\">{ct.about.text}</p>\r\n                    </div>\r\n                );\r\n\r\n            case 'missions':\r\n                return (\r\n                    <div className=\"py-8 max-w-2xl mx-auto space-y-12\">\r\n                        <div className=\"text-center\">\r\n                            <h2 className=\"text-4xl font-display font-black text-white uppercase italic tracking-tighter\">{ct.missions.title}</h2>\r\n                        </div>\r\n                        <div className=\"space-y-6\">\r\n                            {ct.missions.list.map((m: string, i: number) => (\r\n                                <div key={i} className=\"flex gap-6 items-center p-8 rounded-[2rem] bg-white/[0.02] border border-white/5 hover:border-aura-cyan/30 transition-all\">\r\n                                    <span className=\"text-4xl font-display font-black text-aura-cyan/20\">0{i + 1}</span>\r\n                                    <p className=\"text-white text-lg font-light\">{m}</p>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                );\r\n\r\n            case 'careers':\r\n                return (\r\n                    <div className=\"py-8 max-w-2xl mx-auto space-y-8 text-center\">\r\n                        <h2 className=\"text-4xl font-display font-black text-white uppercase italic tracking-tighter\">{ct.careers.title}</h2>\r\n                        <p className=\"text-aura-cyan font-black uppercase tracking-[0.3em] text-xs\">{ct.careers.subtitle}</p>\r\n                        <p className=\"text-gray-400 font-light leading-relaxed\">{ct.careers.text}</p>\r\n                        <button className=\"px-12 py-5 rounded-2xl bg-white text-black font-black uppercase tracking-widest text-[10px] hover:bg-aura-cyan transition-all transform hover:scale-105\">\r\n                            {ct.careers.cta}\r\n                        </button>\r\n                    </div>\r\n                );\r\n\r\n            case 'contact':\r\n                return (\r\n                    <div className=\"py-8 max-w-2xl mx-auto space-y-12 text-center\">\r\n                        <div>\r\n                            <h2 className=\"text-4xl font-display font-black text-white uppercase italic tracking-tighter mb-4\">{ct.contact.title}</h2>\r\n                            <p className=\"text-gray-400 font-light italic\">{ct.contact.subtitle}</p>\r\n                        </div>\r\n                        <a href={`mailto:${ct.contact.email}`} className=\"text-2xl md:text-4xl font-display font-bold text-white hover:text-aura-cyan transition-all tracking-tighter underline underline-offset-8 decoration-aura-cyan/30\">\r\n                            {ct.contact.email}\r\n                        </a>\r\n                        <div className=\"space-y-4\">\r\n                            <div className=\"text-aura-cyan font-black text-[10px] uppercase tracking-[0.4em] mb-2\">{ct.contact.handle ? `@${ct.contact.handle}` : ''}</div>\r\n                            <div className=\"flex gap-6 justify-center\">\r\n                                {ct.contact.socials.map((s: string, i: number) => (\r\n                                    <span key={i} className=\"text-xs font-black uppercase tracking-widest text-gray-500 hover:text-white cursor-pointer transition-all\">{s}</span>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                );\r\n\r\n            default: return null;\r\n        }\r\n    };\r\n\r\n    const modalSize = (type === 'features' || type === 'pricing') ? 'max-w-5xl' : 'max-w-2xl';\r\n\r\n    return (\r\n        <Modal isOpen={!!type} onClose={onClose} title=\"\" className={modalSize}>\r\n            {renderContent()}\r\n        </Modal>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\context\\AuthContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\context\\FocusContext.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`handleComplete` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nD:\\AURA\\web\\src\\context\\FocusContext.tsx:42:13\n  40 |             }, 1000);\n  41 |         } else if (timeLeft === 0 && isActive) {\n> 42 |             handleComplete();\n     |             ^^^^^^^^^^^^^^ `handleComplete` accessed before it is declared\n  43 |         }\n  44 |\n  45 |         return () => {\n\nD:\\AURA\\web\\src\\context\\FocusContext.tsx:50:5\n  48 |     }, [isActive, isPaused, timeLeft]);\n  49 |\n> 50 |     const handleComplete = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 51 |         if (user && sessionId) {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 52 |             // Play completion sound\n     тАж\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 59 |         }\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 60 |     };\n     | ^^^^^^^ `handleComplete` is declared here\n  61 |\n  62 |     const startSession = async (mins: number, tId?: string, tName?: string) => {\n  63 |         if (!user) return;","line":42,"column":13,"nodeType":null,"endLine":42,"endColumn":27},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'handleComplete'. Either include it or remove the dependency array.","line":48,"column":8,"nodeType":"ArrayExpression","endLine":48,"endColumn":38,"suggestions":[{"desc":"Update the dependencies array to be: [handleComplete, isActive, isPaused, timeLeft]","fix":{"range":[1879,1909],"text":"[handleComplete, isActive, isPaused, timeLeft]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":54,"column":42,"nodeType":null,"messageId":"unusedVar","endLine":54,"endColumn":43}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { createContext, useContext, useState, useEffect, useRef } from 'react';\r\nimport { useAuth } from './AuthContext';\r\nimport { startFocusSession, endFocusSession, incrementDistraction } from '@/services/focusService';\r\n\r\ninterface FocusContextType {\r\n    isActive: boolean;\r\n    isPaused: boolean;\r\n    timeLeft: number;\r\n    duration: number;\r\n    sessionId: string | null;\r\n    taskName: string | null;\r\n    taskId: string | null;\r\n    distractions: number;\r\n    startSession: (mins: number, taskId?: string, taskName?: string) => Promise<void>;\r\n    pauseSession: () => void;\r\n    resumeSession: () => void;\r\n    endSession: (status: 'completed' | 'failed' | 'cancelled') => Promise<void>;\r\n}\r\n\r\nconst FocusContext = createContext<FocusContextType | undefined>(undefined);\r\n\r\nexport const FocusProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const { user } = useAuth();\r\n    const [isActive, setIsActive] = useState(false);\r\n    const [isPaused, setIsPaused] = useState(false);\r\n    const [timeLeft, setTimeLeft] = useState(0);\r\n    const [duration, setDuration] = useState(25);\r\n    const [sessionId, setSessionId] = useState<string | null>(null);\r\n    const [taskName, setTaskName] = useState<string | null>(null);\r\n    const [taskId, setTaskId] = useState<string | null>(null);\r\n    const [distractions, setDistractions] = useState(0);\r\n\r\n    const intervalRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n    useEffect(() => {\r\n        if (isActive && !isPaused && timeLeft > 0) {\r\n            intervalRef.current = setInterval(() => {\r\n                setTimeLeft(prev => prev - 1);\r\n            }, 1000);\r\n        } else if (timeLeft === 0 && isActive) {\r\n            handleComplete();\r\n        }\r\n\r\n        return () => {\r\n            if (intervalRef.current) clearInterval(intervalRef.current);\r\n        };\r\n    }, [isActive, isPaused, timeLeft]);\r\n\r\n    const handleComplete = async () => {\r\n        if (user && sessionId) {\r\n            // Play completion sound\r\n            const completionSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-bright-msg-notifier-1044.mp3');\r\n            completionSound.play().catch(e => console.log(\"Audio play blocked by browser\"));\r\n\r\n            await endFocusSession(user.uid, sessionId, 'completed', distractions);\r\n            setIsActive(false);\r\n            setSessionId(null);\r\n        }\r\n    };\r\n\r\n    const startSession = async (mins: number, tId?: string, tName?: string) => {\r\n        if (!user) return;\r\n        const id = await startFocusSession(user.uid, mins, tId, tName);\r\n        setSessionId(id);\r\n        setDuration(mins);\r\n        setTimeLeft(mins * 60);\r\n        setTaskId(tId || null);\r\n        setTaskName(tName || null);\r\n        setDistractions(0);\r\n        setIsActive(true);\r\n        setIsPaused(false);\r\n    };\r\n\r\n    const pauseSession = () => setIsPaused(true);\r\n    const resumeSession = () => setIsPaused(false);\r\n\r\n    const endSession = async (status: 'completed' | 'failed' | 'cancelled') => {\r\n        if (user && sessionId) {\r\n            await endFocusSession(user.uid, sessionId, status, distractions);\r\n            setIsActive(false);\r\n            setIsPaused(false);\r\n            setSessionId(null);\r\n        }\r\n    };\r\n\r\n    // Distraction detection (global)\r\n    useEffect(() => {\r\n        const handleVisibility = () => {\r\n            if (document.hidden && isActive && !isPaused && sessionId && user) {\r\n                setDistractions(prev => {\r\n                    const newCount = prev + 1;\r\n                    incrementDistraction(user.uid, sessionId, prev);\r\n                    return newCount;\r\n                });\r\n            }\r\n        };\r\n        document.addEventListener('visibilitychange', handleVisibility);\r\n        return () => document.removeEventListener('visibilitychange', handleVisibility);\r\n    }, [isActive, isPaused, sessionId, user]);\r\n\r\n    return (\r\n        <FocusContext.Provider value={{\r\n            isActive, isPaused, timeLeft, duration, sessionId, taskName, taskId, distractions,\r\n            startSession, pauseSession, resumeSession, endSession\r\n        }}>\r\n            {children}\r\n        </FocusContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useFocus = () => {\r\n    const context = useContext(FocusContext);\r\n    if (context === undefined) {\r\n        throw new Error('useFocus must be used within a FocusProvider');\r\n    }\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\context\\LanguageContext.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\AURA\\web\\src\\context\\LanguageContext.tsx:2829:13\n  2827 |         const saved = localStorage.getItem('aura-lang') as Language;\n  2828 |         if (saved && ['en', 'uz', 'ru'].includes(saved)) {\n> 2829 |             setLanguage(saved);\n       |             ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  2830 |         }\n  2831 |     }, []);\n  2832 |","line":2829,"column":13,"nodeType":null,"endLine":2829,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\n\r\ntype Language = 'en' | 'uz' | 'ru';\r\n\r\ntype TranslationStructure = {\r\n    common: {\r\n        refresh: string;\r\n        save: string;\r\n        cancel: string;\r\n        back: string;\r\n        viewHistory: string;\r\n        history: string;\r\n        today: string;\r\n        yesterday: string;\r\n        done: string;\r\n        user: string;\r\n    };\r\n    nav: {\r\n        hero: string;\r\n        problem: string;\r\n        solution: string;\r\n        butterfly: string;\r\n        platforms: string;\r\n        family: string;\r\n    };\r\n    sidebar: {\r\n        dashboard: string;\r\n        family: string;\r\n        finance: string;\r\n        tasks: string;\r\n        health: string;\r\n        food: string;\r\n        mind: string;\r\n        interests: string;\r\n        liveness: string;\r\n        settings: string;\r\n        archived: string;\r\n    };\r\n    home: {\r\n        deepWork: string;\r\n        endSession: string;\r\n        rainOn: string;\r\n        ambientOff: string;\r\n        voiceCommand: string;\r\n        listening: string;\r\n        analyzing: string;\r\n        viewHistory: string;\r\n        simStress: string;\r\n        simCalm: string;\r\n        enterZen: string;\r\n        chronos: string;\r\n        atmosphere: string;\r\n        clearSky: string;\r\n        wealthPulse: string;\r\n        familyHub: string;\r\n        approval: string;\r\n        kidsTask: string;\r\n        waiting: string;\r\n        vitality: string;\r\n        geneticRisk: string;\r\n        nutrition: string;\r\n        hobbies: string;\r\n        streak: string;\r\n        dailyInsights: string;\r\n        batteryStatus: {\r\n            ready: string;\r\n            good: string;\r\n            tired: string;\r\n            rest: string;\r\n        };\r\n        thisMonth: string;\r\n        need_more_data: string;\r\n        analysis_error: string;\r\n        system_ready: string;\r\n        modules: {\r\n            finance: string;\r\n            health: string;\r\n            family: string;\r\n            mind: string;\r\n            food: string;\r\n        };\r\n    };\r\n    settings: {\r\n        title: string;\r\n        lang: string;\r\n        notifs: string;\r\n        dailyBrief: string;\r\n        focusAlerts: string;\r\n        familyUpdates: string;\r\n        system: string;\r\n        export: string;\r\n        reset: string;\r\n        currentLocale: string;\r\n        freePlan: string;\r\n        justNow: string;\r\n        dailyBriefDesc: string;\r\n        focusAlertsDesc: string;\r\n        familyUpdatesDesc: string;\r\n        exportSuccess: string;\r\n        resetScheduled: string;\r\n        logType: string;\r\n        logDevice: string;\r\n        logTime: string;\r\n        logLogin: string;\r\n        logWebDashboard: string;\r\n        profile: string;\r\n        securityLog: string;\r\n        logout: string;\r\n        yesterday: string;\r\n        today: string;\r\n        selectDate: string;\r\n    };\r\n    family: {\r\n        title: string;\r\n        subtitle: string;\r\n        readOnly: string;\r\n        readOnlyDesc: string;\r\n        liveHub: string;\r\n        genealogy: string;\r\n        smartParenting: string;\r\n        requests: string;\r\n        approve: string;\r\n        deny: string;\r\n        approved: string;\r\n        reward: string;\r\n        overallMood: string;\r\n        activeQuests: string;\r\n        familyXP: string;\r\n        gen1: string;\r\n        gen2: string;\r\n        gen3: string;\r\n        backToHub: string;\r\n        geneticProfile: string;\r\n        safetyMonitor: string;\r\n        emergencyCall: string;\r\n        parentalControls: string;\r\n        activityLog: string;\r\n        task: string;\r\n        date: string;\r\n        xp: string;\r\n    };\r\n    finance: {\r\n        title: string;\r\n        subtitle: string;\r\n        totalBalance: string;\r\n        monthlyBudget: string;\r\n        savingsGoal: string;\r\n        recentTransactions: string;\r\n        addTransaction: string;\r\n        dailyAnalysis: string;\r\n        dailyAnalysisText: string;\r\n        spendBreakdown: string;\r\n        viewAll: string;\r\n        investment: string;\r\n        credit: string;\r\n        debt: string;\r\n        confirmPaymentsInstruction: string;\r\n        centralBankRate: string;\r\n        realTimeCurrency: string;\r\n        liabilities: string;\r\n        assets: string;\r\n        initialAmount: string;\r\n        byCategory: string;\r\n        debtsPlusCredits: string;\r\n        returnPlusDeposits: string;\r\n        addDebt: string;\r\n        waitingForData: string;\r\n        vsLastMonth: string;\r\n        used: string;\r\n        left: string;\r\n        archivedDays: string;\r\n        readOnly: string;\r\n        readOnlyDesc: string;\r\n        dayClosed: string;\r\n        spent: string;\r\n        days: string;\r\n        weeks: string;\r\n        months: string;\r\n        years: string;\r\n        enterGoal: string;\r\n        deadline: string;\r\n        achieved: string;\r\n        noFunds: string;\r\n        limit: string;\r\n        target: string;\r\n        current: string;\r\n        perMonth: string;\r\n        incomeInsufficient: string;\r\n        iOwe: string;\r\n        owedToMe: string;\r\n        personName: string;\r\n        fullNamePlaceholder: string;\r\n        amount: string;\r\n        currency: string;\r\n        dateTaken: string;\r\n        dateGiven: string;\r\n        returnDate: string;\r\n        addCredit: string;\r\n        addDeposit: string;\r\n        creditName: string;\r\n        creditNamePlaceholder: string;\r\n        depositName: string;\r\n        depositNamePlaceholder: string;\r\n        totalAmount: string;\r\n        currentAmount: string;\r\n        incomeHistoryEmpty: string;\r\n        incomeHistoryEmptyDesc: string;\r\n        expenseHistoryEmpty: string;\r\n        expenseHistoryEmptyDesc: string;\r\n        incomePlan: string;\r\n        expenseControl: string;\r\n        voiceFeedback: {\r\n            listening: string;\r\n            processing: string;\r\n            done: string;\r\n        };\r\n        dailyFlow: string;\r\n        advancedStats: string;\r\n        incomeBudget: string;\r\n        expenseBudget: string;\r\n        targetIncome: string;\r\n        limitExpense: string;\r\n        ultimateGoalTitle: string;\r\n        currentStatus: string;\r\n        timeLeft: string;\r\n        remainingTime: string;\r\n        deadlineExpired: string;\r\n        paymentSuccess: string;\r\n        depositsEmpty: string;\r\n        creditsEmpty: string;\r\n        debtsEmpty: string;\r\n        confirm: string;\r\n        confirmPayment: string;\r\n        todayPayments: string;\r\n        monthlyPayment: string;\r\n        paymentDay: string;\r\n        interestRate: string;\r\n        termMonths: string;\r\n        calculationMethod: string;\r\n        annuity: string;\r\n        differential: string;\r\n        add: string;\r\n        yearlyProfit: string;\r\n        depositDeadline: string;\r\n        daysInMonth: string;\r\n        monthlyProfitChoice: string;\r\n        expectedMonthlyProfit: string;\r\n        startDate: string;\r\n        fillAllFields: string;\r\n        depositOpened: string;\r\n        investmentTransfer: string;\r\n        noDeadline: string;\r\n        extendDeadline: string;\r\n        fromCurrentBalance: string; // New\r\n        noExpenseRecord: string; // New\r\n        markAsIncome: string; // New\r\n        addFunds: string; // New\r\n        editGoalTitle: string;\r\n        editBudgetTitle: string;\r\n        budgetSaved: string;\r\n        incomeGrowthMessage: string;\r\n        expenseLimitMessage: string;\r\n        incomeAlmostTarget: string;\r\n        expenseAlmostLimit: string;\r\n        setNewReturnDate: string;\r\n        datePlaceholder: string;\r\n        creditPayment: string;\r\n        depositProfit: string;\r\n        probability: string;\r\n        aiWealthRoadmap: string;\r\n        analysisForGoal: string;\r\n        professionalPotentialDescription: (role: string) => string;\r\n        professionalPotential: string;\r\n        professionalPotentialDesc: string;\r\n        getCertification: string;\r\n        additionalIncomeChannel: string;\r\n        increaseInvestments: string;\r\n        recommendations: string;\r\n        viewFullAnalysis: string;\r\n        qrScanner: string;\r\n        qrScannerTitle: string;\r\n        qrScannerDesc: string;\r\n        qrScannerAction: string;\r\n        analyzing: string;\r\n        portfolio: string;\r\n        recentActivity: string;\r\n        noTransactions: string;\r\n        aiRoadmapTitle: string;\r\n        filesAnalysis: string;\r\n        detailedList: string;\r\n        monthlyAnalysisTitle: string;\r\n        monthlyIncomeTitle: string;\r\n        weeklyExpenseStats: string;\r\n        iOweLabel: string;\r\n        owedToMeLabel: string;\r\n        repaid: string;\r\n        repay: string;\r\n        extend: string;\r\n        dayLabel: string;\r\n        remaining: string;\r\n        payNow: string;\r\n        prepay: string;\r\n        collecting: string;\r\n        totalCollected: string;\r\n        monthlyPlan: string;\r\n        topUp: string;\r\n        noData: string;\r\n        aiPredictionTitle: string;\r\n        predictionPart1: string;\r\n        predictionPart2: string;\r\n        predictionTrend: (percent: number) => string;\r\n        predictionGoalAdvice: (goal: string, months: number) => string;\r\n        predictionDisclaimerText: string;\r\n        weeklyLabel: string;\r\n        monthlyLabel: string;\r\n        customLabel: string;\r\n        analysisSummary: string;\r\n        incomeTitle: string;\r\n        expenseTitle: string;\r\n        principalAmount: string;\r\n        interestAmount: string;\r\n        repaymentSplit: string;\r\n        realMoney: string;\r\n        transTitle: string;\r\n        transType: string;\r\n        transCategory: string;\r\n        depositActionTitle: string;\r\n        actionAdd: string;\r\n        actionWithdraw: string;\r\n        actionProfit: string;\r\n        sourceBalance: string;\r\n        sourceOutside: string;\r\n        // AI Status & Recs\r\n        financialStatus: string;\r\n        statusStart: string;\r\n        statusPositive: string;\r\n        statusDanger: string;\r\n        statusDescStart: string;\r\n        statusDescPositive: (percent: string) => string;\r\n        statusDescDanger: string;\r\n        recStart: string;\r\n        recSafety: string;\r\n        recDeposit: string;\r\n        recDebt: string;\r\n        recBudget: string;\r\n        statusOk: string;\r\n        predictionMsgExcellent: string;\r\n        predictionMsgGood: string;\r\n        predictionMsgOk: string;\r\n        predictionMsgBad: string;\r\n        fromLabel: string;\r\n        toLabel: string;\r\n        exportExcel: string;\r\n    };\r\n    categories: {\r\n        Salary: string;\r\n        Freelance: string;\r\n        Investment: string;\r\n        Gift: string;\r\n        OtherIncome: string; // 'Other Income' in mock\r\n        Food: string;\r\n        Transport: string;\r\n        Shopping: string;\r\n        Bills: string;\r\n        Health: string;\r\n        Education: string;\r\n        Leisure: string;\r\n        Other: string;\r\n        creditIn: string;\r\n        depositIn: string;\r\n        savings: string;\r\n        // Added keys for translations mapping\r\n        general: string;\r\n        music: string;\r\n        mind: string;\r\n    };\r\n    tasks: {\r\n        title: string;\r\n        subtitle: string;\r\n        newTask: string;\r\n        taskName: string;\r\n        startTime: string;\r\n        endTime: string;\r\n        priority: string;\r\n        low: string;\r\n        medium: string;\r\n        high: string;\r\n        createTask: string;\r\n        calendar: string;\r\n        upcomingTasks: string;\r\n        overdue: string;\r\n        future: string;\r\n        stats: {\r\n            completedToday: string;\r\n            pending: string;\r\n            efficiency: string;\r\n        };\r\n        sections: {\r\n            today: string;\r\n            upcoming: string;\r\n            completed: string;\r\n            overdue: string;\r\n            future: string;\r\n        };\r\n        aiSuggestion: {\r\n            title: string;\r\n            suggestion: string;\r\n            add: string;\r\n        };\r\n        actions: {\r\n            startFocus: string;\r\n            moveToToday: string;\r\n            subtask: string;\r\n            move: string;\r\n            focus: string;\r\n            edit: string;\r\n            delete: string;\r\n            promote: string;\r\n        };\r\n        noTasks: string;\r\n        completedArchive: string;\r\n        readOnly: string;\r\n        readOnlyDesc: string;\r\n    };\r\n    health: {\r\n        history: string;\r\n        readOnly: string;\r\n        readOnlyDesc: string;\r\n        title: string;\r\n        subtitle: string;\r\n        bodyBattery: {\r\n            title: string;\r\n            fullyCharged: string;\r\n            recharge: string;\r\n            sleepRestoration: string;\r\n            activeDrain: string;\r\n            stressTax: string;\r\n            hydrationEfficiency: string;\r\n        };\r\n        vitals: {\r\n            title: string; // Heart Rate Title\r\n            stressTitle: string;\r\n            resting: string;\r\n            heartRateUnit: string;\r\n            normalRange: string;\r\n            avgLevel: string;\r\n            low: string;\r\n            relaxedState: string;\r\n        };\r\n        sleep: {\r\n            score: string;\r\n            quality: string;\r\n            unit: string;\r\n        };\r\n        hydration: {\r\n            title: string;\r\n            goal: string;\r\n            unit: string;\r\n        };\r\n        activity: {\r\n            title: string;\r\n            stepsToday: string;\r\n            kcal: string;\r\n            dist: string;\r\n        };\r\n        trends: {\r\n            title: string;\r\n            stepsHistory: string;\r\n            sleepQuality: string;\r\n        };\r\n        days: {\r\n            mon: string;\r\n            tue: string;\r\n            wed: string;\r\n            thu: string;\r\n            fri: string;\r\n            sat: string;\r\n            sun: string;\r\n        };\r\n        biometrics: {\r\n            title: string;\r\n            aiRecTitle: string;\r\n            aiRecLose: string;\r\n            aiRecMaintain: string;\r\n            weight: string;\r\n            height: string;\r\n            goal: string;\r\n            lose: string;\r\n            gain: string;\r\n            maintain: string;\r\n            unitCm: string;\r\n            unitKg: string;\r\n        };\r\n        aiAdvisor: {\r\n            title: string;\r\n            analyzing: string;\r\n            hydrationLow: string;\r\n            stressHigh: string;\r\n            sleepLow: string;\r\n            allGood: string;\r\n        };\r\n        loading: string;\r\n        simulate: string;\r\n        batteryStatus: {\r\n            ready: string;\r\n            good: string;\r\n            tired: string;\r\n            rest: string;\r\n        };\r\n        voiceAlertSteps: string;\r\n        voiceAlertSleep: string;\r\n        voiceAlertWater: string;\r\n    };\r\n    food: {\r\n        title: string;\r\n        subtitle: string;\r\n        readOnly: string;\r\n        readOnlyDesc: string;\r\n        calories: string;\r\n        macros: string;\r\n        protein: string;\r\n        carbs: string;\r\n        fats: string;\r\n        mealLogs: string;\r\n        scanMeal: string;\r\n        dailyLog: string;\r\n        historyModalTitle: string;\r\n        cameraPrompt: string;\r\n        analyzing: string;\r\n        instantAdviceTitle: string;\r\n        targetAdvice: string;\r\n        scanError: string;\r\n        aiDetected: string;\r\n        eatQuestion: string;\r\n        yes: string;\r\n        no: string;\r\n        streak: string;\r\n        loading: string;\r\n        alertArchived: string;\r\n        mealQuick: string;\r\n        mealSnack: string;\r\n        mealBreakfast: string;\r\n        mealLunch: string;\r\n        mealDinner: string;\r\n        kcal: string;\r\n        unitG: string;\r\n    };\r\n    mind: {\r\n        title: string;\r\n        subtitle: string;\r\n        readOnly: string;\r\n        readOnlyDesc: string;\r\n        weeklyFocus: string;\r\n        focusingOn: string;\r\n        focus: string;\r\n        break: string;\r\n        moodSphere: string;\r\n        moodSphereDesc: string;\r\n        resonanceBreathing: string;\r\n        startSession: string;\r\n        stopSession: string;\r\n        inhale: string;\r\n        exhale: string;\r\n        hold: string;\r\n        ready: string;\r\n        aiSummaryTitle: string;\r\n        aiSummaryText: string;\r\n        historyModalTitle: string;\r\n        recentSessions: string;\r\n        moodTrends: string;\r\n        zenTitle: string;\r\n        zenSubtitle: string;\r\n        whyFeeling: string;\r\n        exitZen: string;\r\n        reasons: {\r\n            tired: string;\r\n            anxious: string;\r\n            overwhelmed: string;\r\n            justBecause: string;\r\n        };\r\n        loadingState: string;\r\n        saved: string;\r\n        saveMood: string;\r\n        zenMapLeft: string;\r\n        zenMapRight: string;\r\n        aiLoading: string;\r\n        aiPoweredBy: string;\r\n    };\r\n    focus: {\r\n        minutes: string;\r\n        done: string;\r\n    };\r\n    interests: {\r\n        title: string;\r\n        subtitle: string;\r\n        readOnly: string;\r\n        readOnlyDesc: string;\r\n        historyModalTitle: string;\r\n        practiceLog: string;\r\n        streak: string;\r\n        newHobby: string;\r\n        aiRecommendation: string;\r\n        aiReason: string;\r\n        tryThis: string;\r\n        hoursSpent: string;\r\n        nextLevel: string;\r\n        discoverNew: string;\r\n\r\n        addHobbyTitle: string;\r\n        hobbyName: string;\r\n        category: string;\r\n        loading: string;\r\n        categories: {\r\n            general: string;\r\n            art: string;\r\n            physical: string;\r\n            mind: string;\r\n            music: string;\r\n        };\r\n        placeholderName: string;\r\n        positive: string;\r\n        negative: string;\r\n        type: string;\r\n        trackingMode: string;\r\n        trackingFrequency: string;\r\n        trackingFrequencyDesc: string;\r\n        trackingBinary: string;\r\n        trackingBinaryDesc: string;\r\n        newHobbyCardTitle: string;\r\n        newHobbyCardDesc: string;\r\n        positiveInterests: string;\r\n        negativeHabits: string;\r\n        dailyActivities: string;\r\n        aiRecStatus: string;\r\n        statCount: string;\r\n        statDuration: string;\r\n        loyaltyXP: string;\r\n        done: string;\r\n        logCount: string;\r\n        log: string;\r\n        status: string;\r\n        times: string;\r\n        level: string;\r\n        totalHours: string;\r\n        totalControl: string;\r\n        logDurationQuestion: string;\r\n        aiRecTitleCorrection: string;\r\n        aiRecTitleGrowth: string;\r\n        aiRecDone: string;\r\n        aiRecTask: string;\r\n        aiRecAddTask: string;\r\n        noActivities: string;\r\n        selectHobby: string;\r\n        notDone: string;\r\n        todayLabel: string;\r\n        dailyStats: string;\r\n    };\r\n    butterfly: {\r\n        title: string;\r\n        subtitle: string;\r\n        analyzing: string;\r\n        lifeHarmony: string;\r\n        keyInsights: string;\r\n        noCorrelations: string;\r\n        keepLogging: string;\r\n        confident: string;\r\n        fixThis: string;\r\n        states: {\r\n            harmonic: string;\r\n            fragmented: string;\r\n            disconnected: string;\r\n        };\r\n        descriptions: {\r\n            harmonic: string;\r\n            fragmented: string;\r\n            disconnected: string;\r\n        };\r\n        insights: {\r\n            sleepProductivityNegative: (sleep: string, productivity: string) => string;\r\n            sleepProductivityPositive: (sleep: string, productivity: string) => string;\r\n            financeMindNegative: (stress: string, mood: number) => string;\r\n            foodHealthNegative: (calories: string, energy: number) => string;\r\n            foodHealthPositive: (protein: string, energy: number) => string;\r\n            focusInterestsPositive: (focus: number, streak: number) => string;\r\n            familyMindPositive: (members: number, mood: number) => string;\r\n        };\r\n        actions: {\r\n            sleep: string;\r\n            finance: string;\r\n            food: string;\r\n        };\r\n    };\r\n    liveness_section: {\r\n        title: string;\r\n        subtitle: string;\r\n        desc: string;\r\n        cta: string;\r\n        silent_mode: string;\r\n        silent_mode_desc: string;\r\n        activity_log: string;\r\n        panic_alert: string;\r\n        panic_confirm: string;\r\n        countdown_prefix: string;\r\n        checkInPrompt: string;\r\n        familyAlert: (hours: number) => string;\r\n    };\r\n};\r\n\r\nconst translations: Record<Language, TranslationStructure> = {\r\n    en: {\r\n        common: {\r\n            refresh: 'Refresh',\r\n            save: 'Save',\r\n            cancel: 'Cancel',\r\n            back: 'Back',\r\n            viewHistory: 'View History',\r\n            history: 'History',\r\n            today: 'Today',\r\n            yesterday: 'Yesterday',\r\n            done: 'Done',\r\n            user: 'User'\r\n        },\r\n        nav: {\r\n            hero: 'Home',\r\n            problem: 'Problem',\r\n            solution: 'Solution',\r\n            butterfly: 'Butterfly',\r\n            platforms: 'Platforms',\r\n            family: 'Family'\r\n        },\r\n        sidebar: {\r\n            dashboard: 'Dashboard',\r\n            family: 'Family',\r\n            finance: 'Finance',\r\n            tasks: 'Tasks',\r\n            health: 'Health',\r\n            food: 'Food',\r\n            mind: 'Mind',\r\n            interests: 'Interests',\r\n            liveness: 'Life Beacon',\r\n            settings: 'Settings',\r\n            archived: 'Archived'\r\n        },\r\n        home: {\r\n            deepWork: 'DEEP WORK SESSION',\r\n            endSession: 'End Session',\r\n            rainOn: 'Rain On',\r\n            ambientOff: 'Ambient Off',\r\n            voiceCommand: 'Voice Command',\r\n            listening: 'Listening...',\r\n            analyzing: 'Analyzing system...',\r\n            viewHistory: 'View History',\r\n            simStress: 'Sim Stress',\r\n            simCalm: 'Sim Calm',\r\n            enterZen: 'Enter Zen',\r\n            chronos: 'Chronos',\r\n            atmosphere: 'Atmosphere',\r\n            clearSky: 'Clear Sky',\r\n            wealthPulse: 'Wealth Pulse',\r\n            familyHub: 'Family Hub',\r\n            approval: '1 Approval',\r\n            kidsTask: \"Kid's Task Done\",\r\n            waiting: 'Waiting for parental confirmation',\r\n            vitality: 'Vitality',\r\n            geneticRisk: 'тЪая╕П Genetic Risk',\r\n            nutrition: 'Nutrition',\r\n            hobbies: 'Hobbies',\r\n            streak: 'Day Streak',\r\n            dailyInsights: 'Daily AI Insights History',\r\n            batteryStatus: {\r\n                ready: 'Ready for action',\r\n                good: 'Feeling good',\r\n                tired: 'Slightly tired',\r\n                rest: 'Need rest'\r\n            },\r\n            thisMonth: 'this month',\r\n            need_more_data: 'Not enough data for analysis. Please fill the modules.',\r\n            analysis_error: 'Error during system analysis. Please check the status of services.',\r\n            system_ready: 'AURA AI system is ready',\r\n            modules: {\r\n                finance: \"Finance\",\r\n                health: \"Health\",\r\n                family: \"Family\",\r\n                mind: \"Mind\",\r\n                food: \"Food\"\r\n            }\r\n        },\r\n        butterfly: {\r\n            title: 'Butterfly Effect',\r\n            subtitle: 'How your daily choices ripple across your life ecosystem',\r\n            analyzing: 'Analyzing correlations across 8 modules...',\r\n            lifeHarmony: 'Life Harmony',\r\n            keyInsights: 'Key Insights',\r\n            noCorrelations: 'No significant correlations detected yet',\r\n            keepLogging: 'Keep logging data across your modules to unlock insights',\r\n            confident: 'confident',\r\n            fixThis: 'Fix This',\r\n            states: {\r\n                harmonic: 'Harmonic Flow',\r\n                fragmented: 'Fragmented',\r\n                disconnected: 'Disconnected'\r\n            },\r\n            descriptions: {\r\n                harmonic: 'Your life modules are working in beautiful synergy',\r\n                fragmented: 'Some areas need attention to restore balance',\r\n                disconnected: 'Critical: Multiple areas require immediate focus'\r\n            },\r\n            insights: {\r\n                sleepProductivityNegative: (sleep, productivity) => `Poor sleep (${sleep}) тЖТ Low productivity (${productivity})`,\r\n                sleepProductivityPositive: (sleep, productivity) => `Great sleep (${sleep}) тЖТ High productivity (${productivity})`,\r\n                financeMindNegative: (stress, mood) => `Financial stress (${stress}) тЖТ Low mood (${mood}/100)`,\r\n                foodHealthNegative: (calories, energy) => `Undereating (${calories}) тЖТ Low energy (${energy}% body battery)`,\r\n                foodHealthPositive: (protein, energy) => `Excellent nutrition (${protein}) тЖТ High energy (${energy}% body battery)`,\r\n                focusInterestsPositive: (focus, streak) => `Deep work (${focus} min today) тЖТ Strong learning habit (${streak} day streak)`,\r\n                familyMindPositive: (members, mood) => `Active family hub (${members} members) тЖТ Positive mood (${mood}/100)`\r\n            },\r\n            actions: {\r\n                sleep: \"Improve sleep quality tonight to boost tomorrow's focus\",\r\n                finance: \"Review budget and create emergency fund plan\",\r\n                food: \"Add a protein-rich snack to restore energy\"\r\n            }\r\n        },\r\n        settings: {\r\n            title: 'Settings',\r\n            lang: 'Language / Til',\r\n            notifs: 'Notifications',\r\n            dailyBrief: 'Daily Briefing (08:00)',\r\n            focusAlerts: 'Focus Alerts',\r\n            familyUpdates: 'Family Updates',\r\n            system: 'System',\r\n            export: 'Export All Data',\r\n            reset: \"Reset Account\",\r\n            currentLocale: \"Current Locale:\",\r\n            freePlan: \"FREE\",\r\n            justNow: \"Just now\",\r\n            dailyBriefDesc: \"Morning summary at 08:00\",\r\n            focusAlertsDesc: \"Reminders to start focus sessions\",\r\n            familyUpdatesDesc: \"When family members complete tasks\",\r\n            exportSuccess: \"тЬЕ Data Exported Successfully!\",\r\n            resetScheduled: \"тЪая╕П Account Reset Scheduled\",\r\n            logType: \"TYPE\",\r\n            logDevice: \"DEVICE\",\r\n            logTime: \"TIME\",\r\n            logLogin: \"LOGIN\",\r\n            logWebDashboard: \"Web Dashboard\",\r\n            profile: 'Member since',\r\n            securityLog: 'Security Audit Log',\r\n            logout: 'Log Out',\r\n            yesterday: 'Yesterday',\r\n            today: 'Today',\r\n            selectDate: 'Select Date'\r\n        },\r\n        family: {\r\n            title: 'Family Hub',\r\n            subtitle: 'Digital bridge between generations.',\r\n            readOnly: 'Family History Locked',\r\n            readOnlyDesc: 'Past activities cannot be modified.',\r\n            liveHub: 'Live Hub',\r\n            genealogy: 'Genealogy',\r\n            smartParenting: 'Smart Parenting Console',\r\n            requests: 'Requests',\r\n            approve: 'Approve',\r\n            deny: 'Deny',\r\n            approved: 'Approved',\r\n            reward: 'Reward',\r\n            overallMood: 'Overall Mood',\r\n            activeQuests: 'Active Quests',\r\n            familyXP: 'Family XP',\r\n            gen1: 'Generation 1 (Roots)',\r\n            gen2: 'Generation 2 (Guardians)',\r\n            gen3: 'Generation 3 (Future)',\r\n            backToHub: 'Back to Family Hub',\r\n            geneticProfile: 'Genetic Profile',\r\n            safetyMonitor: 'Safety Monitor',\r\n            emergencyCall: 'EMERGENCY CALL',\r\n            parentalControls: 'Parental Controls',\r\n            activityLog: 'Activity History',\r\n            task: 'Task',\r\n            date: 'Date',\r\n            xp: 'XP'\r\n        },\r\n        finance: {\r\n            title: 'Finance',\r\n            subtitle: 'Master your wealth.',\r\n            readOnly: 'Context Archived',\r\n            readOnlyDesc: 'Past entries are locked for data integrity.',\r\n            totalBalance: 'Total Balance',\r\n            monthlyBudget: 'Monthly Budget',\r\n            savingsGoal: 'Savings Goal',\r\n            recentTransactions: 'Recent Transactions',\r\n            addTransaction: 'Add Transaction',\r\n            dailyAnalysis: 'Daily Analysis',\r\n            dailyAnalysisText: 'High pending on \"Food\" today matches your high stress levels. Recommended: Cook at home tomorrow.',\r\n            spendBreakdown: 'Spend Breakdown',\r\n            viewAll: 'View All',\r\n            investment: 'Investment',\r\n            credit: 'Credit',\r\n            debt: 'Debt',\r\n            confirmPaymentsInstruction: 'Please confirm the following payments:',\r\n            centralBankRate: 'CENTRAL BANK RATE',\r\n            realTimeCurrency: 'Real-time exchange rates',\r\n            liabilities: 'LIABILITIES',\r\n            assets: 'ASSETS',\r\n            initialAmount: 'Initial Amount',\r\n            byCategory: 'by Category',\r\n            debtsPlusCredits: 'Debts + Credits',\r\n            returnPlusDeposits: 'Debt Returns + Deposits',\r\n            addDebt: '+ Add Debt',\r\n            waitingForData: 'Waiting for data...',\r\n            vsLastMonth: 'vs last month',\r\n            used: 'Used',\r\n            left: 'Left',\r\n            archivedDays: 'Archived Days',\r\n            dayClosed: 'Day Closed',\r\n            spent: 'Spent',\r\n            days: 'Days',\r\n            weeks: 'Weeks',\r\n            months: 'months',\r\n            years: 'years',\r\n            enterGoal: 'Enter your financial goal',\r\n            deadline: 'Deadline',\r\n            achieved: 'Achieved',\r\n            noFunds: 'No funds',\r\n            limit: 'Limit',\r\n            target: 'Target',\r\n            current: 'Current',\r\n            perMonth: 'Per Month',\r\n            incomeInsufficient: 'Income insufficient',\r\n            iOwe: 'I owe',\r\n            owedToMe: 'Owed to me',\r\n            personName: 'Person (From/To)',\r\n            fullNamePlaceholder: 'Full Name',\r\n            amount: 'Amount',\r\n            currency: 'Currency',\r\n            dateTaken: 'Date Taken',\r\n            dateGiven: 'Date Given',\r\n            returnDate: 'Return Date',\r\n            addCredit: 'Add Credit',\r\n            addDeposit: 'Add Deposit',\r\n            creditName: 'Credit Name',\r\n            creditNamePlaceholder: 'e.g. Mortgage, iPhone',\r\n            depositName: 'Deposit Name',\r\n            depositNamePlaceholder: 'e.g. Safety Net, Car',\r\n            totalAmount: 'Total Amount',\r\n            currentAmount: 'Current Amount',\r\n            incomeHistoryEmpty: 'No income history.',\r\n            incomeHistoryEmptyDesc: 'Add your first income transaction to start tracking your progress towards your goals.',\r\n            expenseHistoryEmpty: 'No expense history.',\r\n            expenseHistoryEmptyDesc: 'Set a monthly budget to control your spending and see real-time analysis here.',\r\n            incomePlan: 'INCOME PLAN',\r\n            expenseControl: 'EXPENSE CONTROL',\r\n            voiceFeedback: {\r\n                listening: 'Listening...',\r\n                processing: 'Processing AI Command...',\r\n                done: 'тЬЕ Transaction Added!'\r\n            },\r\n            dailyFlow: 'Daily Flow',\r\n            advancedStats: 'Advanced Statistics',\r\n            incomeBudget: 'Income Budget',\r\n            expenseBudget: 'Expense Budget',\r\n            targetIncome: 'Target Income',\r\n            limitExpense: 'Expense Limit',\r\n            ultimateGoalTitle: 'ULTIMATE GOAL',\r\n            currentStatus: 'CURRENT STATUS',\r\n            timeLeft: 'Time Remaining (AI):',\r\n            remainingTime: 'Time Remaining (AI)',\r\n            deadlineExpired: 'DEADLINE EXPIRED',\r\n            paymentSuccess: 'Payment processed successfully!',\r\n            depositsEmpty: 'No Deposits Available',\r\n            creditsEmpty: 'No Credits Available',\r\n            debtsEmpty: 'No Debts Available',\r\n            confirm: 'Confirm',\r\n            confirmPayment: 'Confirm Payment',\r\n            todayPayments: 'Today\\'s Payments',\r\n            monthlyPayment: 'Monthly Payment',\r\n            paymentDay: 'Payment Day (Date)',\r\n            interestRate: 'Annual Interest (%)',\r\n            termMonths: 'Term (Months)',\r\n            calculationMethod: 'Calculation Method',\r\n            annuity: 'Annuity (Equal)',\r\n            differential: 'Differential (Decreasing)',\r\n            add: 'Add',\r\n            yearlyProfit: 'Yearly Profit (%)',\r\n            depositDeadline: 'Deposit Deadline',\r\n            daysInMonth: '1-31',\r\n            monthlyProfitChoice: 'Monthly Profit Withdrawal',\r\n            expectedMonthlyProfit: 'Expected Monthly Profit',\r\n            startDate: 'Start Date',\r\n            fillAllFields: 'Please fill all fields',\r\n            depositOpened: 'Deposit Opened',\r\n            investmentTransfer: 'Investment (Transfer)',\r\n            noDeadline: 'No deadline',\r\n            extendDeadline: \"Extend Deadline\",\r\n            fromCurrentBalance: \"From Current Balance?\",\r\n            noExpenseRecord: \"No expense recorded (Transfer)\",\r\n            markAsIncome: \"Will record as New Income\",\r\n            addFunds: \"Add Funds\",\r\n            editGoalTitle: \"Edit Financial Goal\",\r\n            editBudgetTitle: \"Monthly Budget Plan\",\r\n            budgetSaved: \"Budgets updated successfully!\",\r\n            incomeGrowthMessage: \"Growth detected! You are approaching your income target. Keep it up! ЁЯЪА\",\r\n            expenseLimitMessage: \"Expense Alert! You have reached your monthly limit! тЪая╕П\",\r\n            incomeAlmostTarget: \"Almost there! {val}% of income target achieved.\",\r\n            expenseAlmostLimit: \"Warning! {val}% of expense limit reached.\",\r\n            setNewReturnDate: \"Set New Return Date\",\r\n            datePlaceholder: 'YYYY-MM-DD or Month Year',\r\n            creditPayment: 'Credit Payment',\r\n            depositProfit: 'Deposit Profit',\r\n            probability: 'Probability',\r\n            aiWealthRoadmap: 'AI WEALTH ROADMAP',\r\n            analysisForGoal: 'Analysis to reach the goal',\r\n            professionalPotentialDescription: (role: string) => `Your expertise as a ${role} is the main driver to reach your financial goals.`,\r\n            professionalPotential: 'PROFESSIONAL POTENTIAL',\r\n            professionalPotentialDesc: 'Your expertise is the main driver to reach your financial goals.',\r\n            recommendations: 'RECOMMENDATIONS',\r\n            increaseInvestments: 'Increase investments by 15%',\r\n            getCertification: 'Get professional certificate',\r\n            additionalIncomeChannel: 'Additional income channel',\r\n            viewFullAnalysis: 'VIEW FULL ANALYSIS',\r\n            qrScanner: 'QR Scanner',\r\n            qrScannerTitle: \"QR Receipt Scanner\",\r\n            qrScannerDesc: \"Point your camera at the QR code or upload a receipt image.\",\r\n            qrScannerAction: \"Scan Now\",\r\n            analyzing: \"Analyzing...\",\r\n            portfolio: 'Portfolio',\r\n            recentActivity: 'Recent Activity',\r\n            noTransactions: 'No transactions yet',\r\n            aiRoadmapTitle: 'AI WEALTH ROADMAP',\r\n            filesAnalysis: 'Analysis to reach the goal',\r\n            detailedList: 'DETAILED LIST',\r\n            monthlyAnalysisTitle: 'MONTHLY ANALYSIS (SUMMARY)',\r\n            monthlyIncomeTitle: 'MONTHLY INCOME',\r\n            weeklyExpenseStats: 'WEEKLY EXPENSE STATISTICS',\r\n            iOweLabel: 'I OWE',\r\n            owedToMeLabel: 'OWED TO ME',\r\n            repaid: 'REPAID',\r\n            repay: 'Repay',\r\n            extend: 'Extend',\r\n            dayLabel: 'DATE',\r\n            remaining: 'Remaining',\r\n            payNow: 'PAY NOW',\r\n            prepay: 'Prepay',\r\n            collecting: 'Collecting',\r\n            totalCollected: 'Total Collected',\r\n            monthlyPlan: 'Monthly Plan',\r\n            topUp: 'Top Up',\r\n            noData: 'No data yet',\r\n            aiPredictionTitle: 'AI MONTHLY FORECAST',\r\n            predictionPart1: 'You are expected to end this month with',\r\n            predictionPart2: 'profit',\r\n            predictionTrend: (percent: number) => `Your expenses decreased by ${percent}% compared to last week.`,\r\n            predictionGoalAdvice: (goal: string, months: number) => `If you continue at this pace, you can reach the ${goal} goal ${months} months earlier than expected.`,\r\n            predictionDisclaimerText: 'Based on your current spending habits and recurring income.',\r\n            weeklyLabel: 'Weekly',\r\n            monthlyLabel: 'Monthly',\r\n            customLabel: 'Custom',\r\n            analysisSummary: 'Summary of system analysis',\r\n            exportExcel: 'Export to Excel',\r\n            incomeTitle: 'Income',\r\n            expenseTitle: 'Expense',\r\n            principalAmount: \"Principal Amount\",\r\n            interestAmount: \"Interest Amount\",\r\n            repaymentSplit: \"Payment Split\",\r\n            realMoney: \"Real Net Worth\",\r\n            transTitle: \"Title\",\r\n            transType: \"Type\",\r\n            transCategory: \"Category\",\r\n            depositActionTitle: \"Manage Deposit\",\r\n            actionAdd: \"Top Up\",\r\n            actionWithdraw: \"Withdraw\",\r\n            actionProfit: \"Add Profit\",\r\n            sourceBalance: \"From Balance (-)\",\r\n            sourceOutside: \"New Income (+)\",\r\n            financialStatus: \"Financial Status\",\r\n            statusStart: \"тЪк Starting\",\r\n            statusPositive: \"тЬЕ Positive\",\r\n            statusDanger: \"тЪая╕П Critical\",\r\n            statusDescStart: \"Not enough data for analysis yet. Add your first income or expense.\",\r\n            statusDescPositive: (percent: string) => `You are saving ${percent}% of your income. That's a great result!`,\r\n            statusDescDanger: \"Warning! Your expenses exceed your income. Reduce at least 2 unnecessary expenses immediately.\",\r\n            recStart: \"Add your first transaction (Income or Expense)\",\r\n            recSafety: \"Build a safety net equal to 3 months of expenses\",\r\n            recDeposit: \"Open a savings account and start saving\",\r\n            recDebt: \"Pay off debts faster using the 'Snowball' method\",\r\n            recBudget: \"Set an income plan (Budget)\",\r\n            statusOk: \"Everything looks good so far!\",\r\n            predictionMsgExcellent: \"Great result! You are saving a large part of your income. Consider investing.\",\r\n            predictionMsgGood: \"Good indicator. Your savings plan is stable. Keep it up.\",\r\n            predictionMsgOk: \"You are in a positive balance, but optimizing expenses a bit could be beneficial.\",\r\n            predictionMsgBad: \"Warning! Your expenses are exceeding your income. Review your budget.\",\r\n            fromLabel: \"From\",\r\n            toLabel: \"To\"\r\n        },\r\n        categories: {\r\n            Salary: \"Salary\",\r\n            Freelance: \"Freelance\",\r\n            Investment: \"Investment\",\r\n            Gift: \"Gift\",\r\n            OtherIncome: \"Other Income\",\r\n            Food: \"Food\",\r\n            Transport: \"Transport\",\r\n            Shopping: \"Shopping\",\r\n            Bills: \"Bills\",\r\n            Health: \"Health\",\r\n            Education: \"Education\",\r\n            Leisure: \"Leisure\",\r\n            Other: \"Other\",\r\n            creditIn: \"Credit (Inflow)\",\r\n            depositIn: \"Deposit (Inflow)\",\r\n            savings: \"Savings/Transfer\",\r\n            general: \"General\",\r\n            music: \"Music\",\r\n            mind: \"Mindfulness\"\r\n        },\r\n        tasks: {\r\n            title: 'Focus & Tasks',\r\n            subtitle: 'Design your day.',\r\n            newTask: 'New Task',\r\n            taskName: 'Task Name',\r\n            startTime: 'Start Time',\r\n            endTime: 'End Time',\r\n            priority: 'Priority',\r\n            low: 'Low',\r\n            medium: 'Medium',\r\n            high: 'High',\r\n            createTask: 'Create Task',\r\n            calendar: 'Calendar',\r\n            upcomingTasks: 'Upcoming Plans',\r\n            overdue: 'Overdue',\r\n            future: 'Future',\r\n            stats: {\r\n                completedToday: 'Completed Today',\r\n                pending: 'Pending',\r\n                efficiency: 'Efficiency Score'\r\n            },\r\n            sections: {\r\n                today: 'Today',\r\n                upcoming: 'Upcoming',\r\n                completed: 'Completed',\r\n                overdue: 'Overdue',\r\n                future: 'Future'\r\n            },\r\n            aiSuggestion: {\r\n                title: 'AI Insight',\r\n                suggestion: '\"Review Monthly Budget\" is overdue.',\r\n                add: 'Add +'\r\n            },\r\n            actions: {\r\n                startFocus: 'Start Focus',\r\n                moveToToday: 'Move to Today',\r\n                subtask: 'Subtask',\r\n                move: 'Move',\r\n                focus: 'Focus',\r\n                edit: 'Edit',\r\n                delete: 'Delete',\r\n                promote: 'Promote to Root'\r\n            },\r\n            completedArchive: 'Completed Tasks Archive',\r\n            readOnly: 'Tasks Archived',\r\n            readOnlyDesc: 'Past tasks are read-only.',\r\n            noTasks: 'No tasks for today. Enjoy your day!'\r\n        },\r\n        health: {\r\n            history: 'History',\r\n            title: 'Health & Vitality',\r\n            subtitle: 'Your body is the engine.',\r\n            bodyBattery: {\r\n                title: 'Body Battery',\r\n                fullyCharged: 'You are fully charged! Perfect time for high-intensity tasks or a workout.',\r\n                recharge: 'Consider taking a break to recharge.',\r\n                sleepRestoration: 'Sleep Restoration',\r\n                activeDrain: 'Active Drain',\r\n                stressTax: 'Stress Tax',\r\n                hydrationEfficiency: 'Hydration Efficiency'\r\n            },\r\n            vitals: {\r\n                title: 'Heart Rate',\r\n                stressTitle: 'Stress Level',\r\n                resting: 'Resting',\r\n                heartRateUnit: 'BPM',\r\n                normalRange: 'Within normal range',\r\n                avgLevel: 'Avg Level',\r\n                low: 'Low',\r\n                relaxedState: 'Relaxed State'\r\n            },\r\n            sleep: {\r\n                score: '/ 100',\r\n                quality: 'Restorative Sleep',\r\n                unit: 'Score'\r\n            },\r\n            hydration: {\r\n                title: 'Hydration',\r\n                goal: 'Goal',\r\n                unit: 'ml'\r\n            },\r\n            activity: {\r\n                title: 'Activity',\r\n                stepsToday: 'steps today',\r\n                kcal: 'kcal',\r\n                dist: 'dist'\r\n            },\r\n            trends: {\r\n                title: 'Health Trends (Last 7 Days)',\r\n                stepsHistory: 'Steps History',\r\n                sleepQuality: 'Sleep Quality'\r\n            },\r\n            days: {\r\n                mon: 'Mon',\r\n                tue: 'Tue',\r\n                wed: 'Wed',\r\n                thu: 'Thu',\r\n                fri: 'Fri',\r\n                sat: 'Sat',\r\n                sun: 'Sun'\r\n            },\r\n            biometrics: {\r\n                title: 'Biometrics',\r\n                aiRecTitle: 'AI Recommendation',\r\n                aiRecLose: 'Metabolism boost suggested. AI will adjust calorie goals.',\r\n                aiRecMaintain: 'Steady progress maintained. Keep the rhythm.',\r\n                weight: 'Weight',\r\n                height: 'Height',\r\n                goal: 'Goal',\r\n                lose: 'Lose Weight',\r\n                gain: 'Gain Muscle',\r\n                maintain: 'Maintain Health',\r\n                unitCm: 'cm',\r\n                unitKg: 'kg'\r\n            },\r\n            aiAdvisor: {\r\n                title: 'AI Health Advisor',\r\n                analyzing: 'AI is analyzing your metrics...',\r\n                hydrationLow: 'Your hydration level is low. Drink 2 more glasses of water to boost efficiency.',\r\n                stressHigh: 'Stress levels are high. Consider a 10-minute meditation breathing session.',\r\n                sleepLow: 'Poor recovery detected. Prioritize rest today and avoid heavy workouts.',\r\n                allGood: 'All systems operational. Your recovery matches your activity level perfectly!'\r\n            },\r\n            readOnly: 'Health Data Locked',\r\n            readOnlyDesc: 'Historical biometrics cannot be modified.',\r\n            loading: \"Loading Health Data...\",\r\n            simulate: \"Simulate 21:00\",\r\n            batteryStatus: {\r\n                ready: \"Ready\",\r\n                good: \"Feeling Good\",\r\n                tired: \"A Bit Tired\",\r\n                rest: \"Need Rest\"\r\n            },\r\n            voiceAlertSteps: \"steps logged!\",\r\n            voiceAlertSleep: \"hours of sleep logged!\",\r\n            voiceAlertWater: \"ml of water added!\"\r\n        },\r\n        food: {\r\n            title: \"Food AI\",\r\n            subtitle: \"Fuel your body intelligently.\",\r\n            readOnly: 'Daily Log Archived',\r\n            readOnlyDesc: 'Past meals cannot be edited or added.',\r\n            calories: \"Calories\",\r\n            macros: \"Macros\",\r\n            protein: \"Protein\",\r\n            carbs: \"Carbs\",\r\n            fats: \"Fats\",\r\n            mealLogs: \"Meal Logs\",\r\n            scanMeal: \"Scan Meal\",\r\n            dailyLog: \"Daily Log\",\r\n            historyModalTitle: \"Meal History (Past 7 Days)\",\r\n            cameraPrompt: \"Point camera at food\",\r\n            analyzing: \"AI Analyzing...\",\r\n            instantAdviceTitle: \"Instant Advice\",\r\n            targetAdvice: \"Great protein intake today! Try adding more fiber (vegetables) to your dinner.\",\r\n            scanError: \"Could not identify food. Please try again.\",\r\n            aiDetected: \"AI Detected\",\r\n            eatQuestion: \"Did you eat this?\",\r\n            yes: \"Yes\",\r\n            no: \"No\",\r\n            streak: \"DAY STREAK\",\r\n            loading: \"Loading Nutrition...\",\r\n            alertArchived: \"You cannot add/delete items for archived days.\",\r\n            mealQuick: \"Quick Log\",\r\n            mealSnack: \"Snack\",\r\n            mealBreakfast: \"Breakfast\",\r\n            mealLunch: \"Lunch\",\r\n            mealDinner: \"Dinner\",\r\n            kcal: \"kcal\",\r\n            unitG: \"g\"\r\n        },\r\n        mind: {\r\n            title: \"Mind Sanctuary\",\r\n            subtitle: \"Mental clarity and focus.\",\r\n            readOnly: 'Mind Context Locked',\r\n            readOnlyDesc: 'Past mental states are archived.',\r\n            weeklyFocus: \"Weekly Focus\",\r\n            focusingOn: \"Focusing on:\",\r\n            focus: \"Focus\",\r\n            break: \"Break\",\r\n            moodSphere: \"Mood Sphere\",\r\n            moodSphereDesc: \"Drag to adjust (<30 = Zen Mode)\",\r\n            resonanceBreathing: \"Resonance Breathing\",\r\n            startSession: \"Start Session\",\r\n            stopSession: \"Stop Session\",\r\n            inhale: \"Inhale\",\r\n            exhale: \"Exhale\",\r\n            hold: \"Hold\",\r\n            ready: \"Ready\",\r\n            aiSummaryTitle: \"AI Daily Summary\",\r\n            aiSummaryText: \"Your mood has been stable today. Focus efficiency is up 15% from yesterday. Keep maintaining this rhythm.\",\r\n            historyModalTitle: \"Mind Journal (Mood History)\",\r\n            recentSessions: \"Recent Focus Sessions\",\r\n            moodTrends: \"Mood Trends\",\r\n            zenTitle: \"Breathe\",\r\n            zenSubtitle: \"Analysis and charts are hidden. Focus on now.\",\r\n            whyFeeling: \"Why are you feeling this way?\",\r\n            exitZen: \"I'm feeling better now (Exit Zen Mode)\",\r\n            reasons: {\r\n                tired: \"Tired\",\r\n                anxious: \"Anxious\",\r\n                overwhelmed: \"Overwhelmed\",\r\n                justBecause: \"Just Because\"\r\n            },\r\n            loadingState: \"Loading Sanctuary...\",\r\n            saved: \"Saved\",\r\n            saveMood: \"Save Mood\",\r\n            zenMapLeft: \"Negative (Zen)\",\r\n            zenMapRight: \"Positive\",\r\n            aiLoading: \"AI is analyzing your state...\",\r\n            aiPoweredBy: \"AURA Strategic Mind\"\r\n        },\r\n        focus: {\r\n            minutes: 'Minutes',\r\n            done: 'Done'\r\n        },\r\n        interests: {\r\n            title: \"Interests & Growth\",\r\n            subtitle: \"Expand your horizons.\",\r\n            readOnly: 'Progress Locked',\r\n            readOnlyDesc: 'Past logs cannot be modified.',\r\n            historyModalTitle: \"Hobby Practice Log\",\r\n            practiceLog: \"Practice Log\",\r\n            streak: \"Day Streak\",\r\n            newHobby: \"+ New Hobby\",\r\n            aiRecommendation: \"AI Recommendation: Pottery\",\r\n            aiReason: \"Based on your \\\"Design\\\" interest, you might enjoy tactile creativity.\",\r\n            tryThis: \"Try this\",\r\n            hoursSpent: \"hrs spent\",\r\n            nextLevel: \"Next: Level\",\r\n            discoverNew: \"Discover New Passion\",\r\n            level: \"Lvl\",\r\n            addHobbyTitle: \"Add New Hobby\",\r\n            hobbyName: \"Name\",\r\n            category: \"Category\",\r\n            loading: \"Loading Hobbies...\",\r\n            categories: {\r\n                general: \"General\",\r\n                art: \"Art\",\r\n                physical: \"Physical\",\r\n                mind: \"Mind\",\r\n                music: \"Music\"\r\n            },\r\n            placeholderName: \"e.g. Pottery, Chess, Piano...\",\r\n            positive: \"Positive\",\r\n            negative: \"Negative\",\r\n            type: \"Type\",\r\n            trackingMode: \"Tracking Mode\",\r\n            trackingFrequency: \"Frequency (+1)\",\r\n            trackingFrequencyDesc: \"Counts every occurrence (e.g. rolled cigarettes).\",\r\n            trackingBinary: \"Once (Yes/No)\",\r\n            trackingBinaryDesc: \"Recorded once per day (e.g. woke up late).\",\r\n            newHobbyCardTitle: \"New Hobby\",\r\n            newHobbyCardDesc: \"For positive growth\",\r\n            positiveInterests: \"Positive Interests\",\r\n            negativeHabits: \"Controlled Habits\",\r\n            dailyActivities: \"Daily Activities\",\r\n            aiRecStatus: \"AI Recommendation Status\",\r\n            statCount: \"COUNT\",\r\n            statDuration: \"DURATION\",\r\n            loyaltyXP: \"LOYALTY XP\",\r\n            done: \"Done\",\r\n            logCount: \"LOG (+1)\",\r\n            log: \"LOG\",\r\n            status: \"Status\",\r\n            times: \"times\",\r\n\r\n            totalHours: \"h TOTAL\",\r\n            totalControl: \"h CONTROL\",\r\n            logDurationQuestion: \"How many minutes did you practice?\",\r\n            aiRecTitleCorrection: \"AURA Correction\",\r\n            aiRecTitleGrowth: \"AURA Growth\",\r\n            aiRecDone: \"Completed\",\r\n            aiRecTask: \"Task\",\r\n            aiRecAddTask: \"Task\",\r\n            noActivities: \"No activities recorded today.\",\r\n            selectHobby: \"Select a hobby above to log activity.\",\r\n            notDone: \"Not Done\",\r\n            todayLabel: \"Today\",\r\n            dailyStats: \"DAILY STATS\"\r\n        },\r\n        liveness_section: {\r\n            title: \"LIFE BEACON\",\r\n            subtitle: \"Bridging the legacy of care.\",\r\n            desc: \"Passive monitoring for your loved ones. If no activity is detected within the set window, we'll alert the family. Ideal for senior safety.\",\r\n            cta: \"Set Up Beacon\",\r\n            silent_mode: 'Silent Mode',\r\n            silent_mode_desc: 'Pause during sleep hours',\r\n            activity_log: 'Pulse History',\r\n            panic_alert: 'PANIC ALERT',\r\n            panic_confirm: 'Send emergency alert now?',\r\n            countdown_prefix: 'Next check in:',\r\n            checkInPrompt: 'Azamat Ota, are you okay? Please confirm.',\r\n            familyAlert: (hours: number) => `Alert: Your father has not checked in for ${hours} hours!`\r\n        },\r\n    },\r\n    uz: {\r\n        common: {\r\n            refresh: 'Yangilash',\r\n            save: 'Saqlash',\r\n            cancel: 'Bekor qilish',\r\n            back: 'Orqaga',\r\n            viewHistory: 'Tarixni ko\\'rish',\r\n            history: 'Tarix',\r\n            today: 'Bugun',\r\n            yesterday: 'Kecha',\r\n            done: 'Bajarildi',\r\n            user: 'Foydalanuvchi'\r\n        },\r\n        nav: {\r\n            hero: 'Bosh sahifa',\r\n            problem: 'Muammo',\r\n            solution: 'Yechim',\r\n            butterfly: 'Kapalak',\r\n            platforms: 'Platformalar',\r\n            family: 'Oila'\r\n        },\r\n        sidebar: {\r\n            dashboard: 'Bosh sahifa',\r\n            family: 'Oila',\r\n            finance: 'Moliya',\r\n            tasks: 'Vazifalar',\r\n            health: 'Salomatlik',\r\n            food: 'Ovqatlanish',\r\n            mind: 'Diqqat',\r\n            interests: 'Qiziqishlar',\r\n            liveness: 'Hayot Signali',\r\n            settings: 'Sozlamalar',\r\n            archived: 'Arxivlangan'\r\n        },\r\n        home: {\r\n            deepWork: 'DIQQAT SESSIYASI',\r\n            endSession: 'Sessiyani yakunlash',\r\n            rainOn: 'Yomg\\'ir',\r\n            ambientOff: 'Ovoz o\\'chirilgan',\r\n            voiceCommand: 'Ovozli buyruq',\r\n            listening: 'Eshitilmoqda...',\r\n            analyzing: 'Tizim tahlil qilinmoqda...',\r\n            viewHistory: 'Tarixni ko\\'rish',\r\n            simStress: 'Sim Stress',\r\n            simCalm: 'Sim Tinch',\r\n            enterZen: 'Zen Kirish',\r\n            chronos: 'Xronos',\r\n            atmosphere: 'Atmosfera',\r\n            clearSky: 'Musaffo Osmon',\r\n            wealthPulse: 'Boylik Pulsi',\r\n            familyHub: 'Oila Markazi',\r\n            approval: '1 Tasdiq',\r\n            kidsTask: \"Bola vazifasi bajarildi\",\r\n            waiting: 'Ota-ona tasdiqlashi kutilmoqda',\r\n            vitality: 'Hayotiylik',\r\n            geneticRisk: 'тЪая╕П Genetik Xavf',\r\n            nutrition: 'Ovqatlanish',\r\n            hobbies: 'Hobbilar',\r\n            streak: 'Kunlik Seriya',\r\n            dailyInsights: 'Kunlik AI Xulosalari',\r\n            batteryStatus: {\r\n                ready: 'Harakatga tayyor',\r\n                good: 'Yaxshi his qilish',\r\n                tired: 'Biroz charchagan',\r\n                rest: 'Dam olish kerak'\r\n            },\r\n            thisMonth: 'bu oy',\r\n            need_more_data: \"Tahlil uchun ma'lumotlar yetarli emas. Iltimos, modullarni to'ldiring.\",\r\n            analysis_error: \"Tizim tahlilida xatolik yuz berdi. Iltimos, servislar holatini tekshiring.\",\r\n            system_ready: \"AURA AI tizimi tayyor\",\r\n            modules: {\r\n                finance: \"Moliya\",\r\n                health: \"Salomatlik\",\r\n                family: \"Oila\",\r\n                mind: \"Ruhiyat\",\r\n                food: \"Taomnoma\"\r\n            }\r\n        },\r\n        butterfly: {\r\n            title: 'Kapalak Effekti',\r\n            subtitle: 'Kundalik tanlovlaringiz hayot ekotizimingizga qanday ta\\'sir qilishi',\r\n            analyzing: '8 ta modul bo\\'yicha bog\\'liqliklar tahlil qilinmoqda...',\r\n            lifeHarmony: 'Hayot Uyg\\'unligi',\r\n            keyInsights: 'Asosiy Xulosalar',\r\n            noCorrelations: 'Hozircha sezilarli bog\\'liqliklar aniqlanmadi',\r\n            keepLogging: 'Xulosalarni ochish uchun modullarda ma\\'lumotlarni kiritishda davom eting',\r\n            confident: 'ishonch',\r\n            fixThis: 'Tuzatish',\r\n            states: {\r\n                harmonic: 'Garmonik Oqim',\r\n                fragmented: 'Parchalangan',\r\n                disconnected: 'Bog\\'lanmagan'\r\n            },\r\n            descriptions: {\r\n                harmonic: 'Hayot modullaringiz go\\'zal uyg\\'unlikda ishlamoqda',\r\n                fragmented: 'Muvozanatni tiklash uchun ba\\'zi sohalarga e\\'tibor qaratish lozim',\r\n                disconnected: 'Kritik: Bir nechta sohalar zudlik bilan e\\'tibor talab qiladi'\r\n            },\r\n            insights: {\r\n                sleepProductivityNegative: (sleep, productivity) => `Yomon uyqu (${sleep}) тЖТ Past mahsuldorlik (${productivity} bajarilgan vazifalar)`,\r\n                sleepProductivityPositive: (sleep, productivity) => `Ajoyib uyqu (${sleep}) тЖТ Yuqori mahsuldorlik (${productivity} bajarilgan vazifalar)`,\r\n                financeMindNegative: (stress, mood) => `Moliyaviy stress (${stress}) тЖТ Past kayfiyat (${mood}/100)`,\r\n                foodHealthNegative: (calories, energy) => `Kam ovqatlanish (kaloriya maqsadining ${calories}) тЖТ Kam quvvat (${energy}% tana quvvati)`,\r\n                foodHealthPositive: (protein, energy) => `Ajoyib ovqatlanish (protein maqsadining ${protein}) тЖТ Yuqori quvvat (${energy}% tana quvvati)`,\r\n                focusInterestsPositive: (focus, streak) => `Chuqur ish (bugun ${focus} daqiqa) тЖТ Kuchli o'rganish odati (${streak} kunlik seriya)`,\r\n                familyMindPositive: (members, mood) => `Faol oila markazi (${members} a'zolar) тЖТ Ijobiy kayfiyat (${mood}/100)`\r\n            },\r\n            actions: {\r\n                sleep: \"Ertangi diqqatni oshirish uchun bugun uyqu sifatini yaxshilang\",\r\n                finance: \"Byudjetni ko'rib chiqing va favqulodda jamg'arma rejasini tuzing\",\r\n                food: \"Energiyani tiklash uchun oqsilga boy gazak qo'shing\"\r\n            }\r\n        },\r\n        settings: {\r\n            title: 'Sozlamalar',\r\n            lang: 'Til / Language',\r\n            notifs: 'Bildirishnomalar',\r\n            dailyBrief: 'Kunlik Xulosa (08:00)',\r\n            focusAlerts: 'Fokus Eslatmalari',\r\n            familyUpdates: 'Oila Yangiliklari',\r\n            system: 'Tizim',\r\n            export: 'Ma\\'lumotlarni Yuklash',\r\n            reset: \"Hisobni tiklash\",\r\n            currentLocale: \"Joriy til:\",\r\n            freePlan: \"BEPUL\",\r\n            justNow: \"Hozirgina\",\r\n            dailyBriefDesc: \"Ertalabki xulosa soat 08:00 da\",\r\n            focusAlertsDesc: \"Fokus seanslarini boshlash uchun eslatmalar\",\r\n            familyUpdatesDesc: \"Oila a'zolari vazifalarni bajarganda\",\r\n            exportSuccess: \"тЬЕ Ma'lumotlar muvaffaqiyatli eksport qilindi!\",\r\n            resetScheduled: \"тЪая╕П Hisobni o'chirish rejalashtirildi\",\r\n            logType: \"TUR\",\r\n            logDevice: \"QURILMA\",\r\n            logTime: \"VAQT\",\r\n            logLogin: \"KIRISH\",\r\n            logWebDashboard: \"Veb Panel\",\r\n            profile: 'A\\'zo bo\\'lgan sana',\r\n            securityLog: 'Xavfsizlik Tarixi',\r\n            logout: 'Chiqish',\r\n            yesterday: 'Kecha',\r\n            today: 'Bugun',\r\n            selectDate: 'Sanani tanlash'\r\n        },\r\n        family: {\r\n            title: 'Oila Markazi',\r\n            subtitle: 'Avlodlar o\\'rtasidagi raqamli ko\\'prik.',\r\n            readOnly: 'Oila Tarixi Arxivlandi',\r\n            readOnlyDesc: 'Ma\\'lumotlar yaxlitligi uchun o\\'tmish bloklangan.',\r\n            liveHub: ' jonli Markaz',\r\n            genealogy: 'Shajara',\r\n            smartParenting: 'Aqlli Ota-ona Konsoli',\r\n            requests: 'So\\'rovlar',\r\n            approve: 'Tasdiqlash',\r\n            deny: 'Rad etish',\r\n            approved: 'Tasdiqlandi',\r\n            reward: 'Mukofot',\r\n            overallMood: 'Umumiy Kayfiyat',\r\n            activeQuests: 'Faol Kvestlar',\r\n            familyXP: 'Oila XP',\r\n            gen1: '1-Avlod (Ildizlar)',\r\n            gen2: '2-Avlod (Posbonlar)',\r\n            gen3: '3-Avlod (Kelajak)',\r\n            backToHub: 'Oila Markaziga qaytish',\r\n            geneticProfile: 'Genetik Profil',\r\n            safetyMonitor: 'Xavfsizlik Monitori',\r\n            emergencyCall: 'FVQ QO\\'NG\\'IROQ',\r\n            parentalControls: 'Ota-ona Nazorati',\r\n            activityLog: 'Faoliyat Tarixi',\r\n            task: 'Vazifa',\r\n            date: 'Sana',\r\n            xp: 'XP'\r\n        },\r\n        finance: {\r\n            title: 'Moliya',\r\n            subtitle: 'Boyligingizni boshqaring.',\r\n            readOnly: 'Moliya Tarixi Arxivlandi',\r\n            readOnlyDesc: 'O\\'tmishdagi ma\\'lumotlar yaxlitlik uchun bloklangan.',\r\n            totalBalance: 'Umumiy Balans',\r\n            monthlyBudget: 'Oylik Byudjet',\r\n            savingsGoal: 'Jamg\\'arma Maqsadi',\r\n            recentTransactions: 'Oxirgi O\\'tkazmalar',\r\n            addTransaction: 'O\\'tkazma Qo\\'shish',\r\n            dailyAnalysis: 'Kunlik Tahlil',\r\n            dailyAnalysisText: 'Bugun \"Ovqat\" uchun xarajat yuqori bo\\'lishi kutilmoqda. Tavsiya: Ertaga uyda ovqatlaning.',\r\n            spendBreakdown: 'Xarajatlar Taqsimoti',\r\n            viewAll: 'Hammasini Ko\\'rish',\r\n            investment: 'Investitsiya',\r\n            credit: 'Kredit',\r\n            debt: 'Qarz',\r\n            confirmPaymentsInstruction: 'Iltimos, quyidagi to\\'lovlarni tasdiqlang:',\r\n            centralBankRate: 'MARKAZIY BANK KURSI',\r\n            realTimeCurrency: 'Real vaqtdagi valyuta kurslari',\r\n            liabilities: 'MAJBURIYATLAR',\r\n            assets: 'AKTIVLAR',\r\n            initialAmount: 'Boshlang\\'ich summa',\r\n            byCategory: 'kategoriya bo\\'yicha',\r\n            debtsPlusCredits: 'Qarzlar + Kreditlar',\r\n            returnPlusDeposits: 'Qarz Qaytarish + Omonatlar',\r\n            addDebt: '+ Qarz Qo\\'shish',\r\n            waitingForData: 'Ma\\'lumotlar kutilmoqda...',\r\n            vsLastMonth: 'o\\'tgan oyga nisbatan',\r\n            used: 'Ishlatildi',\r\n            left: 'Qoldi',\r\n            archivedDays: 'Arxivlanan Kunlar',\r\n            dayClosed: 'Kun yopildi',\r\n            spent: 'Sarflandi',\r\n            days: 'kun',\r\n            weeks: 'Hafta',\r\n            months: 'oy',\r\n            years: 'yil',\r\n            enterGoal: 'Moliyaviy maqsadingizni kiriting',\r\n            deadline: 'Muddat',\r\n            achieved: 'Erishildi',\r\n            noFunds: 'Mablag\\' yo\\'q',\r\n            limit: 'Limit',\r\n            target: 'Maqsad',\r\n            current: 'Hozirgi',\r\n            perMonth: 'Oyiga',\r\n            incomeInsufficient: 'Daromad yetarli emas',\r\n            iOwe: 'Men qarzman',\r\n            owedToMe: 'Mendan qarz',\r\n            personName: 'Shaxs (Kimdan/Kimga)',\r\n            fullNamePlaceholder: 'Ism Familiya',\r\n            amount: 'Summa',\r\n            currency: 'Valyuta',\r\n            dateTaken: 'Olingan sana',\r\n            dateGiven: 'Berilgan sana',\r\n            returnDate: 'Qaytarish sanasi',\r\n            addCredit: 'Kredit Qo\\'shish',\r\n            addDeposit: 'Omonat Qo\\'shish',\r\n            creditName: 'Kredit Nomi',\r\n            creditNamePlaceholder: 'Masalan: Ipoteka, iPhone',\r\n            depositName: 'Omonat Nomi',\r\n            depositNamePlaceholder: 'Masalan: Yostiqcha, Mashina',\r\n            totalAmount: 'Jami Summa',\r\n            currentAmount: 'Joriy Summa',\r\n            incomeHistoryEmpty: 'Daromadlar tarixi yo\\'q.',\r\n            incomeHistoryEmptyDesc: 'Maqsadlaringizga erishishni kuzatish uchun birinchi daromad o\\'tkazmasini qo\\'shing.',\r\n            expenseHistoryEmpty: 'Xarajatlar tarixi yo\\'q.',\r\n            expenseHistoryEmptyDesc: 'Xarajatlaringizni nazorat qilish va real vaqtda tahlilni ko\\'rish uchun oylik byudjet belgilang.',\r\n            incomePlan: 'Daromad Rejasi',\r\n            expenseControl: 'Xarajat Nazorati',\r\n            voiceFeedback: {\r\n                listening: 'Eshitilmoqda...',\r\n                processing: 'AI buyruqni qayta ishlashmoqda...',\r\n                done: 'тЬЕ O\\'tkazma qo\\'shildi!'\r\n            },\r\n            dailyFlow: 'Kunlik Oqim',\r\n            advancedStats: 'Kengaytirilgan Statistika',\r\n            incomeBudget: 'Daromad Byudjeti',\r\n            expenseBudget: 'Xarajat Byudjeti',\r\n            targetIncome: 'Maqsadli Daromad',\r\n            limitExpense: 'Xarajat Limiti',\r\n            ultimateGoalTitle: 'YAKUNIY MAQSAD',\r\n            currentStatus: 'HOZIRGI HOLAT',\r\n            timeLeft: 'Qolgan vaqt (AI):',\r\n            remainingTime: 'Qolgan vaqt (AI)',\r\n            deadlineExpired: 'MUDDAT TUGADI',\r\n            paymentSuccess: 'To\\'lov muvaffaqiyatli amalga oshirildi!',\r\n            depositsEmpty: 'Omonatlar mavjud emas',\r\n            creditsEmpty: 'Kreditlar mavjud emas',\r\n            debtsEmpty: 'Qarzlar mavjud emas',\r\n            confirm: 'Tasdiqlash',\r\n            confirmPayment: 'To\\'lovni Tasdiqlash',\r\n            todayPayments: 'Bugungi To\\'lovlar',\r\n            monthlyPayment: 'Oylik To\\'lov',\r\n            paymentDay: 'To\\'lov Sanasi (Kun)',\r\n            interestRate: 'Yillik Foiz (%)',\r\n            termMonths: 'Muddat (Oy)',\r\n            calculationMethod: 'Hisoblash Usuli',\r\n            annuity: 'Annuitet (Bir Xil)',\r\n            differential: 'Differensial (Kamayuvchi)',\r\n            add: 'Qo\\'shish',\r\n            yearlyProfit: 'Yillik Daromad (%)',\r\n            depositDeadline: 'Omonat Muddati',\r\n            daysInMonth: '1-31',\r\n            monthlyProfitChoice: 'Oyma-oy Foyda Olish',\r\n            expectedMonthlyProfit: 'Kutilayotgan Oylik Foyda',\r\n            startDate: 'Boshlanish Sanasi',\r\n            fillAllFields: 'Iltimos, barcha maydonlarni to\\'ldiring',\r\n            depositOpened: 'Omonat Ochildi',\r\n            investmentTransfer: 'Investitsiya (Transfer)',\r\n            noDeadline: 'Muddatsiz',\r\n            extendDeadline: \"Muddatni uzaytirish\",\r\n            fromCurrentBalance: \"Joriy balansdanmi?\",\r\n            noExpenseRecord: \"Xarajat sifatida yozilmaydi (O'tkazma)\",\r\n            markAsIncome: \"Yangi daromad deb yoziladi\",\r\n            addFunds: \"Mablag' qo'shish\",\r\n            editGoalTitle: \"Moliyaviy maqsadni tahrirlash\",\r\n            editBudgetTitle: \"Oylik byudjet rejasi\",\r\n            budgetSaved: \"Byudjetlar muvaffaqiyatli saqlandi!\",\r\n            incomeGrowthMessage: \"O'sish kuzatilmoqda! Siz daromad maqsadingizga yaqinlashyapsiz. To'xtamang! ЁЯЪА\",\r\n            expenseLimitMessage: \"Xarajat ogohlantirishi! Siz oylik xarajat limitingizga yetdingiz! тЪая╕П\",\r\n            incomeAlmostTarget: \"Deyarli yetdingiz! Daromad maqsadining {val}% i bajarildi.\",\r\n            expenseAlmostLimit: \"Diqqat! Xarajat limitingizning {val}% iga yetdingiz.\",\r\n            setNewReturnDate: \"Yangi qaytarish sanasini belgilash\",\r\n            datePlaceholder: 'YYYY-OO-KK yoki Oy Yil',\r\n            creditPayment: 'Kredit To\\'lovi',\r\n            depositProfit: 'Omonat Foydasi',\r\n            probability: 'Ehtimollik',\r\n            aiWealthRoadmap: 'AI BOYLIQ YO\\'L XARITASI',\r\n            analysisForGoal: 'Maqsadga erishish uchun tahlil',\r\n            professionalPotentialDescription: (role: string) => `Sizning ${role} sifatidagi tajribangiz moliyaviy maqsadlaringizga erishishning asosiy omilidir.`,\r\n            professionalPotential: 'PROFESSIONAL POTENTSIAL',\r\n            professionalPotentialDesc: 'Sizning tajribangiz moliyaviy maqsadlarga erishishning asosiy omilidir.',\r\n            recommendations: 'TAVSIYALAR',\r\n            increaseInvestments: 'Investitsiyalarni 15% ga oshiring',\r\n            getCertification: 'Professional sertifikat olish',\r\n            additionalIncomeChannel: 'Qo\\'shimcha daromad manbai',\r\n            viewFullAnalysis: 'TO\\'LIQ TAHLILNI KO\\'RISH',\r\n            qrScanner: \"QR Skaner\",\r\n            qrScannerTitle: \"QR Chek Skaneri\",\r\n            qrScannerDesc: \"Kamerani QR kodga qarating yoki chek rasmini yuklang.\",\r\n            qrScannerAction: \"Hozir Skanerlash\",\r\n            analyzing: \"Tahlil qilinmoqda...\",\r\n            portfolio: \"Moliyaviy Portfel\",\r\n            recentActivity: 'Oxirgi Faoliyat',\r\n            noTransactions: 'Hali o\\'tkazmalar yo\\'q',\r\n            aiRoadmapTitle: 'AI BOYLIQ YO\\'L XARITASI',\r\n            filesAnalysis: 'Maqsadga erishish uchun tahlil',\r\n            detailedList: 'BATAFSIL RO\\'YXAT',\r\n            monthlyAnalysisTitle: 'OYLIK TAHLIL (JAMLANMA)',\r\n            monthlyIncomeTitle: 'OYLIK DAROMAD',\r\n            weeklyExpenseStats: 'HAFTALIK XARAJAT STATISTIKASI',\r\n            iOweLabel: 'MEN QARZDORMAN',\r\n            owedToMeLabel: 'MENDAN QARZ',\r\n            repaid: 'QAYTARILDI',\r\n            repay: 'Qaytarildi',\r\n            extend: 'Uzaytirish',\r\n            dayLabel: 'SANA',\r\n            remaining: 'Qoldiq',\r\n            payNow: 'TO\\'LOVNI QILISH',\r\n            prepay: 'Oldindan To\\'lash',\r\n            collecting: 'Yig\\'ilmoqda',\r\n            totalCollected: 'Jami Yig\\'ildi',\r\n            monthlyPlan: 'Oylik Reja',\r\n            topUp: 'Hisobni To\\'ldirish',\r\n            noData: 'Hali ma\\'lumot yo\\'q',\r\n            aiPredictionTitle: 'AI OYLIK PROGNOZ',\r\n            predictionPart1: 'Siz bu oyni',\r\n            predictionPart2: 'foyda bilan yakunlashingiz kutilmoqda',\r\n            predictionTrend: (percent: number) => `Xarajatlaringiz o'tgan haftaga nisbatan ${percent}% ga kamaygan.`,\r\n            predictionGoalAdvice: (goal: string, months: number) => `Agar shu tempda davom etsangiz, ${goal} maqsadiga kutilganidan ${months} oy oldin yetishingiz mumkin.`,\r\n            predictionDisclaimerText: 'Joriy xarajat odatlaringiz va takroriy daromadinigizga asoslanib.',\r\n            weeklyLabel: 'Haftalik',\r\n            monthlyLabel: 'Oylik',\r\n            customLabel: 'Oraliq',\r\n            analysisSummary: 'Tizim tahlili xulosasi',\r\n            exportExcel: 'Excelda yuklash',\r\n            incomeTitle: 'Daromad',\r\n            expenseTitle: 'Xarajat',\r\n            principalAmount: \"Asosiy qarz\",\r\n            interestAmount: \"Foizlar\",\r\n            repaymentSplit: \"To'lov taqsimoti\",\r\n            realMoney: \"Haqiqiy pulim (Sof)\",\r\n            transTitle: \"Nomi (Izoh)\",\r\n            transType: \"Turi\",\r\n            transCategory: \"Kategoriya\",\r\n            depositActionTitle: \"Omonatni Boshqarish\",\r\n            actionAdd: \"To'ldirish\",\r\n            actionWithdraw: \"Yechish\",\r\n            actionProfit: \"Foyda\",\r\n            sourceBalance: \"Balansdan (-)\",\r\n            sourceOutside: \"Tashqi Kirim (+)\",\r\n            financialStatus: \"Moliyaviy Holat\",\r\n            statusStart: \"тЪк Boshlanish\",\r\n            statusPositive: \"тЬЕ Ijobiy\",\r\n            statusDanger: \"тЪая╕П Xavfli\",\r\n            statusDescStart: \"Sizda hali tahlil uchun yetarli ma'lumot yo'q. Dastlabki daromad yoki xarajatni kiriting.\",\r\n            statusDescPositive: (percent: string) => `Siz oyiga daromadingizning ${percent}% qismini saqlab qolmoqdasiz. Bu juda yaxshi natija!`,\r\n            statusDescDanger: \"Diqqat! Sizning xarajatlaringiz daromaddan oshib ketdi. Zudlik bilan kamida 2 ta ortiqcha xarajatni qisqartiring.\",\r\n            recStart: \"Birinchi o'tkazmani (Daromad yoki Xarajat) qo'shing\",\r\n            recSafety: \"Xavfsizlik yostig'ini 3 oylik xarajat miqdoriga yetkazing\",\r\n            recDeposit: \"Omonat hisobraqamini oching va jamg'arishni boshlang\",\r\n            recDebt: \"Qarzlarni \\\"Qor uyumi\\\" usulida tezroq yoping\",\r\n            recBudget: \"Daromad rejasini (Budjet) belgilang\",\r\n            statusOk: \"Hozircha hammasi joyida!\",\r\n            predictionMsgExcellent: \"Ajoyib natija! Siz daromadingizning katta qismini saqlab qolmoqdasiz. Investitsiya qilishni o'ylab ko'ring.\",\r\n            predictionMsgGood: \"Yaxshi ko'rsatkich. Saqlash rejangiz barqaror. Davom eting.\",\r\n            predictionMsgOk: \"Ijobiy balansdasiz, ammo xarajatlarni biroz optimallashtirish foydali bo'lishi mumkin.\",\r\n            predictionMsgBad: \"Diqqat! Xarajatlaringiz daromaddan oshmoqda. Byudjetni qayta ko'rib chiqing.\",\r\n            fromLabel: \"Dan\",\r\n            toLabel: \"Gacha\"\r\n        },\r\n        categories: {\r\n            Salary: \"Oylik Maosh\",\r\n            Freelance: \"Frilans\",\r\n            Investment: \"Investitsiya\",\r\n            Gift: \"Sovg'a\",\r\n            OtherIncome: \"Boshqa Daromad\",\r\n            Food: \"Oziq-ovqat\",\r\n            Transport: \"Transport\",\r\n            Shopping: \"Xaridlar\",\r\n            Bills: \"To'lovlar (Kommunal)\",\r\n            Health: \"Sog'liq\",\r\n            Education: \"Ta'lim\",\r\n            Leisure: \"Dam olish\",\r\n            Other: \"Boshqa\",\r\n            creditIn: \"Kredit (Kirim)\",\r\n            depositIn: \"Omonat (Kirim)\",\r\n            savings: \"Omonat/O'tkazma\",\r\n            general: \"Umumiy\",\r\n            music: \"Musiqa\",\r\n            mind: \"Zehn\"\r\n        },\r\n        tasks: {\r\n            title: 'Fokus va Vazifalar',\r\n            subtitle: 'Kuningizni rejalashtiring.',\r\n            newTask: 'Yangi Vazifa',\r\n            taskName: 'Vazifa Nomi',\r\n            startTime: 'Boshlash Vaqti',\r\n            endTime: 'Tugash Vaqti',\r\n            priority: 'Muhimlik',\r\n            low: 'Past',\r\n            medium: 'O\\'rta',\r\n            high: 'Yuqori',\r\n            createTask: 'Vazifa Yaratish',\r\n            calendar: 'Kalendar',\r\n            upcomingTasks: 'Kelgusi Rejalar',\r\n            overdue: 'Muddati O\\'tgan',\r\n            future: 'Kelajak',\r\n            stats: {\r\n                completedToday: 'Bugun Bajarildi',\r\n                pending: 'Kutilmoqda',\r\n                efficiency: 'Samaradorlik'\r\n            },\r\n            sections: {\r\n                today: 'Bugun',\r\n                upcoming: 'Kelgusi',\r\n                completed: 'Bajarilgan',\r\n                overdue: 'Muddati O\\'tgan',\r\n                future: 'Kelajak'\r\n            },\r\n            aiSuggestion: {\r\n                title: 'AI Tavsiyasi',\r\n                suggestion: '\"Oylik byudjetni ko\\'rish\" muddati o\\'tgan.',\r\n                add: 'Qo\\'shish +'\r\n            },\r\n            actions: {\r\n                startFocus: 'Fokusni Boshlash',\r\n                moveToToday: 'Bugunga o\\'tkazish',\r\n                subtask: 'Quyi vazifa',\r\n                move: 'Ko\\'chirish',\r\n                focus: 'Fokus',\r\n                edit: 'Tahrirlash',\r\n                delete: 'O\\'chirish',\r\n                promote: 'Asosiyga O\\'tkazish'\r\n            },\r\n            completedArchive: 'Bajarilgan Vazifalar Arxivi',\r\n            readOnly: 'Vazifalar Arxivlandi',\r\n            readOnlyDesc: 'O\\'tmishdagi vazifalarni o\\'zgartirib bo\\'lmaydi.',\r\n            noTasks: 'Bugun uchun vazifalar yo\\'q. Kuningiz maroqli o\\'tsin!'\r\n        },\r\n        health: {\r\n            history: 'Tarix',\r\n            readOnly: 'Salomatlik Ma\\'lumotlari Bloklangan',\r\n            readOnlyDesc: 'Tarixiy biometrik ma\\'lumotlarni o\\'zgartirib bo\\'lmaydi.',\r\n            title: \"Sog'lik\",\r\n            subtitle: \"Harakatda baraka.\",\r\n            bodyBattery: {\r\n                title: 'Zaryad',\r\n                fullyCharged: 'Siz to\\'liq quvvatlangansiz! Yuqori intensivlikdagi vazifalar yoki mashg\\'ulot uchun ajoyib vaqt.',\r\n                recharge: 'Quvvatni tiklash uchun tanaffus qilishni o\\'ylab ko\\'ring.',\r\n                sleepRestoration: 'Uyqu Tiklanishi',\r\n                activeDrain: 'Faol Xarajat',\r\n                stressTax: 'Stress Yuklamasi',\r\n                hydrationEfficiency: 'Gidratatsiya Samaradorligi'\r\n            },\r\n            vitals: {\r\n                title: 'Yurak urishi',\r\n                stressTitle: 'Stress darajasi',\r\n                resting: 'Dam olishda',\r\n                heartRateUnit: 'urish/daq',\r\n                normalRange: 'Normal diapazonda',\r\n                avgLevel: 'O\\'rtacha daraja',\r\n                low: 'Past',\r\n                relaxedState: 'Bo\\'shashgan holat'\r\n            },\r\n            sleep: {\r\n                score: '/ 100',\r\n                quality: 'Tiklovchi uyqu',\r\n                unit: 'Ball'\r\n            },\r\n            hydration: {\r\n                title: 'Suv balansi',\r\n                goal: 'Maqsad',\r\n                unit: 'ml'\r\n            },\r\n            activity: {\r\n                title: 'Faoliyat',\r\n                stepsToday: 'bugun qadam',\r\n                kcal: 'kkal',\r\n                dist: 'masofa'\r\n            },\r\n            trends: {\r\n                title: 'Salomatlik tendensiyalari (Oxirgi 7 kun)',\r\n                stepsHistory: 'Qadamlar tarixi',\r\n                sleepQuality: 'Uyqu sifati'\r\n            },\r\n            days: {\r\n                mon: 'Du',\r\n                tue: 'Se',\r\n                wed: 'Chor',\r\n                thu: 'Pay',\r\n                fri: 'Ju',\r\n                sat: 'Shan',\r\n                sun: 'Yak'\r\n            },\r\n            biometrics: {\r\n                title: 'Biometrik ma\\'lumotlar',\r\n                aiRecTitle: 'AI Tavsiyasi',\r\n                aiRecLose: 'Metabolizmni tezlashtirish tavsiya etiladi. AI kaloriya maqsadlarini o\\'zgartiradi.',\r\n                aiRecMaintain: 'Barqaror rivojlanish saqlanmoqda. Ritmni ushlab turing.',\r\n                weight: 'Vazn',\r\n                height: 'Bo\\'y',\r\n                goal: 'Maqsad',\r\n                lose: 'Vazn yo\\'qotish',\r\n                gain: 'Vazn orttirish',\r\n                maintain: 'Vaznni saqlash',\r\n                unitCm: 'sm',\r\n                unitKg: \"kg\",\r\n            },\r\n            aiAdvisor: {\r\n                title: 'AI Salomatlik Maslahatchisi',\r\n                analyzing: 'AI ma\\'lumotlarni tahlil qilmoqda...',\r\n                hydrationLow: 'Sizning suv balansingiz past. Samaradorlikni oshirish uchun yana 2 stakan suv iching.',\r\n                stressHigh: 'Stress darajasi yuqori. 10 daqiqalik meditatsiya mashg\\'ulotini o\\'tkazishni tavsiya qilamiz.',\r\n                sleepLow: 'Tiklanish darajasi past. Bugun dam olishga e\\'tibor bering va og\\'ir mashqlardan qoching.',\r\n                allGood: 'Barcha tizimlar joyida. Sizning tiklanish darajangiz faolligingizga to\\'liq mos keladi!'\r\n            },\r\n            loading: \"Salomatlik ma'lumotlari yuklanmoqda...\",\r\n            simulate: \"21:00 simulyatsiya qilish\",\r\n            batteryStatus: {\r\n                ready: \"Tayyor\",\r\n                good: \"Yaxshi his qilyapman\",\r\n                tired: \"Bir oz charchagan\",\r\n                rest: \"Dam olish vaqti\"\r\n            },\r\n            voiceAlertSteps: \"qadamlar qayd etildi!\",\r\n            voiceAlertSleep: \"soat uyqu qayd etildi!\",\r\n            voiceAlertWater: \"ml suv qo'shildi!\"\r\n        },\r\n        food: {\r\n            title: \"Taom AI\",\r\n            subtitle: \"Tanangizni oqilona oziqlantiring.\",\r\n            readOnly: 'Kunlik Jurnal Arxivlandi',\r\n            readOnlyDesc: 'O\\'tmishdagi ovqatlarni tahrirlab bo\\'lmaydi.',\r\n            calories: \"Kaloriyalar\",\r\n            macros: \"Makroslar\",\r\n            protein: \"Oqsillar\",\r\n            carbs: \"Uglevodlar\",\r\n            fats: \"Yog'lar\",\r\n            mealLogs: \"Taomlar Tarixi\",\r\n            scanMeal: \"Taomni Skanerlash\",\r\n            dailyLog: \"Kunlik Jurnal\",\r\n            historyModalTitle: \"Taomlanish Tarixi (So'nggi 7 kun)\",\r\n            cameraPrompt: \"Kamerani taomga qarating\",\r\n            analyzing: \"AI Tahlil qilmoqda...\",\r\n            instantAdviceTitle: \"Tezkor Maslahat\",\r\n            targetAdvice: \"Bugungi oqsil miqdori ajoyib! Kechki ovqatga ko'proq kletchatka (sabzavotlar) qo'shishni sinab ko'ring.\",\r\n            scanError: \"Taomni aniqlab bo'lmadi. Iltimos, qayta urinib ko'ring.\",\r\n            aiDetected: \"AI Aniqladi\",\r\n            eatQuestion: \"Buni yedingizmi?\",\r\n            yes: \"Ha\",\r\n            no: \"Yo'q\",\r\n            streak: \"KUNLIK SERIYA\",\r\n            loading: \"Yuklanmoqda...\",\r\n            alertArchived: \"Siz arxivlangan kunlar uchun ma'lumot qo'sha olmaysiz.\",\r\n            mealQuick: \"Tezkor Kiritish\",\r\n            mealSnack: \"Tamaddi\",\r\n            mealBreakfast: \"Nonushta\",\r\n            mealLunch: \"Tushlik\",\r\n            mealDinner: \"Kechki ovqat\",\r\n            kcal: \"kkal\",\r\n            unitG: \"g\"\r\n        },\r\n        mind: {\r\n            title: \"Zukko Maskani\",\r\n            subtitle: \"Aqliy tiniqlik va diqqat.\",\r\n            readOnly: 'Zehn Konteksti Bloklangan',\r\n            readOnlyDesc: 'O\\'tmishdagi ruhiy holatlar arxivlangan.',\r\n            weeklyFocus: \"Haftalik Maqsad\",\r\n            focusingOn: \"Diqqat markazi:\",\r\n            focus: \"Diqqat\",\r\n            break: \"Tanaffus\",\r\n            moodSphere: \"Kayfiyat Sferasi\",\r\n            moodSphereDesc: \"Sozlash uchun torting (<30 = Zen)\",\r\n            resonanceBreathing: \"Rezonans Nafas\",\r\n            startSession: \"Boshlash\",\r\n            stopSession: \"To'xtatish\",\r\n            inhale: \"Nafas oling\",\r\n            exhale: \"Nafas chiqaring\",\r\n            hold: \"Ushlab turing\",\r\n            ready: \"Tayyormisiz\",\r\n            aiSummaryTitle: \"Kunlik AI Xulosasi\",\r\n            aiSummaryText: \"Bugun kayfiyatingiz barqaror. Diqqat samaradorligi kechagiga qaraganda 15% ga oshdi.\",\r\n            historyModalTitle: \"Kayfiyat Jurnali (Tarix)\",\r\n            recentSessions: \"Oxirgi Sessiyalar\",\r\n            moodTrends: \"Kayfiyat Trendlari\",\r\n            zenTitle: \"Nafas Oling\",\r\n            zenSubtitle: \"Tahlillar yashirilgan. Hozirgi onga e'tibor qarating.\",\r\n            whyFeeling: \"Nega bunday his qilyapsiz?\",\r\n            exitZen: \"O'zimni yaxshi his qilyapman (Chiqish)\",\r\n            reasons: {\r\n                tired: \"Charchagan\",\r\n                anxious: \"Xavotirda\",\r\n                overwhelmed: \"Ortiqcha yuklangan\",\r\n                justBecause: \"Shunchaki\"\r\n            },\r\n            loadingState: \"Yuklanmoqda...\",\r\n            saved: \"Saqlandi\",\r\n            saveMood: \"Kayfiyatni Saqlash\",\r\n            zenMapLeft: \"Salbiy (Zen)\",\r\n            zenMapRight: \"Ijobiy\",\r\n            aiLoading: \"AI holatingizni tahlil qilmoqda...\",\r\n            aiPoweredBy: \"AURA Strategik Ong\"\r\n        },\r\n        focus: {\r\n            minutes: 'Minut',\r\n            done: 'Bajarildi'\r\n        },\r\n        interests: {\r\n            title: \"Qiziqishlar va Rivojlanish\",\r\n            subtitle: \"Ufqingizni kengaytiring.\",\r\n            readOnly: 'Progress Bloklangan',\r\n            readOnlyDesc: 'O\\'tmishdagi jurnallarni o\\'zgartirib bo\\'lmaydi.',\r\n            historyModalTitle: \"Xobbi amaliyot jurnali\",\r\n            practiceLog: \"Amaliyot jurnali\",\r\n            streak: \"Kunlik seriya\",\r\n            newHobby: \"+ Yangi xobbi\",\r\n            aiRecommendation: \"AI Tavsiyasi: Kulolchilik\",\r\n            aiReason: \"Sizning \\\"Dizayn\\\" qiziqishingizga asoslanib, sizga taktil ijodkorlik yoqishi mumkin.\",\r\n            tryThis: \"Buni sinab ko'ring\",\r\n            hoursSpent: \"sarflangan soat\",\r\n            nextLevel: \"Keyingi: Daraja\",\r\n            discoverNew: \"Yangi ehtirosni kashf eting\",\r\n            level: \"Daraja\",\r\n            addHobbyTitle: \"Yangi xobbi qo'shish\",\r\n            hobbyName: \"Nomi\",\r\n            category: \"Kategoriya\",\r\n            loading: \"Xobbilar yuklanmoqda...\",\r\n            categories: {\r\n                general: \"Umumiy\",\r\n                art: \"San'at\",\r\n                physical: \"Jismoniy\",\r\n                mind: \"Aql\",\r\n                music: \"Musiqa\"\r\n            },\r\n            placeholderName: \"Masalan: Kulolchilik, Shaxmat, Pianino...\",\r\n            positive: \"Ijobiy\",\r\n            negative: \"Salbiy\",\r\n            type: \"Turi\",\r\n            trackingMode: \"Kuzatuv rejimi\",\r\n            trackingFrequency: \"Chastota (+1)\",\r\n            trackingFrequencyDesc: \"Har bir hodisani hisoblaydi (masalan, chekilgan sigaretalar).\",\r\n            trackingBinary: \"Bir marta (Ha/Yo'q)\",\r\n            trackingBinaryDesc: \"Kuniga bir marta qayd etiladi (masalan, kech uyg'onish).\",\r\n            newHobbyCardTitle: \"Yangi xobbi\",\r\n            newHobbyCardDesc: \"Ijobiy o'sish uchun\",\r\n            positiveInterests: \"Ijobiy qiziqishlar\",\r\n            negativeHabits: \"Nazorat qilinadigan odatlar\",\r\n            dailyActivities: \"Kundalik faoliyatlar\",\r\n            aiRecStatus: \"AI Tavsiya holati\",\r\n            statCount: \"SONI\",\r\n            statDuration: \"DAVOMIYLIGI\",\r\n            loyaltyXP: \"SADOQAT XP\",\r\n            done: \"Bajarildi\",\r\n            logCount: \"LOG (+1)\",\r\n            log: \"LOG\",\r\n            status: \"Holat\",\r\n            times: \"marta\",\r\n            totalHours: \"h JAMI\",\r\n            totalControl: \"h NAZORAT\",\r\n            logDurationQuestion: \"Necha daqiqa mashq qildingiz?\",\r\n            aiRecTitleCorrection: \"AURA Tuzatish\",\r\n            aiRecTitleGrowth: \"AURA O'sishi\",\r\n            aiRecDone: \"Bajarildi\",\r\n            aiRecTask: \"Vazifa\",\r\n            aiRecAddTask: \"Vazifa\",\r\n            noActivities: \"Bugun hech qanday faoliyat qayd etilmadi.\",\r\n            selectHobby: \"Faoliyatni qayd etish uchun yuqoridan xobbini tanlang.\",\r\n            notDone: \"Bajarilmadi\",\r\n            todayLabel: \"Bugun\",\r\n            dailyStats: \"KUNDALIK STATISTIKA\"\r\n        },\r\n        liveness_section: {\r\n            title: \"HAYOT SIGNALI\",\r\n            subtitle: \"Avlodlar g'amxo'rligining raqamli ko'prigi.\",\r\n            desc: \"Yaqinlaringiz uchun passiv monitoring. Agar belgilangan vaqtda faollik bo'lmasa, oila a'zolari ogohlantiriladi. Keksalar xavfsizligi uchun ideal.\",\r\n            cta: \"Signalni sozlash\",\r\n            silent_mode: 'Tinch rejim',\r\n            silent_mode_desc: 'Uyqu vaqtida to\\'xtatish',\r\n            activity_log: 'Signal tarixi',\r\n            panic_alert: 'XAVF BILDIRISHNOMASI',\r\n            panic_confirm: 'Zudlik bilan xabar yuborilsinmi?',\r\n            countdown_prefix: 'Keyingi tekshiruv:',\r\n            checkInPrompt: 'Azamat ota, ahvolingiz yaxshimi? Iltimos, tasdiqlang.',\r\n            familyAlert: (hours: number) => `Ogohlantirish: Otangiz ${hours} soatdan beri aloqaga chiqmadi!`\r\n        },\r\n    },\r\n    ru: {\r\n        common: {\r\n            refresh: '╨Ю╨▒╨╜╨╛╨▓╨╕╤В╤М',\r\n            save: '╨б╨╛╤Е╤А╨░╨╜╨╕╤В╤М',\r\n            cancel: '╨Ю╤В╨╝╨╡╨╜╨░',\r\n            back: '╨Э╨░╨╖╨░╨┤',\r\n            viewHistory: '╨Ш╤Б╤В╨╛╤А╨╕╤П',\r\n            history: '╨Ш╤Б╤В╨╛╤А╨╕╤П',\r\n            today: '╨б╨╡╨│╨╛╨┤╨╜╤П',\r\n            yesterday: '╨Т╤З╨╡╤А╨░',\r\n            done: '╨У╨╛╤В╨╛╨▓╨╛',\r\n            user: '╨Я╨╛╨╗╤М╨╖╨╛╨▓╨░╤В╨╡╨╗╤М'\r\n        },\r\n        nav: {\r\n            hero: '╨У╨╗╨░╨▓╨╜╨░╤П',\r\n            problem: '╨Я╤А╨╛╨▒╨╗╨╡╨╝╨░',\r\n            solution: '╨а╨╡╤И╨╡╨╜╨╕╨╡',\r\n            butterfly: '╨С╨░╨▒╨╛╤З╨║╨░',\r\n            platforms: '╨Я╨╗╨░╤В╤Д╨╛╤А╨╝╤Л',\r\n            family: '╨б╨╡╨╝╤М╤П'\r\n        },\r\n        sidebar: {\r\n            dashboard: '╨У╨╗╨░╨▓╨╜╨░╤П',\r\n            family: '╨б╨╡╨╝╤М╤П',\r\n            finance: '╨д╨╕╨╜╨░╨╜╤Б╤Л',\r\n            tasks: '╨Ч╨░╨┤╨░╤З╨╕',\r\n            health: '╨Ч╨┤╨╛╤А╨╛╨▓╤М╨╡',\r\n            food: '╨Я╨╕╤В╨░╨╜╨╕╨╡',\r\n            mind: '╨а╨░╨╖╤Г╨╝',\r\n            interests: '╨Ш╨╜╤В╨╡╤А╨╡╤Б╤Л',\r\n            liveness: '╨Я╤Г╨╗╤М╤Б ╨Ц╨╕╨╖╨╜╨╕',\r\n            settings: '╨Э╨░╤Б╤В╤А╨╛╨╣╨║╨╕',\r\n            archived: '╨Р╤А╤Е╨╕╨▓╨╕╤А╨╛╨▓╨░╨╜╨╛'\r\n        },\r\n        home: {\r\n            deepWork: '╨б╨Х╨б╨б╨Ш╨п ╨д╨Ю╨Ъ╨г╨б╨Р',\r\n            endSession: '╨Ч╨░╨▓╨╡╤А╤И╨╕╤В╤М',\r\n            rainOn: '╨Ф╨╛╨╢╨┤╤М',\r\n            ambientOff: '╨С╨╡╨╖ ╨╖╨▓╤Г╨║╨░',\r\n            voiceCommand: '╨У╨╛╨╗╨╛╤Б╨╛╨▓╨░╤П ╨║╨╛╨╝╨░╨╜╨┤╨░',\r\n            listening: '╨б╨╗╤Г╤И╨░╤О...',\r\n            analyzing: '╨Р╨╜╨░╨╗╨╕╨╖ ╤Б╨╕╤Б╤В╨╡╨╝╤Л...',\r\n            viewHistory: '╨Ш╤Б╤В╨╛╤А╨╕╤П',\r\n            simStress: '╨б╨╕╨╝ ╨б╤В╤А╨╡╤Б╤Б',\r\n            simCalm: '╨б╨╕╨╝ ╨г╨╝╨╕╤А╨╛╤В╨▓╨╛╤А╨╡╨╜╨╕╨╡',\r\n            enterZen: '╨Т╨╛╨╣╤В╨╕ ╨▓ ╨Ф╨╖╨╡╨╜',\r\n            chronos: '╨е╤А╨╛╨╜╨╛╤Б',\r\n            atmosphere: '╨Р╤В╨╝╨╛╤Б╤Д╨╡╤А╨░',\r\n            clearSky: '╨п╤Б╨╜╨╛╨╡ ╨╜╨╡╨▒╨╛',\r\n            wealthPulse: '╨Я╤Г╨╗╤М╤Б ╨С╨╛╨│╨░╤В╤Б╤В╨▓╨░',\r\n            familyHub: '╨б╨╡╨╝╨╡╨╣╨╜╤Л╨╣ ╤Ж╨╡╨╜╤В╤А',\r\n            approval: '1 ╨╛╨┤╨╛╨▒╤А╨╡╨╜╨╕╨╡',\r\n            kidsTask: \"╨Ч╨░╨┤╨░╤З╨░ ╤А╨╡╨▒╨╡╨╜╨║╨░ ╨▓╤Л╨┐╨╛╨╗╨╜╨╡╨╜╨░\",\r\n            waiting: '╨Ю╨╢╨╕╨┤╨░╨╜╨╕╨╡ ╨┐╨╛╨┤╤В╨▓╨╡╤А╨╢╨┤╨╡╨╜╨╕╤П ╤А╨╛╨┤╨╕╤В╨╡╨╗╨╡╨╣',\r\n            vitality: '╨Ц╨╕╨╖╨╜╨╡╨╜╨╜╨╛╤Б╤В╤М',\r\n            geneticRisk: 'тЪая╕П ╨У╨╡╨╜╨╡╤В╨╕╤З╨╡╤Б╨║╨╕╨╣ ╤А╨╕╤Б╨║',\r\n            nutrition: '╨Я╨╕╤В╨░╨╜╨╕╨╡',\r\n            hobbies: '╨е╨╛╨▒╨▒╨╕',\r\n            streak: '╨Ф╨╜╨╡╨╣ ╨┐╨╛╨┤╤А╤П╨┤',\r\n            dailyInsights: '╨Х╨╢╨╡╨┤╨╜╨╡╨▓╨╜╤Л╨╡ ╨╕╨╜╤Б╨░╨╣╤В╤Л ╨Ш╨Ш',\r\n            batteryStatus: {\r\n                ready: '╨У╨╛╤В╨╛╨▓ ╨║ ╨┤╨╡╨╣╤Б╤В╨▓╨╕╤О',\r\n                good: '╨з╤Г╨▓╤Б╤В╨▓╤Г╤О ╤Б╨╡╨▒╤П ╤Е╨╛╤А╨╛╤И╨╛',\r\n                tired: '╨Э╨╡╨╝╨╜╨╛╨│╨╛ ╤Г╤Б╤В╨░╨╗',\r\n                rest: '╨Э╤Г╨╢╨╡╨╜ ╨╛╤В╨┤╤Л╤Е'\r\n            },\r\n            thisMonth: '╨▓ ╤Н╤В╨╛╨╝ ╨╝╨╡╤Б╤П╤Ж╨╡',\r\n            need_more_data: '╨Э╨╡╨┤╨╛╤Б╤В╨░╤В╨╛╤З╨╜╨╛ ╨┤╨░╨╜╨╜╤Л╤Е ╨┤╨╗╤П ╨░╨╜╨░╨╗╨╕╨╖╨░. ╨Я╨╛╨╢╨░╨╗╤Г╨╣╤Б╤В╨░, ╨╖╨░╨┐╨╛╨╗╨╜╨╕╤В╨╡ ╨╝╨╛╨┤╤Г╨╗╨╕.',\r\n            analysis_error: '╨Ю╤И╨╕╨▒╨║╨░ ╨┐╤А╨╕ ╨░╨╜╨░╨╗╨╕╨╖╨╡ ╤Б╨╕╤Б╤В╨╡╨╝╤Л. ╨Я╨╛╨╢╨░╨╗╤Г╨╣╤Б╤В╨░, ╨┐╤А╨╛╨▓╨╡╤А╤М╤В╨╡ ╤Б╨╛╤Б╤В╨╛╤П╨╜╨╕╨╡ ╤Б╨╡╤А╨▓╨╕╤Б╨╛╨▓.',\r\n            system_ready: '╨б╨╕╤Б╤В╨╡╨╝╨░ AURA AI ╨│╨╛╤В╨╛╨▓╨░',\r\n            modules: {\r\n                finance: \"╨д╨╕╨╜╨░╨╜╤Б╤Л\",\r\n                health: \"╨Ч╨┤╨╛╤А╨╛╨▓╤М╨╡\",\r\n                family: \"╨б╨╡╨╝╤М╤П\",\r\n                mind: \"╨а╨░╨╖╤Г╨╝\",\r\n                food: \"╨Я╨╕╤В╨░╨╜╨╕╨╡\"\r\n            }\r\n        },\r\n        butterfly: {\r\n            title: '╨н╤Д╤Д╨╡╨║╤В ╨С╨░╨▒╨╛╤З╨║╨╕',\r\n            subtitle: '╨Ъ╨░╨║ ╨▓╨░╤И ╨╡╨╢╨╡╨┤╨╜╨╡╨▓╨╜╤Л╨╣ ╨▓╤Л╨▒╨╛╤А ╨▓╨╗╨╕╤П╨╡╤В ╨╜╨░ ╤Н╨║╨╛╤Б╨╕╤Б╤В╨╡╨╝╤Г ╨▓╨░╤И╨╡╨╣ ╨╢╨╕╨╖╨╜╨╕',\r\n            analyzing: '╨Р╨╜╨░╨╗╨╕╨╖ ╨║╨╛╤А╤А╨╡╨╗╤П╤Ж╨╕╨╣ ╨┐╨╛ 8 ╨╝╨╛╨┤╤Г╨╗╤П╨╝...',\r\n            lifeHarmony: '╨У╨░╤А╨╝╨╛╨╜╨╕╤П ╨Ц╨╕╨╖╨╜╨╕',\r\n            keyInsights: '╨Ъ╨╗╤О╤З╨╡╨▓╤Л╨╡ ╨Ш╨╜╤Б╨░╨╣╤В╤Л',\r\n            noCorrelations: '╨Ч╨╜╨░╤З╨╕╨╝╤Л╤Е ╨║╨╛╤А╤А╨╡╨╗╤П╤Ж╨╕╨╣ ╨┐╨╛╨║╨░ ╨╜╨╡ ╨╛╨▒╨╜╨░╤А╤Г╨╢╨╡╨╜╨╛',\r\n            keepLogging: '╨Я╤А╨╛╨┤╨╛╨╗╨╢╨░╨╣╤В╨╡ ╨▓╨▓╨╛╨┤╨╕╤В╤М ╨┤╨░╨╜╨╜╤Л╨╡ ╨▓ ╨╝╨╛╨┤╤Г╨╗╨╕, ╤З╤В╨╛╨▒╤Л ╤А╨░╨╖╨▒╨╗╨╛╨║╨╕╤А╨╛╨▓╨░╤В╤М ╨╕╨╜╤Б╨░╨╣╤В╤Л',\r\n            confident: '╤Г╨▓╨╡╤А╨╡╨╜╨╜╨╛╤Б╤В╨╕',\r\n            fixThis: '╨Ш╤Б╨┐╤А╨░╨▓╨╕╤В╤М',\r\n            states: {\r\n                harmonic: '╨У╨░╤А╨╝╨╛╨╜╨╕╤З╨╜╤Л╨╣ ╨Я╨╛╤В╨╛╨║',\r\n                fragmented: '╨д╤А╨░╨│╨╝╨╡╨╜╤В╨╕╤А╨╛╨▓╨░╨╜╨╛',\r\n                disconnected: '╨а╨░╨╖╨╛╨▒╤Й╨╡╨╜╨╛'\r\n            },\r\n            descriptions: {\r\n                harmonic: '╨Т╨░╤И╨╕ ╨╢╨╕╨╖╨╜╨╡╨╜╨╜╤Л╨╡ ╨╝╨╛╨┤╤Г╨╗╨╕ ╤А╨░╨▒╨╛╤В╨░╤О╤В ╨▓ ╨┐╤А╨╡╨║╤А╨░╤Б╨╜╨╛╨╣ ╤Б╨╕╨╜╨╡╤А╨│╨╕╨╕',\r\n                fragmented: '╨Э╨╡╨║╨╛╤В╨╛╤А╤Л╨╡ ╨╛╨▒╨╗╨░╤Б╤В╨╕ ╤В╤А╨╡╨▒╤Г╤О╤В ╨▓╨╜╨╕╨╝╨░╨╜╨╕╤П ╨┤╨╗╤П ╨▓╨╛╤Б╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜╨╕╤П ╨▒╨░╨╗╨░╨╜╤Б╨░',\r\n                disconnected: '╨Ъ╤А╨╕╤В╨╕╤З╨╜╨╛: ╨Э╨╡╤Б╨║╨╛╨╗╤М╨║╨╛ ╨╛╨▒╨╗╨░╤Б╤В╨╡╨╣ ╤В╤А╨╡╨▒╤Г╤О╤В ╨╜╨╡╨╝╨╡╨┤╨╗╨╡╨╜╨╜╨╛╨│╨╛ ╨▓╨╜╨╕╨╝╨░╨╜╨╕╤П'\r\n            },\r\n            insights: {\r\n                sleepProductivityNegative: (sleep, productivity) => `╨Я╨╗╨╛╤Е╨╛╨╣ ╤Б╨╛╨╜ (${sleep}) тЖТ ╨Э╨╕╨╖╨║╨░╤П ╨┐╤А╨╛╨┤╤Г╨║╤В╨╕╨▓╨╜╨╛╤Б╤В╤М (${productivity} ╨▓╤Л╨┐╨╛╨╗╨╜╨╡╨╜╨╜╤Л╤Е ╨╖╨░╨┤╨░╤З)`,\r\n                sleepProductivityPositive: (sleep, productivity) => `╨Ю╤В╨╗╨╕╤З╨╜╤Л╨╣ ╤Б╨╛╨╜ (${sleep}) тЖТ ╨Т╤Л╤Б╨╛╨║╨░╤П ╨┐╤А╨╛╨┤╤Г╨║╤В╨╕╨▓╨╜╨╛╤Б╤В╤М (${productivity} ╨▓╤Л╨┐╨╛╨╗╨╜╨╡╨╜╨╜╤Л╤Е ╨╖╨░╨┤╨░╤З)`,\r\n                financeMindNegative: (stress, mood) => `╨д╨╕╨╜╨░╨╜╤Б╨╛╨▓╤Л╨╣ ╤Б╤В╤А╨╡╤Б╤Б (${stress}) тЖТ ╨Э╨╕╨╖╨║╨╛╨╡ ╨╜╨░╤Б╤В╤А╨╛╨╡╨╜╨╕╨╡ (${mood}/100)`,\r\n                foodHealthNegative: (calories, energy) => `╨Э╨╡╨┤╨╛╨╡╨┤╨░╨╜╨╕╨╡ (${calories} ╨╛╤В ╨╜╨╛╤А╨╝╤Л ╨║╨░╨╗╨╛╤А╨╕╨╣) тЖТ ╨Э╨╕╨╖╨║╨░╤П ╤Н╨╜╨╡╤А╨│╨╕╤П (${energy}% ╨╖╨░╤А╤П╨┤╨░ ╤В╨╡╨╗╨░)`,\r\n                foodHealthPositive: (protein, energy) => `╨Ю╤В╨╗╨╕╤З╨╜╨╛╨╡ ╨┐╨╕╤В╨░╨╜╨╕╨╡ (${protein} ╨╛╤В ╨╜╨╛╤А╨╝╤Л ╨▒╨╡╨╗╨║╨░) тЖТ ╨Т╤Л╤Б╨╛╨║╨░╤П ╤Н╨╜╨╡╤А╨│╨╕╤П (${energy}% ╨╖╨░╤А╤П╨┤╨░ ╤В╨╡╨╗╨░)`,\r\n                focusInterestsPositive: (focus, streak) => `╨У╨╗╤Г╨▒╨╛╨║╨░╤П ╤А╨░╨▒╨╛╤В╨░ (${focus} ╨╝╨╕╨╜ ╤Б╨╡╨│╨╛╨┤╨╜╤П) тЖТ ╨б╨╕╨╗╤М╨╜╨░╤П ╨┐╤А╨╕╨▓╤Л╤З╨║╨░ ╨║ ╨╛╨▒╤Г╤З╨╡╨╜╨╕╤О (${streak}-╨┤╨╜╨╡╨▓╨╜╨░╤П ╤Б╨╡╤А╨╕╤П)`,\r\n                familyMindPositive: (members, mood) => `╨Р╨║╤В╨╕╨▓╨╜╤Л╨╣ ╤Б╨╡╨╝╨╡╨╣╨╜╤Л╨╣ ╤Ж╨╡╨╜╤В╤А (${members} ╤Г╤З╨░╤Б╤В╨╜╨╕╨║╨╛╨▓) тЖТ ╨Я╨╛╨╗╨╛╨╢╨╕╤В╨╡╨╗╤М╨╜╨╛╨╡ ╨╜╨░╤Б╤В╤А╨╛╨╡╨╜╨╕╨╡ (${mood}/100)`\r\n            },\r\n            actions: {\r\n                sleep: \"╨г╨╗╤Г╤З╤И╨╕╤В╨╡ ╨║╨░╤З╨╡╤Б╤В╨▓╨╛ ╤Б╨╜╨░ ╤Б╨╡╨│╨╛╨┤╨╜╤П ╨▓╨╡╤З╨╡╤А╨╛╨╝, ╤З╤В╨╛╨▒╤Л ╨┐╨╛╨▓╤Л╤Б╨╕╤В╤М ╨║╨╛╨╜╤Ж╨╡╨╜╤В╤А╨░╤Ж╨╕╤О ╨╖╨░╨▓╤В╤А╨░\",\r\n                finance: \"╨Я╨╡╤А╨╡╤Б╨╝╨╛╤В╤А╨╕╤В╨╡ ╨▒╤О╨┤╨╢╨╡╤В ╨╕ ╤Б╨╛╨╖╨┤╨░╨╣╤В╨╡ ╨┐╨╗╨░╨╜ ╤А╨╡╨╖╨╡╤А╨▓╨╜╨╛╨│╨╛ ╤Д╨╛╨╜╨┤╨░\",\r\n                food: \"╨Ф╨╛╨▒╨░╨▓╤М╤В╨╡ ╨▒╨╛╨│╨░╤В╤Л╨╣ ╨▒╨╡╨╗╨║╨╛╨╝ ╨┐╨╡╤А╨╡╨║╤Г╤Б, ╤З╤В╨╛╨▒╤Л ╨▓╨╛╤Б╤Б╤В╨░╨╜╨╛╨▓╨╕╤В╤М ╤Н╨╜╨╡╤А╨│╨╕╤О\"\r\n            }\r\n        },\r\n        settings: {\r\n            title: '╨Э╨░╤Б╤В╤А╨╛╨╣╨║╨╕',\r\n            lang: '╨п╨╖╤Л╨║ / Language',\r\n            notifs: '╨г╨▓╨╡╨┤╨╛╨╝╨╗╨╡╨╜╨╕╤П',\r\n            dailyBrief: '╨Х╨╢╨╡╨┤╨╜╨╡╨▓╨╜╨░╤П ╤Б╨▓╨╛╨┤╨║╨░ (08:00)',\r\n            focusAlerts: '╨Э╨░╨┐╨╛╨╝╨╕╨╜╨░╨╜╨╕╤П ╤Д╨╛╨║╤Г╤Б╨░',\r\n            familyUpdates: '╨б╨╡╨╝╨╡╨╣╨╜╤Л╨╡ ╨╛╨▒╨╜╨╛╨▓╨╗╨╡╨╜╨╕╤П',\r\n            system: '╨б╨╕╤Б╤В╨╡╨╝╨░',\r\n            export: '╨н╨║╤Б╨┐╨╛╤А╤В ╨┤╨░╨╜╨╜╤Л╤Е',\r\n            reset: \"╨б╨▒╤А╨╛╤Б ╨░╨║╨║╨░╤Г╨╜╤В╨░\",\r\n            currentLocale: \"╨в╨╡╨║╤Г╤Й╨╕╨╣ ╤П╨╖╤Л╨║:\",\r\n            freePlan: \"╨С╨Х╨б╨Я╨Ы╨Р╨в╨Э╨Ю\",\r\n            justNow: \"╨в╨╛╨╗╤М╨║╨╛ ╤З╤В╨╛\",\r\n            dailyBriefDesc: \"╨г╤В╤А╨╡╨╜╨╜╤П╤П ╤Б╨▓╨╛╨┤╨║╨░ ╨▓ 08:00\",\r\n            focusAlertsDesc: \"╨Э╨░╨┐╨╛╨╝╨╕╨╜╨░╨╜╨╕╤П ╨╛ ╨╜╨░╤З╨░╨╗╨╡ ╤Б╨╡╨░╨╜╤Б╨╛╨▓ ╤Д╨╛╨║╤Г╤Б╨░\",\r\n            familyUpdatesDesc: \"╨Ъ╨╛╨│╨┤╨░ ╤З╨╗╨╡╨╜╤Л ╤Б╨╡╨╝╤М╨╕ ╨▓╤Л╨┐╨╛╨╗╨╜╤П╤О╤В ╨╖╨░╨┤╨░╤З╨╕\",\r\n            exportSuccess: \"тЬЕ ╨Ф╨░╨╜╨╜╤Л╨╡ ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╤Н╨║╤Б╨┐╨╛╤А╤В╨╕╤А╨╛╨▓╨░╨╜╤Л!\",\r\n            resetScheduled: \"тЪая╕П ╨б╨▒╤А╨╛╤Б ╨░╨║╨║╨░╤Г╨╜╤В╨░ ╨╖╨░╨┐╨╗╨░╨╜╨╕╤А╨╛╨▓╨░╨╜\",\r\n            logType: \"╨в╨Ш╨Я\",\r\n            logDevice: \"╨г╨б╨в╨а╨Ю╨Щ╨б╨в╨Т╨Ю\",\r\n            logTime: \"╨Т╨а╨Х╨Ь╨п\",\r\n            logLogin: \"╨Т╨е╨Ю╨Ф\",\r\n            logWebDashboard: \"╨Т╨╡╨▒-╨┐╨░╨╜╨╡╨╗╤М\",\r\n            profile: \"╨г╤З╨░╤Б╤В╨╜╨╕╨║ ╤Б\",\r\n            securityLog: \"╨Ц╤Г╤А╨╜╨░╨╗ ╨▒╨╡╨╖╨╛╨┐╨░╤Б╨╜╨╛╤Б╤В╨╕\",\r\n            logout: \"╨Т╤Л╨╣╤В╨╕\",\r\n            yesterday: '╨Т╤З╨╡╤А╨░',\r\n            today: '╨б╨╡╨│╨╛╨┤╨╜╤П',\r\n            selectDate: '╨Т╤Л╨▒╤А╨░╤В╤М ╨┤╨░╤В╤Г'\r\n        },\r\n        family: {\r\n            title: '╨б╨╡╨╝╨╡╨╣╨╜╤Л╨╣ ╤Ж╨╡╨╜╤В╤А',\r\n            subtitle: '╨ж╨╕╤Д╤А╨╛╨▓╨╛╨╣ ╨╝╨╛╤Б╤В ╨╝╨╡╨╢╨┤╤Г ╨┐╨╛╨║╨╛╨╗╨╡╨╜╨╕╤П╨╝╨╕.',\r\n            readOnly: '╨б╨╡╨╝╨╡╨╣╨╜╨░╤П ╨╕╤Б╤В╨╛╤А╨╕╤П ╨░╤А╤Е╨╕╨▓╨╕╤А╨╛╨▓╨░╨╜╨░',\r\n            readOnlyDesc: '╨Я╤А╨╛╤И╨╗╤Л╨╡ ╨┤╨╡╨╣╤Б╤В╨▓╨╕╤П ╨╖╨░╨▒╨╗╨╛╨║╨╕╤А╨╛╨▓╨░╨╜╤Л.',\r\n            liveHub: '╨Ц╨╕╨▓╨╛╨╣ ╤Ж╨╡╨╜╤В╤А',\r\n            genealogy: '╨У╨╡╨╜╨╡╨░╨╗╨╛╨│╨╕╤П',\r\n            smartParenting: '╨Ъ╨╛╨╜╤Б╨╛╨╗╤М ╤А╨╛╨┤╨╕╤В╨╡╨╗╨╡╨╣',\r\n            requests: '╨Ч╨░╨┐╤А╨╛╤Б╤Л',\r\n            approve: '╨Я╤А╨╕╨╜╤П╤В╤М',\r\n            deny: '╨Ю╤В╨║╨╗╨╛╨╜╨╕╤В╤М',\r\n            approved: '╨Ю╨┤╨╛╨▒╤А╨╡╨╜╨╛',\r\n            reward: '╨Э╨░╨│╤А╨░╨┤╨░',\r\n            overallMood: '╨Ю╨▒╤Й╨╡╨╡ ╨╜╨░╤Б╤В╤А╨╛╨╡╨╜╨╕╨╡',\r\n            activeQuests: '╨Р╨║╤В╨╕╨▓╨╜╤Л╨╡ ╨║╨▓╨╡╤Б╤В╤Л',\r\n            familyXP: '╨б╨╡╨╝╨╡╨╣╨╜╤Л╨╣ XP',\r\n            gen1: '╨Я╨╛╨║╨╛╨╗╨╡╨╜╨╕╨╡ 1 (╨Ъ╨╛╤А╨╜╨╕)',\r\n            gen2: '╨Я╨╛╨║╨╛╨╗╨╡╨╜╨╕╨╡ 2 (╨е╤А╨░╨╜╨╕╤В╨╡╨╗╨╕)',\r\n            gen3: '╨Я╨╛╨║╨╛╨╗╨╡╨╜╨╕╨╡ 3 (╨С╤Г╨┤╤Г╤Й╨╡╨╡)',\r\n            backToHub: '╨Э╨░╨╖╨░╨┤ ╨▓ ╨б╨╡╨╝╨╡╨╣╨╜╤Л╨╣ ╤Ж╨╡╨╜╤В╤А',\r\n            geneticProfile: '╨У╨╡╨╜╨╡╤В╨╕╤З╨╡╤Б╨║╨╕╨╣ ╨┐╤А╨╛╤Д╨╕╨╗╤М',\r\n            safetyMonitor: '╨Ь╨╛╨╜╨╕╤В╨╛╤А ╨▒╨╡╨╖╨╛╨┐╨░╤Б╨╜╨╛╤Б╤В╨╕',\r\n            emergencyCall: '╨н╨Ъ╨б╨в╨а╨Х╨Э╨Э╨л╨Щ ╨Т╨л╨Ч╨Ю╨Т',\r\n            parentalControls: '╨а╨╛╨┤╨╕╤В╨╡╨╗╤М╤Б╨║╨╕╨╣ ╨║╨╛╨╜╤В╤А╨╛╨╗╤М',\r\n            activityLog: '╨Ш╤Б╤В╨╛╤А╨╕╤П ╨░╨║╤В╨╕╨▓╨╜╨╛╤Б╤В╨╕',\r\n            task: '╨Ч╨░╨┤╨░╤З╨░',\r\n            date: '╨Ф╨░╤В╨░',\r\n            xp: 'XP'\r\n        },\r\n        finance: {\r\n            title: '╨д╨╕╨╜╨░╨╜╤Б╤Л',\r\n            subtitle: '╨г╨┐╤А╨░╨▓╨╗╤П╨╣╤В╨╡ ╤Б╨▓╨╛╨╕╨╝ ╨▒╨╛╨│╨░╤В╤Б╤В╨▓╨╛╨╝.',\r\n            readOnly: '╨д╨╕╨╜╨░╨╜╤Б╨╛╨▓╤Л╨╡ ╨╖╨░╨┐╨╕╤Б╨╕ ╨░╤А╤Е╨╕╨▓╨╕╤А╨╛╨▓╨░╨╜╤Л',\r\n            readOnlyDesc: '╨Ч╨░╨┐╨╕╤Б╨╕ ╨╖╨░ ╨┐╤А╨╛╤И╨╗╤Л╨╡ ╨┤╨╜╨╕ ╨╜╨╡╨╗╤М╨╖╤П ╨╕╨╖╨╝╨╡╨╜╨╕╤В╤М.',\r\n            totalBalance: '╨Ю╨▒╤Й╨╕╨╣ ╨С╨░╨╗╨░╨╜╤Б',\r\n            monthlyBudget: '╨Ь╨╡╤Б╤П╤З╨╜╤Л╨╣ ╨С╤О╨┤╨╢╨╡╤В',\r\n            savingsGoal: '╨ж╨╡╨╗╤М ╤Б╨▒╨╡╤А╨╡╨╢╨╡╨╜╨╕╨╣',\r\n            recentTransactions: '╨Я╨╛╤Б╨╗╨╡╨┤╨╜╨╕╨╡ ╤В╤А╨░╨╜╨╖╨░╨║╤Ж╨╕╨╕',\r\n            addTransaction: '╨Ф╨╛╨▒╨░╨▓╨╕╤В╤М ╤В╤А╨░╨╜╨╖╨░╨║╤Ж╨╕╤О',\r\n            dailyAnalysis: '╨Х╨╢╨╡╨┤╨╜╨╡╨▓╨╜╤Л╨╣ ╨░╨╜╨░╨╗╨╕╨╖',\r\n            dailyAnalysisText: '╨Т╤Л╤Б╨╛╨║╨╕╨╡ ╤А╨░╤Б╤Е╨╛╨┤╤Л ╨╜╨░ \"╨Х╨┤╤Г\" ╤Б╨╡╨│╨╛╨┤╨╜╤П ╤Б╨╛╨▓╨┐╨░╨┤╨░╤О╤В ╤Б ╨▓╨░╤И╨╕╨╝ ╤Г╤А╨╛╨▓╨╜╨╡╨╝ ╤Б╤В╤А╨╡╤Б╤Б╨░. ╨а╨╡╨║╨╛╨╝╨╡╨╜╨┤╨░╤Ж╨╕╤П: ╨У╨╛╤В╨╛╨▓╤М╤В╨╡ ╨┤╨╛╨╝╨░ ╨╖╨░╨▓╤В╤А╨░.',\r\n            spendBreakdown: '╨а╨░╤Б╨┐╤А╨╡╨┤╨╡╨╗╨╡╨╜╨╕╨╡ ╤А╨░╤Б╤Е╨╛╨┤╨╛╨▓',\r\n            viewAll: '╨б╨╝╨╛╤В╤А╨╡╤В╤М ╨▓╤Б╨╡',\r\n            investment: '╨Ш╨╜╨▓╨╡╤Б╤В╨╕╤Ж╨╕╨╕',\r\n            credit: '╨Ъ╤А╨╡╨┤╨╕╤В',\r\n            debt: '╨Ф╨╛╨╗╨│',\r\n            confirmPaymentsInstruction: '╨Я╨╛╨╢╨░╨╗╤Г╨╣╤Б╤В╨░, ╨┐╨╛╨┤╤В╨▓╨╡╤А╨┤╨╕╤В╨╡ ╤Б╨╗╨╡╨┤╤Г╤О╤Й╨╕╨╡ ╨┐╨╗╨░╤В╨╡╨╢╨╕:',\r\n            centralBankRate: '╨Ъ╨г╨а╨б ╨ж╨Х╨Э╨в╨а╨Ю╨С╨Р╨Э╨Ъ╨Р',\r\n            realTimeCurrency: '╨Ъ╤Г╤А╤Б╤Л ╨▓╨░╨╗╤О╤В ╨▓ ╤А╨╡╨░╨╗╤М╨╜╨╛╨╝ ╨▓╤А╨╡╨╝╨╡╨╜╨╕',\r\n            liabilities: '╨Ю╨С╨п╨Ч╨Р╨в╨Х╨Ы╨м╨б╨в╨Т╨Р',\r\n            assets: '╨Р╨Ъ╨в╨Ш╨Т╨л',\r\n            initialAmount: '╨Э╨░╤З╨░╨╗╤М╨╜╨░╤П ╤Б╤Г╨╝╨╝╨░',\r\n            byCategory: '╨┐╨╛ ╨║╨░╤В╨╡╨│╨╛╤А╨╕╤П╨╝',\r\n            debtsPlusCredits: '╨Ф╨╛╨╗╨│╨╕ + ╨Ъ╤А╨╡╨┤╨╕╤В╤Л',\r\n            returnPlusDeposits: '╨Т╨╛╨╖╨▓╤А╨░╤В╤Л ╨┤╨╛╨╗╨│╨╛╨▓ + ╨Ф╨╡╨┐╨╛╨╖╨╕╤В╤Л',\r\n            addDebt: '+ ╨Ф╨╛╨▒╨░╨▓╨╕╤В╤М ╨┤╨╛╨╗╨│',\r\n            waitingForData: '╨Ю╨╢╨╕╨┤╨░╨╜╨╕╨╡ ╨┤╨░╨╜╨╜╤Л╤Е...',\r\n            vsLastMonth: '╨┐╨╛ ╤Б╤А. ╤Б ╨┐╤А╨╛╤И╨╗╤Л╨╝ ╨╝╨╡╤Б╤П╤Ж╨╡╨╝',\r\n            used: '╨Ш╤Б╨┐╨╛╨╗╤М╨╖╨╛╨▓╨░╨╜╨╛',\r\n            left: '╨Ю╤Б╤В╨░╨╗╨╛╤Б╤М',\r\n            archivedDays: '╨Р╤А╤Е╨╕╨▓╨╕╤А╨╛╨▓╨░╨╜╨╜╤Л╨╡ ╨┤╨╜╨╕',\r\n            dayClosed: '╨Ф╨╡╨╜╤М ╨╖╨░╨║╤А╤Л╤В',\r\n            spent: '╨Я╨╛╤В╤А╨░╤З╨╡╨╜╨╛',\r\n            days: '╨┤╨╜',\r\n            weeks: '╨╜╨╡╨┤',\r\n            months: '╨╝╨╡╤Б',\r\n            years: '╨╗╨╡╤В',\r\n            enterGoal: '╨Т╨▓╨╡╨┤╨╕╤В╨╡ ╨▓╨░╤И╤Г ╤Д╨╕╨╜╨░╨╜╤Б╨╛╨▓╤Г╤О ╤Ж╨╡╨╗╤М',\r\n            deadline: '╨б╤А╨╛╨║',\r\n            achieved: '╨Ф╨╛╤Б╤В╨╕╨│╨╜╤Г╤В╨╛',\r\n            noFunds: '╨Э╨╡╤В ╤Б╤А╨╡╨┤╤Б╤В╨▓',\r\n            limit: '╨Ы╨╕╨╝╨╕╤В',\r\n            target: '╨ж╨╡╨╗╤М',\r\n            current: '╨в╨╡╨║╤Г╤Й╨╕╨╣',\r\n            perMonth: '╨Т ╨╝╨╡╤Б╤П╤Ж',\r\n            incomeInsufficient: '╨Э╨╡╨┤╨╛╤Б╤В╨░╤В╨╛╤З╨╜╨╛ ╨┤╨╛╤Е╨╛╨┤╨░',\r\n            iOwe: '╨п ╨┤╨╛╨╗╨╢╨╡╨╜',\r\n            owedToMe: '╨Ь╨╜╨╡ ╨┤╨╛╨╗╨╢╨╜╤Л',\r\n            personName: '╨Ы╨╕╤Ж╨╛ (╨Ю╤В/╨Ъ╨╛╨╝╤Г)',\r\n            fullNamePlaceholder: '╨Ш╨╝╤П ╨д╨░╨╝╨╕╨╗╨╕╤П',\r\n            amount: '╨б╤Г╨╝╨╝╨░',\r\n            currency: '╨Т╨░╨╗╤О╤В╨░',\r\n            dateTaken: '╨Ф╨░╤В╨░ ╨▓╨╖╤П╤В╨╕╤П',\r\n            dateGiven: '╨Ф╨░╤В╨░ ╨▓╤Л╨┤╨░╤З╨╕',\r\n            returnDate: '╨б╤А╨╛╨║ ╨▓╨╛╨╖╨▓╤А╨░╤В╨░',\r\n            addCredit: '╨Ф╨╛╨▒╨░╨▓╨╕╤В╤М ╨║╤А╨╡╨┤╨╕╤В',\r\n            addDeposit: '╨Ф╨╛╨▒╨░╨▓╨╕╤В╤М ╨┤╨╡╨┐╨╛╨╖╨╕╤В',\r\n            creditName: '╨Э╨░╨╖╨▓╨░╨╜╨╕╨╡ ╨║╤А╨╡╨┤╨╕╤В╨░',\r\n            creditNamePlaceholder: '╨Э╨░╨┐╤А: ╨Ш╨┐╨╛╤В╨╡╨║╨░, iPhone',\r\n            depositName: '╨Э╨░╨╖╨▓╨░╨╜╨╕╨╡ ╨┤╨╡╨┐╨╛╨╖╨╕╤В╨░',\r\n            depositNamePlaceholder: '╨Э╨░╨┐╤А: ╨Я╨╛╨┤╤Г╤И╨║╨░ ╨▒╨╡╨╖╨╛╨┐╨░╤Б╨╜╨╛╤Б╤В╨╕, ╨Ь╨░╤И╨╕╨╜╨░',\r\n            totalAmount: '╨Ю╨▒╤Й╨░╤П ╤Б╤Г╨╝╨╝╨░',\r\n            currentAmount: '╨в╨╡╨║╤Г╤Й╨░╤П ╤Б╤Г╨╝╨╝╨░',\r\n            incomeHistoryEmpty: '╨Ш╤Б╤В╨╛╤А╨╕╤П ╨┤╨╛╤Е╨╛╨┤╨╛╨▓ ╨┐╤Г╤Б╤В╨░.',\r\n            incomeHistoryEmptyDesc: '╨Ф╨╛╨▒╨░╨▓╤М╤В╨╡ ╨┐╨╡╤А╨▓╤Г╤О ╤В╤А╨░╨╜╨╖╨░╨║╤Ж╨╕╤О ╨┤╨╛╤Е╨╛╨┤╨░, ╤З╤В╨╛╨▒╤Л ╨╜╨░╤З╨░╤В╤М ╨╛╤В╤Б╨╗╨╡╨╢╨╕╨▓╨░╤В╤М ╨┐╤А╨╛╨│╤А╨╡╤Б╤Б ╨▓ ╨┤╨╛╤Б╤В╨╕╨╢╨╡╨╜╨╕╨╕ ╨▓╨░╤И╨╕╤Е ╤Ж╨╡╨╗╨╡╨╣.',\r\n            expenseHistoryEmpty: '╨Ш╤Б╤В╨╛╤А╨╕╤П ╤А╨░╤Б╤Е╨╛╨┤╨╛╨▓ ╨┐╤Г╤Б╤В╨░.',\r\n            expenseHistoryEmptyDesc: '╨г╤Б╤В╨░╨╜╨╛╨▓╨╕╤В╨╡ ╨╝╨╡╤Б╤П╤З╨╜╤Л╨╣ ╨▒╤О╨┤╨╢╨╡╤В, ╤З╤В╨╛╨▒╤Л ╨║╨╛╨╜╤В╤А╨╛╨╗╨╕╤А╨╛╨▓╨░╤В╤М ╤А╨░╤Б╤Е╨╛╨┤╤Л ╨╕ ╨▓╨╕╨┤╨╡╤В╤М ╨╖╨┤╨╡╤Б╤М ╨░╨╜╨░╨╗╨╕╨╖ ╨▓ ╤А╨╡╨░╨╗╤М╨╜╨╛╨╝ ╨▓╤А╨╡╨╝╨╡╨╜╨╕.',\r\n            incomePlan: '╨Я╨╗╨░╨╜ ╨┤╨╛╤Е╨╛╨┤╨╛╨▓',\r\n            expenseControl: '╨Ъ╨╛╨╜╤В╤А╨╛╨╗╤М ╤А╨░╤Б╤Е╨╛╨┤╨╛╨▓',\r\n            voiceFeedback: {\r\n                listening: '╨б╨╗╤Г╤И╨░╤О...',\r\n                processing: '╨Ш╨Ш ╨╛╨▒╤А╨░╨▒╨░╤В╤Л╨▓╨░╨╡╤В ╨║╨╛╨╝╨░╨╜╨┤╤Г...',\r\n                done: 'тЬЕ ╨в╤А╨░╨╜╨╖╨░╨║╤Ж╨╕╤П ╨┤╨╛╨▒╨░╨▓╨╗╨╡╨╜╨░!'\r\n            },\r\n            dailyFlow: '╨Ф╨╜╨╡╨▓╨╜╨╛╨╣ ╨┐╨╛╤В╨╛╨║',\r\n            advancedStats: '╨а╨░╤Б╤И╨╕╤А╨╡╨╜╨╜╨░╤П ╤Б╤В╨░╤В╨╕╤Б╤В╨╕╨║╨░',\r\n            incomeBudget: '╨ж╨╡╨╗╤М ╨┤╨╛╤Е╨╛╨┤╨░',\r\n            expenseBudget: '╨Ы╨╕╨╝╨╕╤В ╤А╨░╤Б╤Е╨╛╨┤╨╛╨▓',\r\n            targetIncome: '╨ж╨╡╨╗╨╡╨▓╨╛╨╣ ╨┤╨╛╤Е╨╛╨┤',\r\n            limitExpense: '╨Ы╨╕╨╝╨╕╤В ╤А╨░╤Б╤Е╨╛╨┤╨╛╨▓',\r\n            ultimateGoalTitle: '╨У╨Ы╨Р╨Т╨Э╨Р╨п ╨д╨Ш╨Э╨Р╨Э╨б╨Ю╨Т╨Р╨п ╨ж╨Х╨Ы╨м',\r\n            currentStatus: '╨в╨Х╨Ъ╨г╨й╨Ш╨Щ ╨б╨в╨Р╨в╨г╨б',\r\n            timeLeft: '╨Ю╤Б╤В╨░╨╗╨╛╤Б╤М ╨▓╤А╨╡╨╝╨╡╨╜╨╕ (AI):',\r\n            remainingTime: '╨Ю╤Б╤В╨░╨╗╨╛╤Б╤М ╨▓╤А╨╡╨╝╨╡╨╜╨╕ (AI)',\r\n            deadlineExpired: '╨б╨а╨Ю╨Ъ ╨Ш╨б╨в╨Х╨Ъ',\r\n            paymentSuccess: '╨Я╨╗╨░╤В╨╡╨╢ ╨▓╤Л╨┐╨╛╨╗╨╜╨╡╨╜ ╤Г╤Б╨┐╨╡╤И╨╜╨╛!',\r\n            depositsEmpty: '╨Э╨╡╤В ╨┤╨╛╤Б╤В╤Г╨┐╨╜╤Л╤Е ╨▓╨║╨╗╨░╨┤╨╛╨▓',\r\n            creditsEmpty: '╨Э╨╡╤В ╨┤╨╛╤Б╤В╤Г╨┐╨╜╤Л╤Е ╨║╤А╨╡╨┤╨╕╤В╨╛╨▓',\r\n            debtsEmpty: '╨Э╨╡╤В ╨┤╨╛╤Б╤В╤Г╨┐╨╜╤Л╤Е ╨┤╨╛╨╗╨│╨╛╨▓',\r\n            confirm: '╨Я╨╛╨┤╤В╨▓╨╡╤А╨┤╨╕╤В╤М',\r\n            confirmPayment: '╨Я╨╛╨┤╤В╨▓╨╡╤А╨┤╨╕╤В╤М ╨┐╨╗╨░╤В╨╡╨╢',\r\n            todayPayments: '╨б╨╡╨│╨╛╨┤╨╜╤П╤И╨╜╨╕╨╡ ╨┐╨╗╨░╤В╨╡╨╢╨╕',\r\n            monthlyPayment: '╨Х╨╢╨╡╨╝╨╡╤Б╤П╤З╨╜╤Л╨╣ ╨┐╨╗╨░╤В╨╡╨╢',\r\n            paymentDay: '╨Ф╨╡╨╜╤М ╨┐╨╗╨░╤В╨╡╨╢╨░ (╨з╨╕╤Б╨╗╨╛)',\r\n            interestRate: '╨У╨╛╨┤╨╛╨▓╨░╤П ╤Б╤В╨░╨▓╨║╨░ (%)',\r\n            termMonths: '╨б╤А╨╛╨║ (╨Ь╨╡╤Б╤П╤Ж╨╡╨▓)',\r\n            calculationMethod: '╨Ь╨╡╤В╨╛╨┤ ╤А╨░╤Б╤З╨╡╤В╨░',\r\n            annuity: '╨Р╨╜╨╜╤Г╨╕╤В╨╡╤В (╨а╨░╨▓╨╜╤Л╨╡)',\r\n            differential: '╨Ф╨╕╤Д╤Д╨╡╤А╨╡╨╜╤Ж╨╕╤А╨╛╨▓╨░╨╜╨╜╤Л╨╣ (╨г╨▒╤Л╨▓╨░╤О╤Й╨╕╨╣)',\r\n            add: '╨Ф╨╛╨▒╨░╨▓╨╕╤В╤М',\r\n            yearlyProfit: '╨У╨╛╨┤╨╛╨▓╨░╤П ╨┤╨╛╤Е╨╛╨┤╨╜╨╛╤Б╤В╤М (%)',\r\n            depositDeadline: '╨б╤А╨╛╨║ ╨┤╨╡╨┐╨╛╨╖╨╕╤В╨░',\r\n            daysInMonth: '1-31',\r\n            monthlyProfitChoice: '╨Х╨╢╨╡╨╝╨╡╤Б╤П╤З╨╜╨╛╨╡ ╨┐╨╛╨╗╤Г╤З╨╡╨╜╨╕╨╡ ╨┐╤А╨╕╨▒╤Л╨╗╨╕',\r\n            expectedMonthlyProfit: '╨Ю╨╢╨╕╨┤╨░╨╡╨╝╨░╤П ╨╡╨╢╨╡╨╝╨╡╤Б╤П╤З╨╜╨░╤П ╨┐╤А╨╕╨▒╤Л╨╗╤М',\r\n            startDate: '╨Ф╨░╤В╨░ ╨╜╨░╤З╨░╨╗╨░',\r\n            fillAllFields: '╨Я╨╛╨╢╨░╨╗╤Г╨╣╤Б╤В╨░, ╨╖╨░╨┐╨╛╨╗╨╜╨╕╤В╨╡ ╨▓╤Б╨╡ ╨┐╨╛╨╗╤П',\r\n            depositOpened: '╨Ф╨╡╨┐╨╛╨╖╨╕╤В ╨╛╤В╨║╤А╤Л╤В',\r\n            investmentTransfer: '╨Ш╨╜╨▓╨╡╤Б╤В╨╕╤Ж╨╕╨╕ (╨Я╨╡╤А╨╡╨▓╨╛╨┤)',\r\n            noDeadline: '╨С╨╡╨╖ ╤Б╤А╨╛╨║╨░',\r\n            extendDeadline: \"╨Я╤А╨╛╨┤╨╗╨╕╤В╤М ╤Б╤А╨╛╨║\",\r\n            fromCurrentBalance: \"╨б ╤В╨╡╨║╤Г╤Й╨╡╨│╨╛ ╨▒╨░╨╗╨░╨╜╤Б╨░\",\r\n            noExpenseRecord: \"╨Э╨╡╤В ╨╖╨░╨┐╨╕╤Б╨╡╨╣ ╨╛ ╤А╨░╤Б╤Е╨╛╨┤╨░╤Е\",\r\n            markAsIncome: \"╨Ю╤В╨╝╨╡╤В╨╕╤В╤М ╨║╨░╨║ ╨┤╨╛╤Е╨╛╨┤\",\r\n            addFunds: \"╨Ф╨╛╨▒╨░╨▓╨╕╤В╤М ╤Б╤А╨╡╨┤╤Б╤В╨▓╨░\",\r\n            editGoalTitle: \"╨а╨╡╨┤╨░╨║╤В╨╕╤А╨╛╨▓╨░╤В╤М ╤Д╨╕╨╜╨░╨╜╤Б╨╛╨▓╤Г╤О ╤Ж╨╡╨╗╤М\",\r\n            editBudgetTitle: \"╨Я╨╗╨░╨╜ ╨╝╨╡╤Б╤П╤З╨╜╨╛╨│╨╛ ╨▒╤О╨┤╨╢╨╡╤В╨░\",\r\n            budgetSaved: \"╨С╤О╨┤╨╢╨╡╤В╤Л ╤Г╤Б╨┐╨╡╤И╨╜╨╛ ╨╛╨▒╨╜╨╛╨▓╨╗╨╡╨╜╤Л!\",\r\n            incomeGrowthMessage: \"╨Э╨░╨▒╨╗╤О╨┤╨░╨╡╤В╤Б╤П ╤А╨╛╤Б╤В! ╨Т╤Л ╨┐╤А╨╕╨▒╨╗╨╕╨╢╨░╨╡╤В╨╡╤Б╤М ╨║ ╤Ж╨╡╨╗╨╕ ╨┐╨╛ ╨┤╨╛╤Е╨╛╨┤╨░╨╝. ╨в╨░╨║ ╨┤╨╡╤А╨╢╨░╤В╤М! ЁЯЪА\",\r\n            expenseLimitMessage: \"╨Я╤А╨╡╨┤╤Г╨┐╤А╨╡╨╢╨┤╨╡╨╜╨╕╨╡ ╨╛ ╤А╨░╤Б╤Е╨╛╨┤╨░╤Е! ╨Т╤Л ╨┤╨╛╤Б╤В╨╕╨│╨╗╨╕ ╤Б╨▓╨╛╨╡╨│╨╛ ╨╝╨╡╤Б╤П╤З╨╜╨╛╨│╨╛ ╨╗╨╕╨╝╨╕╤В╨░! тЪая╕П\",\r\n            incomeAlmostTarget: \"╨Я╨╛╤З╤В╨╕ ╤Г ╤Ж╨╡╨╗╨╕! {val}% ╨╛╤В ╨┐╨╗╨░╨╜╨░ ╨┤╨╛╤Е╨╛╨┤╨╛╨▓ ╨┤╨╛╤Б╤В╨╕╨│╨╜╤Г╤В╨╛.\",\r\n            expenseAlmostLimit: \"╨Т╨╜╨╕╨╝╨░╨╜╨╕╨╡! ╨Т╤Л ╨┤╨╛╤Б╤В╨╕╨│╨╗╨╕ {val}% ╨╛╤В ╨╗╨╕╨╝╨╕╤В╨░ ╤А╨░╤Б╤Е╨╛╨┤╨╛╨▓.\",\r\n            setNewReturnDate: \"╨г╤Б╤В╨░╨╜╨╛╨▓╨╕╤В╤М ╨╜╨╛╨▓╤Г╤О ╨┤╨░╤В╤Г ╨▓╨╛╨╖╨▓╤А╨░╤В╨░\",\r\n            datePlaceholder: '╨У╨У╨У╨У-╨Ь╨Ь-╨Ф╨Ф ╨╕╨╗╨╕ ╨Ь╨╡╤Б╤П╤Ж ╨У╨╛╨┤',\r\n            creditPayment: '╨Я╨╗╨░╤В╨╡╨╢ ╨┐╨╛ ╨║╤А╨╡╨┤╨╕╤В╤Г',\r\n            depositProfit: '╨Я╤А╨╕╨▒╤Л╨╗╤М ╨╛╤В ╨┤╨╡╨┐╨╛╨╖╨╕╤В╨░',\r\n            probability: '╨Т╨╡╤А╨╛╤П╤В╨╜╨╛╤Б╤В╤М',\r\n            aiWealthRoadmap: 'AI ╨Ф╨Ю╨а╨Ю╨Ц╨Э╨Р╨п ╨Ъ╨Р╨а╨в╨Р ╨С╨Ю╨У╨Р╨в╨б╨в╨Т╨Р',\r\n            analysisForGoal: '╨Р╨╜╨░╨╗╨╕╨╖ ╨┤╨╗╤П ╨┤╨╛╤Б╤В╨╕╨╢╨╡╨╜╨╕╤П ╤Ж╨╡╨╗╨╕',\r\n            professionalPotentialDescription: (role: string) => `╨Т╨░╤И ╨╛╨┐╤Л╤В ╨║╨░╨║ ${role} ╤П╨▓╨╗╤П╨╡╤В╤Б╤П ╨│╨╗╨░╨▓╨╜╤Л╨╝ ╤Д╨░╨║╤В╨╛╤А╨╛╨╝ ╨┤╨╛╤Б╤В╨╕╨╢╨╡╨╜╨╕╤П ╤Д╨╕╨╜╨░╨╜╤Б╨╛╨▓╤Л╤Е ╤Ж╨╡╨╗╨╡╨╣.`,\r\n            professionalPotential: '╨Я╨а╨Ю╨д╨Х╨б╨б╨Ш╨Ю╨Э╨Р╨Ы╨м╨Э╨л╨Щ ╨Я╨Ю╨в╨Х╨Э╨ж╨Ш╨Р╨Ы',\r\n            professionalPotentialDesc: '╨Т╨░╤И ╨╛╨┐╤Л╤В - ╨│╨╗╨░╨▓╨╜╤Л╨╣ ╨┤╤А╨░╨╣╨▓╨╡╤А ╨┤╨╗╤П ╨┤╨╛╤Б╤В╨╕╨╢╨╡╨╜╨╕╤П ╤Д╨╕╨╜╨░╨╜╤Б╨╛╨▓╤Л╤Е ╤Ж╨╡╨╗╨╡╨╣.',\r\n            recommendations: '╨а╨Х╨Ъ╨Ю╨Ь╨Х╨Э╨Ф╨Р╨ж╨Ш╨Ш',\r\n            increaseInvestments: '╨г╨▓╨╡╨╗╨╕╤З╤М╤В╨╡ ╨╕╨╜╨▓╨╡╤Б╤В╨╕╤Ж╨╕╨╕ ╨╜╨░ 15%',\r\n            getCertification: '╨Я╨╛╨╗╤Г╤З╨╕╤В╨╡ ╨┐╤А╨╛╤Д╨╡╤Б╤Б╨╕╨╛╨╜╨░╨╗╤М╨╜╤Л╨╣ ╤Б╨╡╤А╤В╨╕╤Д╨╕╨║╨░╤В',\r\n            additionalIncomeChannel: '╨Ф╨╛╨┐╨╛╨╗╨╜╨╕╤В╨╡╨╗╤М╨╜╤Л╨╣ ╨║╨░╨╜╨░╨╗ ╨┤╨╛╤Е╨╛╨┤╨░',\r\n            viewFullAnalysis: '╨Я╨Ю╨б╨Ь╨Ю╨в╨а╨Х╨в╨м ╨Я╨Ю╨Ы╨Э╨л╨Щ ╨Р╨Э╨Р╨Ы╨Ш╨Ч',\r\n            qrScanner: \"QR ╨б╨║╨░╨╜╨╡╤А\",\r\n            qrScannerTitle: \"QR ╨б╨║╨░╨╜╨╡╤А ╨з╨╡╨║╨╛╨▓\",\r\n            qrScannerDesc: \"╨Э╨░╨┐╤А╨░╨▓╤М╤В╨╡ ╨║╨░╨╝╨╡╤А╤Г ╨╜╨░ QR-╨║╨╛╨┤ ╨╕╨╗╨╕ ╨╖╨░╨│╤А╤Г╨╖╨╕╤В╨╡ ╨╕╨╖╨╛╨▒╤А╨░╨╢╨╡╨╜╨╕╨╡ ╤З╨╡╨║╨░.\",\r\n            qrScannerAction: \"╨б╨║╨░╨╜╨╕╤А╨╛╨▓╨░╤В╤М ╨б╨╡╨╣╤З╨░╤Б\",\r\n            analyzing: \"╨Р╨╜╨░╨╗╨╕╨╖╨╕╤А╤Г╨╡╨╝...\",\r\n            portfolio: \"╨д╨╕╨╜╨░╨╜╤Б╨╛╨▓╤Л╨╣ ╨Я╨╛╤А╤В╤Д╨╡╨╗╤М\",\r\n            recentActivity: '╨Э╨╡╨┤╨░╨▓╨╜╤П╤П ╨░╨║╤В╨╕╨▓╨╜╨╛╤Б╤В╤М',\r\n            noTransactions: '╨Я╨╛╨║╨░ ╨╜╨╡╤В ╤В╤А╨░╨╜╨╖╨░╨║╤Ж╨╕╨╣',\r\n            aiRoadmapTitle: 'AI ╨Ф╨Ю╨а╨Ю╨Ц╨Э╨Р╨п ╨Ъ╨Р╨а╨в╨Р ╨С╨Ю╨У╨Р╨в╨б╨в╨Т╨Р',\r\n            filesAnalysis: '╨Р╨╜╨░╨╗╨╕╨╖ ╨┤╨╗╤П ╨┤╨╛╤Б╤В╨╕╨╢╨╡╨╜╨╕╤П ╤Ж╨╡╨╗╨╕',\r\n            detailedList: '╨Я╨Ю╨Ф╨а╨Ю╨С╨Э╨л╨Щ ╨б╨Я╨Ш╨б╨Ю╨Ъ',\r\n            monthlyAnalysisTitle: '╨Х╨Ц╨Х╨Ь╨Х╨б╨п╨з╨Э╨л╨Щ ╨Р╨Э╨Р╨Ы╨Ш╨Ч (╨а╨Х╨Ч╨о╨Ь╨Х)',\r\n            monthlyIncomeTitle: '╨Х╨Ц╨Х╨Ь╨Х╨б╨п╨з╨Э╨л╨Щ ╨Ф╨Ю╨е╨Ю╨Ф',\r\n            weeklyExpenseStats: '╨Х╨Ц╨Х╨Э╨Х╨Ф╨Х╨Ы╨м╨Э╨Р╨п ╨б╨в╨Р╨в╨Ш╨б╨в╨Ш╨Ъ╨Р ╨а╨Р╨б╨е╨Ю╨Ф╨Ю╨Т',\r\n            iOweLabel: '╨п ╨Ф╨Ю╨Ы╨Ц╨Х╨Э',\r\n            owedToMeLabel: '╨Ь╨Э╨Х ╨Ф╨Ю╨Ы╨Ц╨Э╨л',\r\n            repaid: '╨Т╨Ю╨Ч╨Т╨а╨Р╨й╨Х╨Э╨Ю',\r\n            repay: '╨Т╨╡╤А╨╜╤Г╤В╤М',\r\n            extend: '╨Я╤А╨╛╨┤╨╗╨╕╤В╤М',\r\n            dayLabel: '╨Ф╨Р╨в╨Р',\r\n            remaining: '╨Ю╤Б╤В╨░╤В╨╛╨║',\r\n            payNow: '╨Ю╨Я╨Ы╨Р╨в╨Ш╨в╨м ╨б╨Х╨Щ╨з╨Р╨б',\r\n            prepay: '╨Т╨╜╨╡╤Б╤В╨╕ ╨┤╨╛╤Б╤А╨╛╤З╨╜╨╛',\r\n            collecting: '╨Э╨░╨║╨░╨┐╨╗╨╕╨▓╨░╨╡╤В╤Б╤П',\r\n            totalCollected: '╨Т╤Б╨╡╨│╨╛ ╨╜╨░╨║╨╛╨┐╨╗╨╡╨╜╨╛',\r\n            monthlyPlan: '╨Ь╨╡╤Б╤П╤З╨╜╤Л╨╣ ╨┐╨╗╨░╨╜',\r\n            topUp: '╨Я╨╛╨┐╨╛╨╗╨╜╨╕╤В╤М',\r\n            noData: '╨Ф╨░╨╜╨╜╤Л╤Е ╨┐╨╛╨║╨░ ╨╜╨╡╤В',\r\n            aiPredictionTitle: 'AI ╨Х╨Ц╨Х╨Ь╨Х╨б╨п╨з╨Э╨л╨Щ ╨Я╨а╨Ю╨У╨Э╨Ю╨Ч',\r\n            predictionPart1: '╨Ю╨╢╨╕╨┤╨░╨╡╤В╤Б╤П, ╤З╤В╨╛ ╨▓╤Л ╨╖╨░╨║╨╛╨╜╤З╨╕╤В╨╡ ╤Н╤В╨╛╤В ╨╝╨╡╤Б╤П╤Ж ╤Б',\r\n            predictionPart2: '╨┐╤А╨╕╨▒╤Л╨╗╤М╤О',\r\n            predictionTrend: (percent: number) => `╨Т╨░╤И╨╕ ╤А╨░╤Б╤Е╨╛╨┤╤Л ╤Б╨╜╨╕╨╖╨╕╨╗╨╕╤Б╤М ╨╜╨░ ${percent}% ╨┐╨╛ ╤Б╤А╨░╨▓╨╜╨╡╨╜╨╕╤О ╤Б ╨┐╤А╨╛╤И╨╗╨╛╨╣ ╨╜╨╡╨┤╨╡╨╗╨╡╨╣.`,\r\n            predictionGoalAdvice: (goal: string, months: number) => `╨Х╤Б╨╗╨╕ ╨▓╤Л ╨┐╤А╨╛╨┤╨╛╨╗╨╢╨╕╤В╨╡ ╨▓ ╤В╨╛╨╝ ╨╢╨╡ ╨┤╤Г╤Е╨╡, ╨▓╤Л ╨┤╨╛╤Б╤В╨╕╨│╨╜╨╡╤В╨╡ ╤Ж╨╡╨╗╨╕ ${goal} ╨╜╨░ ${months} ╨╝╨╡╤Б╤П╤Ж╨░ ╤А╨░╨╜╤М╤И╨╡ ╤Б╤А╨╛╨║╨░.`,\r\n            predictionDisclaimerText: '╨Э╨░ ╨╛╤Б╨╜╨╛╨▓╨╡ ╨▓╨░╤И╨╕╤Е ╤В╨╡╨║╤Г╤Й╨╕╤Е ╨┐╤А╨╕╨▓╤Л╤З╨╡╨║ ╤А╨░╤Б╤Е╨╛╨┤╨╛╨▓ ╨╕ ╤А╨╡╨│╤Г╨╗╤П╤А╨╜╨╛╨│╨╛ ╨┤╨╛╤Е╨╛╨┤╨░.',\r\n            weeklyLabel: '╨Х╨╢╨╡╨╜╨╡╨┤╨╡╨╗╤М╨╜╨╛',\r\n            monthlyLabel: '╨Х╨╢╨╡╨╝╨╡╤Б╤П╤З╨╜╨╛',\r\n            customLabel: '╨Я╨╡╤А╨╕╨╛╨┤',\r\n            analysisSummary: '╨б╨▓╨╛╨┤╨║╨░ ╨░╨╜╨░╨╗╨╕╨╖╨░ ╤Б╨╕╤Б╤В╨╡╨╝╤Л',\r\n            exportExcel: '╨б╨║╨░╤З╨░╤В╤М ╨▓ Excel',\r\n            incomeTitle: '╨Ф╨╛╤Е╨╛╨┤',\r\n            expenseTitle: '╨а╨░╤Б╤Е╨╛╨┤',\r\n            principalAmount: \"╨Ю╤Б╨╜╨╛╨▓╨╜╨╛╨╣ ╨┤╨╛╨╗╨│\",\r\n            interestAmount: \"╨Я╤А╨╛╤Ж╨╡╨╜╤В╤Л (Foiz)\",\r\n            repaymentSplit: \"╨а╨░╨╖╨┤╨╡╨╗╨╡╨╜╨╕╨╡ ╨┐╨╗╨░╤В╨╡╨╢╨░\",\r\n            realMoney: \"╨а╨╡╨░╨╗╤М╨╜╤Л╨╡ ╨┤╨╡╨╜╤М╨│╨╕ (╨з╨╕╤Б╤В╤Л╨╡)\",\r\n            transTitle: \"╨Э╨░╨╖╨▓╨░╨╜╨╕╨╡\",\r\n            transType: \"╨в╨╕╨┐\",\r\n            transCategory: \"╨Ъ╨░╤В╨╡╨│╨╛╤А╨╕╤П\",\r\n            depositActionTitle: \"╨г╨┐╤А╨░╨▓╨╗╨╡╨╜╨╕╨╡ ╨Ф╨╡╨┐╨╛╨╖╨╕╤В╨╛╨╝\",\r\n            actionAdd: \"╨Я╨╛╨┐╨╛╨╗╨╜╨╕╤В╤М\",\r\n            actionWithdraw: \"╨б╨╜╤П╤В╤М\",\r\n            actionProfit: \"╨Я╤А╨╕╨▒╤Л╨╗╤М\",\r\n            sourceBalance: \"╨б ╨▒╨░╨╗╨░╨╜╤Б╨░ (-)\",\r\n            sourceOutside: \"╨Э╨╛╨▓╤Л╨╣ ╨┤╨╛╤Е╨╛╨┤ (+)\",\r\n            financialStatus: \"╨д╨╕╨╜╨░╨╜╤Б╨╛╨▓╤Л╨╣ ╤Б╤В╨░╤В╤Г╤Б\",\r\n            statusStart: \"тЪк ╨Э╨░╤З╨░╨╗╨╛\",\r\n            statusPositive: \"тЬЕ ╨Я╨╛╨╖╨╕╤В╨╕╨▓╨╜╤Л╨╣\",\r\n            statusDanger: \"тЪая╕П ╨Ъ╤А╨╕╤В╨╕╤З╨╡╤Б╨║╨╕╨╣\",\r\n            statusDescStart: \"╨Э╨╡╨┤╨╛╤Б╤В╨░╤В╨╛╤З╨╜╨╛ ╨┤╨░╨╜╨╜╤Л╤Е ╨┤╨╗╤П ╨░╨╜╨░╨╗╨╕╨╖╨░. ╨Ф╨╛╨▒╨░╨▓╤М╤В╨╡ ╨┐╨╡╤А╨▓╤Л╨╣ ╨┤╨╛╤Е╨╛╨┤ ╨╕╨╗╨╕ ╤А╨░╤Б╤Е╨╛╨┤.\",\r\n            statusDescPositive: (percent: string) => `╨Т╤Л ╤Б╨╛╤Е╤А╨░╨╜╤П╨╡╤В╨╡ ${percent}% ╨╛╤В ╤Б╨▓╨╛╨╡╨│╨╛ ╨┤╨╛╤Е╨╛╨┤╨░. ╨Ю╤В╨╗╨╕╤З╨╜╤Л╨╣ ╤А╨╡╨╖╤Г╨╗╤М╤В╨░╤В!`,\r\n            statusDescDanger: \"╨Т╨╜╨╕╨╝╨░╨╜╨╕╨╡! ╨Т╨░╤И╨╕ ╤А╨░╤Б╤Е╨╛╨┤╤Л ╨┐╤А╨╡╨▓╤Л╤И╨░╤О╤В ╨┤╨╛╤Е╨╛╨┤╤Л. ╨Э╨╡╨╝╨╡╨┤╨╗╨╡╨╜╨╜╨╛ ╤Б╨╛╨║╤А╨░╤В╨╕╤В╨╡ ╨╝╨╕╨╜╨╕╨╝╤Г╨╝ 2 ╨╗╨╕╤И╨╜╨╕╤Е ╤А╨░╤Б╤Е╨╛╨┤╨░.\",\r\n            recStart: \"╨Ф╨╛╨▒╨░╨▓╤М╤В╨╡ ╨┐╨╡╤А╨▓╤Г╤О ╤В╤А╨░╨╜╨╖╨░╨║╤Ж╨╕╤О (╨Ф╨╛╤Е╨╛╨┤ ╨╕╨╗╨╕ ╨а╨░╤Б╤Е╨╛╨┤)\",\r\n            recSafety: \"╨б╨╛╨╖╨┤╨░╨╣╤В╨╡ ╨┐╨╛╨┤╤Г╤И╨║╤Г ╨▒╨╡╨╖╨╛╨┐╨░╤Б╨╜╨╛╤Б╤В╨╕ ╤А╨░╨▓╨╜╤Г╤О 3 ╨╝╨╡╤Б╤П╤Ж╨░╨╝ ╤А╨░╤Б╤Е╨╛╨┤╨╛╨▓\",\r\n            recDeposit: \"╨Ю╤В╨║╤А╨╛╨╣╤В╨╡ ╤Б╨▒╨╡╤А╨╡╨│╨░╤В╨╡╨╗╤М╨╜╤Л╨╣ ╤Б╤З╨╡╤В ╨╕ ╨╜╨░╤З╨╜╨╕╤В╨╡ ╨║╨╛╨┐╨╕╤В╤М\",\r\n            recDebt: \"╨Я╨╛╨│╨░╤Б╨╕╤В╨╡ ╨┤╨╛╨╗╨│╨╕ ╨▒╤Л╤Б╤В╤А╨╡╨╡ ╨╝╨╡╤В╨╛╨┤╨╛╨╝ '╨б╨╜╨╡╨╢╨╜╤Л╨╣ ╨║╨╛╨╝'\",\r\n            recBudget: \"╨г╤Б╤В╨░╨╜╨╛╨▓╨╕╤В╨╡ ╨┐╨╗╨░╨╜ ╨┤╨╛╤Е╨╛╨┤╨╛╨▓ (╨С╤О╨┤╨╢╨╡╤В)\",\r\n            statusOk: \"╨Я╨╛╨║╨░ ╨▓╤Б╨╡ ╤Е╨╛╤А╨╛╤И╨╛!\",\r\n            predictionMsgExcellent: \"╨Ю╤В╨╗╨╕╤З╨╜╤Л╨╣ ╤А╨╡╨╖╤Г╨╗╤М╤В╨░╤В! ╨Т╤Л ╤Б╨╛╤Е╤А╨░╨╜╤П╨╡╤В╨╡ ╨▒╨╛╨╗╤М╤И╤Г╤О ╤З╨░╤Б╤В╤М ╨┤╨╛╤Е╨╛╨┤╨░. ╨Я╨╛╨┤╤Г╨╝╨░╨╣╤В╨╡ ╨╛╨▒ ╨╕╨╜╨▓╨╡╤Б╤В╨╕╤Ж╨╕╤П╤Е.\",\r\n            predictionMsgGood: \"╨е╨╛╤А╨╛╤И╨╕╨╣ ╨┐╨╛╨║╨░╨╖╨░╤В╨╡╨╗╤М. ╨Т╨░╤И ╨┐╨╗╨░╨╜ ╨╜╨░╨║╨╛╨┐╨╗╨╡╨╜╨╕╨╣ ╤Б╤В╨░╨▒╨╕╨╗╨╡╨╜. ╨в╨░╨║ ╨┤╨╡╤А╨╢╨░╤В╤М.\",\r\n            predictionMsgOk: \"╨Т╤Л ╨▓ ╨┐╨╗╤О╤Б╨╡, ╨╜╨╛ ╨╜╨╡╨▒╨╛╨╗╤М╤И╨░╤П ╨╛╨┐╤В╨╕╨╝╨╕╨╖╨░╤Ж╨╕╤П ╤А╨░╤Б╤Е╨╛╨┤╨╛╨▓ ╨▒╤Л╨╗╨░ ╨▒╤Л ╨┐╨╛╨╗╨╡╨╖╨╜╨░.\",\r\n            predictionMsgBad: \"╨Т╨╜╨╕╨╝╨░╨╜╨╕╨╡! ╨Т╨░╤И╨╕ ╤А╨░╤Б╤Е╨╛╨┤╤Л ╨┐╤А╨╡╨▓╤Л╤И╨░╤О╤В ╨┤╨╛╤Е╨╛╨┤╤Л. ╨Я╨╡╤А╨╡╤Б╨╝╨╛╤В╤А╨╕╤В╨╡ ╨▒╤О╨┤╨╢╨╡╤В.\",\r\n            fromLabel: \"╨Ю╤В\",\r\n            toLabel: \"╨Ф╨╛\"\r\n        },\r\n        categories: {\r\n            Salary: \"╨Ч╨░╤А╨┐╨╗╨░╤В╨░\",\r\n            Freelance: \"╨д╤А╨╕╨╗╨░╨╜╤Б\",\r\n            Investment: \"╨Ш╨╜╨▓╨╡╤Б╤В╨╕╤Ж╨╕╨╕\",\r\n            Gift: \"╨Я╨╛╨┤╨░╤А╨╛╨║\",\r\n            OtherIncome: \"╨Ф╤А╤Г╨│╨╛╨╣ ╨┤╨╛╤Е╨╛╨┤\",\r\n            Food: \"╨Х╨┤╨░\",\r\n            Transport: \"╨в╤А╨░╨╜╤Б╨┐╨╛╤А╤В\",\r\n            Shopping: \"╨Я╨╛╨║╤Г╨┐╨║╨╕\",\r\n            Bills: \"╨б╤З╨╡╤В╨░\",\r\n            Health: \"╨Ч╨┤╨╛╤А╨╛╨▓╤М╨╡\",\r\n            Education: \"╨Ю╨▒╤А╨░╨╖╨╛╨▓╨░╨╜╨╕╨╡\",\r\n            Leisure: \"╨Ф╨╛╤Б╤Г╨│\",\r\n            Other: \"╨Ф╤А╤Г╨│╨╛╨╡\",\r\n            creditIn: \"╨Ъ╤А╨╡╨┤╨╕╤В (╨Ф╨╛╤Е╨╛╨┤)\",\r\n            depositIn: \"╨Ф╨╡╨┐╨╛╨╖╨╕╤В (╨Ф╨╛╤Е╨╛╨┤)\",\r\n            savings: \"╨б╨▒╨╡╤А╨╡╨╢╨╡╨╜╨╕╤П/╨Я╨╡╤А╨╡╨▓╨╛╨┤\",\r\n            general: \"╨Ю╨▒╤Й╨╡╨╡\",\r\n            music: \"╨Ь╤Г╨╖╤Л╨║╨░\",\r\n            mind: \"╨Ю╤Б╨╛╨╖╨╜╨░╨╜╨╜╨╛╤Б╤В╤М\"\r\n        },\r\n        tasks: {\r\n            title: '╨д╨╛╨║╤Г╤Б ╨╕ ╨Ч╨░╨┤╨░╤З╨╕',\r\n            subtitle: '╨Я╨╗╨░╨╜╨╕╤А╤Г╨╣╤В╨╡ ╤Б╨▓╨╛╨╣ ╨┤╨╡╨╜╤М.',\r\n            newTask: '╨Э╨╛╨▓╨░╤П ╨╖╨░╨┤╨░╤З╨░',\r\n            taskName: '╨Э╨░╨╖╨▓╨░╨╜╨╕╨╡ ╨╖╨░╨┤╨░╤З╨╕',\r\n            startTime: '╨Т╤А╨╡╨╝╤П ╨╜╨░╤З╨░╨╗╨░',\r\n            endTime: '╨Т╤А╨╡╨╝╤П ╨╛╨║╨╛╨╜╤З╨░╨╜╨╕╤П',\r\n            priority: '╨Я╤А╨╕╨╛╤А╨╕╤В╨╡╤В',\r\n            low: '╨Э╨╕╨╖╨║╨╕╨╣',\r\n            medium: '╨б╤А╨╡╨┤╨╜╨╕╨╣',\r\n            high: '╨Т╤Л╤Б╨╛╨║╨╕╨╣',\r\n            createTask: '╨б╨╛╨╖╨┤╨░╤В╤М ╨╖╨░╨┤╨░╤З╤Г',\r\n            calendar: '╨Ъ╨░╨╗╨╡╨╜╨┤╨░╤А╤М',\r\n            upcomingTasks: '╨С╤Г╨┤╤Г╤Й╨╕╨╡ ╨┐╨╗╨░╨╜╤Л',\r\n            overdue: '╨Я╤А╨╛╤Б╤А╨╛╤З╨╡╨╜╨╛',\r\n            future: '╨С╤Г╨┤╤Г╤Й╨╡╨╡',\r\n            stats: {\r\n                completedToday: '╨Т╤Л╨┐╨╛╨╗╨╜╨╡╨╜╨╛ ╤Б╨╡╨│╨╛╨┤╨╜╤П',\r\n                pending: '╨Ю╨╢╨╕╨┤╨░╨╡╤В',\r\n                efficiency: '╨н╤Д╤Д╨╡╨║╤В╨╕╨▓╨╜╨╛╤Б╤В╤М'\r\n            },\r\n            sections: {\r\n                today: '╨б╨╡╨│╨╛╨┤╨╜╤П',\r\n                upcoming: '╨Я╤А╨╡╨┤╤Б╤В╨╛╤П╤Й╨╕╨╡',\r\n                completed: '╨Т╤Л╨┐╨╛╨╗╨╜╨╡╨╜╨╛',\r\n                overdue: '╨Я╤А╨╛╤Б╤А╨╛╤З╨╡╨╜╨╛',\r\n                future: '╨С╤Г╨┤╤Г╤Й╨╡╨╡'\r\n            },\r\n            aiSuggestion: {\r\n                title: '╨Я╤А╨╡╨┤╨╗╨╛╨╢╨╡╨╜╨╕╨╡ ╨Ш╨Ш',\r\n                suggestion: '╨Ч╨░╨┤╨░╤З╨░ \"╨Я╤А╨╛╨▓╨╡╤А╨╕╤В╤М ╨╝╨╡╤Б╤П╤З╨╜╤Л╨╣ ╨▒╤О╨┤╨╢╨╡╤В\" ╨┐╤А╨╛╤Б╤А╨╛╤З╨╡╨╜╨░.',\r\n                add: '╨Ф╨╛╨▒╨░╨▓╨╕╤В╤М +'\r\n            },\r\n            actions: {\r\n                startFocus: '╨Э╨░╤З╨░╤В╤М ╤Д╨╛╨║╤Г╤Б',\r\n                moveToToday: '╨Я╨╡╤А╨╡╨╜╨╡╤Б╤В╨╕ ╨╜╨░ ╤Б╨╡╨│╨╛╨┤╨╜╤П',\r\n                subtask: '╨Я╨╛╨┤╨╖╨░╨┤╨░╤З╨░',\r\n                move: '╨Я╨╡╤А╨╡╨╝╨╡╤Б╤В╨╕╤В╤М',\r\n                focus: '╨д╨╛╨║╤Г╤Б',\r\n                edit: '╨Ш╨╖╨╝╨╡╨╜╨╕╤В╤М',\r\n                delete: '╨г╨┤╨░╨╗╨╕╤В╤М',\r\n                promote: '╨б╨┤╨╡╨╗╨░╤В╤М ╨╛╤Б╨╜╨╛╨▓╨╜╨╛╨╣'\r\n            },\r\n            completedArchive: '╨Р╤А╤Е╨╕╨▓ ╨▓╤Л╨┐╨╛╨╗╨╜╨╡╨╜╨╜╤Л╤Е ╨╖╨░╨┤╨░╤З',\r\n            readOnly: '╨Ч╨░╨┤╨░╤З╨╕ ╨░╤А╤Е╨╕╨▓╨╕╤А╨╛╨▓╨░╨╜╤Л',\r\n            readOnlyDesc: '╨Я╤А╨╛╤И╨╗╤Л╨╡ ╨╖╨░╨┤╨░╤З╨╕ ╨┤╨╛╤Б╤В╤Г╨┐╨╜╤Л ╤В╨╛╨╗╤М╨║╨╛ ╨┤╨╗╤П ╤З╤В╨╡╨╜╨╕╤П.',\r\n            noTasks: '╨Э╨░ ╤Б╨╡╨│╨╛╨┤╨╜╤П ╨╖╨░╨┤╨░╤З ╨╜╨╡╤В. ╨е╨╛╤А╨╛╤И╨╡╨│╨╛ ╨┤╨╜╤П!'\r\n        },\r\n        health: {\r\n            history: '╨Ш╤Б╤В╨╛╤А╨╕╤П',\r\n            readOnly: '╨Ф╨░╨╜╨╜╤Л╨╡ ╨╖╨┤╨╛╤А╨╛╨▓╤М╤П ╨╖╨░╨▒╨╗╨╛╨║╨╕╤А╨╛╨▓╨░╨╜╤Л',\r\n            readOnlyDesc: '╨Ш╤Б╤В╨╛╤А╨╕╤З╨╡╤Б╨║╨╕╨╡ ╨▒╨╕╨╛╨╝╨╡╤В╤А╨╕╤З╨╡╤Б╨║╨╕╨╡ ╨┤╨░╨╜╨╜╤Л╨╡ ╨╜╨╡╨╗╤М╨╖╤П ╨╕╨╖╨╝╨╡╨╜╨╕╤В╤М.',\r\n            title: '╨Ч╨┤╨╛╤А╨╛╨▓╤М╨╡ ╨╕ ╨Ц╨╕╨╖╨╜╨╡╨╜╨╜╨╛╤Б╤В╤М',\r\n            subtitle: '╨Т╨░╤И╨╡ ╤В╨╡╨╗╨╛ - ╤Н╤В╨╛ ╨┤╨▓╨╕╨│╨░╤В╨╡╨╗╤М.',\r\n            bodyBattery: {\r\n                title: '╨Ч╨░╤А╤П╨┤ ╨в╨╡╨╗╨░',\r\n                fullyCharged: '╨Т╤Л ╨┐╨╛╨╗╨╜╨╛╤Б╤В╤М╤О ╨╖╨░╤А╤П╨╢╨╡╨╜╤Л! ╨Ю╤В╨╗╨╕╤З╨╜╨╛╨╡ ╨▓╤А╨╡╨╝╤П ╨┤╨╗╤П ╨╕╨╜╤В╨╡╨╜╤Б╨╕╨▓╨╜╤Л╤Е ╨╖╨░╨┤╨░╤З ╨╕╨╗╨╕ ╤В╤А╨╡╨╜╨╕╤А╨╛╨▓╨║╨╕.',\r\n                recharge: '╨Я╨╛╨┤╤Г╨╝╨░╨╣╤В╨╡ ╨╛ ╨┐╨╡╤А╨╡╤А╤Л╨▓╨╡, ╤З╤В╨╛╨▒╤Л ╨▓╨╛╤Б╤Б╤В╨░╨╜╨╛╨▓╨╕╤В╤М ╤Б╨╕╨╗╤Л.',\r\n                sleepRestoration: '╨Т╨╛╤Б╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜╨╕╨╡ ╤Б╨╜╨╛╨╝',\r\n                activeDrain: '╨Р╨║╤В╨╕╨▓╨╜╤Л╨╣ ╤А╨░╤Б╤Е╨╛╨┤',\r\n                stressTax: '╨б╤В╤А╨╡╤Б╤Б╨╛╨▓╨░╤П ╨╜╨░╨│╤А╤Г╨╖╨║╨░',\r\n                hydrationEfficiency: '╨н╤Д╤Д╨╡╨║╤В╨╕╨▓╨╜╨╛╤Б╤В╤М ╨│╨╕╨┤╤А╨░╤В╨░╤Ж╨╕╨╕'\r\n            },\r\n            vitals: {\r\n                title: '╨б╨╡╤А╨┤╨╡╤З╨╜╤Л╨╣ ╤А╨╕╤В╨╝',\r\n                stressTitle: '╨г╤А╨╛╨▓╨╡╨╜╤М ╤Б╤В╤А╨╡╤Б╤Б╨░',\r\n                resting: '╨Т ╨┐╨╛╨║╨╛╨╡',\r\n                heartRateUnit: '╤Г╨┤/╨╝╨╕╨╜',\r\n                normalRange: '╨Т ╨╜╨╛╤А╨╝╨╡',\r\n                avgLevel: '╨б╤А. ╤Г╤А╨╛╨▓╨╡╨╜╤М',\r\n                low: '╨Э╨╕╨╖╨║╨╕╨╣',\r\n                relaxedState: '╨а╨░╤Б╤Б╨╗╨░╨▒╨╗╨╡╨╜╨╜╨╛╨╡ ╤Б╨╛╤Б╤В╨╛╤П╨╜╨╕╨╡'\r\n            },\r\n            sleep: {\r\n                score: '/ 100',\r\n                quality: '╨Т╨╛╤Б╤Б╤В╨░╨╜╨░╨▓╨╗╨╕╨▓╨░╤О╤Й╨╕╨╣ ╤Б╨╛╨╜',\r\n                unit: '╨С╨░╨╗╨╗'\r\n            },\r\n            hydration: {\r\n                title: '╨У╨╕╨┤╤А╨░╤В╨░╤Ж╨╕╤П',\r\n                goal: '╨ж╨╡╨╗╤М',\r\n                unit: '╨╝╨╗'\r\n            },\r\n            activity: {\r\n                title: '╨Р╨║╤В╨╕╨▓╨╜╨╛╤Б╤В╤М',\r\n                stepsToday: '╤И╨░╨│╨╛╨▓ ╤Б╨╡╨│╨╛╨┤╨╜╤П',\r\n                kcal: '╨║╨║╨░╨╗',\r\n                dist: '╨┤╨╕╤Б╤В'\r\n            },\r\n            trends: {\r\n                title: '╨в╤А╨╡╨╜╨┤╤Л ╨╖╨┤╨╛╤А╨╛╨▓╤М╤П (╨Я╨╛╤Б╨╗╨╡╨┤╨╜╨╕╨╡ 7 ╨┤╨╜╨╡╨╣)',\r\n                stepsHistory: '╨Ш╤Б╤В╨╛╤А╨╕╤П ╤И╨░╨│╨╛╨▓',\r\n                sleepQuality: '╨Ъ╨░╤З╨╡╤Б╤В╨▓╨╛ ╤Б╨╜╨░'\r\n            },\r\n            days: {\r\n                mon: '╨Я╨╜',\r\n                tue: '╨Т╤В',\r\n                wed: '╨б╤А',\r\n                thu: '╨з╤В',\r\n                fri: '╨Я╤В',\r\n                sat: '╨б╤Г╨▒',\r\n                sun: '╨Т╤Б╨║'\r\n            },\r\n            biometrics: {\r\n                title: '╨С╨╕╨╛╨╝╨╡╤В╤А╨╕╤З╨╡╤Б╨║╨╕╨╡ ╨┤╨░╨╜╨╜╤Л╨╡',\r\n                weight: '╨Т╨╡╤Б',\r\n                height: '╨а╨╛╤Б╤В',\r\n                goal: '╨ж╨╡╨╗╤М',\r\n                lose: '╨Я╨╛╤Е╤Г╨┤╨╡╨╜╨╕╨╡',\r\n                gain: '╨Э╨░╨▒╨╛╤А ╨▓╨╡╤Б╨░',\r\n                maintain: '╨Я╨╛╨┤╨┤╨╡╤А╨╢╨░╨╜╨╕╨╡ ╨▓╨╡╤Б╨░',\r\n                unitCm: '╤Б╨╝',\r\n                unitKg: '╨║╨│',\r\n                aiRecTitle: '╨а╨╡╨║╨╛╨╝╨╡╨╜╨┤╨░╤Ж╨╕╤П ╨Ш╨Ш',\r\n                aiRecLose: '╨Я╤А╨╡╨┤╨╗╨░╨│╨░╨╡╤В╤Б╤П ╤Г╤Б╨║╨╛╤А╨╡╨╜╨╕╨╡ ╨╝╨╡╤В╨░╨▒╨╛╨╗╨╕╨╖╨╝╨░. ╨Ш╨Ш ╤Б╨║╨╛╤А╤А╨╡╨║╤В╨╕╤А╤Г╨╡╤В ╤Ж╨╡╨╗╨╕ ╨┐╨╛ ╨║╨░╨╗╨╛╤А╨╕╤П╨╝.',\r\n                aiRecMaintain: '╨б╤В╨░╨▒╨╕╨╗╤М╨╜╤Л╨╣ ╨┐╤А╨╛╨│╤А╨╡╤Б╤Б. ╨б╨╛╤Е╤А╨░╨╜╤П╨╣╤В╨╡ ╤А╨╕╤В╨╝.'\r\n            },\r\n            aiAdvisor: {\r\n                title: '╨Ш╨Ш ╨Ъ╨╛╨╜╤Б╤Г╨╗╤М╤В╨░╨╜╤В ╨┐╨╛ ╨╖╨┤╨╛╤А╨╛╨▓╤М╤О',\r\n                analyzing: '╨Ш╨Ш ╨░╨╜╨░╨╗╨╕╨╖╨╕╤А╤Г╨╡╤В ╨┐╨╛╨║╨░╨╖╨░╤В╨╡╨╗╨╕...',\r\n                hydrationLow: '╨г╤А╨╛╨▓╨╡╨╜╤М ╨▓╨╛╨┤╤Л ╨╜╨╕╨╖╨║╨╕╨╣. ╨Т╤Л╨┐╨╡╨╣╤В╨╡ 2 ╤Б╤В╨░╨║╨░╨╜╨░ ╨▓╨╛╨┤╤Л ╨┤╨╗╤П ╨┐╨╛╨▓╤Л╤И╨╡╨╜╨╕╤П ╤Н╤Д╤Д╨╡╨║╤В╨╕╨▓╨╜╨╛╤Б╤В╨╕.',\r\n                stressHigh: '╨г╤А╨╛╨▓╨╡╨╜╤М ╤Б╤В╤А╨╡╤Б╤Б╨░ ╨▓╤Л╤Б╨╛╨║╨╕╨╣. ╨а╨╡╨║╨╛╨╝╨╡╨╜╨┤╤Г╨╡╨╝ 10-╨╝╨╕╨╜╤Г╤В╨╜╤Г╤О ╤Б╨╡╤Б╤Б╨╕╤О ╨┤╤Л╤Е╨░╤В╨╡╨╗╤М╨╜╨╛╨╣ ╨╝╨╡╨┤╨╕╤В╨░╤Ж╨╕╨╕.',\r\n                sleepLow: '╨Э╨╕╨╖╨║╨╛╨╡ ╨▓╨╛╤Б╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜╨╕╨╡. ╨б╨╡╨│╨╛╨┤╨╜╤П ╨╛╤В╨┤╨░╨╣╤В╨╡ ╨┐╤А╨╕╨╛╤А╨╕╤В╨╡╤В ╨╛╤В╨┤╤Л╤Е╤Г ╨╕ ╨╕╨╖╨▒╨╡╨│╨░╨╣╤В╨╡ ╤В╤П╨╢╨╡╨╗╤Л╤Е ╨╜╨░╨│╤А╤Г╨╖╨╛╨║.',\r\n                allGood: '╨Т╤Б╨╡ ╤Б╨╕╤Б╤В╨╡╨╝╤Л ╨▓ ╨╜╨╛╤А╨╝╨╡. ╨Т╨░╤И╨╡ ╨▓╨╛╤Б╤Б╤В╨░╨╜╨╛╨▓╨╗╨╡╨╜╨╕╨╡ ╨╕╨┤╨╡╨░╨╗╤М╨╜╨╛ ╤Б╨╛╨╛╤В╨▓╨╡╤В╤Б╤В╨▓╤Г╨╡╤В ╤Г╤А╨╛╨▓╨╜╤О ╨░╨║╤В╨╕╨▓╨╜╨╛╤Б╤В╨╕!'\r\n            },\r\n            loading: \"╨Ч╨░╨│╤А╤Г╨╖╨║╨░ ╨┤╨░╨╜╨╜╤Л╤Е ╨╖╨┤╨╛╤А╨╛╨▓╤М╤П...\",\r\n            simulate: \"╨б╨╕╨╝╤Г╨╗╤П╤Ж╨╕╤П 21:00\",\r\n            batteryStatus: {\r\n                ready: \"╨У╨╛╤В╨╛╨▓ ╨║ ╨┤╨╡╨╣╤Б╤В╨▓╨╕╤О\",\r\n                good: \"╨з╤Г╨▓╤Б╤В╨▓╤Г╤О ╤Б╨╡╨▒╤П ╤Е╨╛╤А╨╛╤И╨╛\",\r\n                tired: \"╨Э╨╡╨╝╨╜╨╛╨│╨╛ ╤Г╤Б╤В╨░╨╗\",\r\n                rest: \"╨Т╤А╨╡╨╝╤П ╨╛╤В╨┤╨╛╤Е╨╜╤Г╤В╤М\"\r\n            },\r\n            voiceAlertSteps: \"╤И╨░╨│╨╛╨▓ ╨╖╨░╨┐╨╕╤Б╨░╨╜╨╛!\",\r\n            voiceAlertSleep: \"╤З╨░╤Б╨╛╨▓ ╤Б╨╜╨░ ╨╖╨░╨┐╨╕╤Б╨░╨╜╨╛!\",\r\n            voiceAlertWater: \"╨╝╨╗ ╨▓╨╛╨┤╤Л ╨┤╨╛╨▒╨░╨▓╨╗╨╡╨╜╨╛!\"\r\n        },\r\n        food: {\r\n            title: \"╨Х╨┤╨░ ╨Ш╨Ш\",\r\n            subtitle: \"╨Я╨╕╤В╨░╨╣╤В╨╡ ╤Б╨▓╨╛╨╡ ╤В╨╡╨╗╨╛ ╤А╨░╨╖╤Г╨╝╨╜╨╛.\",\r\n            readOnly: '╨Ф╨╜╨╡╨▓╨╜╨╛╨╣ ╨╢╤Г╤А╨╜╨░╨╗ ╨░╤А╤Е╨╕╨▓╨╕╤А╨╛╨▓╨░╨╜',\r\n            readOnlyDesc: '╨Я╤А╨╛╤И╨╗╤Л╨╡ ╨┐╤А╨╕╨╡╨╝╤Л ╨┐╨╕╤Й╨╕ ╨╜╨╡╨╗╤М╨╖╤П ╨╕╨╖╨╝╨╡╨╜╨╕╤В╤М.',\r\n            calories: \"╨Ъ╨░╨╗╨╛╤А╨╕╨╕\",\r\n            macros: \"╨Ь╨░╨║╤А╨╛╤Б╤Л\",\r\n            protein: \"╨С╨╡╨╗╨║╨╕\",\r\n            carbs: \"╨г╨│╨╗╨╡╨▓╨╛╨┤╤Л\",\r\n            fats: \"╨Ц╨╕╤А╤Л\",\r\n            mealLogs: \"╨Ш╤Б╤В╨╛╤А╨╕╤П ╨Х╨┤╤Л\",\r\n            scanMeal: \"╨б╨║╨░╨╜╨╕╤А╨╛╨▓╨░╤В╤М\",\r\n            dailyLog: \"╨Х╨╢╨╡╨┤╨╜╨╡╨▓╨╜╤Л╨╣ ╨╢╤Г╤А╨╜╨░╨╗\",\r\n            historyModalTitle: \"╨Ш╤Б╤В╨╛╤А╨╕╤П ╨┐╨╕╤В╨░╨╜╨╕╤П (╨┐╨╛╤Б╨╗╨╡╨┤╨╜╨╕╨╡ 7 ╨┤╨╜╨╡╨╣)\",\r\n            cameraPrompt: \"╨Э╨░╨▓╨╡╨┤╨╕╤В╨╡ ╨║╨░╨╝╨╡╤А╤Г ╨╜╨░ ╨╡╨┤╤Г\",\r\n            analyzing: \"╨Ш╨Ш ╨░╨╜╨░╨╗╨╕╨╖╨╕╤А╤Г╨╡╤В...\",\r\n            instantAdviceTitle: \"╨Ь╨│╨╜╨╛╨▓╨╡╨╜╨╜╤Л╨╣ ╤Б╨╛╨▓╨╡╤В\",\r\n            targetAdvice: \"╨Ю╤В╨╗╨╕╤З╨╜╨╛╨╡ ╨┐╨╛╤В╤А╨╡╨▒╨╗╨╡╨╜╨╕╨╡ ╨▒╨╡╨╗╨║╨░ ╤Б╨╡╨│╨╛╨┤╨╜╤П! ╨Я╨╛╨┐╤А╨╛╨▒╤Г╨╣╤В╨╡ ╨┤╨╛╨▒╨░╨▓╨╕╤В╤М ╨▒╨╛╨╗╤М╤И╨╡ ╨║╨╗╨╡╤В╤З╨░╤В╨║╨╕ (╨╛╨▓╨╛╤Й╨╡╨╣) ╨║ ╤Г╨╢╨╕╨╜╤Г.\",\r\n            scanError: \"╨Э╨╡ ╤Г╨┤╨░╨╗╨╛╤Б╤М ╨╛╨┐╤А╨╡╨┤╨╡╨╗╨╕╤В╤М ╨╡╨┤╤Г. ╨Я╨╛╨╢╨░╨╗╤Г╨╣╤Б╤В╨░, ╨┐╨╛╨┐╤А╨╛╨▒╤Г╨╣╤В╨╡ ╨╡╤Й╨╡ ╤А╨░╨╖.\",\r\n            aiDetected: \"╨Ш╨Ш ╨╛╨┐╤А╨╡╨┤╨╡╨╗╨╕╨╗\",\r\n            eatQuestion: \"╨Т╤Л ╤Н╤В╨╛ ╤Б╤К╨╡╨╗╨╕?\",\r\n            yes: \"╨Ф╨░\",\r\n            no: \"╨Э╨╡╤В\",\r\n            streak: \"╨Ф╨Э╨Х╨Щ ╨Я╨Ю╨Ф╨а╨п╨Ф\",\r\n            loading: \"╨Ч╨░╨│╤А╤Г╨╖╨║╨░...\",\r\n            alertArchived: \"╨Т╤Л ╨╜╨╡ ╨╝╨╛╨╢╨╡╤В╨╡ ╨┤╨╛╨▒╨░╨▓╨╗╤П╤В╤М/╤Г╨┤╨░╨╗╤П╤В╤М ╨╖╨░╨┐╨╕╤Б╨╕ ╨╖╨░ ╨░╤А╤Е╨╕╨▓╨╜╤Л╨╡ ╨┤╨╜╨╕.\",\r\n            mealQuick: \"╨С╤Л╤Б╤В╤А╨░╤П ╨╖╨░╨┐╨╕╤Б╤М\",\r\n            mealSnack: \"╨Я╨╡╤А╨╡╨║╤Г╤Б\",\r\n            mealBreakfast: \"╨Ч╨░╨▓╤В╤А╨░╨║\",\r\n            mealLunch: \"╨Ю╨▒╨╡╨┤\",\r\n            mealDinner: \"╨г╨╢╨╕╨╜\",\r\n            kcal: \"╨║╨║╨░╨╗\",\r\n            unitG: \"╨│\"\r\n        },\r\n        mind: {\r\n            title: \"╨г╨╝╤Б╤В╨▓╨╡╨╜╨╜╨╛╨╡ ╤Б╨▓╤П╤В╨╕╨╗╨╕╤Й╨╡\",\r\n            subtitle: \"╨п╤Б╨╜╨╛╤Б╤В╤М ╤Г╨╝╨░ ╨╕ ╤Д╨╛╨║╤Г╤Б.\",\r\n            readOnly: '╨Ъ╨╛╨╜╤В╨╡╨║╤Б╤В ╤А╨░╨╖╤Г╨╝╨░ ╨╖╨░╨▒╨╗╨╛╨║╨╕╤А╨╛╨▓╨░╨╜',\r\n            readOnlyDesc: '╨Я╤А╨╛╤И╨╗╤Л╨╡ ╨╝╨╡╨╜╤В╨░╨╗╤М╨╜╤Л╨╡ ╤Б╨╛╤Б╤В╨╛╤П╨╜╨╕╤П ╨░╤А╤Е╨╕╨▓╨╕╤А╨╛╨▓╨░╨╜╤Л.',\r\n            weeklyFocus: \"╨Э╨╡╨┤╨╡╨╗╤М╨╜╤Л╨╣ ╤Д╨╛╨║╤Г╤Б\",\r\n            focusingOn: \"╨д╨╛╨║╤Г╤Б ╨╜╨░:\",\r\n            focus: \"╨д╨╛╨║╤Г╤Б\",\r\n            break: \"╨Я╨╡╤А╨╡╤А╤Л╨▓\",\r\n            moodSphere: \"╨б╤Д╨╡╤А╨░ ╨╜╨░╤Б╤В╤А╨╛╨╡╨╜╨╕╤П\",\r\n            moodSphereDesc: \"╨Я╨╛╤В╤П╨╜╨╕╤В╨╡ ╨┤╨╗╤П ╨╜╨░╤Б╤В╤А╨╛╨╣╨║╨╕ (<30 = ╨Ф╨╖╨╡╨╜)\",\r\n            resonanceBreathing: \"╨а╨╡╨╖╨╛╨╜╨░╨╜╤Б╨╜╨╛╨╡ ╨┤╤Л╤Е╨░╨╜╨╕╨╡\",\r\n            startSession: \"╨Э╨░╤З╨░╤В╤М ╤Б╨╡╨░╨╜╤Б\",\r\n            stopSession: \"╨Ю╤Б╤В╨░╨╜╨╛╨▓╨╕╤В╤М\",\r\n            inhale: \"╨Т╨┤╨╛╤Е\",\r\n            exhale: \"╨Т╤Л╨┤╨╛╤Е\",\r\n            hold: \"╨Ч╨░╨┤╨╡╤А╨╢╨║╨░\",\r\n            ready: \"╨У╨╛╤В╨╛╨▓╨╛\",\r\n            aiSummaryTitle: \"╨Х╨╢╨╡╨┤╨╜╨╡╨▓╨╜╨░╤П ╤Б╨▓╨╛╨┤╨║╨░ ╨Ш╨Ш\",\r\n            aiSummaryText: \"╨Т╨░╤И╨╡ ╨╜╨░╤Б╤В╤А╨╛╨╡╨╜╨╕╨╡ ╤Б╨╡╨│╨╛╨┤╨╜╤П ╤Б╤В╨░╨▒╨╕╨╗╤М╨╜╨╛. ╨н╤Д╤Д╨╡╨║╤В╨╕╨▓╨╜╨╛╤Б╤В╤М ╤Д╨╛╨║╤Г╤Б╨░ ╨▓╤Л╤А╨╛╤Б╨╗╨░ ╨╜╨░ 15% ╨┐╨╛ ╤Б╤А╨░╨▓╨╜╨╡╨╜╨╕╤О ╤Б╨╛ ╨▓╤З╨╡╤А╨░╤И╨╜╨╕╨╝ ╨┤╨╜╨╡╨╝.\",\r\n            historyModalTitle: \"╨Ц╤Г╤А╨╜╨░╨╗ ╨╜╨░╤Б╤В╤А╨╛╨╡╨╜╨╕╤П (╨Ш╤Б╤В╨╛╤А╨╕╤П)\",\r\n            recentSessions: \"╨Э╨╡╨┤╨░╨▓╨╜╨╕╨╡ ╤Б╨╡╨░╨╜╤Б╤Л ╤Д╨╛╨║╤Г╤Б╨░\",\r\n            moodTrends: \"╨в╤А╨╡╨╜╨┤╤Л ╨╜╨░╤Б╤В╤А╨╛╨╡╨╜╨╕╤П\",\r\n            zenTitle: \"╨Ф╤Л╤И╨╕╤В╨╡\",\r\n            zenSubtitle: \"╨Р╨╜╨░╨╗╨╕╤В╨╕╨║╨░ ╨╕ ╨│╤А╨░╤Д╨╕╨║╨╕ ╤Б╨║╤А╤Л╤В╤Л. ╨б╨╛╤Б╤А╨╡╨┤╨╛╤В╨╛╤З╤М╤В╨╡╤Б╤М ╨╜╨░ ╨╜╨░╤Б╤В╨╛╤П╤Й╨╡╨╝.\",\r\n            whyFeeling: \"╨Я╨╛╤З╨╡╨╝╤Г ╨▓╤Л ╤В╨░╨║ ╤Б╨╡╨▒╤П ╤З╤Г╨▓╤Б╤В╨▓╤Г╨╡╤В╨╡?\",\r\n            exitZen: \"╨Ь╨╜╨╡ ╤Г╨╢╨╡ ╨╗╤Г╤З╤И╨╡ (╨Т╤Л╨╣╤В╨╕ ╨╕╨╖ ╨Ф╨╖╨╡╨╜)\",\r\n            reasons: {\r\n                tired: \"╨г╤Б╤В╨░╨╗╨╛╤Б╤В╤М\",\r\n                anxious: \"╨в╤А╨╡╨▓╨╛╨│╨░\",\r\n                overwhelmed: \"╨Я╨╡╤А╨╡╨│╤А╤Г╨╖\",\r\n                justBecause: \"╨Я╤А╨╛╤Б╤В╨╛ ╤В╨░╨║\"\r\n            },\r\n            loadingState: \"╨Ч╨░╨│╤А╤Г╨╖╨║╨░...\",\r\n            saved: \"╨б╨╛╤Е╤А╨░╨╜╨╡╨╜╨╛\",\r\n            saveMood: \"╨б╨╛╤Е╤А╨░╨╜╨╕╤В╤М ╨╜╨░╤Б╤В╤А╨╛╨╡╨╜╨╕╨╡\",\r\n            zenMapLeft: \"╨Э╨╡╨│╨░╤В╨╕╨▓ (╨Ф╨╖╨╡╨╜)\",\r\n            zenMapRight: \"╨Я╨╛╨╖╨╕╤В╨╕╨▓\",\r\n            aiLoading: \"╨Ш╨Ш ╨░╨╜╨░╨╗╨╕╨╖╨╕╤А╤Г╨╡╤В...\",\r\n            aiPoweredBy: \"AURA ╨б╤В╤А╨░╤В╨╡╨│╨╕╤З╨╡╤Б╨║╨╕╨╣ ╨а╨░╨╖╤Г╨╝\"\r\n        },\r\n        focus: {\r\n            minutes: '╨Ь╨╕╨╜╤Г╤В',\r\n            done: '╨Т╤Л╨┐╨╛╨╗╨╜╨╡╨╜╨╛'\r\n        },\r\n        interests: {\r\n            title: \"╨Ш╨╜╤В╨╡╤А╨╡╤Б╤Л ╨╕ ╨а╨╛╤Б╤В\",\r\n            subtitle: \"╨а╨░╤Б╤И╨╕╤А╤П╨╣╤В╨╡ ╤Б╨▓╨╛╨╕ ╨│╨╛╤А╨╕╨╖╨╛╨╜╤В╤Л.\",\r\n            readOnly: '╨Я╤А╨╛╨│╤А╨╡╤Б╤Б ╨╖╨░╨▒╨╗╨╛╨║╨╕╤А╨╛╨▓╨░╨╜',\r\n            readOnlyDesc: '╨Я╤А╨╛╤И╨╗╤Л╨╡ ╨╖╨░╨┐╨╕╤Б╨╕ ╨╜╨╡╨╗╤М╨╖╤П ╨╕╨╖╨╝╨╡╨╜╨╕╤В╤М.',\r\n            historyModalTitle: \"╨Ц╤Г╤А╨╜╨░╨╗ ╨┐╤А╨░╨║╤В╨╕╨║╨╕ ╤Е╨╛╨▒╨▒╨╕\",\r\n            practiceLog: \"╨Ц╤Г╤А╨╜╨░╨╗ ╨┐╤А╨░╨║╤В╨╕╨║╨╕\",\r\n            streak: \"╨Ф╨╜╨╡╨╣ ╨┐╨╛╨┤╤А╤П╨┤\",\r\n            newHobby: \"+ ╨Э╨╛╨▓╨╛╨╡ ╤Е╨╛╨▒╨▒╨╕\",\r\n            aiRecommendation: \"╨а╨╡╨║╨╛╨╝╨╡╨╜╨┤╨░╤Ж╨╕╤П ╨Ш╨Ш: ╨У╨╛╨╜╤З╨░╤А╤Б╤В╨▓╨╛\",\r\n            aiReason: \"╨г╤З╨╕╤В╤Л╨▓╨░╤П ╨▓╨░╤И ╨╕╨╜╤В╨╡╤А╨╡╤Б ╨║ ┬л╨Ф╨╕╨╖╨░╨╣╨╜╤Г┬╗, ╨▓╨░╨╝ ╨╝╨╛╨╢╨╡╤В ╨┐╨╛╨╜╤А╨░╨▓╨╕╤В╤М╤Б╤П ╤В╨░╨║╤В╨╕╨╗╤М╨╜╨╛╨╡ ╤В╨▓╨╛╤А╤З╨╡╤Б╤В╨▓╨╛.\",\r\n            tryThis: \"╨Я╨╛╨┐╤А╨╛╨▒╨╛╨▓╨░╤В╤М\",\r\n            hoursSpent: \"╤З╨░╤Б╨╛╨▓ ╨┐╨╛╤В╤А╨░╤З╨╡╨╜╨╛\",\r\n            nextLevel: \"╨Ф╨░╨╗╨╡╨╡: ╨г╤А╨╛╨▓╨╡╨╜╤М\",\r\n            discoverNew: \"╨Ю╤В╨║╤А╤Л╤В╤М ╨╜╨╛╨▓╤Г╤О ╤Б╤В╤А╨░╤Б╤В╤М\",\r\n            level: \"╨г╤А.\",\r\n            addHobbyTitle: \"╨Ф╨╛╨▒╨░╨▓╨╕╤В╤М ╨╜╨╛╨▓╨╛╨╡ ╤Е╨╛╨▒╨▒╨╕\",\r\n            hobbyName: \"╨Э╨░╨╖╨▓╨░╨╜╨╕╨╡\",\r\n            category: \"╨Ъ╨░╤В╨╡╨│╨╛╤А╨╕╤П\",\r\n            loading: \"╨Ч╨░╨│╤А╤Г╨╖╨║╨░ ╤Г╨▓╨╗╨╡╤З╨╡╨╜╨╕╨╣...\",\r\n            categories: {\r\n                general: \"╨Ю╨▒╤Й╨╡╨╡\",\r\n                art: \"╨Ш╤Б╨║╤Г╤Б╤Б╤В╨▓╨╛\",\r\n                physical: \"╨д╨╕╨╖╨╕╤З╨╡╤Б╨║╨╛╨╡\",\r\n                mind: \"╨г╨╝╤Б╤В╨▓╨╡╨╜╨╜╨╛╨╡\",\r\n                music: \"╨Ь╤Г╨╖╤Л╨║╨░\"\r\n            },\r\n            placeholderName: \"╨╜╨░╨┐╤А. ╨и╨░╤Е╨╝╨░╤В╤Л, ╨Я╨╕╨░╨╜╨╕╨╜╨╛...\",\r\n            positive: \"╨Я╨╛╨╖╨╕╤В╨╕╨▓╨╜╨╛╨╡\",\r\n            negative: \"╨Э╨╡╨│╨░╤В╨╕╨▓╨╜╨╛╨╡\",\r\n            type: \"╨в╨╕╨┐\",\r\n            trackingMode: \"╨а╨╡╨╢╨╕╨╝ ╨╛╤В╤Б╨╗╨╡╨╢╨╕╨▓╨░╨╜╨╕╤П\",\r\n            trackingFrequency: \"╨з╨░╤Б╤В╨╛╤В╨░ (+1)\",\r\n            trackingFrequencyDesc: \"╨б╤З╨╕╤В╨░╨╡╤В ╨║╨░╨╢╨┤╨╛╨╡ ╤Б╨╛╨▒╤Л╤В╨╕╨╡ (╨╜╨░╨┐╤А. ╤Б╨╕╨│╨░╤А╨╡╤В╤Л).\",\r\n            trackingBinary: \"╨Ю╨┤╨╕╨╜ ╤А╨░╨╖ (╨Ф╨░/╨Э╨╡╤В)\",\r\n            trackingBinaryDesc: \"╨Ч╨░╨┐╨╕╤Б╤Л╨▓╨░╨╡╤В╤Б╤П ╨╛╨┤╨╕╨╜ ╤А╨░╨╖ ╨▓ ╨┤╨╡╨╜╤М (╨╜╨░╨┐╤А. ╨▓╤Б╤В╨░╨╗ ╨┐╨╛╨╖╨┤╨╜╨╛).\",\r\n            newHobbyCardTitle: \"╨Э╨╛╨▓╨╛╨╡ ╨е╨╛╨▒╨▒╨╕\",\r\n            newHobbyCardDesc: \"╨Ф╨╗╤П ╤А╨░╨╖╨▓╨╕╤В╨╕╤П\",\r\n            positiveInterests: \"╨Я╨╛╨╖╨╕╤В╨╕╨▓╨╜╤Л╨╡ ╨╕╨╜╤В╨╡╤А╨╡╤Б╤Л\",\r\n            negativeHabits: \"╨Ъ╨╛╨╜╤В╤А╨╛╨╗╨╕╤А╤Г╨╡╨╝╤Л╨╡ ╨┐╤А╨╕╨▓╤Л╤З╨║╨╕\",\r\n            dailyActivities: \"╨Р╨║╤В╨╕╨▓╨╜╨╛╤Б╤В╤М ╨╖╨░ ╤Б╨╡╨│╨╛╨┤╨╜╤П\",\r\n            aiRecStatus: \"╨б╤В╨░╤В╤Г╤Б ╨Ш╨Ш ╤А╨╡╨║╨╛╨╝╨╡╨╜╨┤╨░╤Ж╨╕╨╣\",\r\n            statCount: \"╨б╨з╨Х╨в\",\r\n            statDuration: \"╨Ф╨Ы╨Ш╨в╨Х╨Ы╨м╨Э╨Ю╨б╨в╨м\",\r\n            loyaltyXP: \"╨Ю╨Я╨л╨в ╨Ы╨Ю╨п╨Ы╨м╨Э╨Ю╨б╨в╨Ш\",\r\n            done: \"╨У╨╛╤В╨╛╨▓╨╛\",\r\n            logCount: \"╨Ч╨Р╨Я╨Ш╨б╨м (+1)\",\r\n            log: \"╨Ч╨Р╨Я╨Ш╨б╨м\",\r\n            status: \"╨б╤В╨░╤В╤Г╤Б\",\r\n            times: \"╤А╨░╨╖\",\r\n            totalHours: \"╤З ╨Т╨б╨Х╨У╨Ю\",\r\n            totalControl: \"╤З ╨Ъ╨Ю╨Э╨в╨а╨Ю╨Ы╨м\",\r\n            logDurationQuestion: \"╨б╨║╨╛╨╗╤М╨║╨╛ ╨╝╨╕╨╜╤Г╤В ╨▓╤Л ╨╖╨░╨╜╨╕╨╝╨░╨╗╨╕╤Б╤М?\",\r\n            aiRecTitleCorrection: \"AURA ╨Ъ╨╛╤А╤А╨╡╨║╤Ж╨╕╤П\",\r\n            aiRecTitleGrowth: \"AURA ╨а╨╛╤Б╤В\",\r\n            aiRecDone: \"╨Т╤Л╨┐╨╛╨╗╨╜╨╡╨╜╨╛\",\r\n            aiRecTask: \"╨Ч╨░╨┤╨░╤З╨░\",\r\n            aiRecAddTask: \"╨Ч╨░╨┤╨░╤З╨░\",\r\n            noActivities: \"╨б╨╡╨│╨╛╨┤╨╜╤П ╨░╨║╤В╨╕╨▓╨╜╨╛╤Б╤В╨╕ ╨╜╨╡ ╨╖╨░╨┐╨╕╤Б╨░╨╜╨╛.\",\r\n            selectHobby: \"╨Т╤Л╨▒╨╡╤А╨╕╤В╨╡ ╤Е╨╛╨▒╨▒╨╕ ╨▓╤Л╤И╨╡, ╤З╤В╨╛╨▒╤Л ╨╖╨░╨┐╨╕╤Б╨░╤В╤М ╨░╨║╤В╨╕╨▓╨╜╨╛╤Б╤В╤М.\",\r\n            notDone: \"╨Э╨╡ ╨▓╤Л╨┐╨╛╨╗╨╜╨╡╨╜╨╛\",\r\n            todayLabel: \"╨б╨╡╨│╨╛╨┤╨╜╤П\",\r\n            dailyStats: \"╨Х╨Ц╨Х╨Ф╨Э╨Х╨Т╨Э╨Р╨п ╨б╨в╨Р╨в╨Ш╨б╨в╨Ш╨Ъ╨Р\"\r\n        },\r\n        liveness_section: {\r\n            title: \"╨Я╨г╨Ы╨м╨б ╨Ц╨Ш╨Ч╨Э╨Ш\",\r\n            subtitle: \"╨ж╨╕╤Д╤А╨╛╨▓╨╛╨╣ ╨╝╨╛╤Б╤В ╨╖╨░╨▒╨╛╤В╤Л ╨╛ ╨▒╨╗╨╕╨╖╨║╨╕╤Е.\",\r\n            desc: \"╨Я╨░╤Б╤Б╨╕╨▓╨╜╤Л╨╣ ╨╝╨╛╨╜╨╕╤В╨╛╤А╨╕╨╜╨│ ╨▓╨░╤И╨╕╤Е ╨▒╨╗╨╕╨╖╨║╨╕╤Е. ╨Х╤Б╨╗╨╕ ╨░╨║╤В╨╕╨▓╨╜╨╛╤Б╤В╤М ╨╜╨╡ ╨╛╨▒╨╜╨░╤А╤Г╨╢╨╡╨╜╨░ ╨▓ ╨╖╨░╨┤╨░╨╜╨╜╨╛╨╡ ╨╛╨║╨╜╨╛, ╤Б╨╡╨╝╤М╤П ╨┐╨╛╨╗╤Г╤З╨╕╤В ╤Г╨▓╨╡╨┤╨╛╨╝╨╗╨╡╨╜╨╕╨╡. ╨Ш╨┤╨╡╨░╨╗╤М╨╜╨╛ ╨┤╨╗╤П ╨▒╨╡╨╖╨╛╨┐╨░╤Б╨╜╨╛╤Б╤В╨╕ ╨┐╨╛╨╢╨╕╨╗╤Л╤Е ╨╗╤О╨┤╨╡╨╣.\",\r\n            cta: \"╨Э╨░╤Б╤В╤А╨╛╨╕╤В╤М ╨Я╤Г╨╗╤М╤Б\",\r\n            silent_mode: '╨в╨╕╤Е╨╕╨╣ ╤А╨╡╨╢╨╕╨╝',\r\n            silent_mode_desc: '╨Я╨░╤Г╨╖╨░ ╨▓╨╛ ╨▓╤А╨╡╨╝╤П ╤Б╨╜╨░',\r\n            activity_log: '╨Ш╤Б╤В╨╛╤А╨╕╤П ╨┐╤Г╨╗╤М╤Б╨░',\r\n            panic_alert: '╨в╨а╨Х╨Т╨Ю╨Ц╨Э╨Р╨п ╨Ъ╨Э╨Ю╨Я╨Ъ╨Р',\r\n            panic_confirm: '╨Ю╤В╨┐╤А╨░╨▓╨╕╤В╤М ╤Б╨╕╨│╨╜╨░╨╗ ╤В╤А╨╡╨▓╨╛╨│╨╕ ╤Б╨╡╨╣╤З╨░╤Б?',\r\n            countdown_prefix: '╨Ф╨╛ ╨┐╤А╨╛╨▓╨╡╤А╨║╨╕:',\r\n            checkInPrompt: '╨Р╨╖╨░╨╝╨░╤В ╨╛╤В╨░, ╨▓╤Л ╨▓ ╨┐╨╛╤А╤П╨┤╨║╨╡? ╨Я╨╛╨╢╨░╨╗╤Г╨╣╤Б╤В╨░, ╨┐╨╛╨┤╤В╨▓╨╡╤А╨┤╨╕╤В╨╡.',\r\n            familyAlert: (hours: number) => `╨Т╨╜╨╕╨╝╨░╨╜╨╕╨╡: ╨Т╨░╤И ╨╛╤В╨╡╤Ж ╨╜╨╡ ╨▓╤Л╤Е╨╛╨┤╨╕╨╗ ╨╜╨░ ╤Б╨▓╤П╨╖╤М ${hours} ╤З╨░╤Б╨╛╨▓!`\r\n        },\r\n    },\r\n};\r\n\r\ninterface LanguageContextType {\r\n    language: Language;\r\n    setLanguage: (lang: Language) => void;\r\n    t: TranslationStructure;\r\n}\r\n\r\nconst LanguageContext = createContext<LanguageContextType | undefined>(undefined);\r\n\r\nexport const LanguageProvider = ({ children }: { children: ReactNode }) => {\r\n    const [language, setLanguage] = useState<Language>('en');\r\n\r\n    // Attempt to load from localStorage on mount\r\n    useEffect(() => {\r\n        const saved = localStorage.getItem('aura-lang') as Language;\r\n        if (saved && ['en', 'uz', 'ru'].includes(saved)) {\r\n            setLanguage(saved);\r\n        }\r\n    }, []);\r\n\r\n    const changeLanguage = (lang: Language) => {\r\n        setLanguage(lang);\r\n        localStorage.setItem('aura-lang', lang);\r\n    };\r\n\r\n    return (\r\n        <LanguageContext.Provider value={{ language, setLanguage: changeLanguage, t: translations[language] }}>\r\n            {children}\r\n        </LanguageContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useLanguage = () => {\r\n    const context = useContext(LanguageContext);\r\n    if (!context) {\r\n        throw new Error('useLanguage must be used within a LanguageProvider');\r\n    }\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\context\\NotificationContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":2,"column":78,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":85},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'user'. Either include it or remove the dependency array.","line":88,"column":8,"nodeType":"ArrayExpression","endLine":88,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [user, user.uid]","fix":{"range":[3409,3420],"text":"[user, user.uid]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":93,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":93,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3621,3624],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3621,3624],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'user'. Either include it or remove the dependency array.","line":104,"column":8,"nodeType":"ArrayExpression","endLine":104,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [user, user.uid]","fix":{"range":[3976,3987],"text":"[user, user.uid]"}}]},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":156,"column":29,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":156,"endColumn":55}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React, { createContext, useContext, useState, useEffect, useCallback, useMemo, ReactNode } from 'react';\r\nimport { useAuth } from './AuthContext';\r\nimport { db } from '@/firebaseConfig';\r\nimport { collection, query, where, onSnapshot, doc } from 'firebase/firestore';\r\nimport { getLocalTodayStr } from '@/lib/dateUtils';\r\n\r\ninterface NotificationState {\r\n    family: number;\r\n    interests: number;\r\n    tasks: number;\r\n    finance: number;\r\n    health: number;\r\n    food: number;\r\n    mind: number;\r\n}\r\n\r\ninterface NotificationContextType {\r\n    notifications: NotificationState;\r\n    clearNotification: (module: keyof NotificationState) => void;\r\n    setNotification: (module: keyof NotificationState, count: number) => void;\r\n}\r\n\r\nconst NotificationContext = createContext<NotificationContextType | undefined>(undefined);\r\n\r\nexport const NotificationProvider = ({ children }: { children: ReactNode }) => {\r\n    const { user } = useAuth();\r\n    const [notifications, setNotifications] = useState<NotificationState>({\r\n        family: 0,\r\n        interests: 0,\r\n        tasks: 0,\r\n        finance: 0,\r\n        health: 0,\r\n        food: 0,\r\n        mind: 0,\r\n    });\r\n\r\n    // Real-time listener for Family Join Requests\r\n    useEffect(() => {\r\n        if (!user) {\r\n            // Only reset if truly logged out, not just initializing\r\n            // setNotifications(prev => ({ ...prev, family: 0 })); \r\n            return;\r\n        }\r\n\r\n        const q = query(\r\n            collection(db, \"family_groups\"),\r\n            where(\"ownerId\", \"==\", user.uid),\r\n            where(\"isDeleted\", \"==\", false)\r\n        );\r\n\r\n        const unsubscribeFamily = onSnapshot(q, (snapshot) => {\r\n            let totalRequests = 0;\r\n            snapshot.docs.forEach(doc => {\r\n                const data = doc.data();\r\n                if (data.joinRequests && Array.isArray(data.joinRequests)) {\r\n                    totalRequests += data.joinRequests.length;\r\n                }\r\n            });\r\n            setNotifications(prev => ({ ...prev, family: totalRequests }));\r\n        }, (error) => {\r\n            console.error(\"Error listening for family requests:\", error);\r\n        });\r\n\r\n        // Sub 3: Listen to ALL AI Insights to trigger notifications\r\n        const modules: (keyof NotificationState)[] = ['finance', 'health', 'interests', 'tasks', 'food', 'mind'];\r\n        const todayStr = getLocalTodayStr();\r\n\r\n        const unsubInsights = modules.map(m => {\r\n            return onSnapshot(doc(db, `users/${user.uid}/ai_insights/${m}_${todayStr}`), (snap) => {\r\n                if (snap.exists()) {\r\n                    const insightData = snap.data();\r\n                    const generatedAt = insightData.generatedAt;\r\n\r\n                    // We need to re-fetch profile or use the one from unsubscribeUser to compare\r\n                    // To keep it simple, we'll trigger a re-check of the profile's lastViewed\r\n                    // Actually, the unsubscribeUser listener below will handle the profile.\r\n                    // Let's just store the latest insight timestamps in a local state to help the user listener.\r\n                    setLatestInsights(prev => ({ ...prev, [m]: generatedAt }));\r\n                }\r\n            });\r\n        });\r\n\r\n        return () => {\r\n            unsubscribeFamily();\r\n            unsubInsights.forEach(unsub => unsub());\r\n        };\r\n    }, [user?.uid]);\r\n\r\n    const [latestInsights, setLatestInsights] = useState<Record<string, string>>({});\r\n\r\n    // Listen for User Profile to get lastViewed timestamps\r\n    const [userData, setUserData] = useState<any>(null);\r\n\r\n    // 1. Listen for User Profile changes\r\n    useEffect(() => {\r\n        if (!user) return;\r\n        const unsubscribeUser = onSnapshot(doc(db, \"users\", user.uid), (docSnap) => {\r\n            if (docSnap.exists()) {\r\n                setUserData(docSnap.data());\r\n            }\r\n        });\r\n        return () => unsubscribeUser();\r\n    }, [user?.uid]);\r\n\r\n    // 2. Calculate Notifications when Data or Insights change\r\n    useEffect(() => {\r\n        if (!userData) return;\r\n\r\n        const lastViewed = userData.lastViewed || {};\r\n\r\n        setNotifications(prev => {\r\n            const newState = { ...prev };\r\n            const modules: (keyof NotificationState)[] = ['finance', 'health', 'interests', 'tasks', 'food', 'mind'];\r\n            modules.forEach(m => {\r\n                const insightTime = latestInsights[m];\r\n                const viewedTime = lastViewed[m];\r\n\r\n                if (insightTime) {\r\n                    newState[m] = (!viewedTime || viewedTime < insightTime) ? 1 : 0;\r\n                } else {\r\n                    newState[m] = 0;\r\n                }\r\n            });\r\n            return newState;\r\n        });\r\n    }, [userData, latestInsights]);\r\n\r\n    // Function to clear notifications for a module (e.g. when page is visited)\r\n    const clearNotification = useCallback(async (module: keyof NotificationState) => {\r\n        if (!user) return;\r\n\r\n        // Loop Protection: If already 0, do nothing.\r\n        // We need to access the current value. Since we are in a callback, we trust 'notifications' from context?\r\n        // No, 'notifications' might be stale in this callback if not in dependency.\r\n        // But we can use the state functional update to check? No, we need to block the DB call.\r\n\r\n        // Better: Pass 'notifications' to dependency? No, that triggers recreation.\r\n        // We will optimistically set it.\r\n\r\n        setNotifications(prev => {\r\n            if (prev[module] === 0) return prev; // No change\r\n            return { ...prev, [module]: 0 };\r\n        });\r\n\r\n        if (module !== 'family') {\r\n            const { updateUserProfile } = await import('@/services/userService');\r\n            const now = new Date().toISOString();\r\n            updateUserProfile(user.uid, {\r\n                [`lastViewed.${module}`]: now\r\n            }).catch(err => console.error(\"Error clearing notification:\", err));\r\n        }\r\n    }, [user]);\r\n\r\n    // V2: Centralized Path-Aware Logic\r\n    const { usePathname } = require('next/navigation');\r\n    const pathname = usePathname();\r\n\r\n    // Mapping: Path Segment -> Notification Key\r\n    const MODULE_PATHS: { [key: string]: keyof NotificationState } = React.useMemo(() => ({\r\n        'family': 'family',\r\n        'interests': 'interests',\r\n        'tasks': 'tasks',\r\n        'finance': 'finance',\r\n        'health': 'health',\r\n        'food': 'food',\r\n        'mind': 'mind'\r\n    }), []);\r\n\r\n    // 1. Auto-Clear on Path Change\r\n    useEffect(() => {\r\n        if (!pathname) return;\r\n\r\n        const segment = pathname.split('/').filter(Boolean)[1];\r\n        const moduleKey = MODULE_PATHS[segment];\r\n\r\n        if (moduleKey) {\r\n            clearNotification(moduleKey);\r\n        }\r\n    }, [pathname, MODULE_PATHS, clearNotification]);\r\n\r\n    // 2. Computed/Derived State for UI (Force 0 if active)\r\n    const visibleNotifications = React.useMemo(() => {\r\n        if (!pathname) return notifications;\r\n        const segment = pathname.split('/').filter(Boolean)[1];\r\n        const activeModule = MODULE_PATHS[segment];\r\n\r\n        if (activeModule && notifications[activeModule] > 0) {\r\n            return {\r\n                ...notifications,\r\n                [activeModule]: 0\r\n            };\r\n        }\r\n        return notifications;\r\n    }, [notifications, pathname, MODULE_PATHS]);\r\n\r\n    const setNotification = useCallback((module: keyof NotificationState, count: number) => {\r\n        setNotifications(prev => ({\r\n            ...prev,\r\n            [module]: count\r\n        }));\r\n    }, []);\r\n\r\n    const contextValue = React.useMemo(() => ({\r\n        notifications: visibleNotifications,\r\n        clearNotification,\r\n        setNotification\r\n    }), [visibleNotifications, clearNotification, setNotification]);\r\n\r\n    return (\r\n        <NotificationContext.Provider value={contextValue}>\r\n            {children}\r\n        </NotificationContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useNotifications = () => {\r\n    const context = useContext(NotificationContext);\r\n    if (context === undefined) {\r\n        throw new Error('useNotifications must be used within a NotificationProvider');\r\n    }\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\data\\familyMock.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\data\\financeMock.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\data\\foodMock.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\data\\healthMock.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\data\\interestsMock.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\data\\mindMock.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\data\\settingsMock.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\data\\tasksMock.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\firebaseConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\hooks\\useFinance.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1192,1195],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1192,1195],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1460,1463],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1460,1463],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":99,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":102,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1476,1479],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1476,1479],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1509,1512],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1509,1512],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'safeSetState'. Either include it or remove the dependency array.","line":83,"column":8,"nodeType":"ArrayExpression","endLine":83,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [userId, selectedDate, safeSetState]","fix":{"range":[3002,3024],"text":"[userId, selectedDate, safeSetState]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'setFinanceData'. Either include it or remove the dependency array.","line":112,"column":34,"nodeType":"Identifier","endLine":112,"endColumn":45,"suggestions":[{"desc":"Update the dependencies array to be: [setFinanceData]","fix":{"range":[4394,4396],"text":"[setFinanceData]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'setTransactions'. Either include it or remove the dependency array.","line":113,"column":35,"nodeType":"Identifier","endLine":113,"endColumn":46,"suggestions":[{"desc":"Update the dependencies array to be: [setTransactions]","fix":{"range":[4463,4465],"text":"[setTransactions]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'setDebts'. Either include it or remove the dependency array.","line":114,"column":28,"nodeType":"Identifier","endLine":114,"endColumn":39,"suggestions":[{"desc":"Update the dependencies array to be: [setDebts]","fix":{"range":[4518,4520],"text":"[setDebts]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'setCredits'. Either include it or remove the dependency array.","line":115,"column":30,"nodeType":"Identifier","endLine":115,"endColumn":41,"suggestions":[{"desc":"Update the dependencies array to be: [setCredits]","fix":{"range":[4577,4579],"text":"[setCredits]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'setDeposits'. Either include it or remove the dependency array.","line":116,"column":31,"nodeType":"Identifier","endLine":116,"endColumn":42,"suggestions":[{"desc":"Update the dependencies array to be: [setDeposits]","fix":{"range":[4638,4640],"text":"[setDeposits]"}}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef, useCallback } from 'react';\r\nimport {\r\n    FinanceOverview,\r\n    Transaction,\r\n    DebtItem,\r\n    CreditItem,\r\n    DepositItem,\r\n    subscribeToFinanceOverview,\r\n    subscribeToTransactionsByDate,\r\n    subscribeToDebts,\r\n    subscribeToCredits,\r\n    subscribeToDeposits,\r\n    seedFinanceData\r\n} from '@/services/financeService';\r\nimport { getScheduledInsight } from '@/services/aiPersistenceService';\r\n\r\nexport const useFinance = (userId: string | undefined, language: string, selectedDate: string) => {\r\n    const [financeData, setFinanceData] = useState<FinanceOverview>({\r\n        totalBalance: 0,\r\n        incomeBudget: 0,\r\n        expenseBudget: 0,\r\n        monthlyIncome: 0,\r\n        monthlySpent: 0,\r\n        savingsGoal: 0,\r\n        currentSavings: 0,\r\n        monthlyBudget: 0\r\n    });\r\n    const [transactions, setTransactions] = useState<Transaction[]>([]);\r\n    const [debts, setDebts] = useState<DebtItem[]>([]);\r\n    const [credits, setCredits] = useState<CreditItem[]>([]);\r\n    const [deposits, setDeposits] = useState<DepositItem[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [aiInsight, setAiInsight] = useState<any | null>(null);\r\n    const [aiLoading, setAiLoading] = useState(false);\r\n\r\n    const seedingRef = useRef(false);\r\n\r\n    // Helper for deep comparison to avoid unnecessary re-renders\r\n    const safeSetState = useCallback((setter: React.Dispatch<React.SetStateAction<any>>, newData: any) => {\r\n        setter((prev: any) => {\r\n            if (JSON.stringify(prev) === JSON.stringify(newData)) return prev;\r\n            return newData;\r\n        });\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (!userId) return;\r\n\r\n        setLoading(true);\r\n\r\n        // Sub 1: Overview\r\n        const unsubOverview = subscribeToFinanceOverview(userId, async (data) => {\r\n            if (data) {\r\n                safeSetState(setFinanceData, data);\r\n                setLoading(false);\r\n            } else {\r\n                if (!seedingRef.current) {\r\n                    seedingRef.current = true;\r\n                    console.log(\"Finance Overview Missing. Seeding...\");\r\n                    await seedFinanceData(userId);\r\n                    seedingRef.current = false;\r\n                }\r\n            }\r\n        });\r\n\r\n        // Sub 2: Transactions\r\n        const unsubTx = subscribeToTransactionsByDate(userId, selectedDate, (data) => {\r\n            safeSetState(setTransactions, data);\r\n        });\r\n\r\n        // Sub 3: Portfolio\r\n        const unsubDebts = subscribeToDebts(userId, (data) => safeSetState(setDebts, data));\r\n        const unsubCredits = subscribeToCredits(userId, (data) => safeSetState(setCredits, data));\r\n        const unsubDeposits = subscribeToDeposits(userId, (data) => safeSetState(setDeposits, data));\r\n\r\n        return () => {\r\n            unsubOverview();\r\n            unsubTx();\r\n            unsubDebts();\r\n            unsubCredits();\r\n            unsubDeposits();\r\n        };\r\n    }, [userId, selectedDate]); // safeSetState removed - it's stable via useCallback\r\n\r\n    // Manual AI Trigger\r\n    const refreshInsight = async () => {\r\n        if (!userId) return;\r\n        setAiLoading(true);\r\n        try {\r\n            const context = {\r\n                totalBalance: financeData.totalBalance,\r\n                monthlySpent: financeData.monthlySpent,\r\n                monthlyIncome: financeData.monthlyIncome,\r\n                expenseBudget: financeData.expenseBudget,\r\n                incomeBudget: financeData.incomeBudget,\r\n                debtTotal: debts.reduce((acc, d) => acc + (d.status === 'active' ? (d.amount - (d.totalRepaid || 0)) : 0), 0),\r\n                creditTotal: credits.reduce((acc, c) => acc + (c.status === 'active' ? c.remainingAmount : 0), 0),\r\n                depositTotal: deposits.reduce((acc, d) => acc + d.currentAmount, 0)\r\n            };\r\n            const insight = await getScheduledInsight(userId, 'finance', language, context, { force: true });\r\n            if (insight) {\r\n                setAiInsight(insight.data || insight);\r\n            }\r\n        } catch (err) {\r\n            console.error(\"AI Scan Failed:\", err);\r\n        } finally {\r\n            setAiLoading(false);\r\n        }\r\n    };\r\n\r\n    // Stable setter wrappers to prevent infinite loops when used in page.tsx\r\n    const stableSetFinanceData = useCallback(setFinanceData, []);\r\n    const stableSetTransactions = useCallback(setTransactions, []);\r\n    const stableSetDebts = useCallback(setDebts, []);\r\n    const stableSetCredits = useCallback(setCredits, []);\r\n    const stableSetDeposits = useCallback(setDeposits, []);\r\n\r\n    return {\r\n        financeData,\r\n        transactions,\r\n        debts,\r\n        credits,\r\n        deposits,\r\n        loading,\r\n        aiInsight,\r\n        aiLoading,\r\n        refreshInsight,\r\n        setFinanceData: stableSetFinanceData, // Stable references\r\n        setTransactions: stableSetTransactions,\r\n        setDebts: stableSetDebts,\r\n        setCredits: stableSetCredits,\r\n        setDeposits: stableSetDeposits\r\n    };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\hooks\\useVoiceCommand.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1194,1197],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1194,1197],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useRef } from 'react';\r\nimport { transcribeAudio, parseCommand } from '@/services/groqService';\r\n\r\nexport const useVoiceCommand = () => {\r\n    const [isRecording, setIsRecording] = useState(false);\r\n    const [isProcessing, setIsProcessing] = useState(false);\r\n    const [transcript, setTranscript] = useState('');\r\n    const mediaRecorderRef = useRef<MediaRecorder | null>(null);\r\n    const chunksRef = useRef<Blob[]>([]);\r\n\r\n    const startRecording = async () => {\r\n        try {\r\n            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n            mediaRecorderRef.current = new MediaRecorder(stream);\r\n            chunksRef.current = [];\r\n\r\n            mediaRecorderRef.current.ondataavailable = (e) => {\r\n                if (e.data.size > 0) chunksRef.current.push(e.data);\r\n            };\r\n\r\n            mediaRecorderRef.current.start();\r\n            setIsRecording(true);\r\n            setTranscript(''); // Clear previous\r\n        } catch (error) {\r\n            console.error(\"Error accessing microphone:\", error);\r\n            alert(\"Could not access microphone.\");\r\n        }\r\n    };\r\n\r\n    const stopRecording = async (): Promise<any> => {\r\n        return new Promise((resolve) => {\r\n            if (!mediaRecorderRef.current) return resolve(null);\r\n\r\n            mediaRecorderRef.current.onstop = async () => {\r\n                setIsProcessing(true);\r\n                const blob = new Blob(chunksRef.current, { type: 'audio/webm' });\r\n\r\n                // 1. Transcribe (Whisper)\r\n                const text = await transcribeAudio(blob);\r\n                setTranscript(text);\r\n\r\n                // 2. Parse Intent (Llama 3)\r\n                const intent = await parseCommand(text);\r\n\r\n                setIsProcessing(false);\r\n                setIsRecording(false);\r\n\r\n                // Stop tracks\r\n                mediaRecorderRef.current?.stream.getTracks().forEach(track => track.stop());\r\n\r\n                resolve({ text, intent });\r\n            };\r\n\r\n            mediaRecorderRef.current.stop();\r\n        });\r\n    };\r\n\r\n    return {\r\n        isRecording,\r\n        isProcessing,\r\n        transcript,\r\n        startRecording,\r\n        stopRecording\r\n    };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\lib\\cloudFunctions.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_userId' is defined but never used.","line":142,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":142,"endColumn":48},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_taskId' is defined but never used.","line":142,"column":58,"nodeType":null,"messageId":"unusedVar","endLine":142,"endColumn":65},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_callback' is defined but never used.","line":142,"column":75,"nodeType":null,"messageId":"unusedVar","endLine":142,"endColumn":84},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":142,"column":93,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":96,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4369,4372],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4369,4372],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_getAuthToken' is defined but never used.","line":152,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":152,"endColumn":29}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Cloud Functions API Client\r\n * Provides methods to call AURA backend functions\r\n */\r\n\r\n// Use LOCAL Emulator URLs for development\r\nconst PROJECT_ID = 'aura-f1d36';\r\nconst REGION = 'us-central1';\r\nconst BASE_URL = typeof window !== 'undefined' && (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1')\r\n    ? `http://127.0.0.1:5001/${PROJECT_ID}/${REGION}`\r\n    : `https://${REGION}-${PROJECT_ID}.cloudfunctions.net`;\r\n\r\nconst ANALYZE_TASK_URL = `${BASE_URL}/analyzeTask`;\r\nconst GET_DAILY_INSIGHT_URL = `${BASE_URL}/getDailyInsight`;\r\nconst HEALTH_CHECK_URL = `${BASE_URL}/healthCheck`;\r\n\r\n/**\r\n * Analyze task for duplicates and priority using GROQ AI\r\n * @param {string} taskTitle - New task title\r\n * @param {string[]} existingTasks - Array of existing task titles\r\n * @returns {Promise<object>} Analysis result\r\n */\r\nexport async function analyzeTaskWithAI(taskTitle: string, existingTasks: string[] = []) {\r\n    try {\r\n        const response = await fetch(`${ANALYZE_TASK_URL}`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                // Add auth token if needed\r\n                // 'Authorization': `Bearer ${getAuthToken()}`\r\n            },\r\n            body: JSON.stringify({\r\n                taskTitle,\r\n                existingTasks,\r\n            }),\r\n        });\r\n\r\n        if (!response.ok) {\r\n            throw new Error(`AI analysis failed: ${response.statusText}`);\r\n        }\r\n\r\n        const data = await response.json();\r\n        return data.analysis;\r\n    } catch (error) {\r\n        console.error('AI Task Analysis Error:', error);\r\n        return {\r\n            hasDuplicates: false,\r\n            similarTasks: [],\r\n            suggestion: 'Tahlil amalga oshmadi',\r\n            error: error instanceof Error ? error.message : 'Unknown error',\r\n        };\r\n    }\r\n}\r\n\r\n/**\r\n * Get personalized daily insight\r\n * @param {object} userData - Comprehensive user data from all modules\r\n * @returns {Promise<string>} Daily insight text\r\n */\r\nexport async function getDailyInsight(userData: {\r\n    finance?: {\r\n        totalBalance: number;\r\n        monthlyIncome: number;\r\n        monthlySpent: number;\r\n        savingsRate: number;\r\n    };\r\n    health?: {\r\n        bodyBattery: number;\r\n        sleepDuration: string;\r\n        heartRate: number | null;\r\n        steps: number;\r\n    };\r\n    food?: {\r\n        caloriesConsumed: number;\r\n        caloriesGoal: number;\r\n        proteinConsumed: number;\r\n        proteinGoal: number;\r\n    } | null;\r\n    interests?: {\r\n        totalActive: number;\r\n        learningStreak: number;\r\n    } | null;\r\n    tasks?: {\r\n        completed: number;\r\n        pending: number;\r\n    };\r\n    family?: {\r\n        memberCount: number;\r\n    };\r\n    stressLevel?: number;\r\n}) {\r\n    try {\r\n        const response = await fetch(`${GET_DAILY_INSIGHT_URL}`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify(userData),\r\n        });\r\n\r\n        if (!response.ok) {\r\n            throw new Error(`Daily insight failed: ${response.statusText}`);\r\n        }\r\n\r\n        const data = await response.json();\r\n        return data.insight;\r\n    } catch (error) {\r\n        console.error('Daily Insight Error:', error);\r\n        return 'Bugun ham ajoyib kun! Maqsadlaringizga erishish uchun harakat qiling.';\r\n    }\r\n}\r\n\r\n/**\r\n * Check backend health status\r\n * @returns {Promise<object>} Health status\r\n */\r\nexport async function checkBackendHealth() {\r\n    try {\r\n        const response = await fetch(`${HEALTH_CHECK_URL}`);\r\n\r\n        if (!response.ok) {\r\n            throw new Error('Health check failed');\r\n        }\r\n\r\n        return await response.json();\r\n    } catch (error) {\r\n        console.error('Health Check Error:', error);\r\n        return {\r\n            status: 'unhealthy',\r\n            error: error instanceof Error ? error.message : 'Unknown error',\r\n        };\r\n    }\r\n}\r\n\r\n/**\r\n * Subscribe to AI analysis results for a task\r\n * @param {string} userId - User ID\r\n * @param {string} taskId - Task ID\r\n * @param {function} callback - Callback function for updates\r\n * @returns {function} Unsubscribe function\r\n */\r\nexport function subscribeToTaskAnalysis(_userId: string, _taskId: string, _callback: (data: any) => void) {\r\n    // This will be implemented with Firestore real-time listener\r\n    // For now, return a no-op unsubscribe\r\n    return () => { };\r\n}\r\n\r\n/**\r\n * Get auth token for authenticated requests\r\n * @returns {Promise<string>} Auth token\r\n */\r\nasync function _getAuthToken() {\r\n    // Implement based on your auth system\r\n    // For now, return empty string\r\n    return '';\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\lib\\dateUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\lib\\familyUtils.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'baseGender' is assigned a value but never used.","line":36,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":127,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4412,4415],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4412,4415],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":127,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4420,4423],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4420,4423],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { FamilyMember } from \"@/services/familyService\";\r\n\r\nexport type UzbekRelationship =\r\n    | \"Ota\"\r\n    | \"Ona\"\r\n    | \"O'g'il\"\r\n    | \"Qiz\"\r\n    | \"Aka\"\r\n    | \"Uka\"\r\n    | \"Opa\"\r\n    | \"Singil\"\r\n    | \"Amaki\"\r\n    | \"Tog'a\"\r\n    | \"Amma\"\r\n    | \"Xola\"\r\n    | \"Bobo\"\r\n    | \"Buvi\"\r\n    | \"Nabira\"\r\n    | \"Kelin\"\r\n    | \"Kuyov\"\r\n    | \"Jiyan\"\r\n    | \"Qarindosh\"\r\n    | \"O'zim\";\r\n\r\n/**\r\n * Calculates the relationship of 'target' member relative to 'base' member.\r\n */\r\nexport function calculateRelationship(\r\n    target: FamilyMember,\r\n    base: FamilyMember,\r\n    allMembers: FamilyMember[]\r\n): UzbekRelationship {\r\n    if (target.id === base.id) return \"O'zim\";\r\n\r\n    const targetGender = getGender(target);\r\n    const baseGender = getGender(base);\r\n\r\n    // 1. Direct Vertical\r\n    if (target.id === base.fatherId) return \"Ota\";\r\n    if (target.id === base.motherId) return \"Ona\";\r\n    if (base.id === target.fatherId) return targetGender === 'male' ? \"O'g'il\" : \"Qiz\";\r\n    if (base.id === target.motherId) return targetGender === 'male' ? \"O'g'il\" : \"Qiz\";\r\n\r\n    // 2. Siblings (Same Parents)\r\n    const isSibling = target.fatherId && target.motherId &&\r\n        target.fatherId === base.fatherId &&\r\n        target.motherId === base.motherId;\r\n\r\n    if (isSibling) {\r\n        const isOlder = isOlderThan(target, base);\r\n        if (targetGender === 'male') return isOlder ? \"Aka\" : \"Uka\";\r\n        return isOlder ? \"Opa\" : \"Singil\";\r\n    }\r\n\r\n    // 3. Grandparents\r\n    const baseFather = allMembers.find(m => m.id === base.fatherId);\r\n    const baseMother = allMembers.find(m => m.id === base.motherId);\r\n\r\n    if (target.id === baseFather?.fatherId || target.id === baseMother?.fatherId) return \"Bobo\";\r\n    if (target.id === baseFather?.motherId || target.id === baseMother?.motherId) return \"Buvi\";\r\n\r\n    // 4. Grandchildren\r\n    const targetFather = allMembers.find(m => m.id === target.fatherId);\r\n    const targetMother = allMembers.find(m => m.id === target.motherId);\r\n\r\n    if (base.id === targetFather?.fatherId || base.id === targetFather?.motherId ||\r\n        base.id === targetMother?.fatherId || base.id === targetMother?.motherId) return \"Nabira\";\r\n\r\n    // 5. Uncles and Aunts (Siblings of Parents)\r\n    // Father's side\r\n    if (base.fatherId) {\r\n        const fatherSiblings = allMembers.filter(m =>\r\n            m.id !== base.fatherId &&\r\n            m.fatherId === baseFather?.fatherId &&\r\n            m.motherId === baseFather?.motherId &&\r\n            m.fatherId != null\r\n        );\r\n        if (fatherSiblings.some(s => s.id === target.id)) {\r\n            return targetGender === 'male' ? \"Amaki\" : \"Amma\";\r\n        }\r\n    }\r\n    // Mother's side\r\n    if (base.motherId) {\r\n        const motherSiblings = allMembers.filter(m =>\r\n            m.id !== base.motherId &&\r\n            m.fatherId === baseMother?.fatherId &&\r\n            m.motherId === baseMother?.motherId &&\r\n            m.fatherId != null\r\n        );\r\n        if (motherSiblings.some(s => s.id === target.id)) {\r\n            return targetGender === 'male' ? \"Tog'a\" : \"Xola\";\r\n        }\r\n    }\r\n\r\n    // 6. In-laws (Kelin/Kuyov)\r\n    // If target is spouse of someone who is my child\r\n    const targetSpouse = allMembers.find(m => m.id === target.spouseId);\r\n    if (targetSpouse && (targetSpouse.fatherId === base.id || targetSpouse.motherId === base.id)) {\r\n        return targetGender === 'female' ? \"Kelin\" : \"Kuyov\";\r\n    }\r\n\r\n    // 7. Jiyan (Children of siblings)\r\n    const baseSiblings = allMembers.filter(m =>\r\n        m.id !== base.id &&\r\n        m.fatherId === base.fatherId &&\r\n        m.motherId === base.motherId &&\r\n        m.fatherId != null\r\n    );\r\n    if (baseSiblings.some(s => target.fatherId === s.id || target.motherId === s.id)) {\r\n        return \"Jiyan\";\r\n    }\r\n\r\n    return \"Qarindosh\";\r\n}\r\n\r\nfunction getGender(member: FamilyMember): 'male' | 'female' {\r\n    const role = (member.role || \"\").toLowerCase();\r\n    if (role.includes('father') || role.includes('son') || role.includes('brother') || role.includes('uncle') || role.includes('grandfather') || role.includes('kuyov')) {\r\n        return 'male';\r\n    }\r\n    if (role.includes('mother') || role.includes('daughter') || role.includes('sister') || role.includes('aunt') || role.includes('grandmother') || role.includes('kelin')) {\r\n        return 'female';\r\n    }\r\n    return 'male'; // Default\r\n}\r\n\r\nfunction isOlderThan(a: any, b: any): boolean {\r\n    const birthA = a.birthDate || a.birth;\r\n    const birthB = b.birthDate || b.birth;\r\n    if (!birthA || !birthB) return false;\r\n    return new Date(birthA) < new Date(birthB);\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\services\\aiPersistenceService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[495,498],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[495,498],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[847,850],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[847,850],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":60,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1698,1701],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1698,1701],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { db } from \"@/firebaseConfig\";\r\nimport { doc, getDoc, setDoc, onSnapshot } from \"firebase/firestore\";\r\nimport {\r\n    getFinanceInsight,\r\n    getHealthAudioInsight,\r\n    getDeepInterestsRecommendation,\r\n    getMindInsight,\r\n    getDailyTaskInsight\r\n} from \"./groqService\";\r\n\r\nexport interface AIInsight {\r\n    id: string;\r\n    moduleKey: string;\r\n    title: string;\r\n    insight: string;\r\n    emoji: string;\r\n    generatedAt: string; // ISO String\r\n    scheduledHour: number;\r\n    data?: any; // Store full JSON structure here\r\n}\r\n\r\nconst MODULE_SCHEDULE: Record<string, number> = {\r\n    health: 8,\r\n    tasks: 9,\r\n    focus: 18,\r\n    interests: 19,\r\n    mind: 20,\r\n    finance: 21,\r\n    food: 22\r\n};\r\n\r\nexport const getScheduledInsight = async (\r\n    userId: string,\r\n    moduleKey: string,\r\n    language: string = 'uz',\r\n    userContext: any = {},\r\n    options: { force?: boolean } = {}\r\n): Promise<AIInsight | null> => {\r\n    const scheduledHour = MODULE_SCHEDULE[moduleKey] || 0;\r\n    const now = new Date();\r\n    const todayStr = now.toISOString().split('T')[0];\r\n\r\n    // 1. Check Firestore for today's insight\r\n    const docRef = doc(db, `users/${userId}/ai_insights/${moduleKey}_${todayStr}`);\r\n\r\n    if (!options.force) {\r\n        const snap = await getDoc(docRef);\r\n        if (snap.exists()) {\r\n            return snap.data() as AIInsight;\r\n        }\r\n    }\r\n\r\n    // 2. If no insight for today OR forced, generate\r\n    const currentHour = now.getHours();\r\n\r\n    if (options.force || currentHour >= scheduledHour) {\r\n        // Time to generate!\r\n        console.log(`[AI Persistence] Generating new insight for ${moduleKey} (Force: ${options.force})`);\r\n\r\n        let rawResult: any;\r\n        switch (moduleKey) {\r\n            case 'finance': rawResult = await getFinanceInsight(language, userContext); break;\r\n            case 'health': {\r\n                rawResult = await getHealthAudioInsight(language, userContext);\r\n                break;\r\n            }\r\n            case 'interests': {\r\n                const hour = now.getHours();\r\n                const window = hour >= 6 && hour < 12 ? 'morning' : hour >= 12 && hour < 18 ? 'lunch' : 'evening';\r\n                const intRes = await getDeepInterestsRecommendation(language, window, userContext);\r\n                rawResult = {\r\n                    title: \"Qiziqishlar\",\r\n                    insight: intRes.recommendations?.[0]?.recommendation || \"Yangi mashg'ulotlar o'rganing.\",\r\n                    emoji: \"ЁЯОи\",\r\n                    data: intRes // Store FULL result\r\n                };\r\n                break;\r\n            }\r\n            case 'mind': rawResult = await getMindInsight(language, userContext); break;\r\n            case 'tasks': {\r\n                const taskRes = await getDailyTaskInsight(language, userContext);\r\n                rawResult = { title: taskRes.title, insight: taskRes.suggestion, emoji: \"тЬЕ\" };\r\n                break;\r\n            }\r\n            default: return null;\r\n        }\r\n\r\n        const newInsight: AIInsight = {\r\n            id: `${moduleKey}_${todayStr}`,\r\n            moduleKey,\r\n            title: rawResult.title || \"Tavsiya\",\r\n            insight: rawResult.insight || rawResult.suggestion || rawResult.text || \"\",\r\n            emoji: rawResult.emoji || \"тЬи\",\r\n            generatedAt: now.toISOString(),\r\n            scheduledHour,\r\n            data: rawResult.data || rawResult // Ensure data is stored\r\n        };\r\n\r\n        await setDoc(docRef, newInsight);\r\n        return newInsight;\r\n    } else {\r\n        // Too early for today. Look for yesterday's insight as fallback\r\n        const yesterday = new Date();\r\n        yesterday.setDate(now.getDate() - 1);\r\n        const yesterdayStr = yesterday.toISOString().split('T')[0];\r\n\r\n        const prevDocRef = doc(db, `users/${userId}/ai_insights/${moduleKey}_${yesterdayStr}`);\r\n        const prevSnap = await getDoc(prevDocRef);\r\n\r\n        if (prevSnap.exists()) {\r\n            return prevSnap.data() as AIInsight;\r\n        }\r\n\r\n        return null;\r\n    }\r\n};\r\n\r\nexport const dismissInsight = async (userId: string, moduleKey: string) => {\r\n    const todayStr = new Date().toISOString().split('T')[0];\r\n    const docRef = doc(db, `users/${userId}/ai_insights/${moduleKey}_${todayStr}`);\r\n    await setDoc(docRef, { isDismissed: true }, { merge: true });\r\n};\r\n\r\nexport const subscribeToScheduledInsight = (\r\n    userId: string,\r\n    moduleKey: string,\r\n    callback: (insight: AIInsight) => void\r\n) => {\r\n    const todayStr = new Date().toISOString().split('T')[0];\r\n    const docRef = doc(db, `users/${userId}/ai_insights/${moduleKey}_${todayStr}`);\r\n\r\n    return onSnapshot(docRef, (snap) => {\r\n        if (snap.exists()) {\r\n            callback(snap.data() as AIInsight);\r\n        }\r\n    });\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\services\\correlationService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'s' is defined but never used.","line":29,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":63,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1751,1754],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1751,1754],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1769,1772],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1769,1772],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":65,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":65,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1789,1792],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1789,1792],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":66,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1810,1813],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1810,1813],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":116,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3596,3599],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3596,3599],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":221,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":221,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8977,8980],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8977,8980],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":323,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":323,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13314,13317],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13314,13317],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":336,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":336,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13942,13945],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13942,13945],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\r\n    getFinanceOverview,\r\n    FinanceOverview\r\n} from './financeService';\r\nimport {\r\n    getHealthData,\r\n    HealthData\r\n} from './healthService';\r\nimport {\r\n    getFoodLog,\r\n    FoodDayLog\r\n} from './foodService';\r\nimport {\r\n    getInterestsData,\r\n    InterestsData\r\n} from './interestsService';\r\nimport {\r\n    getMindData\r\n} from './mindService';\r\nimport {\r\n    getTasksByDate\r\n} from './tasksService';\r\nimport {\r\n    getFocusHistory\r\n} from './focusService';\r\nimport {\r\n    getFamilyMembers\r\n} from './familyService';\r\nimport { s } from 'framer-motion/client';\r\n\r\n// ============================================================================\r\n// TYPES\r\n// ============================================================================\r\n\r\nexport interface Correlation {\r\n    id: string;\r\n    type: 'positive' | 'negative' | 'neutral';\r\n    modules: [string, string]; // e.g., [\"Health\", \"Tasks\"]\r\n    insight: string; // Legacy/Fallback\r\n    insightKey?: string; // e.g., 'sleepProductivityNegative'\r\n    confidence: number; // 0-1\r\n    action?: string; // Legacy/Fallback\r\n    actionKey?: string; // e.g., 'sleep'\r\n    priority: 'high' | 'medium' | 'low';\r\n    metrics: {\r\n        source: { module: string; metric: string; value: number | string };\r\n        target: { module: string; metric: string; value: number | string };\r\n    };\r\n}\r\n\r\nexport interface ButterflyScoreData {\r\n    score: number; // 0-100\r\n    state: 'disconnected' | 'fragmented' | 'harmonic';\r\n    moduleScores: Record<string, number>;\r\n    trend: 'improving' | 'declining' | 'stable';\r\n}\r\n\r\ninterface ModuleData {\r\n    finance?: FinanceOverview | null;\r\n    health?: HealthData | null;\r\n    food?: FoodDayLog | null;\r\n    interests?: InterestsData | null;\r\n    mind?: any;\r\n    tasks?: any[];\r\n    focus?: any[];\r\n    family?: any[];\r\n}\r\n\r\n// ============================================================================\r\n// AGGREGATION\r\n// ============================================================================\r\n\r\n/**\r\n * Fetch all module data for a given user and date\r\n */\r\nexport async function aggregateAllData(\r\n    userId: string,\r\n    date: string = new Date().toISOString().split('T')[0]\r\n): Promise<ModuleData> {\r\n    try {\r\n        const [finance, health, food, interests, mind, tasks, focus, family] = await Promise.all([\r\n            getFinanceOverview(userId),\r\n            getHealthData(userId, date),\r\n            getFoodLog(userId, date),\r\n            getInterestsData(userId),\r\n            getMindData(userId),\r\n            getTasksByDate(userId, date),\r\n            getFocusHistory(userId, 20),\r\n            getFamilyMembers(userId)\r\n        ]);\r\n\r\n        return { finance, health, food, interests, mind, tasks, focus, family };\r\n    } catch (error) {\r\n        console.error('Error aggregating module data:', error);\r\n        return {};\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// CORRELATION ANALYSIS\r\n// ============================================================================\r\n\r\n/**\r\n * Analyze cross-module correlations and return ranked insights\r\n */\r\nexport async function analyzeCorrelations(\r\n    userId: string,\r\n    date: string = new Date().toISOString().split('T')[0]\r\n): Promise<Correlation[]> {\r\n    const data = await aggregateAllData(userId, date);\r\n    const correlations: Correlation[] = [];\r\n\r\n    // CORRELATION 1: Sleep тЖТ Tasks Productivity\r\n    if (data.health && data.tasks) {\r\n        const sleepDuration = parseSleepHours(data.health.sleep?.duration);\r\n        const completedTasks = data.tasks.filter((t: any) => t.status === 'completed').length;\r\n        const totalTasks = data.tasks.length;\r\n        const completionRate = totalTasks > 0 ? (completedTasks / totalTasks) * 100 : 0;\r\n\r\n        if (sleepDuration < 6 && completionRate < 40) {\r\n            correlations.push({\r\n                id: 'sleep-tasks-negative',\r\n                type: 'negative',\r\n                modules: ['Health', 'Tasks'],\r\n                insight: `Poor sleep (${sleepDuration}h) тЖТ Low productivity (${Math.round(completionRate)}% tasks completed)`,\r\n                insightKey: 'sleepProductivityNegative',\r\n                confidence: 0.85,\r\n                action: \"Improve sleep quality tonight to boost tomorrow's focus\",\r\n                actionKey: 'sleep',\r\n                priority: 'high',\r\n                metrics: {\r\n                    source: { module: 'Health', metric: 'Sleep Duration', value: `${sleepDuration}h` },\r\n                    target: { module: 'Tasks', metric: 'Completion Rate', value: `${Math.round(completionRate)}%` }\r\n                }\r\n            });\r\n        } else if (sleepDuration >= 7 && completionRate > 70) {\r\n            correlations.push({\r\n                id: 'sleep-tasks-positive',\r\n                type: 'positive',\r\n                modules: ['Health', 'Tasks'],\r\n                insight: `Great sleep (${sleepDuration}h) тЖТ High productivity (${Math.round(completionRate)}% tasks completed)`,\r\n                insightKey: 'sleepProductivityPositive',\r\n                confidence: 0.82,\r\n                priority: 'low',\r\n                metrics: {\r\n                    source: { module: 'Health', metric: 'Sleep Duration', value: `${sleepDuration}h` },\r\n                    target: { module: 'Tasks', metric: 'Completion Rate', value: `${Math.round(completionRate)}%` }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // CORRELATION 2: Finance Stress тЖТ Mind State\r\n    if (data.finance && data.mind) {\r\n        const balance = data.finance.totalBalance || 0;\r\n        const monthlySpent = data.finance.monthlySpent || 0;\r\n        const monthlyIncome = data.finance.monthlyIncome || 1;\r\n        const spendingRatio = monthlySpent / monthlyIncome;\r\n        const moodScore = data.mind.moodHistory?.[0]?.score || 50;\r\n\r\n        if ((balance < 0 || spendingRatio > 0.9) && moodScore < 40) {\r\n            correlations.push({\r\n                id: 'finance-mind-negative',\r\n                type: 'negative',\r\n                modules: ['Finance', 'Mind'],\r\n                insight: `Financial stress (${balance < 0 ? 'negative balance' : `${Math.round(spendingRatio * 100)}% of income spent`}) тЖТ Low mood (${moodScore}/100)`,\r\n                insightKey: 'financeMindNegative',\r\n                confidence: 0.78,\r\n                action: 'Review budget and create emergency fund plan',\r\n                actionKey: 'finance',\r\n                priority: 'high',\r\n                metrics: {\r\n                    source: { module: 'Finance', metric: 'Balance', value: balance < 0 ? 'negative' : `${Math.round(spendingRatio * 100)}%` },\r\n                    target: { module: 'Mind', metric: 'Mood Score', value: moodScore }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // CORRELATION 3: Nutrition тЖТ Health Battery\r\n    if (data.food && data.health) {\r\n        const caloriesRatio = (data.food.summary.calories.current / data.food.summary.calories.goal) * 100;\r\n        const proteinRatio = (data.food.summary.protein.current / data.food.summary.protein.goal) * 100;\r\n        const bodyBattery = data.health.bodyBattery.current || 50;\r\n\r\n        if (caloriesRatio < 70 && bodyBattery < 40) {\r\n            correlations.push({\r\n                id: 'food-health-negative',\r\n                type: 'negative',\r\n                modules: ['Food', 'Health'],\r\n                insight: `Undereating (${Math.round(caloriesRatio)}% of calorie target) тЖТ Low energy (${bodyBattery}% body battery)`,\r\n                insightKey: 'foodHealthNegative',\r\n                confidence: 0.72,\r\n                action: 'Add a protein-rich snack to restore energy',\r\n                actionKey: 'food',\r\n                priority: 'medium',\r\n                metrics: {\r\n                    source: { module: 'Food', metric: 'Calorie Intake', value: `${Math.round(caloriesRatio)}%` },\r\n                    target: { module: 'Health', metric: 'Body Battery', value: bodyBattery }\r\n                }\r\n            });\r\n        } else if (proteinRatio > 90 && bodyBattery > 70) {\r\n            correlations.push({\r\n                id: 'food-health-positive',\r\n                type: 'positive',\r\n                modules: ['Food', 'Health'],\r\n                insight: `Excellent nutrition (${Math.round(proteinRatio)}% protein target) тЖТ High energy (${bodyBattery}% body battery)`,\r\n                insightKey: 'foodHealthPositive',\r\n                confidence: 0.75,\r\n                priority: 'low',\r\n                metrics: {\r\n                    source: { module: 'Food', metric: 'Protein Intake', value: `${Math.round(proteinRatio)}%` },\r\n                    target: { module: 'Health', metric: 'Body Battery', value: bodyBattery }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // CORRELATION 4: Focus Time тЖТ Learning Streak (Interests)\r\n    if (data.focus && data.interests) {\r\n        const focusMinutesToday = data.focus.reduce((sum: number, session: any) => sum + (session.duration || 0), 0);\r\n        const learningStreak = data.interests.stats.learningStreak || 0;\r\n\r\n        if (focusMinutesToday > 60 && learningStreak > 5) {\r\n            correlations.push({\r\n                id: 'focus-interests-positive',\r\n                type: 'positive',\r\n                modules: ['Focus', 'Interests'],\r\n                insight: `Deep work (${focusMinutesToday} min today) тЖТ Strong learning habit (${learningStreak} day streak)`,\r\n                insightKey: 'focusInterestsPositive',\r\n                confidence: 0.80,\r\n                priority: 'low',\r\n                metrics: {\r\n                    source: { module: 'Focus', metric: 'Minutes Today', value: focusMinutesToday },\r\n                    target: { module: 'Interests', metric: 'Learning Streak', value: learningStreak }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // CORRELATION 5: Family Engagement тЖТ Mind Wellbeing\r\n    if (data.family && data.mind) {\r\n        const activeFamilyMembers = data.family.length;\r\n        const moodScore = data.mind.moodHistory?.[0]?.score || 50;\r\n\r\n        if (activeFamilyMembers >= 2 && moodScore > 60) {\r\n            correlations.push({\r\n                id: 'family-mind-positive',\r\n                type: 'positive',\r\n                modules: ['Family', 'Mind'],\r\n                insight: `Active family hub (${activeFamilyMembers} members) тЖТ Positive mood (${moodScore}/100)`,\r\n                insightKey: 'familyMindPositive',\r\n                confidence: 0.68,\r\n                priority: 'low',\r\n                metrics: {\r\n                    source: { module: 'Family', metric: 'Active Members', value: activeFamilyMembers },\r\n                    target: { module: 'Mind', metric: 'Mood Score', value: moodScore }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // Sort by priority and confidence\r\n    return correlations.sort((a, b) => {\r\n        const priorityWeight = { high: 3, medium: 2, low: 1 };\r\n        const scoreA = priorityWeight[a.priority] * a.confidence;\r\n        const scoreB = priorityWeight[b.priority] * b.confidence;\r\n        return scoreB - scoreA;\r\n    });\r\n}\r\n\r\n// ============================================================================\r\n// BUTTERFLY SCORE\r\n// ============================================================================\r\n\r\n/**\r\n * Calculate overall life harmony score (0-100)\r\n */\r\nexport function calculateButterflyScore(data: ModuleData): ButterflyScoreData {\r\n    const moduleScores: Record<string, number> = {};\r\n\r\n    // Finance: 0-100 based on balance, debt ratio, savings rate\r\n    if (data.finance) {\r\n        const balance = data.finance.totalBalance || 0;\r\n        const spent = data.finance.monthlySpent || 0;\r\n        const income = data.finance.monthlyIncome || 1;\r\n        const savingsRate = Math.max(0, (income - spent) / income);\r\n\r\n        let financeScore = 50; // baseline\r\n        if (balance > 0) financeScore += 20;\r\n        if (balance > income * 3) financeScore += 10; // 3-month emergency fund\r\n        financeScore += savingsRate * 20;\r\n\r\n        moduleScores.finance = Math.min(100, financeScore);\r\n    }\r\n\r\n    // Health: 0-100 based on body battery, sleep, activity\r\n    if (data.health) {\r\n        const battery = data.health.bodyBattery.current || 50;\r\n        const sleepHours = parseSleepHours(data.health.sleep?.duration);\r\n        const sleepScore = Math.min(100, (sleepHours / 8) * 50);\r\n\r\n        moduleScores.health = Math.round((battery + sleepScore) / 2);\r\n    }\r\n\r\n    // Food: 0-100 based on calorie/macro targets\r\n    if (data.food) {\r\n        const calGoal = data.food.summary?.calories?.goal || 2000;\r\n        const protGoal = data.food.summary?.protein?.goal || 50;\r\n        const calorieRatio = Math.min(1.2, (data.food.summary?.calories?.current || 0) / calGoal);\r\n        const proteinRatio = Math.min(1.2, (data.food.summary?.protein?.current || 0) / protGoal);\r\n\r\n        moduleScores.food = Math.round(((calorieRatio + proteinRatio) / 2.4) * 100);\r\n    }\r\n\r\n    // Mind: 0-100 based on latest mood score\r\n    if (data.mind?.moodHistory?.[0]) {\r\n        moduleScores.mind = data.mind.moodHistory[0].score;\r\n    }\r\n\r\n    // Tasks: 0-100 based on completion rate\r\n    if (data.tasks && data.tasks.length > 0) {\r\n        const completed = data.tasks.filter((t: any) => t.status === 'completed').length;\r\n        moduleScores.tasks = Math.round((completed / data.tasks.length) * 100);\r\n    }\r\n\r\n    // Interests: 0-100 based on streak and active hobbies\r\n    if (data.interests) {\r\n        const streakScore = Math.min(100, data.interests.stats.learningStreak * 5);\r\n        const activeScore = Math.min(100, data.interests.stats.totalActive * 10);\r\n        moduleScores.interests = Math.round((streakScore + activeScore) / 2);\r\n    }\r\n\r\n    // Focus: 0-100 based on daily focus time (target: 120 min)\r\n    if (data.focus) {\r\n        const totalMinutes = data.focus.reduce((sum: number, s: any) => sum + (s.duration || 0), 0);\r\n        moduleScores.focus = Math.min(100, Math.round((totalMinutes / 120) * 100));\r\n    }\r\n\r\n    // Family: 0-100 based on active members\r\n    if (data.family) {\r\n        moduleScores.family = Math.min(100, data.family.length * 25);\r\n    }\r\n\r\n    // Calculate weighted average (penalize missing modules)\r\n    const rawScores = Object.values(moduleScores).filter(s => !isNaN(s));\r\n    const avgScore = rawScores.length > 0\r\n        ? Math.round(rawScores.reduce((sum, s) => sum + s, 0) / rawScores.length)\r\n        : 0;\r\n\r\n    // Apply interconnectedness penalty: If variance is high, reduce score\r\n    const variance = rawScores.length > 0 ? calculateVariance(rawScores) : 0;\r\n    const balancePenalty = Math.min(20, variance / 5); // Max 20 point penalty\r\n    let finalScore = Math.max(0, Math.round(avgScore - balancePenalty));\r\n\r\n    // Final NaN check\r\n    if (isNaN(finalScore)) finalScore = 0;\r\n\r\n    // Determine state\r\n    let state: 'disconnected' | 'fragmented' | 'harmonic';\r\n    if (finalScore >= 60) state = 'harmonic';\r\n    else if (finalScore >= 30) state = 'fragmented';\r\n    else state = 'disconnected';\r\n\r\n    return {\r\n        score: finalScore,\r\n        state,\r\n        moduleScores,\r\n        trend: 'stable' // TODO: Calculate from historical data\r\n    };\r\n}\r\n\r\n// ============================================================================\r\n// HELPERS\r\n// ============================================================================\r\n\r\nfunction parseSleepHours(duration?: string): number {\r\n    if (!duration) return 7;\r\n    const match = duration.match(/(\\d+)h/);\r\n    return match ? parseInt(match[1]) : 7;\r\n}\r\n\r\nfunction calculateVariance(scores: number[]): number {\r\n    if (scores.length === 0) return 0;\r\n    const mean = scores.reduce((sum, s) => sum + s, 0) / scores.length;\r\n    const squaredDiffs = scores.map(s => Math.pow(s - mean, 2));\r\n    return Math.sqrt(squaredDiffs.reduce((sum, d) => sum + d, 0) / scores.length);\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\services\\dailyService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\services\\db.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\services\\familyService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_userId' is defined but never used.","line":500,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":500,"endColumn":48},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_memberId' is defined but never used.","line":500,"column":58,"nodeType":null,"messageId":"unusedVar","endLine":500,"endColumn":67}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { db } from \"@/firebaseConfig\";\r\nimport { collection, doc, getDoc, getDocs, setDoc, updateDoc, addDoc, query, where, deleteDoc, onSnapshot } from \"firebase/firestore\";\r\nimport { getLocalTodayStr } from \"@/lib/dateUtils\";\r\n\r\nexport interface FamilyMember {\r\n    id: string;\r\n    name: string;\r\n    fullName?: string;\r\n    birthDate?: string; // YYYY-MM-DD or just YYYY\r\n    role: 'Father' | 'Mother' | 'Son' | 'Daughter' | string;\r\n    status: 'home' | 'work' | 'school' | 'gym' | 'legacy' | string;\r\n    battery: number;\r\n    mood: 'happy' | 'focused' | 'tired' | 'stressed' | string;\r\n    level: number;\r\n    avatar?: string;\r\n    // Linkage\r\n    fatherId?: string;\r\n    motherId?: string;\r\n    spouseId?: string;\r\n    // Extended fields for ClientProfile\r\n    safetyStatus?: 'safe' | 'danger' | 'unknown';\r\n    location?: string;\r\n    lastActive?: string;\r\n    currentXP?: number;\r\n    maxXP?: number;\r\n    screenTime?: {\r\n        used: number;\r\n        limit: number;\r\n    };\r\n    genetics?: string[];\r\n    beaconWindow?: '12h' | '24h' | '48h';\r\n\r\n    // Extended Details\r\n    profession?: string;\r\n    bio?: string;\r\n    education?: string;\r\n    // 7-module monitoring status\r\n    modules?: {\r\n        finance: number;\r\n        health: number;\r\n        tasks: number;\r\n        food: number;\r\n        mind: number;\r\n        interests: number;\r\n        family: number;\r\n    };\r\n    balance?: number; // Coin balance\r\n}\r\n\r\n// Extended Family Group with Soft Delete and Owners\r\nexport interface FamilyGroup {\r\n    id: string;\r\n    name: string;\r\n    ownerId: string;\r\n    members: string[]; // member user IDs\r\n\r\n    // Soft Delete\r\n    isDeleted?: boolean;\r\n    deletedAt?: string | null; // For soft delete logic (ISO date string)\r\n    deletedBy?: string; // User ID who deleted\r\n\r\n    createdAt: string;\r\n    joinRequests?: string[]; // user IDs requesting to join\r\n}\r\n\r\n// Join Request with user details (for UI display)\r\nexport interface JoinRequest {\r\n    userId: string;\r\n    userName: string; // snapshot of name at request time\r\n    status: 'pending' | 'approved' | 'rejected';\r\n}\r\n\r\nexport interface ParentingRequest {\r\n    id: string;\r\n    kid: string;\r\n    task: string;\r\n    reward: string;\r\n    status: 'pending' | 'approved' | 'denied';\r\n    timestamp: string;\r\n    // Linkage\r\n    fatherId?: string;\r\n    motherId?: string;\r\n    spouseId?: string;\r\n}\r\n\r\nexport interface Ancestor {\r\n    id: string;\r\n    name: string;\r\n    role: string;\r\n    birth: string;\r\n    death: string;\r\n    profession: string;\r\n    education?: string;\r\n    healthIssues: string[];\r\n    traits: string[];\r\n    status?: string;\r\n    photo?: string;\r\n    avatar?: string;\r\n    // Linkage\r\n    fatherId?: string;\r\n    motherId?: string;\r\n    spouseId?: string;\r\n    bio?: string;\r\n}\r\n\r\n// New Roles List\r\nexport const FAMILY_ROLES = [\r\n    'Grandfather', 'Grandmother',\r\n    'Father', 'Mother',\r\n    'Spouse (Turmush o\\'rtog\\'im)',\r\n    'Brother', 'Younger Brother',\r\n    'Sister', 'Younger Sister',\r\n    'Son', 'Daughter',\r\n    'Daughter-in-law (Kelin)',\r\n    'Uncle (Amaki)', \"Uncle (Tog'a)\",\r\n    'Aunt (Amma)', 'Aunt (Xola)',\r\n    'Nephew/Niece (Jiyan)',\r\n    'Grandchild (Nabira)',\r\n    'Relative (Qarindosh)'\r\n];\r\n\r\nconst getSubCollection = (userId: string, subName: string) => {\r\n    return collection(db, `users/${userId}/${subName}`);\r\n};\r\n\r\n// ... existing cleanup function ...\r\nexport const removeFakeFamilyData = async (userId: string) => {\r\n    const fakeNames = ['Alex', 'Elena', 'Grandpa', 'Grandma', 'Sarah', 'Mike', 'Sophie', 'Max', 'Grandmother'];\r\n    const membersRef = getSubCollection(userId, \"family_members\");\r\n    const snapshot = await getDocs(membersRef);\r\n\r\n    const deletePromises = snapshot.docs\r\n        .filter(doc => fakeNames.includes(doc.data().name))\r\n        .map(doc => deleteDoc(doc.ref));\r\n\r\n    await Promise.all(deletePromises);\r\n};\r\n\r\n// ... existing deleteFamilyMember ... (logic needs update to remove from Group too ideally, but for now simple doc delete)\r\nexport const deleteFamilyMember = async (userId: string, memberId: string) => {\r\n    const docRef = doc(db, `users/${userId}/family_members/${memberId}`);\r\n    await deleteDoc(docRef);\r\n};\r\n\r\nexport const ensureOwnerProfile = async (userId: string) => {\r\n    const memberRef = doc(db, `users/${userId}/family_members/${userId}`);\r\n    const memberSnap = await getDoc(memberRef);\r\n\r\n    if (!memberSnap.exists()) {\r\n        await setDoc(memberRef, {\r\n            id: userId,\r\n            name: \"Oila Boshlig'i\",\r\n            role: 'Father',\r\n            battery: 100,\r\n            mood: 'happy',\r\n            status: 'home',\r\n            level: 1,\r\n            safetyStatus: 'safe'\r\n        });\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\n\r\nexport const subscribeToFamilyMembers = (ownerId: string, onUpdate: (members: FamilyMember[]) => void) => {\r\n    if (!ownerId) return () => { };\r\n    const membersRef = getSubCollection(ownerId, \"family_members\");\r\n    return onSnapshot(membersRef, (snapshot) => {\r\n        const members = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as FamilyMember));\r\n        onUpdate(members);\r\n    }, (error) => {\r\n        console.error(\"Error subscribing to family members:\", error);\r\n    });\r\n};\r\n\r\nexport const getFamilyMembers = async (userId: string): Promise<FamilyMember[]> => {\r\n    const snapshot = await getDocs(getSubCollection(userId, \"family_members\"));\r\n    return snapshot.docs.map(d => ({ id: d.id, ...d.data() } as FamilyMember));\r\n};\r\n\r\nexport const getFamilyMember = async (userId: string, memberId: string): Promise<FamilyMember | null> => {\r\n    const docRef = doc(db, `users/${userId}/family_members/${memberId}`);\r\n    const snap = await getDoc(docRef);\r\n    if (snap.exists()) {\r\n        return { id: snap.id, ...snap.data() } as FamilyMember;\r\n    }\r\n    return null;\r\n};\r\n\r\n// --- FAMILY GROUP SERVICES ---\r\n\r\n// Get active family groups (filtering out soft deleted ones older than 30 days or hiding them)\r\nexport const getFamilyGroups = async (userId: string): Promise<FamilyGroup[]> => {\r\n    // In a real app with subcollections, we might need a collectionGroup query or similar.\r\n    // For this architecture where groups are under `users/{userId}/family_groups`, \r\n    // it implies only the owner sees them easily. \r\n    // To allow \"Global\" families, we should ideally move `family_groups` to root.\r\n    // However, adhering to current structure: we assume we are fetching groups THIS user owns or belongs to.\r\n\r\n    // CURRENT ARCHITECTURE LIMITATION FIX:\r\n    // Since we are using detailed role management and multi-user, `family_groups` should ideally be a root collection.\r\n    // But to respect the likely Firestore rules of the current user scope, I will create them in a way accessible.\r\n    // For now, let's keep it simple: We fetch groups where `ownerId` == userId OR `members` contains userId.\r\n    // NOTE: Generating a compound query might require an index. We will stick to fetching owned groups for now \r\n    // and assume a \"Join\" flow adds the group copy or reference. \r\n\r\n    // ACTUALLY, checking the `createFamilyGroup` implementation... it was `getSubCollection(userId, \"family_groups\")`.\r\n    // This means groups are private to the user. This contradicts \"Joining\" another user's family easily without restricted access.\r\n    // I will MOVE family_groups to a ROOT collection to handle multi-user properly.\r\n\r\n    const q = query(collection(db, \"family_groups\"), where(\"members\", \"array-contains\", userId));\r\n    const snapshot = await getDocs(q);\r\n\r\n    const groups = snapshot.docs.map(d => ({ id: d.id, ...d.data() } as FamilyGroup));\r\n\r\n    return groups;\r\n};\r\n\r\n// Real-time listener for a Family Group\r\nexport const subscribeToFamilyGroup = (groupId: string, onUpdate: (data: FamilyGroup) => void) => {\r\n    const ref = doc(db, \"family_groups\", groupId);\r\n    return onSnapshot(ref, (doc) => {\r\n        if (doc.exists()) {\r\n            onUpdate({ id: doc.id, ...doc.data() } as FamilyGroup);\r\n        }\r\n    });\r\n};\r\n\r\n// Real-time listener for ALL groups a user belongs to (for instant join updates)\r\nexport const subscribeToUserFamilies = (userId: string, onUpdate: (groups: FamilyGroup[]) => void) => {\r\n    if (!userId) return () => { };\r\n\r\n    const q = query(\r\n        collection(db, \"family_groups\"),\r\n        where(\"members\", \"array-contains\", userId),\r\n        where(\"isDeleted\", \"==\", false)\r\n    );\r\n\r\n    return onSnapshot(q, (snapshot) => {\r\n        const groups = snapshot.docs.map(d => ({ id: d.id, ...d.data() } as FamilyGroup));\r\n        onUpdate(groups);\r\n    }, (error) => {\r\n        console.error(\"Error subscribing to user families:\", error);\r\n    });\r\n};\r\n\r\nexport const upsertMemberProfile = async (userId: string, details: { fullName: string, birthDate: string, role?: string }) => {\r\n    const memberRef = doc(db, `users/${userId}/family_members/${userId}`);\r\n    const data = {\r\n        id: userId,\r\n        name: details.fullName.split(' ')[0],\r\n        fullName: details.fullName,\r\n        birthDate: details.birthDate,\r\n        role: details.role || 'Son',\r\n        battery: 100,\r\n        mood: 'happy',\r\n        status: 'home',\r\n        level: 1,\r\n        safetyStatus: 'safe'\r\n    };\r\n    await setDoc(memberRef, data, { merge: true });\r\n\r\n    // Also sync to root users collection for global visibility during joins\r\n    try {\r\n        const { createUserProfile } = await import('./userService');\r\n        await createUserProfile(userId, {\r\n            displayName: details.fullName,\r\n            // We can add more fields if we want to expand userService\r\n        });\r\n    } catch (e) {\r\n        console.warn(\"Could not sync to root users collection\", e);\r\n    }\r\n};\r\n\r\ninterface OwnerDetails {\r\n    fullName: string;\r\n    birthDate: string;\r\n    role: string;\r\n}\r\n\r\nexport const createFamilyGroup = async (userId: string, name: string, ownerDetails?: OwnerDetails): Promise<string> => {\r\n    // check limit\r\n    const existing = await getFamilyGroups(userId);\r\n    // Filter out ones I own\r\n    const owned = existing.filter(g => g.ownerId === userId && !g.deletedAt);\r\n\r\n    if (owned.length >= 3) {\r\n        throw new Error(\"Siz maksimal 3 ta oila yaratishingiz mumkin.\");\r\n    }\r\n\r\n    const newGroup: Omit<FamilyGroup, 'id'> = {\r\n        name,\r\n        ownerId: userId,\r\n        members: [userId],\r\n        createdAt: getLocalTodayStr(),\r\n        joinRequests: [],\r\n        isDeleted: false,\r\n        deletedAt: null\r\n    };\r\n\r\n    const docRef = await addDoc(collection(db, \"family_groups\"), newGroup);\r\n\r\n    // Ensure Owner has a Member Profile with DETAILED info\r\n    const memberRef = doc(db, `users/${userId}/family_members/${userId}`);\r\n    const ownerData = {\r\n        id: userId,\r\n        name: ownerDetails?.fullName?.split(' ')[0] || \"Oila Boshlig'i\",\r\n        fullName: ownerDetails?.fullName,\r\n        birthDate: ownerDetails?.birthDate,\r\n        role: ownerDetails?.role || 'Head',\r\n        battery: 100,\r\n        mood: 'happy',\r\n        status: 'home',\r\n        level: 1,\r\n        safetyStatus: 'safe'\r\n    };\r\n    await setDoc(memberRef, ownerData, { merge: true });\r\n\r\n    // Sync to root users\r\n    if (ownerDetails?.fullName) {\r\n        try {\r\n            const { createUserProfile } = await import('./userService');\r\n            await createUserProfile(userId, {\r\n                displayName: ownerDetails.fullName\r\n            });\r\n        } catch (e) {\r\n            console.warn(\"Could not sync owner to root users collection\", e);\r\n        }\r\n    }\r\n\r\n    return docRef.id;\r\n};\r\n\r\nexport const updateFamilyGroup = async (groupId: string, name: string) => {\r\n    const ref = doc(db, \"family_groups\", groupId);\r\n    await updateDoc(ref, { name });\r\n};\r\n\r\n// Soft Delete\r\nexport const deleteFamilyGroup = async (groupId: string, userId: string) => {\r\n    const ref = doc(db, \"family_groups\", groupId);\r\n    await updateDoc(ref, {\r\n        isDeleted: true,\r\n        deletedAt: getLocalTodayStr(),\r\n        deletedBy: userId\r\n    });\r\n};\r\n\r\n// Restore\r\nexport const restoreFamilyGroup = async (groupId: string) => {\r\n    const ref = doc(db, \"family_groups\", groupId);\r\n    await updateDoc(ref, {\r\n        isDeleted: false,\r\n        deletedAt: null,\r\n        deletedBy: null\r\n    });\r\n};\r\n\r\n// Request to Join\r\nexport const requestJoinFamily = async (userId: string, groupId: string) => {\r\n    const ref = doc(db, \"family_groups\", groupId);\r\n    const snap = await getDoc(ref);\r\n    if (!snap.exists()) throw new Error(\"Oila topilmadi\");\r\n\r\n    const data = snap.data() as FamilyGroup;\r\n    if (data.members.includes(userId)) throw new Error(\"Siz allaqachon bu oiladasiz\");\r\n    if (data.joinRequests?.includes(userId)) throw new Error(\"So'rov yuborilgan\");\r\n\r\n    // Add to requests\r\n    // Note: In real app use arrayUnion\r\n    const currentRequests = data.joinRequests || [];\r\n    await updateDoc(ref, { joinRequests: [...currentRequests, userId] });\r\n};\r\n\r\n// Approve Join\r\nexport const approveJoinRequest = async (ownerId: string, groupId: string, requestingUserId: string, role: string, linkage?: { fatherId?: string, motherId?: string }) => {\r\n    const ref = doc(db, \"family_groups\", groupId);\r\n    const snap = await getDoc(ref);\r\n    if (!snap.exists()) throw new Error(\"Oila topilmadi\");\r\n    const data = snap.data() as FamilyGroup;\r\n\r\n    if (data.ownerId !== ownerId) throw new Error(\"Huquqingiz yo'q\");\r\n\r\n    const newMembers = [...data.members, requestingUserId];\r\n    const newRequests = (data.joinRequests || []).filter(id => id !== requestingUserId);\r\n\r\n    await updateDoc(ref, {\r\n        members: newMembers,\r\n        joinRequests: newRequests\r\n    });\r\n\r\n    // Fetch user public profile to get real name\r\n    let memberName = \"Yangi A'zo\";\r\n    const memberBirth = \"\";\r\n\r\n    try {\r\n        const { getUserProfile } = await import('./userService');\r\n        const userProfile = await getUserProfile(requestingUserId);\r\n        if (userProfile) {\r\n            memberName = userProfile.fullName || userProfile.displayName || \"Yangi A'zo\";\r\n        }\r\n    } catch (e) {\r\n        console.warn(\"Could not fetch user profile for name\", e);\r\n    }\r\n\r\n    await setDoc(doc(db, `users/${ownerId}/family_members/${requestingUserId}`), {\r\n        id: requestingUserId,\r\n        name: memberName.split(' ')[0],\r\n        fullName: memberName,\r\n        birthDate: memberBirth,\r\n        role: role,\r\n        fatherId: linkage?.fatherId || '',\r\n        motherId: linkage?.motherId || '',\r\n        battery: 100,\r\n        status: 'home',\r\n        mood: 'happy',\r\n        level: 1,\r\n        safetyStatus: 'safe'\r\n    });\r\n};\r\n\r\n// Remove Member (Kick)\r\nexport const removeMemberFromGroup = async (ownerId: string, groupId: string, targetUserId: string) => {\r\n    const ref = doc(db, \"family_groups\", groupId);\r\n    const snap = await getDoc(ref);\r\n    const data = snap.data() as FamilyGroup;\r\n\r\n    if (data.ownerId !== ownerId) throw new Error(\"Huquqingiz yo'q\");\r\n\r\n    const newMembers = data.members.filter(m => m !== targetUserId);\r\n    await updateDoc(ref, { members: newMembers });\r\n\r\n    // Also remove from subcollection\r\n    await deleteDoc(doc(db, `users/${ownerId}/family_members/${targetUserId}`));\r\n};\r\n\r\n// ... existing exports for parenting requests, ancestors, coins etc ...\r\n// We need to keep getFamilyMembers, getParentingRequests etc for UI compatibility\r\n// BUT we should update getFamilyMembers to potentially fetch from the \"active group\" logic in future.\r\n// For now, leaving them as is creates a bridge between new Group logic and old UI.\r\n\r\nexport const getAncestors = async (id: string, isGroup: boolean = false): Promise<Ancestor[]> => {\r\n    const colRef = isGroup\r\n        ? collection(db, `family_groups/${id}/ancestors`)\r\n        : collection(db, `users/${id}/ancestors`);\r\n    const snapshot = await getDocs(colRef);\r\n    return snapshot.docs.map(d => ({ id: d.id, ...d.data() } as Ancestor));\r\n};\r\n\r\nexport function subscribeToAncestors(\r\n    id: string,\r\n    isGroup: boolean,\r\n    callback: (ancestors: Ancestor[]) => void\r\n) {\r\n    const colRef = isGroup\r\n        ? collection(db, `family_groups/${id}/ancestors`)\r\n        : collection(db, `users/${id}/ancestors`);\r\n\r\n    return onSnapshot(colRef, snapshot => {\r\n        const ancestors = snapshot.docs.map(doc => ({\r\n            id: doc.id,\r\n            ...doc.data()\r\n        })) as Ancestor[];\r\n        callback(ancestors);\r\n    });\r\n}\r\n\r\nexport const updateRequestStatus = async (userId: string, requestId: string, status: 'approved' | 'denied') => {\r\n    const docRef = doc(db, `users/${userId}/parenting_requests/${requestId}`);\r\n    await updateDoc(docRef, { status });\r\n};\r\n\r\nexport const unlockScreenTime = async (userId: string, memberId: string, minutes: number) => {\r\n    const docRef = doc(db, `users/${userId}/family_members/${memberId}`);\r\n    const snap = await getDoc(docRef);\r\n    if (snap.exists()) {\r\n        const data = snap.data() as FamilyMember;\r\n        const currentLimit = data.screenTime?.limit || 60;\r\n        await updateDoc(docRef, {\r\n            screenTime: { ...data.screenTime, limit: currentLimit + minutes }\r\n        });\r\n    }\r\n};\r\n\r\nexport const updateFamilyMember = async (userId: string, memberId: string, data: Partial<FamilyMember>) => {\r\n    const docRef = doc(db, `users/${userId}/family_members/${memberId}`);\r\n    await updateDoc(docRef, data);\r\n};\r\n\r\nexport const addCoins = async (userId: string, memberId: string, amount: number) => {\r\n    const docRef = doc(db, `users/${userId}/family_members/${memberId}`);\r\n    const snap = await getDoc(docRef);\r\n    if (snap.exists()) {\r\n        const data = snap.data() as FamilyMember;\r\n        const currentBalance = data.balance || 0;\r\n        await updateDoc(docRef, { balance: currentBalance + amount });\r\n    }\r\n};\r\n\r\nexport const checkSafetyStatus = async (_userId: string, _memberId: string): Promise<'safe' | 'danger'> => {\r\n    return 'safe'; // Placeholder\r\n};\r\n\r\nexport const upsertAncestor = async (id: string, ancestor: Omit<Ancestor, 'id'> & { id?: string }, isGroup: boolean = false) => {\r\n    const colRef = isGroup\r\n        ? collection(db, `family_groups/${id}/ancestors`)\r\n        : collection(db, `users/${id}/ancestors`);\r\n\r\n    if (ancestor.id) {\r\n        const docRef = doc(db, colRef.path, ancestor.id);\r\n        await updateDoc(docRef, ancestor as Partial<Ancestor>);\r\n    } else {\r\n        await addDoc(colRef, ancestor);\r\n    }\r\n};\r\n\r\nexport const getParentingRequests = async (userId: string): Promise<ParentingRequest[]> => {\r\n    const snapshot = await getDocs(getSubCollection(userId, \"parenting_requests\"));\r\n    return snapshot.docs.map(d => ({ id: d.id, ...d.data() } as ParentingRequest));\r\n};\r\n\r\n/**\r\n * Permanently delete a family (cannot be undone)\r\n */\r\nexport async function permanentDeleteFamily(familyId: string) {\r\n    const familyRef = doc(db, 'family_groups', familyId);\r\n    await deleteDoc(familyRef);\r\n}\r\n\r\n/**\r\n * Subscribe to deleted families for a user (for restore UI)\r\n */\r\nexport function subscribeToDeletedFamilies(\r\n    userId: string,\r\n    callback: (families: FamilyGroup[]) => void\r\n) {\r\n    const q = query(\r\n        collection(db, 'family_groups'),\r\n        where('ownerId', '==', userId),\r\n        where('isDeleted', '==', true)\r\n    );\r\n\r\n    return onSnapshot(q, snapshot => {\r\n        const families = snapshot.docs.map(doc => ({\r\n            id: doc.id,\r\n            ...doc.data()\r\n        })) as FamilyGroup[];\r\n        callback(families);\r\n    });\r\n}\r\n\r\n\r\n// --- RELATIONSHIP LINKING SERVICES ---\r\n\r\nexport interface RelationshipPayload {\r\n    sourceId: string;\r\n    targetId: string;\r\n    type: 'father' | 'mother' | 'spouse' | 'son' | 'daughter';\r\n}\r\n\r\n/**\r\n * Link two family members.\r\n * Note: Linking A as father of B implies B is child of A.\r\n * We store reference on Child (fatherId, motherId) and Spouse (spouseId).\r\n */\r\nexport const linkFamilyMembers = async (ownerId: string, payload: RelationshipPayload) => {\r\n    // 1. If type is 'father', set fatherId on target\r\n    // 2. If type is 'mother', set motherId on target\r\n    // 3. If type is 'spouse', set spouseId on BOTH\r\n    // 4. If type is 'son'/'daughter', inverse: set father/mother on source (based on owner gender? or explicit?)\r\n    //    Actually, better to be explicit: 'source' is the PARENT, 'target' is the CHILD if type is 'son'.\r\n    //    Let's handle basic types directly mapping to DB fields.\r\n\r\n    // Scenario 1: Source is Father of Target\r\n    if (payload.type === 'father') {\r\n        await updateDoc(doc(db, `users/${ownerId}/family_members/${payload.targetId}`), {\r\n            fatherId: payload.sourceId\r\n        });\r\n    }\r\n    // Scenario 2: Source is Mother of Target\r\n    else if (payload.type === 'mother') {\r\n        await updateDoc(doc(db, `users/${ownerId}/family_members/${payload.targetId}`), {\r\n            motherId: payload.sourceId\r\n        });\r\n    }\r\n    // Scenario 3: Source is Spouse of Target\r\n    else if (payload.type === 'spouse') {\r\n        // Bi-directional for spouse\r\n        await updateDoc(doc(db, `users/${ownerId}/family_members/${payload.sourceId}`), {\r\n            spouseId: payload.targetId\r\n        });\r\n        await updateDoc(doc(db, `users/${ownerId}/family_members/${payload.targetId}`), {\r\n            spouseId: payload.sourceId\r\n        });\r\n    }\r\n};\r\n\r\n/**\r\n * Remove a specific relationship link\r\n */\r\nexport const removeRelationship = async (ownerId: string, memberId: string, relationField: 'fatherId' | 'motherId' | 'spouseId') => {\r\n    // If spouse, remove from both\r\n    if (relationField === 'spouseId') {\r\n        const member = await getFamilyMember(ownerId, memberId);\r\n        if (member && member.spouseId) {\r\n            await updateDoc(doc(db, `users/${ownerId}/family_members/${member.spouseId}`), {\r\n                spouseId: '' // or deleteField()\r\n            });\r\n        }\r\n    }\r\n\r\n    await updateDoc(doc(db, `users/${ownerId}/family_members/${memberId}`), {\r\n        [relationField]: ''\r\n    });\r\n};\r\n\r\n\r\n// --- STRATEGIC LIFE BEACON (Passive Care) LOGIC ---\r\n\r\n/**\r\n * MOCK: Simulated cron job logic triggered by the system.\r\n * In a real app, this would be a Cloud Function (cron) checking everyone's lastActive.\r\n */\r\nexport const checkVitalityTrigger = async (userId: string) => {\r\n    console.log(`[Life Beacon] Running vitality check for system user: ${userId}`);\r\n    // Logic: \r\n    // 1. Fetch all family members.\r\n    // 2. Identify seniors (Grandfather/Grandmother).\r\n    // 3. Compare lastActive timestamp with threshold (12h/24h/48h).\r\n    // 4. If overdue -> push alert to family owner.\r\n    return { status: 'monitoring', timestamp: new Date().toISOString() };\r\n};\r\n\r\n/**\r\n * MOCK: Update user activity timestamp.\r\n * Called whenever the user interacts with the app.\r\n */\r\nexport const updateLastActive = async (userId: string) => {\r\n    const memberRef = doc(db, `users/${userId}/family_members/${userId}`);\r\n    const now = new Date().toISOString();\r\n    await updateDoc(memberRef, {\r\n        lastActive: now,\r\n        safetyStatus: 'safe' // Reset danger status if they are active\r\n    });\r\n    console.log(`[Life Beacon] Activity recorded for ${userId} at ${now}`);\r\n};\r\n\r\n/**\r\n * MOCK: Explicit \"I'm OK\" check-in from the dashboard.\r\n */\r\nexport const pulseCheckIn = async (userId: string) => {\r\n    await updateLastActive(userId);\r\n    // Potential for rewarding with XP for being proactive\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\services\\financeService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'pastPayments' is assigned a value but never used.","line":151,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":151,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userId' is defined but never used.","line":548,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":548,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'debtId' is defined but never used.","line":548,"column":50,"nodeType":null,"messageId":"unusedVar","endLine":548,"endColumn":56}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { db } from \"@/firebaseConfig\";\r\n// Finance Service V13\r\nimport { collection, doc, getDoc, getDocs, setDoc, addDoc, deleteDoc, query, orderBy, limit, where, arrayUnion, onSnapshot } from \"firebase/firestore\";\r\nimport { getLocalTodayStr } from \"@/lib/dateUtils\";\r\n\r\nexport interface Transaction {\r\n    id: string;\r\n    title: string;\r\n    amount: number; // positive for income, negative for expense (or check type)\r\n    type: 'income' | 'expense';\r\n    category: string;\r\n    date: string;\r\n    icon: string;\r\n    currency?: 'UZS' | 'USD' | 'EUR' | 'RUB';\r\n    originalAmount?: number;\r\n    // V17 Credit Logic\r\n    isLiability?: boolean; // If true, this income is NOT Profit, it's Debt Inflow\r\n    isDebtRepayment?: boolean; // If true, this expense is Principal Repayment (not loss)\r\n    principalAmount?: number;\r\n    interestAmount?: number;\r\n    // V18 Deposit Logic\r\n    isTransfer?: boolean; // If true, this transaction is a neutral transfer (Wallet <-> Deposit), Balance unchanged.\r\n}\r\n\r\nexport interface DebtItem {\r\n    id: string;\r\n    type: 'i_owe' | 'owed_to_me'; // 'Men Qarzdorman' | 'Mendan Qarz'\r\n    person: string;\r\n    amount: number;\r\n    currency: 'UZS' | 'USD' | 'EUR' | 'RUB';\r\n    date: string;\r\n    deadline?: string;\r\n    description?: string;\r\n    status: 'active' | 'paid' | 'partial';\r\n    repaymentHistory: { date: string; amount: number; }[];\r\n    totalRepaid: number;\r\n}\r\n\r\nexport interface CreditItem {\r\n    id?: string;\r\n    title: string;\r\n    totalAmount: number;\r\n    remainingAmount: number;\r\n    monthlyPayment: number;\r\n    paymentDay: number;\r\n    currency: 'UZS' | 'USD' | 'EUR' | 'RUB';\r\n    startDate: string;\r\n    nextPaymentDate: string;\r\n    status: 'active' | 'paid';\r\n    // V14 Banking Logic\r\n    interestRate?: number; // Annual %\r\n    termMonths?: number;\r\n    calculationMethod?: 'annuity' | 'differential';\r\n    schedule?: { date: string; payment: number; interest: number; principal: number; remaining: number }[];\r\n    history?: { date: string; amount: number }[];\r\n    historical?: {\r\n        initialAmount: number;\r\n        monthsPassed: number;\r\n        isHistorical: boolean;\r\n    };\r\n}\r\n\r\nexport interface DepositItem {\r\n    id?: string;\r\n    title: string;\r\n    currentAmount: number;\r\n    goalAmount?: number;\r\n    monthlyContribution: number;\r\n    contributionDay: number;\r\n    currency: 'UZS' | 'USD' | 'EUR' | 'RUB';\r\n    startDate: string;\r\n    // V14 & V16 Banking Logic\r\n    interestRate?: number; // Annual %\r\n    termMonths?: number; // New: Investment Term\r\n    isMonthlyInterest?: boolean; // New: Monthly Payout vs End of Term\r\n    payoutHistory?: { date: string; amount: number; status: 'pending' | 'received' }[]; // New: Track payouts\r\n    history?: { date: string; amount: number }[];\r\n    historical?: {\r\n        initialAmount: number;\r\n        accruedInterest: number;\r\n        monthsPassed: number;\r\n    };\r\n}\r\n\r\n// --- V14 Calculation Helpers ---\r\nexport const calculateAnnuitySchedule = (principal: number, annualRate: number, months: number, startDate: Date) => {\r\n    const monthlyRate = annualRate / 12 / 100;\r\n    // Standard Annuity Formula: P * (r * (1+r)^n) / ((1+r)^n - 1)\r\n    const monthlyPayment = principal * (monthlyRate * Math.pow(1 + monthlyRate, months)) / (Math.pow(1 + monthlyRate, months) - 1);\r\n\r\n    let balance = principal;\r\n    const schedule = [];\r\n\r\n    for (let i = 1; i <= months; i++) {\r\n        const interest = balance * monthlyRate;\r\n        const principalPart = monthlyPayment - interest;\r\n        balance -= principalPart;\r\n\r\n        const date = new Date(startDate);\r\n        date.setMonth(date.getMonth() + i);\r\n\r\n        schedule.push({\r\n            date: date.toISOString().split('T')[0],\r\n            payment: monthlyPayment,\r\n            interest: interest,\r\n            principal: principalPart,\r\n            remaining: Math.max(0, balance)\r\n        });\r\n    }\r\n    return schedule;\r\n};\r\n\r\nexport const calculateDifferentialSchedule = (principal: number, annualRate: number, months: number, startDate: Date) => {\r\n    const monthlyRate = annualRate / 12 / 100;\r\n    const principalPart = principal / months;\r\n\r\n    let balance = principal;\r\n    const schedule = [];\r\n\r\n    for (let i = 1; i <= months; i++) {\r\n        const interest = balance * monthlyRate;\r\n        const payment = principalPart + interest;\r\n        balance -= principalPart;\r\n\r\n        const date = new Date(startDate);\r\n        date.setMonth(date.getMonth() + i);\r\n\r\n        schedule.push({\r\n            date: date.toISOString().split('T')[0],\r\n            payment: payment,\r\n            interest: interest,\r\n            principal: principalPart,\r\n            remaining: Math.max(0, balance)\r\n        });\r\n    }\r\n    return schedule;\r\n};\r\n\r\nexport const calculateHistoricalLoan = (principal: number, annualRate: number, termMonths: number, startDate: string, method: 'annuity' | 'differential' = 'annuity') => {\r\n    const start = new Date(startDate);\r\n    const now = new Date();\r\n    // Calculate months passed\r\n    let monthsPassed = (now.getFullYear() - start.getFullYear()) * 12 + (now.getMonth() - start.getMonth());\r\n    monthsPassed = Math.max(0, monthsPassed);\r\n\r\n    const schedule = method === 'annuity'\r\n        ? calculateAnnuitySchedule(principal, annualRate, termMonths, start)\r\n        : calculateDifferentialSchedule(principal, annualRate, termMonths, start);\r\n\r\n    // Past payments are those with index < monthsPassed\r\n    const pastPayments = schedule.slice(0, monthsPassed);\r\n    const futurePayments = schedule.slice(monthsPassed);\r\n\r\n    // Determine current remaining principal from the schedule\r\n    let currentRemaining = 0;\r\n    if (monthsPassed >= termMonths) {\r\n        currentRemaining = 0;\r\n    } else if (monthsPassed === 0) {\r\n        currentRemaining = principal;\r\n    } else {\r\n        // The remaining amount AFTER the last past payment\r\n        currentRemaining = schedule[monthsPassed - 1].remaining;\r\n    }\r\n\r\n    const nextPaymentDate = futurePayments.length > 0 ? futurePayments[0].date : null;\r\n    const progress = Math.min(100, (monthsPassed / termMonths) * 100);\r\n\r\n    return {\r\n        initialAmount: principal,\r\n        currentRemaining,\r\n        monthsPassed,\r\n        progress,\r\n        nextPaymentDate,\r\n        isHistorical: monthsPassed > 0\r\n    };\r\n};\r\n\r\nexport const calculateHistoricalDeposit = (principal: number, annualRate: number, termMonths: number, startDate: string, capitalization: boolean) => {\r\n    const start = new Date(startDate);\r\n    const now = new Date();\r\n    let monthsPassed = (now.getFullYear() - start.getFullYear()) * 12 + (now.getMonth() - start.getMonth());\r\n    monthsPassed = Math.max(0, monthsPassed);\r\n\r\n    // Monthly interest logic\r\n    const monthlyRate = annualRate / 12 / 100;\r\n    let accruedInterest = 0;\r\n    let currentAmount = principal;\r\n\r\n    if (capitalization) {\r\n        // Compound interest: A = P * (1 + r)^n\r\n        // If passed term, cap at term\r\n        const calcMonths = Math.min(monthsPassed, termMonths);\r\n        const amountWithInterest = principal * Math.pow(1 + monthlyRate, calcMonths);\r\n        accruedInterest = amountWithInterest - principal;\r\n        currentAmount = amountWithInterest;\r\n    } else {\r\n        // Simple interest paid out\r\n        const calcMonths = Math.min(monthsPassed, termMonths);\r\n        const interestPerMonth = principal * monthlyRate;\r\n        accruedInterest = interestPerMonth * calcMonths;\r\n        currentAmount = principal;\r\n    }\r\n\r\n    return {\r\n        initialAmount: principal,\r\n        currentAmount,\r\n        accruedInterest,\r\n        monthsPassed,\r\n        progress: Math.min(100, (monthsPassed / termMonths) * 100)\r\n    };\r\n};\r\n\r\nexport const convertToUZS = (amount: number, currency: string, rates: { code: string, rate: number }[]): number => {\r\n    if (currency === 'UZS') return amount;\r\n    const rate = rates.find(r => r.code === currency)?.rate || 1;\r\n    return Math.round(amount * rate);\r\n};\r\n\r\nexport interface FinanceOverview {\r\n    totalBalance: number;\r\n    monthlyBudget: number; // For backward compatibility if needed\r\n    incomeBudget: number;  // Target monthly income\r\n    expenseBudget: number; // Max monthly expense\r\n    monthlyIncome: number; // Actual current income\r\n    monthlySpent: number;\r\n    savingsGoal: number;\r\n    currentSavings: number;\r\n    ultimateGoal?: {\r\n        target: number;\r\n        deadline: string;\r\n        title: string;\r\n        progress: number;\r\n        currency?: 'UZS' | 'USD' | 'EUR' | 'RUB';\r\n    };\r\n}\r\n\r\nconst getSubCollection = (userId: string, col: string) => collection(db, `users/${userId}/${col}`);\r\n\r\nexport const getFinanceOverview = async (userId: string): Promise<FinanceOverview | null> => {\r\n    const docRef = doc(db, `users/${userId}/finance/overview`);\r\n    const snap = await getDoc(docRef);\r\n    return snap.exists() ? snap.data() as FinanceOverview : null;\r\n};\r\n\r\nexport const subscribeToFinanceOverview = (userId: string, callback: (data: FinanceOverview | null) => void) => {\r\n    const docRef = doc(db, `users/${userId}/finance/overview`);\r\n    return onSnapshot(docRef, (snap) => {\r\n        if (snap.exists()) {\r\n            callback(snap.data() as FinanceOverview);\r\n        } else {\r\n            callback(null);\r\n        }\r\n    }, (error) => {\r\n        console.error(\"Error subscribing to finance overview:\", error);\r\n    });\r\n};\r\n\r\nexport const subscribeToTransactions = (userId: string, callback: (data: Transaction[]) => void) => {\r\n    const q = query(getSubCollection(userId, \"finance_transactions\"), orderBy(\"date\", \"desc\"), limit(50));\r\n    return onSnapshot(q, (snap) => {\r\n        const txs = snap.docs.map(d => ({ id: d.id, ...d.data() } as Transaction));\r\n        callback(txs);\r\n    }, (error) => {\r\n        console.error(\"Error subscribing to transactions:\", error);\r\n        // Fallback: Try without ordering if index is missing (though this changes UX, better than nothing)\r\n        // For now just log, as index creation is the fix.\r\n    });\r\n};\r\n\r\nexport const getTransactions = async (userId: string): Promise<Transaction[]> => {\r\n    try {\r\n        const q = query(getSubCollection(userId, \"finance_transactions\"), orderBy(\"date\", \"desc\"), limit(50));\r\n        const snap = await getDocs(q);\r\n        return snap.docs.map(d => ({ id: d.id, ...d.data() } as Transaction));\r\n    } catch (error) {\r\n        console.error(\"Error fetching transactions:\", error);\r\n        return [];\r\n    }\r\n};\r\n\r\n// NEW: Subscribe to transactions by date\r\nexport const subscribeToTransactionsByDate = (userId: string, date: string, callback: (data: Transaction[]) => void) => {\r\n    const q = query(\r\n        getSubCollection(userId, \"finance_transactions\"),\r\n        where(\"date\", \"==\", date)\r\n        // orderBy(\"createdAt\", \"desc\") // removed as createdAt field is missing in interface\r\n    );\r\n    // Note: if 'date' is exact string \"YYYY-MM-DD\", works.\r\n    // Ideally user stores date as \"YYYY-MM-DD\".\r\n\r\n    return onSnapshot(q, (snap) => {\r\n        const txs = snap.docs.map(d => ({ id: d.id, ...d.data() } as Transaction));\r\n        callback(txs);\r\n    }, (error) => {\r\n        console.error(\"Error subscribing to transactions by date:\", error);\r\n    });\r\n};\r\n\r\nexport const getTransactionsByDate = async (userId: string, date: string): Promise<Transaction[]> => {\r\n    // ... existing implementation ...\r\n    // Ideally we would index on date, but for now we can reuse the existing collection and query\r\n    const q = query(getSubCollection(userId, \"finance_transactions\"), where(\"date\", \"==\", date));\r\n    const snap = await getDocs(q);\r\n    return snap.docs.map(d => ({ id: d.id, ...d.data() } as Transaction));\r\n};\r\n\r\nexport const addTransaction = async (userId: string, transaction: Omit<Transaction, 'id'>) => {\r\n    // Ensure standard date format YYYY-MM-DD\r\n    const date = transaction.date.includes('T') ? transaction.date.split('T')[0] : transaction.date;\r\n    const rates = await getCurrencyRates();\r\n    const currency = transaction.currency || 'UZS';\r\n    const amountInUZS = convertToUZS(transaction.amount, currency, rates);\r\n\r\n    const finalTransaction = {\r\n        ...transaction,\r\n        amount: isNaN(amountInUZS) ? 0 : amountInUZS, // Store standardized UZS amount for stats\r\n        originalAmount: transaction.amount, // Store original input\r\n        currency,\r\n        date\r\n    };\r\n\r\n    await addDoc(getSubCollection(userId, \"finance_transactions\"), finalTransaction);\r\n\r\n    const overview = await getFinanceOverview(userId) || {\r\n        totalBalance: 0,\r\n        incomeBudget: 0,\r\n        expenseBudget: 0,\r\n        monthlyIncome: 0,\r\n        monthlySpent: 0,\r\n        savingsGoal: 0,\r\n        currentSavings: 0,\r\n        monthlyBudget: 0\r\n    };\r\n\r\n    let newBalance = overview.totalBalance;\r\n    let newSpent = overview.monthlySpent;\r\n    let newIncome = overview.monthlyIncome || 0;\r\n\r\n    // V18: Transfers do NOT affect Total Balance (Net Worth) or Budget Stats\r\n    // They are just records of movement.\r\n    if (!transaction.isTransfer) {\r\n        if (transaction.type === 'income') {\r\n            // V17: Debt Inflow (Liability) also doesn't count as \"Income\" for budget, \r\n            // but DOES increase Cash Balance? \r\n            // Wait, User said: \"Credit is Liability\". \r\n            // If I borrow 1000, my Cash +1000, Liability +1000. Net Worth same.\r\n            // So TotalBalance (Net Worth) should roughly stay same? \r\n            // AURA V1 definition: TotalBalance = \"All Money I Have\". \r\n            // So Borrowing INCREASES TotalBalance. \r\n            // BUT \"Profit\" (Monthly Income) should NOT increase.\r\n\r\n            newBalance += amountInUZS;\r\n            if (!transaction.isLiability) {\r\n                newIncome += amountInUZS;\r\n            }\r\n        } else {\r\n            // Expense\r\n            newBalance -= amountInUZS;\r\n            if (!transaction.isDebtRepayment) {\r\n                newSpent += amountInUZS;\r\n            }\r\n        }\r\n    }\r\n\r\n    await setDoc(doc(db, `users/${userId}/finance/overview`), {\r\n        ...overview,\r\n        totalBalance: newBalance,\r\n        monthlySpent: newSpent,\r\n        monthlyIncome: newIncome\r\n    });\r\n};\r\n\r\nexport const updateBudgets = async (userId: string, incomeBudget: number, expenseBudget: number) => {\r\n    const overview = await getFinanceOverview(userId);\r\n    if (!overview) return;\r\n    await setDoc(doc(db, `users/${userId}/finance/overview`), {\r\n        ...overview,\r\n        incomeBudget,\r\n        expenseBudget\r\n    });\r\n};\r\n\r\nexport const updateUltimateGoal = async (userId: string, goalData: { target: number, deadline: string, title?: string, currency?: 'UZS' | 'USD' | 'EUR' | 'RUB' }) => {\r\n    const overview = await getFinanceOverview(userId);\r\n    if (!overview) return;\r\n\r\n    await setDoc(doc(db, `users/${userId}/finance/overview`), {\r\n        ...overview,\r\n        ultimateGoal: {\r\n            ...overview.ultimateGoal,\r\n            target: goalData.target,\r\n            deadline: goalData.deadline,\r\n            title: goalData.title || overview.ultimateGoal?.title || 'Financial Freedom',\r\n            progress: overview.ultimateGoal?.progress || 0,\r\n            currency: goalData.currency || overview.ultimateGoal?.currency || 'USD'\r\n        }\r\n    });\r\n};\r\n\r\nexport const getCurrencyRates = async () => {\r\n    // In production, this would fetch from an API like CBU.UZ or a free exchange rate API\r\n    // For now, we return real-time-ish mock data targeted at UZS (Uzbekistan market)\r\n    return [\r\n        { code: 'USD', rate: 12850, icon: 'ЁЯЗ║ЁЯЗ╕', trend: 'up' },\r\n        { code: 'EUR', rate: 13920, icon: 'ЁЯЗкЁЯЗ║', trend: 'down' },\r\n        { code: 'RUB', rate: 142, icon: 'ЁЯЗ╖ЁЯЗ║', trend: 'up' },\r\n    ];\r\n};\r\n\r\nexport const getStatisticsByRange = async (userId: string, startDate: string, endDate: string) => {\r\n    const q = query(\r\n        getSubCollection(userId, \"finance_transactions\"),\r\n        where(\"date\", \">=\", startDate),\r\n        where(\"date\", \"<=\", endDate),\r\n        orderBy(\"date\", \"desc\")\r\n    );\r\n    const snap = await getDocs(q);\r\n    const txs = snap.docs.map(d => ({ id: d.id, ...d.data() } as Transaction));\r\n\r\n    // Aggregate by category and type\r\n    const stats = {\r\n        income: {} as Record<string, number>,\r\n        expense: {} as Record<string, number>,\r\n        totalIncome: 0,\r\n        totalExpense: 0,\r\n        transactions: [] as Transaction[]\r\n    };\r\n\r\n    txs.forEach(t => {\r\n        const cat = t.category || 'Other';\r\n        if (t.type === 'income') {\r\n            // V17: Exclude Debt Inflows from \"Profit\" calculation\r\n            if (!t.isLiability) {\r\n                stats.income[cat] = (stats.income[cat] || 0) + t.amount;\r\n                stats.totalIncome += t.amount;\r\n            }\r\n        } else {\r\n            // Exclude Principal Repayment from \"Expense\" calculation (Net Worth neutral) - Optional based on user pref\r\n            // User said: \"Principal: Reduces Debt (Liability), Interest: Expense.\"\r\n            // So Principal should ideally NOT be in totalExpense (Profit/Loss).\r\n            if (!t.isDebtRepayment) {\r\n                stats.expense[cat] = (stats.expense[cat] || 0) + t.amount;\r\n                stats.totalExpense += t.amount;\r\n            }\r\n        }\r\n    });\r\n\r\n    stats.transactions = txs;\r\n    return stats;\r\n};\r\n\r\nexport const seedFinanceData = async (userId: string): Promise<FinanceOverview> => {\r\n    // Seed Overview - Zero State\r\n    const overview: FinanceOverview = {\r\n        totalBalance: 0,\r\n        incomeBudget: 0,\r\n        expenseBudget: 0,\r\n        monthlyIncome: 0,\r\n        monthlySpent: 0,\r\n        savingsGoal: 0,\r\n        currentSavings: 0,\r\n        monthlyBudget: 0,\r\n        ultimateGoal: {\r\n            title: \"Mening Asosiy Maqsadim\",\r\n            target: 0,\r\n            deadline: new Date(new Date().setFullYear(new Date().getFullYear() + 1)).toISOString().split('T')[0],\r\n            progress: 0\r\n        }\r\n    };\r\n\r\n    await setDoc(doc(db, `users/${userId}/finance/overview`), overview);\r\n\r\n    // No initial transactions for clean slate\r\n    return overview;\r\n};\r\n\r\n// --- DEBT MANAGEMENT (V12) ---\r\n\r\nexport const addDebt = async (userId: string, debt: Omit<DebtItem, 'id'>) => {\r\n    try {\r\n        await addDoc(getSubCollection(userId, \"finance_debts\"), debt);\r\n    } catch (e) {\r\n        console.error(\"Error adding debt: \", e);\r\n    }\r\n};\r\n\r\nexport const subscribeToDebts = (userId: string, callback: (data: DebtItem[]) => void) => {\r\n    const q = query(getSubCollection(userId, \"finance_debts\"), orderBy(\"date\", \"desc\"));\r\n    return onSnapshot(q, (snap) => {\r\n        callback(snap.docs.map(d => ({ id: d.id, ...d.data() } as DebtItem)));\r\n    }, (error) => {\r\n        console.error(\"Error subscribing to debts:\", error);\r\n    });\r\n};\r\n\r\nexport const getDebts = async (userId: string) => {\r\n    try {\r\n        const q = query(getSubCollection(userId, \"finance_debts\"), orderBy(\"date\", \"desc\"));\r\n        const snap = await getDocs(q);\r\n        return snap.docs.map(d => ({ id: d.id, ...d.data() } as DebtItem));\r\n    } catch (e) {\r\n        console.error(\"Error fetching debts: \", e);\r\n        return [];\r\n    }\r\n};\r\n\r\nexport const updateDebt = async (userId: string, debtId: string, updates: Partial<DebtItem>) => {\r\n    try {\r\n        const ref = doc(db, `users/${userId}/finance_debts/${debtId}`);\r\n        await setDoc(ref, updates, { merge: true });\r\n    } catch (e) {\r\n        console.error(\"Error updating debt: \", e);\r\n    }\r\n};\r\n\r\nexport const repayDebt = async (userId: string, debt: DebtItem, amount: number, isFullRepayment: boolean) => {\r\n    try {\r\n        // 1. Update Debt Record\r\n        const debtRef = doc(db, `users/${userId}/finance_debts/${debt.id}`);\r\n        await setDoc(debtRef, {\r\n            status: isFullRepayment ? 'paid' : 'partial',\r\n            totalRepaid: (debt.totalRepaid || 0) + amount,\r\n            repaymentHistory: [...(debt.repaymentHistory || []), { date: new Date().toISOString(), amount }]\r\n        }, { merge: true });\r\n\r\n        // 2. Add Transaction for Cash Flow (Real Data)\r\n        // If 'i_owe' (Liability) -> I paid money -> Expense (or just negative balance flow)\r\n        // If 'owed_to_me' (Asset) -> I received money -> Income (or positive balance flow)\r\n\r\n        // NOTE: We categorize this as 'Debt Repayment' so it doesn't mess up \"Business Income\" stats if user desires, \r\n        // but for now we treat it as Cash Flow.\r\n\r\n        await addTransaction(userId, {\r\n            title: `${debt.type === 'i_owe' ? 'Qarz to\\'landi' : 'Qarz qaytarildi'}: ${debt.person}`,\r\n            amount: amount,\r\n            type: debt.type === 'i_owe' ? 'expense' : 'income',\r\n            category: 'Debt',\r\n            date: new Date().toISOString().split('T')[0],\r\n            icon: debt.type === 'i_owe' ? 'ЁЯУЙ' : 'ЁЯУИ',\r\n            currency: debt.currency\r\n        });\r\n\r\n    } catch (e) {\r\n        console.error(\"Error repaying debt: \", e);\r\n    }\r\n};\r\n\r\nexport const deleteDebt = async (userId: string, debtId: string) => {\r\n    // Requires deleteDoc import if needed, for now placeholder or handle in future\r\n};\r\n\r\n// --- V13 Credits (Loans) ---\r\nexport const addCredit = async (userId: string, credit: CreditItem) => {\r\n    try {\r\n        await addDoc(collection(db, `users/${userId}/finance_credits`), credit);\r\n    } catch (e) {\r\n        console.error(\"Error adding credit: \", e);\r\n    }\r\n};\r\n\r\nexport const subscribeToCredits = (userId: string, callback: (data: CreditItem[]) => void) => {\r\n    const q = query(collection(db, `users/${userId}/finance_credits`));\r\n    return onSnapshot(q, (snap) => {\r\n        callback(snap.docs.map(d => ({ id: d.id, ...d.data() } as CreditItem)));\r\n    }, (error) => {\r\n        console.error(\"Error subscribing to credits:\", error);\r\n    });\r\n};\r\n\r\nexport const getCredits = async (userId: string): Promise<CreditItem[]> => {\r\n    try {\r\n        const q = query(collection(db, `users/${userId}/finance_credits`));\r\n        const snapshot = await getDocs(q);\r\n        return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as CreditItem));\r\n    } catch (e) {\r\n        console.error(\"Error fetching credits: \", e);\r\n        return [];\r\n    }\r\n};\r\n\r\nexport const payCredit = async (userId: string, credit: CreditItem, amount: number) => {\r\n    try {\r\n        const creditRef = doc(db, `users/${userId}/finance_credits/${credit.id}`);\r\n        const newRemaining = Math.max(0, credit.remainingAmount - amount);\r\n        const status = newRemaining === 0 ? 'paid' : 'active';\r\n\r\n        // Calculate next month's payment date\r\n        const nextDate = new Date();\r\n        nextDate.setMonth(nextDate.getMonth() + 1);\r\n        nextDate.setDate(Math.min(credit.paymentDay, 28)); // Simple logic, can be improved\r\n\r\n        await setDoc(creditRef, {\r\n            remainingAmount: newRemaining,\r\n            status,\r\n            nextPaymentDate: nextDate.toISOString().split('T')[0],\r\n            history: arrayUnion({ date: new Date().toISOString(), amount })\r\n        }, { merge: true });\r\n\r\n        // Add Expense Transaction\r\n        await addTransaction(userId, {\r\n            title: `Kredit To'lovi: ${credit.title}`,\r\n            amount: amount,\r\n            type: 'expense',\r\n            category: 'Credit',\r\n            date: new Date().toISOString().split('T')[0],\r\n            icon: 'ЁЯПж',\r\n            currency: credit.currency\r\n        });\r\n\r\n    } catch (e) {\r\n        console.error(\"Error paying credit: \", e);\r\n    }\r\n};\r\n\r\nexport const updateCredit = async (userId: string, creditId: string, updates: Partial<CreditItem>) => {\r\n    try {\r\n        const ref = doc(db, `users/${userId}/finance_credits/${creditId}`);\r\n        await setDoc(ref, updates, { merge: true });\r\n    } catch (e) {\r\n        console.error(\"Error updating credit: \", e);\r\n    }\r\n};\r\n\r\n// --- V13 Deposits (Savings) ---\r\nexport const addDeposit = async (userId: string, deposit: DepositItem) => {\r\n    try {\r\n        await addDoc(collection(db, `users/${userId}/finance_deposits`), deposit);\r\n    } catch (e) {\r\n        console.error(\"Error adding deposit: \", e);\r\n    }\r\n};\r\n\r\nexport const updateDeposit = async (userId: string, depositId: string, data: Partial<DepositItem>) => {\r\n    try {\r\n        const depositRef = doc(db, `users/${userId}/finance_deposits/${depositId}`);\r\n        await setDoc(depositRef, data, { merge: true });\r\n    } catch (e) {\r\n        console.error(\"Error updating deposit: \", e);\r\n    }\r\n};\r\n\r\nexport const deleteDeposit = async (userId: string, depositId: string) => {\r\n    try {\r\n        await deleteDoc(doc(db, `users/${userId}/finance_deposits/${depositId}`));\r\n    } catch (e) {\r\n        console.error(\"Error deleting deposit: \", e);\r\n    }\r\n};\r\n\r\n\r\nexport const subscribeToDeposits = (userId: string, callback: (data: DepositItem[]) => void) => {\r\n    const q = query(collection(db, `users/${userId}/finance_deposits`));\r\n    return onSnapshot(q, (snap) => {\r\n        callback(snap.docs.map(d => ({ id: d.id, ...d.data() } as DepositItem)));\r\n    }, (error) => {\r\n        console.error(\"Error subscribing to deposits:\", error);\r\n    });\r\n};\r\n\r\nexport const getDeposits = async (userId: string): Promise<DepositItem[]> => {\r\n    try {\r\n        const q = query(collection(db, `users/${userId}/finance_deposits`));\r\n        const snapshot = await getDocs(q);\r\n        return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as DepositItem));\r\n    } catch (e) {\r\n        console.error(\"Error fetching deposits: \", e);\r\n        return [];\r\n    }\r\n};\r\n\r\nexport const addFundsToDeposit = async (userId: string, deposit: DepositItem, amount: number, isFromBalance: boolean) => {\r\n    try {\r\n        const depositRef = doc(db, `users/${userId}/finance_deposits/${deposit.id}`);\r\n\r\n        await setDoc(depositRef, {\r\n            currentAmount: (deposit.currentAmount || 0) + amount,\r\n            history: arrayUnion({ date: new Date().toISOString(), amount, type: 'deposit' })\r\n        }, { merge: true });\r\n\r\n        // If from balance, it's a TRANSFER (Wallet -> Deposit)\r\n        // If from outside (new money), it's INCOME (but we handle that logic in UI usually, \r\n        // effectively if it's 'New Money' it increases Total Balance. \r\n        // If 'From Balance', Total Balance stays same.\r\n\r\n        await addTransaction(userId, {\r\n            title: `Omonatga To'ldirish: ${deposit.title}`,\r\n            amount: amount,\r\n            type: isFromBalance ? 'expense' : 'income',\r\n            // If from balance: Expense (Transfer) to reduce \"Cash\", but isTransfer=true so TotalBalance unchanged? \r\n            // WAIT. If I move 100 from Cash to Deposit. \r\n            // Cash -100. Deposit +100. Total Balance (Cash+Deposit) = Same.\r\n            // Our 'addTransaction' reduces TotalBalance if type='expense' & !isTransfer.\r\n            // If isTransfer=true, addTransaction does NOTHING to TotalBalance.\r\n            // BUT we want to track that \"Cash\" wallet decreased? \r\n            // Current App architecture: \"TotalBalance\" IS the wallet. \r\n            // Actually, AURA V1 Architecture: TotalBalance derived from Overview. \r\n            // If we use isTransfer=true, TotalBalance doesn't change. \r\n            // This is correct for \"Net Worth\". \r\n            // But if \"TotalBalance\" implies \"Liquid Cash\", then it SHOULD decrease.\r\n            // User Request: \"Omonat Hamyoni (+), Asosiy Hamyon (-). Jami boylik o'zgarmaydi.\"\r\n            // So: addTransaction should NOT change TotalBalance. \r\n            // Hence isTransfer=true is correct.\r\n\r\n            isTransfer: isFromBalance, // Only if from balance is it a neutral transfer\r\n            category: 'Savings',\r\n            date: getLocalTodayStr(),\r\n            icon: 'ЁЯУе',\r\n            currency: deposit.currency\r\n        });\r\n\r\n    } catch (e) {\r\n        console.error(\"Error adding funds to deposit: \", e);\r\n    }\r\n};\r\n\r\nexport const withdrawFromDeposit = async (userId: string, deposit: DepositItem, amount: number) => {\r\n    try {\r\n        const depositRef = doc(db, `users/${userId}/finance_deposits/${deposit.id}`);\r\n        // Prevent negative\r\n        const newAmount = Math.max(0, (deposit.currentAmount || 0) - amount);\r\n\r\n        await setDoc(depositRef, {\r\n            currentAmount: newAmount,\r\n            history: arrayUnion({ date: getLocalTodayStr(), amount, type: 'withdrawal' })\r\n        }, { merge: true });\r\n\r\n        // Withdrawal = Transfer from Deposit to Wallet\r\n        // Wallet (+), Deposit (-). Total Balance Same.\r\n        // Transaction: type='income' (to Wallet), isTransfer=true.\r\n\r\n        await addTransaction(userId, {\r\n            title: `Omonatdan Yechish: ${deposit.title}`,\r\n            amount: amount,\r\n            type: 'income',\r\n            isTransfer: true,\r\n            category: 'Savings',\r\n            date: getLocalTodayStr(),\r\n            icon: 'ЁЯУд',\r\n            currency: deposit.currency\r\n        });\r\n\r\n    } catch (e) {\r\n        console.error(\"Error withdrawing from deposit: \", e);\r\n    }\r\n};\r\n\r\nexport const addProfitToDeposit = async (userId: string, deposit: DepositItem, amount: number) => {\r\n    try {\r\n        const depositRef = doc(db, `users/${userId}/finance_deposits/${deposit.id}`);\r\n\r\n        await setDoc(depositRef, {\r\n            currentAmount: (deposit.currentAmount || 0) + amount,\r\n            history: arrayUnion({ date: new Date().toISOString(), amount, type: 'profit' })\r\n        }, { merge: true });\r\n\r\n        // Profit = Actual Income (Net Worth Increases)\r\n        // Deposit (+), Wallet (0). Net Worth (+).\r\n        // Transaction: type='income', isTransfer=FALSE (It is profit).\r\n\r\n        await addTransaction(userId, {\r\n            title: `Omonat Foydasi: ${deposit.title}`,\r\n            amount: amount,\r\n            type: 'income',\r\n            isTransfer: false, // Increases Net Worth\r\n            category: 'Investment', // Or 'Savings'\r\n            date: new Date().toISOString().split('T')[0],\r\n            icon: 'ЁЯУИ',\r\n            currency: deposit.currency\r\n        });\r\n\r\n    } catch (e) {\r\n        console.error(\"Error adding profit to deposit: \", e);\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\services\\focusService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[700,703],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[700,703],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { db } from '@/firebaseConfig';\r\nimport { collection, doc, addDoc, updateDoc, getDocs, query, where, orderBy, Timestamp } from 'firebase/firestore';\r\n\r\nexport interface FocusSession {\r\n    id: string;\r\n    taskId?: string;\r\n    taskName?: string;\r\n    duration: number; // minutes\r\n    status: 'running' | 'completed' | 'failed' | 'cancelled';\r\n    distractions: number;\r\n    startedAt: Date;\r\n    endedAt?: Date;\r\n}\r\n\r\nconst getSubCollection = (userId: string) => collection(db, `users/${userId}/focus_sessions`);\r\n\r\nexport const startFocusSession = async (\r\n    userId: string,\r\n    duration: number,\r\n    taskId?: string,\r\n    taskName?: string\r\n): Promise<string> => {\r\n    const session: any = {\r\n        duration,\r\n        status: 'running',\r\n        distractions: 0,\r\n        startedAt: new Date()\r\n    };\r\n\r\n    if (taskId) session.taskId = taskId;\r\n    if (taskName) session.taskName = taskName;\r\n\r\n    const docRef = await addDoc(getSubCollection(userId), {\r\n        ...session,\r\n        startedAt: Timestamp.fromDate(session.startedAt)\r\n    });\r\n\r\n    return docRef.id;\r\n};\r\n\r\nexport const endFocusSession = async (\r\n    userId: string,\r\n    sessionId: string,\r\n    status: 'completed' | 'failed' | 'cancelled',\r\n    distractions: number = 0\r\n): Promise<void> => {\r\n    const docRef = doc(db, `users/${userId}/focus_sessions/${sessionId}`);\r\n    await updateDoc(docRef, {\r\n        status,\r\n        distractions,\r\n        endedAt: Timestamp.fromDate(new Date())\r\n    });\r\n};\r\n\r\nexport const incrementDistraction = async (userId: string, sessionId: string, currentCount: number): Promise<void> => {\r\n    const docRef = doc(db, `users/${userId}/focus_sessions/${sessionId}`);\r\n    await updateDoc(docRef, {\r\n        distractions: currentCount + 1\r\n    });\r\n};\r\n\r\nexport const getFocusHistory = async (userId: string, limit: number = 10): Promise<FocusSession[]> => {\r\n    try {\r\n        const q = query(\r\n            getSubCollection(userId),\r\n            orderBy('startedAt', 'desc')\r\n        );\r\n\r\n        const snapshot = await getDocs(q);\r\n        return snapshot.docs.slice(0, limit).map(doc => ({\r\n            id: doc.id,\r\n            ...doc.data(),\r\n            ...doc.data(),\r\n            startedAt: doc.data().startedAt?.toDate ? doc.data().startedAt.toDate() : new Date(doc.data().startedAt),\r\n            endedAt: doc.data().endedAt?.toDate ? doc.data().endedAt.toDate() : (doc.data().endedAt ? new Date(doc.data().endedAt) : undefined)\r\n        })) as FocusSession[];\r\n    } catch (error) {\r\n        console.error(\"Error getting focus history:\", error);\r\n        return [];\r\n    }\r\n};\r\n\r\nexport const getTodayFocusStats = async (userId: string): Promise<{ totalMinutes: number; sessions: number; completed: number }> => {\r\n    try {\r\n        const today = new Date();\r\n        today.setHours(0, 0, 0, 0);\r\n\r\n        const q = query(\r\n            getSubCollection(userId),\r\n            where('startedAt', '>=', Timestamp.fromDate(today))\r\n        );\r\n\r\n        const snapshot = await getDocs(q);\r\n        const sessions = snapshot.docs.map(doc => doc.data());\r\n\r\n        const completed = sessions.filter(s => s.status === 'completed');\r\n        const totalMinutes = completed.reduce((sum, s) => sum + (s.duration || 0), 0);\r\n\r\n        return {\r\n            totalMinutes,\r\n            sessions: sessions.length,\r\n            completed: completed.length\r\n        };\r\n    } catch (error) {\r\n        console.error(\"Error getting today focus stats:\", error);\r\n        return { totalMinutes: 0, sessions: 0, completed: 0 };\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\services\\foodService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\services\\groqService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\services\\healthService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\services\\interestsService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'orderBy' is defined but never used.","line":2,"column":77,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":84},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'limit' is defined but never used.","line":2,"column":86,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":91},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'deleteDoc' is defined but never used.","line":2,"column":93,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":102}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { db } from \"@/firebaseConfig\";\r\nimport { collection, doc, getDoc, getDocs, setDoc, updateDoc, query, where, orderBy, limit, deleteDoc, arrayUnion, onSnapshot, addDoc } from \"firebase/firestore\";\r\n\r\nexport interface Interest {\r\n    id: string;\r\n    name: string;\r\n    category: string;\r\n    type: 'positive' | 'negative';\r\n    level: number; // 1-10\r\n    progress: number; // 0-100% to next level\r\n    totalHours: number;\r\n    image: string;\r\n    trackingMode?: 'frequency' | 'binary'; // default frequency\r\n}\r\n\r\nexport interface AIRec {\r\n    recommendation: string;\r\n    reason: string;\r\n    emoji: string;\r\n    category?: string;\r\n    type: 'growth' | 'correction';\r\n    feedback?: 'like' | 'dislike';\r\n    isAddedToTasks?: boolean;\r\n    taskId?: string;\r\n    isDone?: boolean;\r\n}\r\n\r\nexport interface DailyRecs {\r\n    morning: AIRec[];\r\n    lunch: AIRec[];\r\n    evening: AIRec[];\r\n    habitAdvice?: string;\r\n}\r\n\r\nexport interface InterestsData {\r\n    stats: {\r\n        totalActive: number;\r\n        learningStreak: number;\r\n    };\r\n    hobbies: Interest[];\r\n    dailyRecs?: {\r\n        [date: string]: DailyRecs;\r\n    };\r\n}\r\n\r\nconst getDocRef = (userId: string) => doc(db, `users/${userId}/interests/data`);\r\n\r\nexport const getInterestsData = async (userId: string): Promise<InterestsData | null> => {\r\n    const docRef = doc(db, `users/${userId}/interests/data`);\r\n    const snap = await getDoc(docRef);\r\n    return snap.exists() ? snap.data() as InterestsData : null;\r\n};\r\n\r\nexport const subscribeToInterestsData = (userId: string, callback: (data: InterestsData) => void) => {\r\n    const docRef = doc(db, `users/${userId}/interests/data`);\r\n    return onSnapshot(docRef, (snap) => {\r\n        if (snap.exists()) callback(snap.data() as InterestsData);\r\n    });\r\n};\r\n\r\nexport const addInterest = async (userId: string, interest: Interest) => {\r\n    const ref = getDocRef(userId);\r\n    // Add to hobbies array\r\n    // Also, we might want to increment totalActive in stats, but usually stats are derived. \r\n    // For simplicity, we'll just push to array for now. \r\n    // In a real app we might fetch-modify-save or use transactions.\r\n    await updateDoc(ref, {\r\n        hobbies: arrayUnion(interest)\r\n    });\r\n};\r\n\r\nexport const updateInterestProgress = async (userId: string, interestId: string, hours: number) => {\r\n    const ref = getDocRef(userId);\r\n    const snap = await getDoc(ref);\r\n    if (!snap.exists()) return;\r\n\r\n    const data = snap.data() as InterestsData;\r\n    const hobbies = data.hobbies.map(h => {\r\n        if (h.id === interestId) {\r\n            // Simplified level up logic: 10 hours = 1 level\r\n            const newTotal = h.totalHours + hours;\r\n            const newLevel = Math.floor(newTotal / 10) + 1;\r\n            const newProgress = Math.min(100, ((newTotal % 10) / 10) * 100);\r\n\r\n            return {\r\n                ...h,\r\n                totalHours: Number(newTotal.toFixed(1)),\r\n                level: newLevel,\r\n                progress: newProgress\r\n            };\r\n        }\r\n        return h;\r\n    });\r\n\r\n    await updateDoc(ref, { hobbies });\r\n};\r\n\r\nexport const seedInterestsData = async (userId: string): Promise<InterestsData> => {\r\n    const data: InterestsData = {\r\n        stats: {\r\n            totalActive: 0,\r\n            learningStreak: 0,\r\n        },\r\n        hobbies: []\r\n    };\r\n\r\n    await setDoc(getDocRef(userId), data);\r\n    await setDoc(getDocRef(userId), data);\r\n    return data;\r\n};\r\n\r\nexport interface InterestLog {\r\n    id: string;\r\n    hobbyId: string;\r\n    hobbyName: string;\r\n    durationMinutes?: number;\r\n    count?: number;\r\n    date: string;\r\n    notes?: string;\r\n}\r\n\r\nexport const logInterestActivity = async (userId: string, log: Omit<InterestLog, 'id'>) => {\r\n    // 1. Add log entry\r\n    await addDoc(collection(db, `users/${userId}/interest_logs`), log);\r\n\r\n    // 2. Update aggregate progress\r\n    if (log.durationMinutes) {\r\n        await updateInterestProgress(userId, log.hobbyId, log.durationMinutes / 60);\r\n    }\r\n};\r\n\r\nexport const getInterestLogsByDate = async (userId: string, date: string): Promise<InterestLog[]> => {\r\n    const q = query(collection(db, `users/${userId}/interest_logs`), where(\"date\", \"==\", date));\r\n    const snap = await getDocs(q);\r\n    return snap.docs.map(d => ({ id: d.id, ...d.data() } as InterestLog));\r\n};\r\n\r\nexport const saveDailyRecs = async (userId: string, date: string, window: keyof DailyRecs, recs: AIRec[]) => {\r\n    const ref = getDocRef(userId);\r\n    await updateDoc(ref, {\r\n        [`dailyRecs.${date}.${window}`]: recs\r\n    });\r\n};\r\n\r\nexport const saveAIRecFeedback = async (userId: string, date: string, window: keyof DailyRecs, recIndex: number, feedback: 'like' | 'dislike') => {\r\n    const ref = getDocRef(userId);\r\n    await updateDoc(ref, {\r\n        [`dailyRecs.${date}.${window}.${recIndex}.feedback`]: feedback\r\n    });\r\n};\r\n\r\nexport const markAIRecAsTask = async (userId: string, date: string, window: keyof DailyRecs, recIndex: number, taskId: string) => {\r\n    const ref = getDocRef(userId);\r\n    await updateDoc(ref, {\r\n        [`dailyRecs.${date}.${window}.${recIndex}.isAddedToTasks`]: true,\r\n        [`dailyRecs.${date}.${window}.${recIndex}.taskId`]: taskId\r\n    });\r\n};\r\n\r\nexport const markAIRecDone = async (userId: string, date: string, window: keyof DailyRecs, recIndex: number) => {\r\n    const ref = getDocRef(userId);\r\n    await updateDoc(ref, {\r\n        [`dailyRecs.${date}.${window}.${recIndex}.isDone`]: true\r\n    });\r\n};\r\n\r\nexport const logHabitOccurrence = async (userId: string, habit: { id: string, name: string, trackingMode?: 'frequency' | 'binary' }, date: string) => {\r\n    if (habit.trackingMode === 'binary') {\r\n        const q = query(\r\n            collection(db, `users/${userId}/interest_logs`),\r\n            where(\"hobbyId\", \"==\", habit.id),\r\n            where(\"date\", \"==\", date)\r\n        );\r\n        const existing = await getDocs(q);\r\n        if (!existing.empty) return; // Already logged for today\r\n    }\r\n\r\n    // 1. Add log entry as a count increment\r\n    await addDoc(collection(db, `users/${userId}/interest_logs`), {\r\n        hobbyId: habit.id,\r\n        hobbyName: habit.name,\r\n        count: 1,\r\n        date: date\r\n    });\r\n};\r\n\r\nexport const saveHabitAdvice = async (userId: string, date: string, advice: string) => {\r\n    const ref = getDocRef(userId);\r\n    await updateDoc(ref, {\r\n        [`dailyRecs.${date}.habitAdvice`]: advice\r\n    });\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\services\\mindService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\services\\tasksService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getDoc' is defined but never used.","line":2,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":33},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setDoc' is defined but never used.","line":2,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":50}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { db } from \"@/firebaseConfig\";\r\nimport { collection, doc, getDoc, getDocs, setDoc, addDoc, updateDoc, query, where, orderBy, deleteDoc, onSnapshot, limit } from \"firebase/firestore\";\r\nimport { getLocalTodayStr } from \"@/lib/dateUtils\";\r\n\r\nexport type Priority = 'low' | 'medium' | 'high';\r\nexport type TaskStatus = 'todo' | 'in-progress' | 'done';\r\n\r\nexport interface SubTask {\r\n    id: string;\r\n    title: string;\r\n    status: TaskStatus;\r\n    priority: Priority;\r\n    category?: string;\r\n    subtasks?: SubTask[];\r\n    date?: string;\r\n    startTime?: string;\r\n    endTime?: string;\r\n    parentId?: string;\r\n    parentTitle?: string;\r\n    createdAt?: number;\r\n}\r\n\r\nexport interface Resource {\r\n    type: 'link' | 'file';\r\n    title: string;\r\n    url: string;\r\n}\r\n\r\nexport interface Task {\r\n    id: string;\r\n    title: string;\r\n    description?: string;\r\n    status: TaskStatus;\r\n    priority: Priority;\r\n    startTime: string;\r\n    endTime: string;\r\n    category: string;\r\n    date: string; // YYYY-MM-DD\r\n    subtasks?: SubTask[];\r\n    resources?: Resource[];\r\n    parentId?: string;\r\n    parentTitle?: string;\r\n    createdAt?: number;\r\n    isSubtaskDisplay?: boolean;\r\n    parentTitleDisplay?: string;\r\n    parentIdDisplay?: string;\r\n}\r\n\r\nconst getSubCollection = (userId: string) => collection(db, `users/${userId}/tasks`);\r\n\r\nexport const getTasksByDate = async (userId: string, date: string): Promise<Task[]> => {\r\n    const q = query(getSubCollection(userId), where(\"date\", \"==\", date), orderBy(\"startTime\", \"asc\"));\r\n    const snap = await getDocs(q);\r\n    return snap.docs.map(d => ({ id: d.id, ...d.data() } as Task));\r\n};\r\n\r\nexport const subscribeToTasksByDate = (userId: string, date: string, callback: (tasks: Task[]) => void) => {\r\n    const q = query(getSubCollection(userId), where(\"date\", \"==\", date), orderBy(\"startTime\", \"asc\"));\r\n    return onSnapshot(q, (snap) => {\r\n        callback(snap.docs.map(d => ({ id: d.id, ...d.data() } as Task)));\r\n    });\r\n};\r\n\r\nexport const subscribeToUpcomingTasks = (userId: string, fromDate: string, callback: (tasks: Task[]) => void) => {\r\n    const q = query(getSubCollection(userId), where(\"date\", \">\", fromDate), orderBy(\"date\", \"asc\"), limit(20));\r\n    return onSnapshot(q, (snap) => {\r\n        callback(snap.docs.map(d => ({ id: d.id, ...d.data() } as Task)));\r\n    });\r\n};\r\n\r\nexport const subscribeToFutureTasks = (userId: string, fromDate: string, callback: (tasks: Task[]) => void) => {\r\n    const q = query(getSubCollection(userId), where(\"date\", \">\", fromDate), orderBy(\"date\", \"asc\"));\r\n    return onSnapshot(q, (snap) => {\r\n        callback(snap.docs.map(d => ({ id: d.id, ...d.data() } as Task)));\r\n    });\r\n};\r\n\r\nexport const getUpcomingTasks = async (userId: string, fromDate: string): Promise<Task[]> => {\r\n    const q = query(getSubCollection(userId), where(\"date\", \">\", fromDate), orderBy(\"date\"));\r\n    const snap = await getDocs(q);\r\n    return snap.docs.map(d => ({ id: d.id, ...d.data() } as Task));\r\n};\r\n\r\nexport const subscribeToOverdueTasks = (userId: string, date: string, callback: (tasks: Task[]) => void) => {\r\n    const q = query(getSubCollection(userId), where(\"date\", \"<\", date), where(\"status\", \"!=\", \"done\"));\r\n    return onSnapshot(q, (snap) => {\r\n        callback(snap.docs.map(d => ({ id: d.id, ...d.data() } as Task)));\r\n    });\r\n};\r\n\r\nexport const getOverdueTasks = async (userId: string, date: string): Promise<Task[]> => {\r\n    const q = query(\r\n        getSubCollection(userId),\r\n        where(\"date\", \"<\", date),\r\n        where(\"status\", \"!=\", \"done\")\r\n    );\r\n    const snap = await getDocs(q);\r\n    return snap.docs.map(d => ({ id: d.id, ...d.data() } as Task));\r\n};\r\n\r\nexport const moveTask = async (userId: string, taskId: string, newDate: string) => {\r\n    await updateDoc(doc(db, `users/${userId}/tasks/${taskId}`), { date: newDate });\r\n};\r\n\r\nexport const addTask = async (userId: string, task: Omit<Task, 'id'>) => {\r\n    await addDoc(getSubCollection(userId), task);\r\n};\r\n\r\nexport const updateTaskStatus = async (userId: string, taskId: string, status: TaskStatus) => {\r\n    await updateDoc(doc(db, `users/${userId}/tasks/${taskId}`), { status });\r\n};\r\n\r\nexport const updateTask = async (userId: string, taskId: string, updates: Partial<Task>) => {\r\n    await updateDoc(doc(db, `users/${userId}/tasks/${taskId}`), updates);\r\n};\r\n\r\nexport const deleteTask = async (userId: string, taskId: string) => {\r\n    await deleteDoc(doc(db, `users/${userId}/tasks/${taskId}`));\r\n};\r\n\r\nexport const seedTasks = async (userId: string) => {\r\n    const today = getLocalTodayStr();\r\n\r\n    // Onboarding Checklist\r\n    const tasks: Omit<Task, 'id'>[] = [\r\n        {\r\n            title: 'Welcome to Aura! ЁЯСЛ',\r\n            description: 'This is your centralized dashboard. Complete your profile to get started.',\r\n            status: 'todo',\r\n            priority: 'high',\r\n            startTime: '09:00',\r\n            endTime: '09:15',\r\n            category: 'Personal',\r\n            date: today,\r\n            subtasks: [\r\n                { id: '1-1', title: 'Complete profile setup', status: 'done', priority: 'high' },\r\n                { id: '1-2', title: 'Connect Shajara (Genealogy)', status: 'todo', priority: 'medium' }\r\n            ],\r\n            resources: [{ type: 'link', title: 'Getting Started Guide', url: 'https://aura-docs.com' }]\r\n        },\r\n        {\r\n            title: 'Set your Financial Goals',\r\n            description: 'Go to the Finance module and set a monthly budget.',\r\n            status: 'todo',\r\n            priority: 'medium',\r\n            startTime: '10:00',\r\n            endTime: '10:30',\r\n            category: 'Growth',\r\n            date: today,\r\n            subtasks: [\r\n                { id: '2-1', title: 'Review last month expenses', status: 'todo', priority: 'medium' },\r\n                { id: '2-2', title: 'Define savings target', status: 'todo', priority: 'high' }\r\n            ]\r\n        },\r\n        {\r\n            title: 'Log your first Mood',\r\n            description: 'Check in with the Mind module to track your mental state.',\r\n            status: 'todo',\r\n            priority: 'low',\r\n            startTime: '12:00',\r\n            endTime: '12:05',\r\n            category: 'Health',\r\n            date: today\r\n        },\r\n    ];\r\n\r\n    for (const t of tasks) {\r\n        await addDoc(getSubCollection(userId), t);\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\AURA\\web\\src\\services\\userService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'updateDoc' is defined but never used.","line":2,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":40}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { db } from \"@/firebaseConfig\";\r\nimport { doc, getDoc, setDoc, updateDoc } from \"firebase/firestore\";\r\n\r\nexport interface UserProfile {\r\n    uid: string;\r\n    email: string;\r\n    displayName?: string;\r\n    fullName?: string;\r\n    photoURL?: string;\r\n    language?: 'en' | 'uz' | 'ru';\r\n    plan?: string;\r\n    memberSince?: string;\r\n    profession?: string;\r\n    education?: string;\r\n    bio?: string;\r\n    settings?: {\r\n        notifications?: {\r\n            dailyBriefing: boolean;\r\n            focusAlerts: boolean;\r\n            familyUpdates: boolean;\r\n        }\r\n    };\r\n    lastViewed?: {\r\n        [key: string]: string; // ISO date string\r\n    };\r\n}\r\n\r\nexport const getUserProfile = async (uid: string): Promise<UserProfile | null> => {\r\n    const docRef = doc(db, \"users\", uid);\r\n    const docSnap = await getDoc(docRef);\r\n\r\n    if (docSnap.exists()) {\r\n        return docSnap.data() as UserProfile;\r\n    } else {\r\n        return null;\r\n    }\r\n};\r\n\r\nexport const createUserProfile = async (uid: string, data: Partial<UserProfile>) => {\r\n    const docRef = doc(db, \"users\", uid);\r\n    await setDoc(docRef, {\r\n        uid,\r\n        memberSince: new Date().toISOString(),\r\n        plan: \"Free\",\r\n        ...data\r\n    }, { merge: true });\r\n};\r\n\r\nexport const updateUserProfile = async (uid: string, data: Partial<UserProfile>) => {\r\n    const docRef = doc(db, \"users\", uid);\r\n    await setDoc(docRef, data, { merge: true });\r\n};\r\n","usedDeprecatedRules":[]}]
